import{_ as q,X as D,B as T,d as P,e as C,f as N,I as E,g as I,h as L,j as A,r as i,k as f,m,n as o,o as t,w as e,p as y,q as n,s as u,F as U,t as j,u as h}from"./index-13ff96f4.js";import{D as F,a as M}from"./DataTable-e31a825a.js";import{D as H,a as V}from"./DataTableCell-51c0104f.js";import{R as X}from"./RuntimeServicesEmptyState-4762d358.js";import{R as z}from"./RuntimeServiceActions-b7c4daa9.js";import{R as G}from"./repositoryActionMenu-07f5f11b.js";import{P as O}from"./PieChart-d893d03a.js";import"./OverviewEmptyState-c8440b9c.js";import"./RuntimeIllustration-4912df3a.js";import"./ActionMenu-3e4470bf.js";import"./transform-c376ec3f.js";import"./arc-12e4470a.js";const Z={components:{XPreloader:D,PieChart:O,BaseParagraph:T,BasePill:P,RepositoryActionMenu:G,BaseIconButton:C,RuntimeServiceActions:z,RuntimeServicesEmptyState:X,DataTable:F,DataTableCell:H,DataTableRow:V,DataTableHeader:M,BaseButton:N,InputSearch:E,BaseLink:I},data(){return{services:[],usageStats:void 0,loading:!0}},computed:{chartData(){let a=Math.round(this.usageStats.requests/this.usageStats.maxRequests*100),r="#645dd7";return a>=100&&(r="#d72638"),a=Math.min(a,100),[{value:100-a,color:"#A9A8B2"},{value:a,color:r}]},enrichedServices(){return this.services.map(r=>{var _;return{...r,requests:((_=this.usageStats.services.find(b=>b.service_id===r.id))==null?void 0:_.requests)||0}}).sort((r,_)=>_.requests-r.requests)},shouldShowEmptyState(){return!this.loading&&this.services.length===0}},async mounted(){this.$breadcrumbs.show({breadcrumbs:[{label:this.$t("RUNTIME_PROTECTION")}]});const[a,r]=await Promise.all([L(),A()]);this.services=a,this.usageStats=r,this.loading=!1},methods:{shortenNumber(a){return new Intl.NumberFormat("en",{notation:"compact",compactDisplay:"short"}).format(a)},percentageUsed(a){return new Intl.NumberFormat("en",{style:"percent",maximumFractionDigits:0}).format(a/this.usageStats.maxRequests)},exceededLimit(a){return a>=this.usageStats.maxRequests},handleGetStarted(){this.$router.push("/runtime/services")},handleExceededLimitClick(){window.Intercom&&window.Intercom("showNewMessage","Hi, I would like to upgrade my subscription for Zen.")}}},J={key:1,class:"flex flex-column gap-16px"},K={class:"flex align-center justify-between w-full truncate"},Q={key:0,class:"flex justify-between w-full items-center"},W={key:1},Y={colspan:"2"},$={key:0,class:"flex justify-between items-center w-full"},ee={class:"flex gap-8px align-center"},te={key:1},ae={class:"flex justify-end w-full"};function se(a,r,_,b,l,s){const x=i("XPreloader"),S=i("DataTableHeader"),d=i("BaseParagraph"),p=i("DataTableCell"),v=i("BasePill"),g=i("DataTableRow"),w=i("RuntimeServicesEmptyState"),k=i("PieChart"),B=i("DataTable"),R=i("BaseButton");return l.loading?(n(),f(x,{key:0,size:"medium",class:"supercenter",theme:"transparent"})):(n(),m("div",J,[o("div",null,[t(B,null,{header:e(()=>[t(S,{width:"auto"},{default:e(()=>[u("App name")]),_:1}),t(S,{width:"300px"},{default:e(()=>[u("# Requests current month")]),_:1})]),body:e(()=>[(n(!0),m(U,null,j(s.enrichedServices,c=>(n(),f(g,{key:c.id,class:"text-blue-dark",clickable:"",href:`/runtime/services/${c.id}/events`},{default:e(()=>[t(p,null,{default:e(()=>[o("div",K,[o("div",null,[t(d,{class:"truncate mb-4px"},{default:e(()=>[u(h(c.name),1)]),_:2},1024)])])]),_:2},1024),t(p,null,{default:e(()=>[l.usageStats.unlimited?(n(),m("div",W,[t(d,null,{default:e(()=>[u(h(s.shortenNumber(c.requests)),1)]),_:2},1024)])):(n(),m("div",Q,[o("div",null,[t(d,null,{default:e(()=>[u(h(s.shortenNumber(c.requests)),1)]),_:2},1024)]),o("div",null,[t(v,{variation:s.exceededLimit(c.requests)?"red":"gray-fill",title:s.percentageUsed(c.requests)},null,8,["variation","title"])])]))]),_:2},1024)]),_:2},1032,["href"]))),128)),s.shouldShowEmptyState?(n(),f(g,{key:0},{default:e(()=>[o("td",Y,[t(w,{onAddRuntimeService:s.handleGetStarted},null,8,["onAddRuntimeService"])])]),_:1})):l.loading?y("",!0):(n(),f(g,{key:1},{default:e(()=>[t(p,{class:"bg-gray-10"},{default:e(()=>[t(d,{bold:!0},{default:e(()=>[u("Total")]),_:1})]),_:1}),t(p,{class:"bg-gray-10"},{default:e(()=>[l.usageStats.unlimited?(n(),m("div",te,[t(d,null,{default:e(()=>[u(h(s.shortenNumber(l.usageStats.requests)),1)]),_:1})])):(n(),m("div",$,[o("div",ee,[t(k,{"max-size":16,thickness:3,data:s.chartData},null,8,["data"]),t(d,null,{default:e(()=>[u(h(s.shortenNumber(l.usageStats.requests))+" / "+h(s.shortenNumber(l.usageStats.maxRequests)),1)]),_:1})]),o("div",null,[t(v,{variation:s.exceededLimit(l.usageStats.requests)?"red":"gray-fill",title:s.percentageUsed(l.usageStats.requests)},null,8,["variation","title"])])]))]),_:1})]),_:1}))]),_:1}),o("div",ae,[s.exceededLimit(l.usageStats.requests)?(n(),f(R,{key:0,onClick:s.handleExceededLimitClick,variation:"brand-gradient",class:"mt-16px",type:"button"},{default:e(()=>[u(" Contact sales ")]),_:1},8,["onClick"])):y("",!0)])])]))}const pe=q(Z,[["render",se]]);export{pe as default};
