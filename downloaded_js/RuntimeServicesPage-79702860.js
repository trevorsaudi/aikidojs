import{_ as D,B as A,d as N,e as E,f as P,I as M,g as V,a2 as $,an as m,h as z,e2 as L,r as i,m as v,n as s,o as e,w as a,k as c,p as _,q as l,s as o,F as O,t as U,u as p,S as H,ai as k}from"./index-13ff96f4.js";import{D as j,a as F}from"./DataTable-e31a825a.js";import{D as W,a as X}from"./DataTableCell-51c0104f.js";import{R as q}from"./RuntimeServicesEmptyState-4762d358.js";import{R as G}from"./RuntimeServiceActions-b7c4daa9.js";import{R as J}from"./repositoryActionMenu-07f5f11b.js";import{g as K}from"./service-39b61fa2.js";import{_ as Q}from"./slack-acc9a57d.js";import"./OverviewEmptyState-c8440b9c.js";import"./RuntimeIllustration-4912df3a.js";import"./ActionMenu-3e4470bf.js";const Y={components:{BaseParagraph:A,BasePill:N,RepositoryActionMenu:J,BaseIconButton:E,RuntimeServiceActions:G,RuntimeServicesEmptyState:q,DataTable:j,DataTableCell:W,DataTableRow:X,DataTableHeader:F,BaseButton:P,InputSearch:M,BaseLink:V,XTooltip:$},data(){return{search:"",services:[],routeStats:[],loading:!0}},computed:{shouldShowEmptyState(){return!this.loading&&this.services.length===0},enrichedServices(){return this.services.filter(r=>this.search?r.name.toLowerCase().includes(this.search.toLowerCase()):!0).map(r=>{const n=this.routeStats.find(b=>b.service_id===r.id);return{...r,status:K(r),routes:n?n.routes:0,schemas:n?n.schemas:0}})}},created(){m.on("runtime.service.added",this.init),m.on("runtime.service.updated",this.init),m.on("runtime.service.deleted",this.init)},beforeUnmount(){m.off("runtime.service.added",this.init),m.off("runtime.service.updated",this.init),m.off("runtime.service.deleted",this.init)},async mounted(){this.$breadcrumbs.show({breadcrumbs:[{label:this.$t("RUNTIME_PROTECTION")}]}),await this.init()},methods:{async init(){this.search="",await this.loadServices()},async loadServices(){this.loading=!0,this.services=await z(),this.routeStats=await L(),this.loading=!1},async handleAddService(){if(this.$group.is_demo_group===1)return this.$modal.show("AddWorkspaceRedirectModal");await this.$modal.show("AddRuntimeServiceModal")}}},Z={class:"flex flex-column gap-16px"},tt={class:"flex justify-between tablet_flex-column"},et={class:"flex gap-8px flex-wrap tablet_mt-8px"},at=s("i",{class:"icon icon-information"},null,-1),st=s("img",{src:Q,alt:"Slack",height:"16"},null,-1),nt=s("span",{class:"text--semi-bold"},"Manage Alerts",-1),ot=s("i",{class:"icon icon-add"},null,-1),it={class:"flex align-center justify-between w-full truncate"},lt={key:0},rt={key:0,class:"text-gray-600 text-12px"},ct={class:"flex align-center gap-8px"},ut=s("p",{class:"pill__label truncate"},"Waiting for events",-1),dt={colspan:"6"};function mt(r,n,b,_t,w,f){const y=i("InputSearch"),S=i("BaseButton"),u=i("DataTableHeader"),g=i("BaseParagraph"),h=i("BasePill"),d=i("DataTableCell"),R=i("BaseIconButton"),B=i("RuntimeServiceActions"),x=i("DataTableRow"),T=i("RuntimeServicesEmptyState"),C=i("DataTable");return l(),v("div",Z,[s("div",tt,[e(y,{modelValue:w.search,"onUpdate:modelValue":n[0]||(n[0]=t=>w.search=t),spacing:"compact"},null,8,["modelValue"]),s("div",et,[e(S,{as:"'button'",size:"small",variation:"tertiary",onClick:n[1]||(n[1]=t=>r.$modal.show("RuntimeInstallInstructionsModal"))},{default:a(()=>[at,o(" Setup Instructions ")]),_:1}),this.services.length>0?(l(),c(S,{key:0,as:"link",variation:"white",size:"small",to:"/runtime/alerts/slack"},{default:a(()=>[st,nt]),_:1})):_("",!0),e(S,{as:"'button'",size:"small",onClick:f.handleAddService},{default:a(()=>[ot,o(" Add app ")]),_:1},8,["onClick"])])]),s("div",null,[e(C,null,{header:a(()=>[e(u,{width:"40%"},{default:a(()=>[o("Name")]),_:1}),e(u,{width:"auto"},{default:a(()=>[o("Linked Repo")]),_:1}),e(u,{width:"160px"},{default:a(()=>[o("Platform")]),_:1}),e(u,{width:"100px"},{default:a(()=>[o("Routes")]),_:1}),e(u,{width:"160px"},{default:a(()=>[o("Status")]),_:1}),e(u,{width:"48px"})]),body:a(()=>[(l(!0),v(O,null,U(f.enrichedServices,t=>(l(),c(x,{key:t.id,clickable:"",href:`/runtime/services/${t.id}/events`,class:"text-blue-dark"},{default:a(()=>[e(d,null,{default:a(()=>[s("div",it,[s("div",null,[e(g,{class:"truncate mb-4px"},{default:a(()=>[o(p(t.name),1)]),_:2},1024),t.agent?(l(),v("div",lt,[s("span",{class:H(["text-gray-600 text-12px",{"text-surface-orange-120":t.agent.latest_version&&t.agent.version!=t.agent.latest_version}])},[o(" Version "+p(t.agent.version),1),t.agent.latest_version&&t.agent.version!=t.agent.latest_version?(l(),v("span",rt," - Latest "+p(t.agent.latest_version),1)):_("",!0)],2)])):_("",!0)]),s("div",ct,[e(h,{title:t.environment,variation:"gray-fill",class:"text--capitalize"},null,8,["title"]),e(h,{title:r.$t("RUNTIME_PROTECTION.X_INSTANCES",t.amount_instances),variation:"gray-fill"},null,8,["title"])])])]),_:2},1024),e(d,null,{default:a(()=>[e(g,{class:"truncate"},{default:a(()=>[o(p(t.repo_name||"None"),1)]),_:2},1024)]),_:2},1024),e(d,null,{default:a(()=>[t.agent?(l(),c(g,{key:0},{default:a(()=>[o(p(t.agent.runtime),1)]),_:2},1024)):_("",!0)]),_:2},1024),e(d,null,{default:a(()=>[e(g,null,{default:a(()=>[o(p(t.routes),1)]),_:2},1024)]),_:2},1024),e(d,null,{default:a(()=>[t.status?(l(),c(h,{key:0,title:t.status.label,variation:t.status.color,iconSvg:t.status.svgIcon,class:"text--capitalize"},null,8,["title","variation","iconSvg"])):t.has_token?t.amount_instances==0?(l(),c(h,{key:2,variation:"gray-fill",class:"truncate"},{default:a(()=>[ut]),_:1})):_("",!0):(l(),c(h,{key:1,variation:"orange",title:"No token"}))]),_:2},1024),e(d,{spacing:"compact",alignment:"center"},{default:a(()=>[s("div",{class:"data-table__row__action-container",onClick:n[3]||(n[3]=k(()=>{},["prevent","stop"]))},[e(B,{service:t},{trigger:a(I=>[e(R,{onClick:n[2]||(n[2]=k(()=>{},["prevent","stop"])),onClicked:I.toggle,icon:"icon-actions",ref_for:!0,ref:"trigger",class:"data-table__row__action"},null,8,["onClicked"])]),_:2},1032,["service"])])]),_:2},1024)]),_:2},1032,["href"]))),128)),f.shouldShowEmptyState?(l(),c(x,{key:0},{default:a(()=>[s("td",dt,[e(T,{onAddRuntimeService:f.handleAddService},null,8,["onAddRuntimeService"])])]),_:1})):_("",!0)]),_:1})])])}const Rt=D(Y,[["render",mt]]);export{Rt as default};
