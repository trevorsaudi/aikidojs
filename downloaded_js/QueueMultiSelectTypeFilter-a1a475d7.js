import{F as R}from"./FilterButton-bb5393a7.js";import{_ as m,bt as x,B as L,x as $,r as u,q as s,k as S,w as h,aa as O,n as c,ai as p,m as r,F,t as C,p as d,o as b,s as I,u as _,S as o,cr as P}from"./index-13ff96f4.js";import{c as B}from"./ScmSecurity-27bd32ff.js";const N={props:{placement:{type:String},sections:{type:Array,required:!0},iconColor:{type:String,validator:t=>["green","organge","blue","purple","secondary","red"].includes(t)},useBaseIcon:Boolean},components:{Popover:x,BaseParagraph:L,BaseIcon:$},methods:{getIconColorTheme(t){switch(t){case"green":return"text-surface-green-100";case"blue":return"text-surface-blue-100";case"orange":return"text-surface-orange-100";case"purple":return"text-primary-aik-100";case"purple-light":return"text-primary-aik-80";case"secondary":return"text-secondary-dev-100";case"red":return"text-surface-red-100";default:return"text-carbon-100"}}}},Q={key:0,class:"divider w-full"},Y={key:1,class:"action-menu__section-title"},M=["disabled","onClick"],w={class:"action-menu__section-items"},D=["onClick","disabled"],V=["src"],q=["checked","disabled","onInput"];function K(t,n,i,f,k,a){const T=u("BaseParagraph"),g=u("BaseIcon"),y=u("Popover");return s(),S(y,{placement:i.placement,keepPopoverOpenOnInsideClick:!0},{trigger:h(l=>[O(t.$slots,"trigger",{toggle:l.toggle})]),content:h(()=>[c("div",{class:"action-menu",onClick:n[0]||(n[0]=p(()=>{},["prevent"]))},[(s(!0),r(F,null,C(i.sections,(l,U)=>{var v;return s(),r("div",{key:U,class:"action-menu__section"},[l.divider?(s(),r("hr",Q)):d("",!0),l.title?(s(),r("div",Y,[b(T,{color:"gray",class:"text--semi"},{default:h(()=>[I(_(l.title),1)]),_:2},1024),l.action?(s(),r("button",{key:0,disabled:l.action.disabled,class:"button-brand button--as-link",onClick:p(l.action.onClick,["prevent"])},_(l.action.label),9,M)):d("",!0)])):d("",!0),c("ul",w,[(s(!0),r(F,null,C((v=l.items)==null?void 0:v.filter(e=>!e.hidden),(e,A)=>(s(),r("li",{key:A,class:o(["action-menu__section__item group",[e.active&&"action-menu__section__item--active",e.destructive&&"action-menu__section__item--destructive"]])},[c("button",{onClick:p(E=>e.onClick(E),["prevent"]),disabled:e.disabled,class:"action-menu__section__item-button align-none relative"},[e.icon?(s(),r(F,{key:0},[i.useBaseIcon||e.useBaseIcon?(s(),S(g,{key:0,icon:e.icon,class:o(["mr-12px group-hover:opacity-0 transition-opacity transition-duration-150",[a.getIconColorTheme(e.iconColor),e.active&&"opacity-0"]])},null,8,["icon","class"])):(s(),r("i",{key:1,class:o(["icon icon-14px mr-12px group-hover:opacity-0 transition-opacity transition-duration-150",[e.icon,a.getIconColorTheme(e.iconColor),e.active&&"opacity-0"]])},null,2))],64)):d("",!0),e.svgIcon?(s(),r("img",{key:1,src:`/assets/icons/${e.svgIcon}.svg`,height:"14",class:o(["mr-12px group-hover:opacity-0 transition-opacity transition-duration-150",[e.active&&"opacity-0"]])},null,10,V)):d("",!0),c("div",{class:o(["opacity-0 group_hover_opacity-100 transition-opacity transition-duration-150 absolute pin-l-16px",{"opacity-100":e.active}])},[c("input",{ref_for:!0,ref:"checkbox",class:o(["cursor-pointer checkbox checkbox-sm mr-12px",{"checkbox--checked":e.active,"checkbox--unchecked":!e.active}]),type:"checkbox",checked:e.active,disabled:e.disabled,onInput:p(E=>!e.disabled&&e.onClick(E),["stop"])},null,42,q)],2),I(" "+_(e.label),1)],8,D)],2))),128))])])}),128))])]),_:3},8,["placement"])}const j=m(N,[["render",K]]),z={props:{cloud:{type:Object},initialRelatedTypeFilter:{type:Array,default:()=>[]},refreshQueryParams:{type:Boolean,default:!0},persistFilterToQueryParams:{type:Boolean,default:!1}},components:{MultiSelectActionMenu:j,FilterButton:R},data(){return{relatedTypeFilters:this.initialRelatedTypeFilter,ignoreReasonFilter:this.$route.query.ignore_reason_filter}},emits:["filterSelected"],computed:{label(){if(this.relatedTypeFilters.length>0){const t=this.relatedTypeFilters.map(i=>this.$t(`QUEUE.FILTER.LABEL_SHORTHAND.${i}`));let n=t.join(", ");return t.length>3&&(n=[...t].slice(0,3).join(", ")+",..."),this.$t("QUEUE.QUICK_FILTER.LABEL",{filter:n})}return"All types"},actions(){return[{title:this.$t("QUEUE.TYPE_FILTER.TITLE"),action:{label:this.clearFilterCopy,onClick:()=>this.handleClearFilter()},items:[...this.ignoreReasonFilter?[{label:"Ignore reason",icon:"icon-hidden",onClick:this.handleToggleIgnoreReasonFilter,active:!0}]:[],{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.OPEN_SOURCE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("open_source"),icon:"icon-box",active:this.isActive("open_source"),type:"open_source"},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.SAST_ISSUES"),onClick:()=>this.handleToggleTypeFilter("sast"),icon:"icon-code",active:this.isActive("sast"),type:"sast"},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.IAC_ISSUES"),onClick:()=>this.handleToggleTypeFilter("iac"),icon:"icon-IasC",active:this.isActive("iac"),type:"iac"},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.LEAKED_SECRETS"),onClick:()=>this.handleToggleTypeFilter("leaked_secret"),icon:"icon-secrets",active:this.isActive("leaked_secret"),type:"leaked_secret"},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.SURFACE_MONITORING_ISSUES"),onClick:()=>this.handleToggleTypeFilter("surface_monitoring"),icon:"icon-group",active:this.isActive("surface_monitoring"),type:"surface_monitoring"}]},{divider:!0,items:[{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.CLOUD_CONFIG_ISSUES"),onClick:()=>this.handleToggleTypeFilter("cloud"),icon:"icon-cloud",active:this.isActive("cloud"),type:"cloud"},{label:this.$t("QUEUE.QUICK_FILTER.ACTIONS.DOCKER"),onClick:()=>this.handleToggleTypeFilter("docker_container"),icon:"icon-container",active:this.isActive("docker_container"),type:"docker_container"},...this.$featureflags.aws_ebs_scanning||this.$featureflags.azure_vm_scanning?[{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.CLOUD_INSTANCE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("cloud_instance"),icon:"icon-cloud-server",active:this.isActive("cloud_instance"),type:"cloud_instance"}]:[]]},{divider:!0,items:[{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.MOBILE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("mobile"),icon:"icon-mobile",active:this.isActive("mobile"),type:"mobile"},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.MALWARE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("malware"),icon:"icon-critical",active:this.isActive("malware"),type:"malware"},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.EOL_ISSUES"),onClick:()=>this.handleToggleTypeFilter("eol"),icon:"icon-eol",active:this.isActive("eol"),type:"eol"},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.SCM_SECURITY_ISSUES"),onClick:()=>this.handleToggleTypeFilter("scm_security"),icon:"icon-git",active:this.isActive("scm_security"),type:"scm_security",hidden:B()===!1},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.LICENSE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("license"),icon:"icon-license",active:this.isActive("license"),type:"license",hidden:!this.$featureflags.licenses_in_feed}]}]},hasFilter(){return!!this.ignoreReasonFilter||this.relatedTypeFilters.length>0},clearFilterCopy(){return this.relatedTypeFilters.length==0?"Select all":"Clear all"}},methods:{isActive(t){return this.relatedTypeFilters.includes(t)},handleClearFilter(){if(this.relatedTypeFilters.length==0){const t=this.actions.map(n=>n.items.filter(i=>!i.hidden&&i.type).map(i=>i.type)).flat(1);this.relatedTypeFilters=t}else this.relatedTypeFilters=[],this.clearIgnoreReasonFilter();this.emitSelectedFilter()},handleToggleTypeFilter(t){const n=this.relatedTypeFilters.findIndex(i=>i==t);if(n!=-1){const i=[...this.relatedTypeFilters];i.splice(n,1),this.relatedTypeFilters=i}else this.relatedTypeFilters.push(t);this.emitSelectedFilter()},clearIgnoreReasonFilter(){this.ignoreReasonFilter=void 0,this.refreshQueryParams&&this.$router.replace({query:{}})},handleToggleIgnoreReasonFilter(){this.clearIgnoreReasonFilter(),this.emitSelectedFilter()},emitSelectedFilter(){const t={relatedTypeFilters:this.relatedTypeFilters,ignoreReasonFilter:this.ignoreReasonFilter};this.$emit("filterSelected",t),this.persistFilterToQueryParams&&P(t)}}},G=c("i",{class:"icon icon-caret_down icon-12px"},null,-1);function H(t,n,i,f,k,a){const T=u("FilterButton"),g=u("MultiSelectActionMenu");return s(),S(g,{sections:a.actions,placement:"bottom-start",useBaseIcon:!0},{trigger:h(y=>[b(T,{onClick:y.toggle,class:o({"filter-button--active":a.hasFilter})},{default:h(()=>[I(_(a.label)+" ",1),G]),_:2},1032,["onClick","class"])]),_:1},8,["sections"])}const Z=m(z,[["render",H]]);export{Z as Q};
