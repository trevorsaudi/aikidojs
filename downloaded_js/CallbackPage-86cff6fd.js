import{a as p,b as h,c as m,u as x}from"./ms-teams-5bb92351.js";import{_ as k,X as T,H as B,N as w,f as y,c4 as C,c0 as N,c5 as S,r as t,k as V,m as v,n,o as a,w as o,q as d,s as i}from"./index-13ff96f4.js";const L={components:{XPreloader:T,BaseHeading:B,BaseSelect:w,BaseButton:y},data(){return{teams:[],isLoading:!0,team:null}},async mounted(){const{code:c}=C();if(!N("ms-teams"))return Toast.error({title:this.$t("SOMETHING_WENT_WRONG"),description:this.$t("ERR_INTEGRATION_OAUTH_VALIDATION")}),S("Integration MS Teams oauth token validation failed"),go("/settings/integrations");try{await p({code:c}),await this.fetchTeams()}catch{go("/settings/integrations")}},methods:{async fetchTeams(){if(this.teams=await h(),this.teams.length!==1){this.isLoading=!1;return}return await m(this.teams[0].id),go("/settings/integrations/notifications/ms-teams")},async handleLinkTeam(){return await m(this.team),go("/settings/integrations/notifications/ms-teams")},async handleCancel(){await x(),go("/settings/integrations")}}},H={key:1,class:"page-content flex align-center justify-center flex-1"},I={class:"flex max-w-600px w-full py-32px px-16px bg-white rounded-8px shadow-sm"},M={class:"flex flex-column gap-16px flex-1"},O={class:"flex gap-8px justify-between flex-1"};function A(c,s,E,b,e,l){const u=t("XPreloader"),f=t("BaseHeading"),g=t("BaseSelect"),r=t("BaseButton");return e.isLoading?(d(),V(u,{key:0,class:"supercenter",theme:"light"})):(d(),v("div",H,[n("div",I,[n("div",M,[a(f,{as:"h3"},{default:o(()=>[i("Select the Microsoft Teams team you'd like to connect to Aikido")]),_:1}),a(g,{id:"team",modelValue:e.team,"onUpdate:modelValue":s[0]||(s[0]=_=>e.team=_),options:e.teams},null,8,["modelValue","options"]),n("div",O,[a(r,{onClick:l.handleCancel,class:"ml-auto",variation:"secondary"},{default:o(()=>[i("Cancel")]),_:1},8,["onClick"]),a(r,{onClick:l.handleLinkTeam},{default:o(()=>[i("Connect team")]),_:1},8,["onClick"])])])])]))}const X=k(L,[["render",A]]);export{X as default};
