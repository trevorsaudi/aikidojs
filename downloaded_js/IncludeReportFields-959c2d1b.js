import{_ as k,M as F,X as I,B as C,f as x,g as L,f9 as P,r as o,q as l,k as A,w as a,o as n,s as r,m as c,p as f,n as v,a2 as B,fa as R,F as T,t as E,u as S}from"./index-13ff96f4.js";import{A as M}from"./AuditReport-bfa18622.js";import{g as N}from"./slaSettings-fece48e7.js";import{I as O}from"./InputCheckbox-81cb3ca6.js";const V={props:{includedFields:Array,filterTeamId:[String,Number]},components:{AuditReport:M,BaseModal:F,XPreloader:I,BaseParagraph:C,BaseButton:x,BaseLink:L},emits:["close"],data(){return{isLoading:!0,report:{}}},async mounted(){await this.fetchReportDetails(),this.isLoading=!1},methods:{async fetchReportDetails(){this.report=await P(this.includedFields.map(e=>e.id),this.filterTeamId)},openPrintView(){const e=document.createElement("div");e.innerHTML=this.$refs.AuditReportWrapper.innerHTML,document.documentElement.appendChild(e),document.body.classList.add("hidden"),window.print(),document.documentElement.removeChild(e),document.body.classList.remove("hidden")}}},D={key:0},U=v("span",{class:"text-underline"},"Print",-1),$={key:0,class:"min-h-110px relative"},X={key:1,class:"border-1 border-carbon-40 bg-carbon-5 p-12px rounded-4px",ref:"AuditReportWrapper"};function H(e,t,i,u,p,d){const y=o("BaseLink"),_=o("BaseParagraph"),m=o("XPreloader"),b=o("AuditReport"),g=o("BaseButton"),s=o("BaseModal");return l(),A(s,{width:900,onClose:t[1]||(t[1]=w=>e.$emit("close"))},{header:a(()=>[n(_,{color:"gray"},{default:a(()=>[r(" Report preview "),!p.isLoading&&e.$group.status!="trial"?(l(),c("span",D,[r("- "),n(y,{onClick:d.openPrintView,class:"text--normal text-carbon-60"},{default:a(()=>[U]),_:1},8,["onClick"])])):f("",!0)]),_:1})]),content:a(()=>[p.isLoading?(l(),c("div",$,[n(m,{class:"absolute-centered",size:"medium",theme:"transparent"})])):(l(),c("div",X,[n(b,{report:p.report,"is-preview":!0},null,8,["report"])],512))]),footer:a(()=>[n(g,{onClicked:t[0]||(t[0]=w=>e.$emit("close")),variation:"plain",class:"ml-auto"},{default:a(()=>[r(" Cancel ")]),_:1})]),_:1})}const Z=k(V,[["render",H]]),h=[{id:"aikido_benchmark",label:"Aikido benchmark",description:"An indicator of how your account performs against other Aikido customers in terms of code, cloud and general security.",tooltip:"The Aikido Benchmark is an organization wide score and can therefore not be applied on a per team basis"},{id:"owasp",label:"OWASP Top 10",description:"An overview of the OWASP top 10 risks that your organization currently has active measures against"},{id:"sla_compliance",label:"SLA compliance",description:"An overview of the SLA levels you configured and number of issues which currently have not yet been resolved in those timeframes",tooltip:"Enable and configure the SLAs from the settings page to include this field into your reports",settingsUrl:"/settings/sla"},{id:"iso_27001_2022",label:"ISO 27001:2022 compliance",description:"A summary of topics from ISO with which you currently comply"},{id:"soc2",label:"SOC2 compliance",description:"A summary of topics from SOC2 with which you currently comply"},{id:"cis",label:"CIS Controls",description:"A summary of topics from CIS with which you currently comply"},{id:"nis2",label:"NIS2 Directive",description:"A summary of topics from NIS2 with which you currently comply"},{id:"nist",label:"NIST Compliance",description:"A summary of topics from NIST Comlpiance Checklist with which you currently comply"},{id:"pci",label:"PCI Standards",description:"A summary of topics from PCI with which you currently comply"},{id:"hipaa",label:"HIPAA Compliance Checklist",description:"A summary of topics from HIPAA Compliance Checklist with which you currently comply"},{id:"dora",label:"DORA Compliance Checklist",description:"A summary of topics from DORA Compliance Checklist with which you currently comply"},{id:"hitrust",label:"HITRUST LVL3 Compliance",description:"A summary of topics from HITRUST LVL3 Compliance framework with which you currently comply"},{id:"gdpr",label:"GDPR Compliance",description:"A summary of topics from GDPR with which you currently comply"},{id:"ens",label:"Esquema Nacional de Seguridad (ENS) compliance",description:"A summary of topics from ENS with which you currently comply"},{id:"scan_history",label:"Scan history",description:"A brief overview of the different scans we perform, their frequency and coverage"},{id:"issue_insights",label:"Issue insights",description:"A high level overview of some key statistics about the issues we found in the past 90 days"},{id:"open_issue_insights",label:"Open Issues Snapshot",description:"A high level overview of the current open issues per severity and per type"},{id:"cloud_compliance",label:"Cloud compliance",description:"A list of cloud rules that your account complies with",tooltip:"Connect your cloud to include this field into your reports",settingsUrl:"/clouds?connect_cloud=true"}],W={props:{allowEdits:Boolean,initialSelectedFields:{type:Array,default:null,required:!1},excludeFields:{type:Array,default:()=>[]}},emits:["update"],components:{InputCheckbox:O,BaseParagraph:C,XTooltip:B},data(){return{isLoading:!0,cloudMetadata:{},enabledSlaSettings:!1,selectedFields:[],disabledFields:[]}},watch:{excludeFields(){for(const e of this.excludeFields)this.handleUpdateField(!1,{id:e})}},async mounted(){await Promise.allSettled([this.fetchCloudMetadata(),this.fetchSlaSettings()]);let e=[];if(this.cloudMetadata.count===0&&e.push("cloud_compliance"),this.enabledSlaSettings===!1&&e.push("sla_compliance"),this.disabledFields=e,this.initialSelectedFields!=null)this.selectedFields=h.filter(t=>this.initialSelectedFields.includes(t.id));else{const t=h.filter(i=>i.id!=="soc2"&&i.id!=="iso_27001_2022"&&i.id!=="cis"&&i.id!=="nis2"&&i.id!=="nist"&&i.id!=="aikido_benchmark"&&i.id!=="issues"&&i.id!=="pci"&&i.id!=="hipaa"&&i.id!=="dora"&&i.id!=="hitrust"&&i.id!=="ens"&&i.id!=="gdpr"&&i.id!=="open_issue_insights");this.selectedFields=t.filter(i=>this.disabledFields.includes(i.id)===!1)}this.isLoading=!1,this.$emit("update",this.selectedFields)},computed:{fieldOptions(){return this.isLoading?[]:h},disabledFieldIds(){return this.allowEdits===!1?h.map(e=>e.id):[...this.disabledFields,...this.excludeFields]}},methods:{handleUpdateField(e,t){const i=!!this.selectedFields.find(u=>u.id===t.id);e&&i||!e&&!i||(!e&&i&&(this.selectedFields=this.selectedFields.filter(u=>u.id!==t.id)),e&&!i&&(this.selectedFields=[...this.selectedFields,t]),this.$emit("update",this.selectedFields))},isSelected(e){return this.selectedFields.some(t=>t.id===e)},isFieldDisabled(e){return this.allowEdits===!1?!0:this.disabledFields.includes(e)},async fetchCloudMetadata(){this.cloudMetadata=await R()},async fetchSlaSettings(){const e=await N();this.enabledSlaSettings=e.is_enabled}}},q={class:"flex flex-column gap-8px"},z={key:0,class:"h-104px relative"},G={class:"flex flex-column"};function j(e,t,i,u,p,d){const y=o("XPreloader"),_=o("RouterLink"),m=o("BaseParagraph"),b=o("XTooltip"),g=o("InputCheckbox");return l(),c("div",q,[p.isLoading?(l(),c("div",z,[n(y,{class:"absolute-centered mt-12px",size:"medium"})])):f("",!0),(l(!0),c(T,null,E(d.fieldOptions,s=>(l(),c("div",{key:s.id,class:"flex align-center gap-12px"},[n(g,{"onUpdate:modelValue":w=>d.handleUpdateField(w,s),modelValue:d.isSelected(s.id),disabled:d.disabledFieldIds.includes(s.id),name:s.id,class:"align-center"},{default:a(()=>[v("div",G,[n(m,null,{default:a(()=>[r(S(s.label)+" ",1),d.disabledFieldIds.includes(s.id)&&s.settingsUrl?(l(),A(_,{key:0,class:"ml-8px link",to:s.settingsUrl},{default:a(()=>[r("Enable")]),_:2},1032,["to"])):f("",!0)]),_:2},1024),n(m,{color:"gray"},{default:a(()=>[r(S(s.description),1)]),_:2},1024)]),s.tooltip&&d.disabledFieldIds.includes(s.id)?(l(),A(b,{key:0},{default:a(()=>[r(S(s.tooltip),1)]),_:2},1024)):f("",!0)]),_:2},1032,["onUpdate:modelValue","modelValue","disabled","name"])]))),128))])}const ee=k(W,[["render",j]]);export{ee as I,Z as R};
