import{s as b}from"./transform-c376ec3f.js";import{_ as z,q as g,m as y,F as M,t as B,ah as R,u as K,p as V,S as _,n as S}from"./index-13ff96f4.js";import{c as l,t as w,a as q}from"./arc-12e4470a.js";function E(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function G(n,s){return s<n?-1:s>n?1:s>=n?0:NaN}function j(n){return n}function F(){var n=j,s=G,a=null,u=l(0),r=l(w),i=l(0);function e(t){var o,c=(t=E(t)).length,m,x,v=0,f=new Array(c),h=new Array(c),p=+u.apply(this,arguments),C=Math.min(w,Math.max(-w,r.apply(this,arguments)-p)),A,L=Math.min(Math.abs(C)/c,i.apply(this,arguments)),N=L*(C<0?-1:1),d;for(o=0;o<c;++o)(d=h[f[o]=o]=+n(t[o],o,t))>0&&(v+=d);for(s!=null?f.sort(function(k,$){return s(h[k],h[$])}):a!=null&&f.sort(function(k,$){return a(t[k],t[$])}),o=0,x=v?(C-c*N)/v:0;o<c;++o,p=A)m=f[o],d=h[m],A=p+(d>0?d*x:0)+N,h[m]={data:t[m],index:o,value:d,startAngle:p,endAngle:A,padAngle:L};return h}return e.value=function(t){return arguments.length?(n=typeof t=="function"?t:l(+t),e):n},e.sortValues=function(t){return arguments.length?(s=t,a=null,e):s},e.sort=function(t){return arguments.length?(a=t,s=null,e):a},e.startAngle=function(t){return arguments.length?(u=typeof t=="function"?t:l(+t),e):u},e.endAngle=function(t){return arguments.length?(r=typeof t=="function"?t:l(+t),e):r},e.padAngle=function(t){return arguments.length?(i=typeof t=="function"?t:l(+t),e):i},e}const P={props:{data:{type:Array,required:!0},hasLegend:{type:Boolean,default:!1},containerClass:{type:String,default:""},maxSize:{type:Number,default:200},thickness:{type:Number,default:0},marginTop:{type:Number,default:0},marginRight:{type:Number,default:0},marginLeft:{type:Number,default:0},menuKey:{type:String,required:!1}},data(){return{radius:0,arc:null,pieG:null}},created(){window.addEventListener("resize",this.renderChart)},beforeUnmount(){window.removeEventListener("resize",this.renderChart)},mounted(){this.renderChart()},watch:{data:{handler(){this.renderChart()},deep:!0},menuKey(){this.renderChart()}},methods:{clearChart(){this.$refs,b(this.$refs.container).select(".containerChart svg > *").remove()},renderChart(){this.clearChart();const n=b(this.$refs.container).select(".containerChart svg"),s=Math.round(this.$refs.container.clientWidth),a=Math.min(s,this.maxSize);this.radius=(a-this.marginLeft-this.marginRight)/2,n.attr("width",a).attr("height",a);const u=n.append("g").attr("transform",`translate(${this.marginLeft}, ${this.marginTop})`),r=Math.max(this.radius-this.thickness,0);this.arc=q().outerRadius(this.radius).innerRadius(r).padAngle(0).cornerRadius(0),this.pieG=u.append("g").attr("transform",`translate(${this.radius}, ${this.radius})`),this.drawChart(this.data)},drawChart(n){const s=F().sort(null).value(r=>r.value)(n),a=this.pieG.selectAll(".arc").data(s);a.select("path").attr("d",this.arc),a.enter().append("g").classed("arc",!0).append("path").attr("d",this.arc).attr("id",(r,i)=>"arc-"+i).attr("fill",r=>r.data.color).attr("fill-opacity",r=>!this.menuKey||r.data.key===this.menuKey?1:.25).on("mouseover",r=>{var i,e;this.$emit("hover",this.data,r.data,(i=r.event)==null?void 0:i.clientX,(e=r.event)==null?void 0:e.clientY)}).on("mousemove",r=>{var i,e;this.$emit("hover",this.data,r.data,(i=r.event)==null?void 0:i.clientX,(e=r.event)==null?void 0:e.clientY)}).on("mouseout",()=>{this.$emit("hoverOut")})}}},T=S("div",{class:"containerChart inline-flex"},[S("svg")],-1),W={key:0,class:"text-center mb-20px"};function X(n,s,a,u,r,i){return g(),y("div",{class:_(["inline-flex align-center",a.containerClass]),ref:"container"},[T,a.hasLegend?(g(),y("div",W,[(g(!0),y(M,null,B(a.data,e=>(g(),y("span",{key:e.key,style:R({color:e.color}),class:"px-10px"},K(n.$t(e.key)),5))),128))])):V("",!0)],2)}const U=z(P,[["render",X]]);export{U as P};
