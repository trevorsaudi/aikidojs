import{f as A}from"./reports-ed4978a9.js";import{P as S}from"./PageHeader-46c38a32.js";import{_ as M,H as x,X as B,dv as I,B as D,aV as H,r as e,m as s,o as t,w as a,n as r,k as h,F as l,t as L,p as N,q as i,s as _,S as R,u as p}from"./index-13ff96f4.js";import{A as V}from"./ActionMenu-3e4470bf.js";import{F as E}from"./FilterButton-bb5393a7.js";import{C as T}from"./ComplianceSection-1226ea47.js";import{C as O}from"./CompliancePrintHeader-341b18be.js";import{P as X}from"./PdfDownloadButton-072addbd.js";import"./AccordionContainer-09dc0ed4.js";import"./DataTable-e31a825a.js";import"./DataTableCell-51c0104f.js";import"./BracesIcon-0a8568f4.js";const z={components:{PageHeader:S,BaseHeading:x,XPreloader:B,ProgressBar:I,ComplianceSection:T,CompliancePrintHeader:O,ActionMenu:V,FilterButton:E,BaseParagraph:D,PdfDownloadButton:X},data(){return{isLoading:!0,overview:{},groupReference:void 0,mode:void 0}},provide(){return{filter_team_id:H(()=>this.$teamContext)}},async mounted(){await Promise.allSettled([this.loadComplianceOverview()])},watch:{async $teamContext(){this.$globalLoadingIndicator.show();try{await this.loadComplianceOverview()}finally{this.$globalLoadingIndicator.hide()}}},computed:{breadcrumbs(){return[{label:"Reports",href:"/reports"},{label:"CIS compliance"}]},compliance(){const n=this.overview.total_complying_rule_count??0,d=this.overview.total_rule_count??0;return n===0||this.isLoading?0:Math.round(n/d*100)},sections(){return this.mode?this.overview[this.mode]??{}:{...this.overview.inventory_and_control_of_software_assets??{},...this.overview.data_protection??{},...this.overview.secure_configuration_of_enterprise_assets_and_software??{},...this.overview.account_management??{},...this.overview.enhanced_access_control_management??{},...this.overview.continuous_vulnerability_management??{},...this.overview.audit_log_management??{},...this.overview.malware_defenses??{},...this.overview.data_recovery??{},...this.overview.network_infrastructure_management??{},...this.overview.network_monitoring_and_defense??{},...this.overview.application_software_security??{},...this.overview.incident_response_management??{}}},filterLabel(){return this.mode?this.mode==="inventory_and_control_of_enterprise_assets"?"Inventory and Control of Enterprise Assets":this.mode==="inventory_and_control_of_software_assets"?"Inventory and Control of Software Assets":this.mode==="data_protection"?"Data Protection":this.mode==="secure_configuration_of_enterprise_assets_and_software"?"Secure Configuration of Enterprise Assets and Software":this.mode==="account_management"?"Account Management":this.mode==="enhanced_access_control_management"?"Access Control Management":this.mode==="continuous_vulnerability_management"?"Continuous Vulnerability Management":this.mode==="malware_defenses"?"Malware Defenses":this.mode==="data_recovery"?"Data Recovery":this.mode==="network_infrastructure_management"?"Network Infrastructure Management":this.mode==="network_monitoring_and_defense"?"Network Monitoring and Defense":this.mode==="security_awareness_and_skills_training"?"Security Awareness and Skills Training":this.mode==="service_provider_management"?"Service Provider Management":this.mode==="penetration_testing"?"Penetration Testing":this.mode==="application_software_security"||this.mode==="incident_response_management"?"application_software_security":"Filter controls":"Filter controls"},actions(){return[{title:"Controls",action:{label:"Clear filter",onClick:()=>this.mode=void 0},items:[{label:"1 Inventory and Control of Enterprise Assets",onClick:()=>this.handleChangeFilter("inventory_and_control_of_enterprise_assets"),active:this.mode==="inventory_and_control_of_enterprise_assets"},{label:"2 Inventory and Control of Software Assets",onClick:()=>this.handleChangeFilter("inventory_and_control_of_software_assets"),active:this.mode==="inventory_and_control_of_software_assets"},{label:"3 Data Protection",onClick:()=>this.handleChangeFilter("data_protection"),active:this.mode==="data_protection"},{label:"4 Secure Configuration of Enterprise Assets and Software",onClick:()=>this.handleChangeFilter("secure_configuration_of_enterprise_assets_and_software"),active:this.mode==="secure_configuration_of_enterprise_assets_and_software"},{label:"5 Account Management",onClick:()=>this.handleChangeFilter("account_management"),active:this.mode==="account_management"},{label:"6 Access Control Management",onClick:()=>this.handleChangeFilter("enhanced_access_control_management"),active:this.mode==="enhanced_access_control_management"},{label:"7 Continuous Vulnerability Management",onClick:()=>this.handleChangeFilter("continuous_vulnerability_management"),active:this.mode==="continuous_vulnerability_management"},{label:"8 Audit Log Management",onClick:()=>this.handleChangeFilter("audit_log_management"),active:this.mode==="audit_log_management"},{label:"9 Email and Web Browser Protections",onClick:()=>this.handleChangeFilter("email_and_web_browser_protections"),active:this.mode==="email_and_web_browser_protections"},{label:"10 Malware Defenses",onClick:()=>this.handleChangeFilter("malware_defenses"),active:this.mode==="malware_defenses"},{label:"11 Data Recovery",onClick:()=>this.handleChangeFilter("data_recovery"),active:this.mode==="data_recovery"},{label:"12 Network Infrastructure Management",onClick:()=>this.handleChangeFilter("network_infrastructure_management"),active:this.mode==="network_infrastructure_management"},{label:"13 Network Monitoring and Defense",onClick:()=>this.handleChangeFilter("network_monitoring_and_defense"),active:this.mode==="network_monitoring_and_defense"},{label:"14 Security Awareness and Skills Training",onClick:()=>this.handleChangeFilter("security_awareness_and_skills_training"),active:this.mode==="security_awareness_and_skills_training"},{label:"15 Service Provider Management",onClick:()=>this.handleChangeFilter("service_provider_management"),active:this.mode==="service_provider_management"},{label:"16 Application Software Security",onClick:()=>this.handleChangeFilter("application_software_security"),active:this.mode==="application_software_security"},{label:"17 Incident Response Management",onClick:()=>this.handleChangeFilter("incident_response_management"),active:this.mode==="incident_response_management"},{label:"18 Penetration Testing",onClick:()=>this.handleChangeFilter("penetration_testing"),active:this.mode==="penetration_testing"}]}]},emptyControlsMessage(){if(this.mode==="inventory_and_control_of_enterprise_assets"||this.mode==="email_and_web_browser_protections"||this.mode==="security_awareness_and_skills_training"||this.mode==="service_provider_management"||this.mode==="penetration_testing"||this.mode==="incident_response_management")return"Aikido currently does not support any checks for this control"}},methods:{async loadComplianceOverview(){this.overview=await A({teamId:null}),this.isLoading=!1},handleChangeFilter(n){if(this.mode===n){this.mode=void 0;return}this.mode=n}}},W={class:"flex gap-32px align-center"},q={class:"page-content"},j={class:"mb-16px flex align-center gap-12px"},G=r("i",{class:"icon icon-caret_down icon-12px"},null,-1),J={class:"flex flex-column gap-12px",id:"ComplianceSectionWrapper"},K={key:0,class:"flex rounded-8px py-32px px-16px bg-white border-1 border-carbon-20"};function Q(n,d,U,Y,m,o){const f=e("BaseHeading"),g=e("ProgressBar"),v=e("PdfDownloadButton"),w=e("PageHeader"),C=e("XPreloader"),y=e("FilterButton"),k=e("ActionMenu"),b=e("CompliancePrintHeader"),P=e("ComplianceSection"),F=e("BaseParagraph");return i(),s(l,null,[t(w,{breadcrumbs:o.breadcrumbs},{title:a(()=>[r("div",W,[t(f,{as:"h1"},{default:a(()=>[_("CIS compliance overview")]),_:1}),t(g,{progress:o.compliance},null,8,["progress"])])]),rightContent:a(()=>[t(v,{exportType:"cis"})]),_:1},8,["breadcrumbs"]),r("div",q,[m.isLoading?(i(),h(C,{key:0,class:"absolute-centered",theme:"transparent"})):(i(),s(l,{key:1},[r("div",j,[t(k,{sections:o.actions,placement:"bottom-start"},{trigger:a(c=>[t(y,{onClick:c.toggle,class:R({"filter-button--active":!!m.mode})},{default:a(()=>[_(p(o.filterLabel)+" ",1),G]),_:2},1032,["onClick","class"])]),_:1},8,["sections"])]),r("div",J,[t(b,{title:"CIS compliance overview"}),(i(!0),s(l,null,L(o.sections??{},(c,u)=>(i(),h(P,{key:u,section:c,code:u},null,8,["section","code"]))),128)),o.emptyControlsMessage?(i(),s("div",K,[t(F,{size:"medium"},{default:a(()=>[_(p(o.emptyControlsMessage),1)]),_:1})])):N("",!0)])],64))])],64)}const _e=M(z,[["render",Q]]);export{_e as default};
