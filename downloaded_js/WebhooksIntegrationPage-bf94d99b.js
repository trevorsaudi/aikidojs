import{_ as S,r as o,q as i,k as b,w as t,aa as O,B as x,e as P,o as e,s as d,u as B,n as l,ai as H,f as C,an as u,m as g,F as f,a1 as V,g as N,t as D,p as F}from"./index-13ff96f4.js";import{t as j,h as z,c as G,l as A}from"./webhooks-7a1ad9af.js";import{P as K}from"./PageHeader-46c38a32.js";import{D as Y,a as U}from"./DataTable-e31a825a.js";import{a as I,D as $}from"./DataTableCell-51c0104f.js";import{A as v}from"./ActionMenu-3e4470bf.js";import{O as q}from"./OverviewEmptyState-c8440b9c.js";import{E as J}from"./EmptyMetricsIllutstration-491e438a.js";import{F as Q}from"./FilterButton-bb5393a7.js";const X={props:{webhook:Object},components:{ActionMenu:v},computed:{actions(){return[{title:"Actions",items:[{label:"Send test event",onClick:this.handleSendWebhookTestEvent},{label:"Delete",onClick:this.handleDeleteWebhook,destructive:!0}]}]}},methods:{async handleDeleteWebhook(){this.$modal.show("DeleteWebhookModal",{webhook:this.webhook})},async handleSendWebhookTestEvent(){await j(this.webhook.id),this.$toast.success({title:"Test event triggered",description:"A test event was triggered successfully for this webhook."})}}};function Z(n,_,h,w,r,a){const c=o("ActionMenu");return i(),b(c,{sections:a.actions,placement:"bottom-end"},{trigger:t(s=>[O(n.$slots,"trigger",{toggle:s.toggle})]),_:3},8,["sections"])}const ee=S(X,[["render",Z]]),te={props:{webhook:Object},components:{DataTableRow:I,DataTableCell:$,BaseParagraph:x,WebhooksIntegrationActionMenu:ee,BaseIconButton:P}};function oe(n,_,h,w,r,a){const c=o("BaseParagraph"),s=o("DataTableCell"),m=o("BaseIconButton"),W=o("WebhooksIntegrationActionMenu"),p=o("DataTableRow");return i(),b(p,null,{default:t(()=>[e(s,null,{default:t(()=>[e(c,null,{default:t(()=>[d(B(h.webhook.target_url),1)]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(c,null,{default:t(()=>[d(B(h.webhook.event_type),1)]),_:1})]),_:1}),e(s,{spacing:"compact",alignment:"center"},{default:t(()=>[l("div",{class:"data-table__row__action-container",onClick:_[0]||(_[0]=H(()=>n.$refs.trigger.click(),["stop"]))},[e(W,{webhook:h.webhook},{trigger:t(k=>[e(m,{icon:"icon-actions",onClicked:k.toggle,class:"data-table__row__action",ref:"trigger"},null,8,["onClicked"])]),_:1},8,["webhook"])])]),_:1})]),_:1})}const ne=S(te,[["render",oe]]),ae={components:{OverviewEmptyState:q,EmptyMetricsIllustration:J},methods:{async handleRegisterWebhook(){this.$modal.show("RegisterWebhookModal")}}};function se(n,_,h,w,r,a){const c=o("EmptyMetricsIllustration"),s=o("OverviewEmptyState");return i(),b(s,{title:n.$t("SETTINGS.WEBHOOKS.OVERVIEW.EMPTY_STATE_TITLE"),description:n.$t("SETTINGS.WEBHOOKS.OVERVIEW.EMPTY_STATE_DESCRIPTION"),actionLabel:n.$t("SETTINGS.WEBHOOKS.OVERVIEW.EMPTY_STATE_ACTION_LABEL"),variation:"empty",onOnAction:a.handleRegisterWebhook},{default:t(()=>[e(c)]),_:1},8,["title","description","actionLabel","onOnAction"])}const ie=S(ae,[["render",se]]),ce={props:{},components:{ActionMenu:v,BaseButton:C,FilterButton:Q},data(){return{isLoading:!0,hasSecret:!1}},async mounted(){u.on("webhookSecretDeleted",this.getWebhookSecretStatus),await this.getWebhookSecretStatus(),this.isLoading=!1},beforeUnmount(){u.off("webhookSecretDeleted",this.getWebhookSecretStatus)},computed:{sections(){return[{items:[{label:"Rotate secret",onClick:this.handleRotateSecret,icon:"icon-refresh"},{label:"Delete secret",onClick:this.handleDeleteSecret,destructive:!0}]}]}},methods:{async getWebhookSecretStatus(){this.hasSecret=await z()},async handleCreateSecret(){this.isLoading=!0;try{const n=await G();this.$modal.show("CopyWebhookSecretModal",{secret:n.secret}),this.hasSecret=!0}finally{this.isLoading=!1}},async handleRotateSecret(){this.$modal.show("RotateWebhookSecretModal")},async handleDeleteSecret(){this.$modal.show("DeleteWebhookSecretModal")}}},le=l("i",{class:"icon icon-caret_down icon-12px"},null,-1),re=l("i",{class:"icon icon-secrets icon-12px"},null,-1);function he(n,_,h,w,r,a){const c=o("BaseButton"),s=o("ActionMenu");return i(),b(s,{sections:a.sections,placement:"bottom-end"},{trigger:t(m=>[e(c,{onClick:W=>r.hasSecret?m.toggle():a.handleCreateSecret(),"is-loading":r.isLoading,size:"small",variation:"filter"},{default:t(()=>[r.hasSecret?(i(),g(f,{key:0},[d(" Manage HMAC Secret "),le],64)):(i(),g(f,{key:1},[re,d(" Add HMAC Secret ")],64))]),_:2},1032,["onClick","is-loading"])]),_:1},8,["sections"])}const de=S(ce,[["render",he]]),_e={components:{PageHeader:K,DataTable:Y,DataTableHeader:U,DataTableRow:I,WebhooksIntegrationRow:ne,WebhooksIntegrationEmptyState:ie,DataTableCell:$,LoadingSkeleton:V,BaseButton:C,WebhooksSecretButton:de,BaseLink:N},data(){return{isLoading:!0,webhooks:[]}},async mounted(){u.on("webhookCreated",this.listAllWebhooks),u.on("webhookDeleted",this.listAllWebhooks),await this.listAllWebhooks(),this.isLoading=!1},beforeUnmount(){u.off("webhookCreated",this.listAllWebhooks),u.off("webhookDeleted",this.listAllWebhooks)},computed:{breadcrumbs(){return[{label:"Settings",href:"/settings"},{label:"Integrations",href:"/settings/integrations"},{label:"API"},{label:"Webhooks"}]},showEmptyState(){return!this.isLoading&&this.webhooks.length===0}},methods:{async listAllWebhooks(){this.webhooks=await A()},async getWebhookSecret(){this.hasSecret=await A()},handleRegisterWebhook(){this.$modal.show("RegisterWebhookModal")}}},ue={class:"page-content"},be={class:"flex justify-between mb-16px"},me={class:"flex align-center ml-auto gap-12px"},pe=l("i",{class:"icon icon-12px icon-information"},null,-1),ke=l("u",null,"Docs",-1),ge=l("i",{class:"icon icon-add"},null,-1),fe={colspan:"3"};function Se(n,_,h,w,r,a){const c=o("PageHeader"),s=o("BaseLink"),m=o("WebhooksSecretButton"),W=o("BaseButton"),p=o("DataTableHeader"),k=o("LoadingSkeleton"),T=o("DataTableCell"),E=o("DataTableRow"),M=o("WebhooksIntegrationRow"),R=o("WebhooksIntegrationEmptyState"),L=o("DataTable");return i(),g(f,null,[e(c,{title:"Webhooks",breadcrumbs:a.breadcrumbs},null,8,["breadcrumbs"]),l("div",ue,[l("div",be,[l("div",me,[e(s,{href:"https://apidocs.aikido.dev/reference/webhooks",class:"subdued link--weight-400 paragraph--tiny link--size-tiny inline-flex align-center gap-4px",target:"_blank"},{default:t(()=>[pe,ke]),_:1}),e(m),e(W,{onClick:a.handleRegisterWebhook,size:"small"},{default:t(()=>[ge,d(" Register webhook ")]),_:1},8,["onClick"])])]),e(L,null,{header:t(()=>[e(p,{width:"auto"},{default:t(()=>[d("Webhook target")]),_:1}),e(p,{width:"200px"},{default:t(()=>[d("Event type")]),_:1}),e(p,{width:"48px",alignment:"center"})]),body:t(()=>[r.isLoading?(i(),g(f,{key:0},D(5,y=>e(E,{key:y},{default:t(()=>[e(T,null,{default:t(()=>[e(k)]),_:1}),e(T,null,{default:t(()=>[e(k)]),_:1}),e(T,null,{default:t(()=>[e(k)]),_:1})]),_:2},1024)),64)):(i(!0),g(f,{key:1},D(r.webhooks,y=>(i(),b(M,{webhook:y,key:y.id},null,8,["webhook"]))),128)),a.showEmptyState?(i(),b(E,{key:2},{default:t(()=>[l("td",fe,[e(R)])]),_:1})):F("",!0)]),_:1})])],64)}const Ie=S(_e,[["render",Se]]);export{Ie as default};
