import{g as _,u as E,s as h}from"./drata-1feda70f.js";import{_ as f,X as D,f as A,H as I,A as u,Q as y,r as e,k as v,m as r,o as t,w as i,p as b,F as S,q as s,s as o}from"./index-13ff96f4.js";import{P as w}from"./PageHeader-46c38a32.js";import{S as P}from"./SettingsEmptyState-8e8644cd.js";import{E as k}from"./EmptyUsersIllustration-1a5638d0.js";const C={components:{XPreloader:D,BaseButton:A,SettingsEmptyState:P,EmptyUsersIllustration:k,PageHeader:w,BaseHeading:I},data(){return{activeDrataIntegration:null,loaded:!1,sendingEvidence:!1}},created(){this.init()},computed:{breadcrumbs(){return[{label:"Settings",href:"/settings"},{label:"Integrations",href:"/settings/integrations"},{label:"Drata"}]},subtitle(){return this.activeDrataIntegration?"Active":""},canAlwaysUseDrata(){return!!this.$featureflags.force_enable_drata}},methods:{async init(){this.activeDrataIntegration=await _(),this.loaded=!0},async addDrataIntegration(){if(!u.isPayingAndNoProTrial()&&!this.canAlwaysUseDrata)return this.$modal.show("UpgradeAccountModal",{title:"This integration is available on all paid plans",msg:"Upgrade now to any paid plan to start integrating with your compliancy tool."});await this.$modal.show("DrataAccessTokenModal"),this.init()},async deactivateDrata(){await y({headerText:"Drata Integration",description:"Do you want to deactivate the Drata integration?",buttonSubmitText:"Yes, deactivate"})&&(await E(this.activeDrataIntegration.id),this.init(),Toast.success({title:this.$t("NOTIFICATIONS.INTEGRATION_DEACTIVATED.TITLE"),description:this.$t("DRATA_DEACTIVATED")}))},async sendToDrata(){if(!u.isPayingAndNoProTrial()&&!this.canAlwaysUseDrata)return this.$modal.show("UpgradeAccountModal",{title:"This integration is available on all paid plans",msg:"Upgrade now to any paid plan to start integrating with your compliancy tool."});this.sendingEvidence=!0;try{await h()}finally{this.sendingEvidence=!1}Toast.success({title:this.$t("SUCCESS"),description:"We've successfully sent vulnerabilities to Drata"})}}},N={key:0,class:"page-content"},B={key:0},x={key:1};function U(l,V,R,L,a,n){const g=e("XPreloader"),m=e("PageHeader"),p=e("EmptyUsersIllustration"),T=e("SettingsEmptyState"),c=e("BaseHeading"),d=e("BaseButton");return a.loaded?(s(),r(S,{key:1},[t(m,{title:"Drata integration",breadcrumbs:n.breadcrumbs,subtitle:n.subtitle},null,8,["breadcrumbs","subtitle"]),a.loaded?(s(),r("div",N,[a.activeDrataIntegration==null?(s(),r("div",B,[t(T,{title:l.$t("SETTINGS.DRATA.OVERVIEW.EMPTY_STATE_TITLE"),description:l.$t("SETTINGS.DRATA.OVERVIEW.EMPTY_STATE_DESCRIPTION"),actionLabel:l.$t("SETTINGS.DRATA.OVERVIEW.EMPTY_STATE_ACTION_LABEL"),onAction:n.addDrataIntegration},{default:i(()=>[t(p)]),_:1},8,["title","description","actionLabel","onAction"])])):(s(),r("div",x,[t(c,{as:"h4",class:"flex justify-between mb-8px"},{default:i(()=>[o("Actions")]),_:1}),t(d,{class:"mt-4px",size:"small",onClick:n.sendToDrata,isLoading:a.sendingEvidence,disabled:a.sendingEvidence},{default:i(()=>[o("Send evidence to Drata")]),_:1},8,["onClick","isLoading","disabled"]),t(c,{as:"h4",class:"flex justify-between mt-36px mb-8px"},{default:i(()=>[o("Danger zone")]),_:1}),t(d,{class:"mt-4px",variation:"destructive",size:"small",onClick:n.deactivateDrata},{default:i(()=>[o("Deactivate")]),_:1},8,["onClick"])]))])):b("",!0)],64)):(s(),v(g,{key:0,class:"supercenter",theme:"transparent"}))}const X=f(C,[["render",U]]);export{X as default};
