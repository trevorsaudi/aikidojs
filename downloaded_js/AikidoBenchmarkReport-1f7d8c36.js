import{o as A,u as D}from"./reports-ed4978a9.js";import{_ as S,B as I,f as C,r as i,q as r,m as u,n as k,o,w as n,s as a,u as g,p as v,F as w,k as d,t as R,ai as H,cu as Q,c7 as j,S as V,H as E,dv as N,d as P,X as $}from"./index-13ff96f4.js";import{P as z}from"./PageHeader-46c38a32.js";import{A as q,a as X}from"./AccordionItem-61c3c0ba.js";import{Q as T}from"./QueueTable-de6aabd1.js";import{Q as L}from"./QueueSidebar-47492277.js";import{D as F,a as M}from"./DataTable-e31a825a.js";import{a as U}from"./DataTableCell-51c0104f.js";import{R as G,L as W}from"./LoadingRepositoryOverviewRow-a49a41a6.js";import"./dateFns-a344cb79.js";import"./index-b87db690.js";import"./IssueGroupSeverityColumn-7631c77a.js";import"./ActionMenu-3e4470bf.js";import"./SidebarActionMenu-1bf6804b.js";import"./CreateAutoFixProgressFlow-8111d22c.js";import"./RadioButtonList-1d4cdaad.js";import"./EnableIntegrationModal-48b01f56.js";import"./focusModePreference-150f170e.js";import"./TableListHeader-e50d01d1.js";import"./BaseRadioInput-a7ac3557.js";import"./BaseLabel-a1c0ca00.js";import"./AIText-891d4f7b.js";import"./InputCheckbox-81cb3ca6.js";import"./BreakSlashes-925eef0e.js";import"./UnignoreIssue-5dff8957.js";import"./CreateTicketModal-c14deeb1.js";import"./ManualInputSearchDropdown-6a7ece3e.js";import"./InputSearchDropdown-02988f6b.js";import"./repoName-872812ed.js";import"./taskTrackerNaming-55adac3e.js";import"./taskTrackerIcon-504ea566.js";import"./autofixable-c6560249.js";import"./autofixSastIssues-779ec5b4.js";import"./lock-files-cdbb050f.js";import"./BaseCodeBlock-cec75629.js";import"./string-814c5ffd.js";import"./ButtonMultiOption-12e505fb.js";import"./transform-c376ec3f.js";import"./linear-efb37b7f.js";import"./arc-12e4470a.js";import"./BaseForm-4c6fa06f.js";import"./XTabs-d492da26.js";import"./BaseCard-471d3203.js";import"./AccordionContainer-09dc0ed4.js";import"./trycatch-83445d5b.js";import"./licenses-6ab38515.js";import"./BaseStatusLabel-0ccd2806.js";import"./DataTableSeverityIndicator-48ffb8dc.js";import"./IssueGroupTypeColumn-03f014b0.js";import"./BracesIcon-0a8568f4.js";import"./BoxIcon-9908469f.js";import"./StackedAvatars-4925baeb.js";import"./repositoryActionMenu-07f5f11b.js";import"./RepostioryDomainCell-e75ba707.js";import"./SupportedLockFilesModal-4d6e0a8a.js";import"./RepositoryDetailCheckFileEntry-e151c779.js";import"./FaultyLockfileModal-7f5493a7.js";import"./DataTableLastScanColumn-e155b78a.js";import"./freePlanLimitations-5f359256.js";const O=e=>{const l=e>=50?"Top":"Bottom";let t;return e>=95?t="5%":e>=90?t="10%":e>=80?t="20%":e>=70?t="30%":e>=60?t="40%":e>=50?t="50%":e>=40?t="40%":e>=30?t="30%":e>=20?t="20%":t="10%",`${l} ${t}`},J={props:{insight:Object},components:{QueueTable:T,QueueSidebar:L,BaseParagraph:I,BaseButton:C},data(){return{isExpanded:!1}},computed:{expandResultsButtonLabel(){return this.isExpanded?"Show less":"Show all"},canExpandResults(){return this.issues.length>3},visibleIssues(){return this.isExpanded?this.issues:this.issues.slice(0,3)},issues(){return this.insight.metadata.issues}},methods:{toggleExpand(){this.isExpanded=!this.isExpanded},async onItemSelected(e){this.$router.replace({path:this.$route.path,query:{...this.$route.query,sidebarIssue:e.id}})}}},K={class:"flex flex-column gap-12px"},Y={key:0,class:"flex justify-center w-full"};function Z(e,l,t,x,f,s){const p=i("BaseParagraph"),c=i("QueueTable"),_=i("BaseButton"),m=i("QueueSidebar");return r(),u(w,null,[k("div",K,[o(p,null,{default:n(()=>[a(g(t.insight.description),1)]),_:1}),o(c,{onItemClicked:s.onItemSelected,groupedIssues:s.visibleIssues},null,8,["onItemClicked","groupedIssues"]),s.canExpandResults?(r(),u("div",Y,[o(_,{size:"small",variation:"plain",onClick:s.toggleExpand},{default:n(()=>[a(g(s.expandResultsButtonLabel),1)]),_:1},8,["onClick"])])):v("",!0)]),o(m,{"grouped-issues":s.visibleIssues},null,8,["grouped-issues"])],64)}const ee=S(J,[["render",Z]]),te={props:{insight:Object},components:{BaseParagraph:I,DataTable:F,DataTableHeader:M,DataTableRow:U,RepositoryOverviewRow:G,LoadingRepositoryOverviewRow:W,BaseButton:C},data(){return{isExpanded:!1}},computed:{expandResultsButtonLabel(){return this.isExpanded?"Show less":"Show all"},canExpandResults(){return this.insight.metadata.repositories.length>3},repositories(){let e=this.insight.metadata.repositories;return e=e.filter(l=>!l.externally_archived),this.isExpanded?e:e.slice(0,3)}},methods:{toggleExpand(){this.isExpanded=!this.isExpanded},handleNavigateToRepository(e){this.$router.push(`/repositories/${e}`)}}},se={class:"flex flex-column gap-12px"},ie={key:1,class:"flex justify-center w-full"};function ne(e,l,t,x,f,s){const p=i("BaseParagraph"),c=i("DataTableHeader"),_=i("LoadingRepositoryOverviewRow"),m=i("RepositoryOverviewRow"),b=i("DataTableRow"),B=i("DataTable"),y=i("BaseButton");return r(),u("div",se,[o(p,null,{default:n(()=>[a(g(t.insight.description),1)]),_:1}),s.repositories?(r(),d(B,{key:0},{header:n(()=>[o(c,{width:"auto"},{default:n(()=>[a("Repo name")]),_:1}),o(c,{width:"100px",alignment:"center"},{default:n(()=>[a("Severity")]),_:1}),o(c,{width:"100px"},{default:n(()=>[a("Language")]),_:1}),o(c,{width:"10%"},{default:n(()=>[a("Open issues")]),_:1}),o(c,{width:"10%"},{default:n(()=>[a("Ignored issues")]),_:1}),o(c,{width:"10%"},{default:n(()=>[a("Last activity")]),_:1}),o(c,{width:"48px",alignment:"center"})]),body:n(()=>[e.isLoading?(r(),u(w,{key:0},R(10,h=>o(_,{key:h})),64)):(r(!0),u(w,{key:1},R(s.repositories,h=>(r(),d(b,{key:h.id,clickable:!0,disabled:!h.active,onClick:H(()=>h.active&&s.handleNavigateToRepository(h.id),["stop"])},{default:n(()=>[o(m,{repository:h,bookmarks:[],faultyLockfileFindings:[],hideDomainSection:!0},null,8,["repository"])]),_:2},1032,["disabled","onClick"]))),128))]),_:1})):v("",!0),s.canExpandResults?(r(),u("div",ie,[o(y,{size:"small",variation:"plain",onClick:s.toggleExpand},{default:n(()=>[a(g(s.expandResultsButtonLabel),1)]),_:1},8,["onClick"])])):v("",!0)])}const oe=S(te,[["render",ne]]),re={props:{insight:Object},components:{QueueTable:T,QueueSidebar:L,BaseParagraph:I,BaseButton:C},data(){return{issues:[],isExpanded:!1}},async mounted(){await this.fetchAllIssues()},computed:{expandResultsButtonLabel(){return this.isExpanded?"Show less":"Show all"},canExpandResults(){return this.issueIds.length>3},visibleIssues(){return this.isExpanded?this.issues:this.issues.slice(0,3)},issueIds(){return this.insight.metadata.issue_ids}},methods:{toggleExpand(){this.isExpanded=!this.isExpanded},async onItemSelected(e){this.$router.replace({path:this.$route.path,query:{...this.$route.query,sidebarIssue:e.id}})},async fetchAllIssues(){this.issues=await Q({filter_issue_ids:this.issueIds,dont_pass_team_context:!0})}}},ae={class:"flex flex-column gap-12px"},ce={key:0,class:"flex justify-center w-full"};function le(e,l,t,x,f,s){const p=i("BaseParagraph"),c=i("QueueTable"),_=i("BaseButton"),m=i("QueueSidebar");return r(),u(w,null,[k("div",ae,[o(p,null,{default:n(()=>[a(g(t.insight.description),1)]),_:1}),o(c,{onItemClicked:s.onItemSelected,groupedIssues:s.visibleIssues},null,8,["onItemClicked","groupedIssues"]),s.canExpandResults?(r(),u("div",ce,[o(_,{size:"small",variation:"plain",onClick:s.toggleExpand},{default:n(()=>[a(g(s.expandResultsButtonLabel),1)]),_:1},8,["onClick"])])):v("",!0)]),o(m,{"grouped-issues":s.visibleIssues},null,8,["grouped-issues"])],64)}const ue=S(re,[["render",le]]),de={props:{insight:Object,code:String},components:{AccordionItem:q,BaseParagraph:I,CloudIssueSection:ee,RepositoryOverviewSection:oe,CodeIssueSection:ue},computed:{iconClasses(){return this.insight.status==="complying"?["icon-tick-circle text-surface-green-100"]:["icon-close text-surface-red-100"]},useRepositoryOverviewSection(){return["code__all_repos_added","code__uses_lockfiles_in_most_repos","code__configured_architecture_for_most_repos"].includes(this.code)},link(){if(this.insight.status!=="complying"){if(this.code==="general__slack_integration_added")return"/settings/integrations/notifications/slack";if(this.code==="general__sla_integration_enabled")return"/settings/sla"}}},methods:{}},pe={class:"flex align-center gap-8px"};function _e(e,l,t,x,f,s){const p=i("BaseParagraph"),c=i("RouterLink"),_=i("CloudIssueSection"),m=i("RepositoryOverviewSection"),b=i("CodeIssueSection"),B=i("AccordionItem");return r(),d(B,null,j({title:n(()=>[k("div",pe,[o(p,{size:"medium",bold:""},{default:n(()=>[a(g(t.insight.title),1)]),_:1}),k("i",{class:V(["icon icon-16px",s.iconClasses])},null,2),s.link?(r(),d(c,{key:0,to:s.link,class:"link"},{default:n(()=>[a("Enable")]),_:1},8,["to"])):v("",!0)])]),_:2},[t.insight.status==="failing"?{name:"body",fn:n(()=>[t.code==="cloud__non_compliant_cloud_rules"?(r(),d(_,{key:0,insight:t.insight},null,8,["insight"])):s.useRepositoryOverviewSection?(r(),d(m,{key:1,insight:t.insight},null,8,["insight"])):t.code==="code__no_open_high_or_critical_issues_open"?(r(),d(b,{key:2,insight:t.insight},null,8,["insight"])):(r(),d(p,{key:3},{default:n(()=>[a(g(t.insight.description),1)]),_:1}))]),key:"0"}:void 0]),1024)}const me=S(de,[["render",_e]]),he={props:{section:Object},components:{BaseParagraph:I,BaseHeading:E,AccordionContainer:X,BenchmarkSectionItem:me,ProgressBar:N,BasePill:P},computed:{progress(){const e=this.section.insights.length,l=this.section.insights.reduce((t,x)=>x.status==="complying"?t+=1:t,0);return l===0?0:Math.round(l/e*100)},error(){return this.section.error?this.section.error==="no_active_clouds_monitored"?"No active clouds monitored":this.section.error:null},percentileScoreTitle(){return`${O(this.section.percentile_score)} of all Aikido accounts`},percentileScoreVariation(){return this.section.percentile_score>=70?"green":this.section.percentile_score>=40?"orange":"red"}}},ge={class:"flex flex-1 gap-12px justify-between"},fe={class:"flex flex-1 align-center gap-12px"},ke={key:0,class:"flex align-center gap-4px"},xe=k("i",{class:"icon icon-critical icon-14px text-surface-orange-120"},null,-1),be={key:1};function Be(e,l,t,x,f,s){const p=i("BaseHeading"),c=i("BaseParagraph"),_=i("BasePill"),m=i("ProgressBar"),b=i("BenchmarkSectionItem"),B=i("AccordionContainer");return r(),d(B,null,{header:n(()=>[k("div",ge,[k("div",fe,[o(p,{as:"h4"},{default:n(()=>[a(g(t.section.title),1)]),_:1}),s.error?(r(),u("div",ke,[xe,o(c,{color:"warning"},{default:n(()=>[a(g(s.error),1)]),_:1})])):t.section.percentile_score?(r(),u("div",be,[o(_,{title:s.percentileScoreTitle,variation:s.percentileScoreVariation},null,8,["title","variation"])])):v("",!0)]),o(m,{progress:s.progress},null,8,["progress"])])]),body:n(()=>[(r(!0),u(w,null,R(t.section.insights,y=>(r(),d(b,{key:y.code,code:y.code,insight:y},null,8,["code","insight"]))),128))]),_:1})}const ye=S(he,[["render",Be]]),ve={components:{PageHeader:z,BaseHeading:E,XPreloader:$,BenchmarkSection:ye,BasePill:P,BaseButton:C},data(){return{isLoading:!0,benchmarkInsights:{},isCalculatingScore:!1}},async mounted(){await Promise.allSettled([this.loadBreakdown()])},computed:{breadcrumbs(){return[{label:"Reports",href:"/reports"},{label:"Aikido benchmark"}]},percentileScoreTitle(){var t;const e=((t=this.benchmarkInsights.scores)==null?void 0:t.total_score)??0;return`${O(e)} of all Aikido accounts`},subtitleVariation(){var l;const e=((l=this.benchmarkInsights.scores)==null?void 0:l.total_score)??0;return e>=70?"green":e>=40?"orange":"red"}},methods:{async loadBreakdown(){this.benchmarkInsights=await A(),this.isLoading=!1},async handleUpdateScore(){this.isCalculatingScore=!0;try{await D(),await this.loadBreakdown()}finally{this.isCalculatingScore=!1}}}},we={class:"flex gap-32px align-center"},Se={class:"page-content"},Ie={key:1,class:"flex flex-column gap-24px"};function Re(e,l,t,x,f,s){const p=i("BaseHeading"),c=i("BasePill"),_=i("BaseButton"),m=i("PageHeader"),b=i("XPreloader"),B=i("BenchmarkSection");return r(),u(w,null,[o(m,{breadcrumbs:s.breadcrumbs},{title:n(()=>[k("div",we,[o(p,{as:"h1"},{default:n(()=>[a("Aikido benchmark insights")]),_:1})])]),subTitle:n(()=>[f.benchmarkInsights.scores?(r(),d(c,{key:0,title:s.percentileScoreTitle,variation:s.subtitleVariation},null,8,["title","variation"])):v("",!0)]),rightContent:n(()=>[o(_,{onClick:s.handleUpdateScore,"is-loading":f.isCalculatingScore,size:"small"},{default:n(()=>[a("Recalculate score")]),_:1},8,["onClick","is-loading"])]),_:1},8,["breadcrumbs"]),k("div",Se,[f.isLoading?(r(),d(b,{key:0,class:"absolute-centered",theme:"transparent"})):(r(),u("div",Ie,[(r(!0),u(w,null,R(f.benchmarkInsights.sections,(y,h)=>(r(),d(B,{key:h,section:y,"section-key":h},null,8,["section","section-key"]))),128))]))])],64)}const Ot=S(ve,[["render",Re]]);export{Ot as default};
