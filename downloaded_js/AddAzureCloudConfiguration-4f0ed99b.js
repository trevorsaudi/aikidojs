import{P as K}from"./PageHeader-46c38a32.js";import{_ as g,bk as B,V as v,g as G,f as k,H as A,x as q,a2 as T,r as l,q as m,m as C,n as e,o as i,w as d,s as o,F as S,e_ as D,bs as z,N as V,bE as P,bg as E,an as N,A as H,k as I,p as x}from"./index-13ff96f4.js";import{P as $}from"./ProgressTracker-672a1ecc.js";const M={props:{initialApplicationId:String,initialDirectoryId:String},components:{BaseBody:B,InputText:v,BaseLink:G,BaseButton:k,BaseHeading:A,BaseIcon:q,XTooltip:T},emits:["cancel","continue"],data(){return{applicationId:this.initialApplicationId,directoryId:this.initialDirectoryId}},computed:{isComplete(){return!(!this.applicationId||this.applicationId&&this.applicationId===""||!this.directoryId||this.directoryId&&this.directoryId==="")}},methods:{handleCancel(){this.$emit("cancel")},handleSubmit(){this.$emit("continue",{applicationId:this.applicationId,directoryId:this.directoryId})},handleKeyDown(){this.isComplete&&this.handleSubmit()}}},L={class:"flex flex-column gap-32px"},U={class:"flex flex-column gap-8px"},R={class:"cloud-config__content__list"},O=e("strong",null,"Microsoft Entra ID service",-1),j=e("li",null,[o("Select App registrations and then click on "),e("strong",null,"New registration"),o(".")],-1),F=e("li",null,'Enter "AikidoSecurity" and/or a descriptive name in the Name field, take note of it, it will be used again in step 3.',-1),X=e("li",null,'Leave the "Supported account types" default: "Accounts in this organizational directory only".',-1),W=e("li",null,[o("Click on "),e("strong",null,"Register"),o(".")],-1),Y={class:"flex flex-column gap-24px"},J=e("hr",{class:"divider my-24px"},null,-1),Q={class:"flex flex-end gap-16px mt-12px justify-end"};function Z(r,t,y,b,s,n){const u=l("BaseHeading"),p=l("BaseBody"),a=l("BaseLink"),h=l("XTooltip"),_=l("BaseIcon"),f=l("InputText"),w=l("BaseButton");return m(),C(S,null,[e("div",L,[e("div",U,[i(u,{as:"h3"},{default:d(()=>[o("Microsoft Azure Cloud Provider Configuration")]),_:1}),i(p,{color:"subdued"},{default:d(()=>[o("Navigate to Subscriptions and Connect your Subscription ID.")]),_:1})]),e("div",null,[e("ul",R,[e("li",null,[o("Log into your "),i(a,{href:"https://portal.azure.com/",target:"_blank"},{default:d(()=>[o("Azure Portal")]),_:1}),o(" and navigate to the "),O,o(". "),i(_,{icon:"icon-help",class:"cursor-help inline-flex valign-middle"},{default:d(()=>[i(h,null,{default:d(()=>[o("Formerly known as Azure Active Directory")]),_:1})]),_:1})]),j,F,X,W])]),e("div",null,[e("div",Y,[i(f,{title:"Copy the Application ID and Paste it below.",placeholder:"bc38ac14-d509-4586-9e36-2dc0d503d9be",modelValue:s.applicationId,"onUpdate:modelValue":t[0]||(t[0]=c=>s.applicationId=c),modelModifiers:{trim:!0},name:"applicationId",onEnterKeyPress:n.handleKeyDown},null,8,["modelValue","onEnterKeyPress"]),i(f,{title:"Copy the Directory ID and Paste it below.",placeholder:"d0501bf2-4c72-41fc-9737-fd964ddf79e6",modelValue:s.directoryId,"onUpdate:modelValue":t[1]||(t[1]=c=>s.directoryId=c),modelModifiers:{trim:!0},name:"directoryId",onEnterKeyPress:n.handleKeyDown},null,8,["modelValue","onEnterKeyPress"])])])]),e("div",null,[J,e("div",Q,[i(w,{variation:"plain",onClicked:n.handleCancel},{default:d(()=>[o("Cancel")]),_:1},8,["onClicked"]),i(w,{disabled:!n.isComplete,onClicked:n.handleSubmit},{default:d(()=>[o("Continue")]),_:1},8,["disabled","onClicked"])])])],64)}const ee=g(M,[["render",Z]]),te={props:{initialSecret:String},components:{BaseBody:B,BaseButton:k,InputText:v,BaseHeading:A},emits:["goBack","continue"],data(){return{secretKey:this.initialSecret}},computed:{isComplete(){return!(!this.secretKey||this.secretKey&&this.secretKey==="")}},methods:{handleBack(){this.$emit("goBack",{secretKey:this.secretKey})},handleSubmit(){this.$emit("continue",{secretKey:this.secretKey})},handleKeyDown(){this.isComplete&&this.handleSubmit()}}},ne={class:"flex flex-column gap-32px"},oe={class:"flex flex-column gap-8px"},se=e("ul",{class:"cloud-config__content__list"},[e("li",null,[o("Click on "),e("strong",null,"Certificates & secrets"),o(".")]),e("li",null,[o("Under Client secrets, click on "),e("strong",null,"New client secret")]),e("li",null,'Enter a Description (i.e. AikidoSecurity) and select Expires "In 2 year".'),e("li",null,[o("Click on "),e("strong",null,"Add"),o(".")]),e("li",null,"Copy the secret key value")],-1),ie=e("hr",{class:"divider my-24px"},null,-1),le={class:"flex flex-end gap-16px mt-12px justify-end"};function de(r,t,y,b,s,n){const u=l("BaseHeading"),p=l("BaseBody"),a=l("InputText"),h=l("BaseButton");return m(),C(S,null,[e("div",ne,[e("div",oe,[i(u,{as:"h3"},{default:d(()=>[o("Add a new secret")]),_:1}),i(p,{color:"subdued"},{default:d(()=>[o("Now we need to add a secret and set an expiration date.")]),_:1})]),se,i(a,{title:"Paste the secret key value below.",placeholder:"Jk7******************",modelValue:s.secretKey,"onUpdate:modelValue":t[0]||(t[0]=_=>s.secretKey=_),modelModifiers:{trim:!0},name:"secretKey",onEnterKeyPress:n.handleKeyDown},null,8,["modelValue","onEnterKeyPress"])]),e("div",null,[ie,e("div",le,[i(h,{variation:"plain",onClicked:n.handleBack},{default:d(()=>[o("Go back")]),_:1},8,["onClicked"]),i(h,{disabled:!n.isComplete,onClicked:n.handleSubmit},{default:d(()=>[o(" Continue ")]),_:1},8,["disabled","onClicked"])])])],64)}const ce=g(te,[["render",de]]),re={props:{initialSubscriptionId:String},components:{BaseBody:B,InputText:v,BaseButton:k,BaseHeading:A},emits:["goBack","continue"],data(){return{subscriptionId:this.initialSubscriptionId}},computed:{isComplete(){return!(!this.subscriptionId||this.subscriptionId&&this.subscriptionId==="")}},methods:{handleGoBack(){this.$emit("goBack",{subscriptionId:this.subscriptionId})},async handleSubmit(){this.$emit("continue",{subscriptionId:this.subscriptionId})},handleKeyDown(){this.isComplete&&this.handleSubmit()}}},ae={class:"flex flex-column gap-32px"},ue={class:"flex flex-column gap-8px"},pe=e("hr",{class:"divider my-24px"},null,-1),he={class:"flex flex-end gap-16px mt-12px justify-end"};function me(r,t,y,b,s,n){const u=l("BaseHeading"),p=l("BaseBody"),a=l("InputText"),h=l("BaseButton");return m(),C(S,null,[e("div",ae,[e("div",ue,[i(u,{as:"h3"},{default:d(()=>[o("Subscriptions")]),_:1}),i(p,{color:"subdued"},{default:d(()=>[o("Navigate to Subscriptions and Connect your Subscription ID.")]),_:1})]),i(a,{title:"Click on the relevant Subscription ID, copy and paste the ID below.",placeholder:"Example id",modelValue:s.subscriptionId,"onUpdate:modelValue":t[0]||(t[0]=_=>s.subscriptionId=_),modelModifiers:{trim:!0},name:"subscriptionId",onEnterKeyPress:n.handleKeyDown},null,8,["modelValue","onEnterKeyPress"])]),e("div",null,[pe,e("div",he,[i(h,{variation:"plain",onClicked:n.handleGoBack},{default:d(()=>[o("Go back")]),_:1},8,["onClicked"]),i(h,{disabled:!n.isComplete,onClicked:n.handleSubmit},{default:d(()=>[o("Continue")]),_:1},8,["disabled","onClicked"])])])],64)}const _e=g(re,[["render",me]]),fe={props:{directoryId:String,applicationId:String,secretKey:String,subscriptionId:String},components:{BaseBody:B,BaseButton:k,BaseHeading:A},emits:["cancel","goBack"],methods:{handleGoBack(){this.$emit("goBack",{})},async handleSubmit(){const r=await this.handleCreateCloud();this.$emit("continue",{cloudId:r})},async handleCreateCloud(){return(await D(this.applicationId,this.directoryId,this.secretKey,this.subscriptionId)).cloud_id}}},ge={class:"flex flex-column gap-32px"},Ce={class:"flex flex-column gap-8px"},Se=z('<div><ul class="cloud-config__content__list"><li>Click on <strong>&quot;Access Control (IAM)&quot;</strong>.</li><li>Go to the Role assignments tab.</li><li>Click on <strong>&quot;Add&quot;</strong>, then <strong>&quot;Add role assignment&quot;</strong>.</li><li>In the <strong>&quot;Role&quot;</strong> list, search and select <strong>&quot;Security Reader&quot;</strong>.</li><li>Click <strong>&quot;Next&quot;</strong>.</li><li>Leave the <strong>&quot;Assign access to&quot;</strong> default value.</li><li>Click on <strong>&quot;Select Members&quot;</strong>, search for the name of the app registration (e.g. &quot;AikidoSecurity&quot;) you created and select it. </li><li>Click <strong>&quot;Select&quot;</strong>.</li><li>Click <strong>&quot;Review + assign&quot;</strong>.</li><li>Repeat the process for the role <strong>&quot;Log Analytics Reader&quot;</strong>.</li></ul></div>',1),ye=e("hr",{class:"divider my-24px"},null,-1),be={class:"flex flex-end gap-16px mt-12px justify-end"};function Ie(r,t,y,b,s,n){const u=l("BaseHeading"),p=l("BaseBody"),a=l("BaseButton");return m(),C(S,null,[e("div",ge,[e("div",Ce,[i(u,{as:"h3"},{default:d(()=>[o("Grant access to roles")]),_:1}),i(p,{color:"subdued"},{default:d(()=>[o("This is the final step, letâ€™s grant access to roles we need.")]),_:1})]),Se]),e("div",null,[ye,e("div",be,[i(a,{variation:"plain",onClicked:n.handleGoBack},{default:d(()=>[o("Go back")]),_:1},8,["onClicked"]),i(a,{onClicked:n.handleSubmit},{default:d(()=>[o("Save & Continue")]),_:1},8,["onClicked"])])])],64)}const xe=g(fe,[["render",Ie]]),Be={components:{BaseBody:B,InputText:v,BaseButton:k,BaseSelect:V,BaseHeading:A},props:{cloudId:Number},emits:["cancel","complete"],data(){return{name:void 0,purpose:void 0}},computed:{purposeOptions(){return[{id:"production",title:"Production"},{id:"staging",title:"Staging"},{id:"development",title:"Development"},{id:"mixed",title:"Mixed"}]},isComplete(){return!(!this.name||this.name&&this.name===""||!this.purpose||this.purpose&&this.purpose==="")}},methods:{handleCancel(){this.$emit("cancel")},async handleSubmit(){await P({cloud_id:this.cloudId,account_purpose:this.purpose,name:this.name}),Toast.success({title:this.$t("NOTIFICATIONS.CLOUD_UPDATED.TITLE"),description:this.$t("SUCCESSFULLY_EDITED_INTEGRATION")}),await E(this.cloudId,"scan"),this.$emit("complete"),N.emit("cloudAdded")}}},ke={class:"flex flex-column gap-32px"},Ae={class:"flex flex-column gap-8px"},we={class:"flex flex-column gap-24px"},ve=e("hr",{class:"divider my-24px"},null,-1),Ke={class:"flex flex-end gap-16px mt-12px justify-end"};function Ge(r,t,y,b,s,n){const u=l("BaseHeading"),p=l("BaseBody"),a=l("InputText"),h=l("BaseSelect"),_=l("BaseButton");return m(),C(S,null,[e("div",ke,[e("div",Ae,[i(u,{as:"h3"},{default:d(()=>[o("It worked! Everything seems to be connected.")]),_:1}),i(p,{color:"subdued"},{default:d(()=>[o(" Your cloud is connected, please answer two questions and you are good to go! ")]),_:1})]),e("div",null,[e("div",we,[i(a,{title:"Name your Cloud.",placeholder:"Azure cloud infrastructure",modelValue:s.name,"onUpdate:modelValue":t[0]||(t[0]=f=>s.name=f),modelModifiers:{trim:!0},name:"name"},null,8,["modelValue"]),i(h,{modelValue:s.purpose,"onUpdate:modelValue":t[1]||(t[1]=f=>s.purpose=f),label:"What is the purpose of your cloud?",options:n.purposeOptions},null,8,["modelValue","options"])])])]),e("div",null,[ve,e("div",Ke,[i(_,{variation:"plain",onClicked:n.handleCancel},{default:d(()=>[o("Cancel")]),_:1},8,["onClicked"]),i(_,{disabled:!n.isComplete,onClicked:n.handleSubmit},{default:d(()=>[o(" Save ")]),_:1},8,["disabled","onClicked"])])])],64)}const qe=g(Be,[["render",Ge]]),Te={components:{StartAzureCloudConfiguration:ee,PageHeader:K,AddSecretAzureCloudConfiguration:ce,AddSubscriptionAzureCloudConfiguration:_e,GrantAccessAzureCloudConfiguration:xe,CompleteAzureCloudConfiguration:qe,ProgressTracker:$},computed:{breadcrumbs(){return[{label:"Add a cloud"},{label:"Microsoft Azure"}]},steps(){return[{title:"Register your app",completed:this.completedSteps.includes("start"),pending:this.showStartStep},{title:"Add a new secret",completed:this.completedSteps.includes("secret"),pending:this.showAddSecretStep},{title:"Add subscription",completed:this.completedSteps.includes("subscription"),pending:this.showAddSubscriptionStep},{title:"Grant access to roles",completed:this.completedSteps.includes("grant-access"),pending:this.showGrantAccessStep},{title:"Name your connection",completed:this.completedSteps.includes("complete-setup"),pending:this.showCompleteSetupStep}]}},data(){return{showStartStep:!0,showAddSecretStep:!1,showAddSubscriptionStep:!1,showGrantAccessStep:!1,showCompleteSetupStep:!1,applicationId:void 0,secretKey:void 0,directoryId:void 0,subscriptionId:void 0,completedSteps:[],cloudId:void 0}},methods:{handleCancel(){this.$router.back()},handleContinue(r,t){if(H.data.group.is_demo_group===1)return this.$modal.show("AddWorkspaceRedirectModal");switch(this.completedSteps.push(r),r){case"start":this.applicationId=t.applicationId,this.directoryId=t.directoryId,this.showStartStep=!1,this.showAddSecretStep=!0;return;case"secret":this.secretKey=t.secretKey,this.showAddSecretStep=!1,this.showAddSubscriptionStep=!0;return;case"subscription":this.subscriptionId=t.subscriptionId,this.showAddSubscriptionStep=!1,this.showGrantAccessStep=!0;return;case"grant-access":this.cloudId=t.cloudId,this.showGrantAccessStep=!1,this.showCompleteSetupStep=!0;return}},handleGoBack(r,t){switch(this.completedSteps.pop(),r){case"secret":this.secretKey=t.secretKey,this.showStartStep=!0,this.showAddSecretStep=!1;return;case"subscription":this.subscriptionId=t.subscriptionId,this.showAddSecretStep=!0,this.showAddSubscriptionStep=!1;return;case"grant-access":this.showAddSubscriptionStep=!0,this.showGrantAccessStep=!1;return}},handleComplete(){this.showCompleteSetupStep=!1,this.$router.back()}}},De={class:"page-content bg-white"},ze={class:"cloud-config"},Ve={class:"cloud-config__step-container"},Pe={class:"cloud-config__progress-container"};function Ee(r,t,y,b,s,n){const u=l("PageHeader"),p=l("StartAzureCloudConfiguration"),a=l("AddSecretAzureCloudConfiguration"),h=l("AddSubscriptionAzureCloudConfiguration"),_=l("GrantAccessAzureCloudConfiguration"),f=l("CompleteAzureCloudConfiguration"),w=l("ProgressTracker");return m(),C(S,null,[i(u,{breadcrumbs:n.breadcrumbs,title:"Cloud configuration"},null,8,["breadcrumbs"]),e("div",De,[e("div",ze,[e("div",Ve,[s.showStartStep?(m(),I(p,{key:0,"initial-directory-id":s.directoryId,"initial-application-id":s.applicationId,onCancel:n.handleCancel,onContinue:t[0]||(t[0]=c=>n.handleContinue("start",c))},null,8,["initial-directory-id","initial-application-id","onCancel"])):x("",!0),s.showAddSecretStep?(m(),I(a,{key:1,"initial-secret":s.secretKey,onGoBack:t[1]||(t[1]=c=>n.handleGoBack("secret",c)),onContinue:t[2]||(t[2]=c=>n.handleContinue("secret",c))},null,8,["initial-secret"])):x("",!0),s.showAddSubscriptionStep?(m(),I(h,{key:2,"initial-subscription-id":s.subscriptionId,onGoBack:t[3]||(t[3]=c=>n.handleGoBack("subscription",c)),onContinue:t[4]||(t[4]=c=>n.handleContinue("subscription",c))},null,8,["initial-subscription-id"])):x("",!0),s.showGrantAccessStep?(m(),I(_,{key:3,"directory-id":s.directoryId,"application-id":s.applicationId,"secret-key":s.secretKey,"subscription-id":s.subscriptionId,onGoBack:t[5]||(t[5]=()=>n.handleGoBack("grant-access")),onContinue:t[6]||(t[6]=c=>n.handleContinue("grant-access",c))},null,8,["directory-id","application-id","secret-key","subscription-id"])):x("",!0),s.showCompleteSetupStep?(m(),I(f,{key:4,onCancel:n.handleCancel,onComplete:n.handleComplete,"cloud-id":s.cloudId},null,8,["onCancel","onComplete","cloud-id"])):x("",!0)]),e("div",Pe,[i(w,{steps:n.steps},null,8,["steps"])])])])],64)}const Me=g(Te,[["render",Ee]]);export{Me as default};
