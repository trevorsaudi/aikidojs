import{_ as F,I as k,cq as m,an as n,cs as L,cr as C,cu as D,r as i,m as c,o,p as v,n as f,w as d,F as E,q as u,s as b,k as h}from"./index-13ff96f4.js";import{s as q}from"./slaEmptyState-e877fc05.js";import{Q}from"./QueueTable-de6aabd1.js";import{F as B}from"./FilterButton-bb5393a7.js";import{A as U}from"./ActionMenu-3e4470bf.js";import{Q as N}from"./QueueSidebar-47492277.js";import{Q as G}from"./QueueQuickFilter-70881bd4.js";import{D as M}from"./DastIllustration-f420fa73.js";import{O as V}from"./OverviewEmptyState-c8440b9c.js";import{S as P}from"./SlaEmptyState-a5a9e243.js";import{B as x}from"./BaseCallout-aea0aba4.js";import"./dateFns-a344cb79.js";import"./index-b87db690.js";import"./DataTableCell-51c0104f.js";import"./IssueGroupSeverityColumn-7631c77a.js";import"./SidebarActionMenu-1bf6804b.js";import"./CreateAutoFixProgressFlow-8111d22c.js";import"./RadioButtonList-1d4cdaad.js";import"./EnableIntegrationModal-48b01f56.js";import"./focusModePreference-150f170e.js";import"./TableListHeader-e50d01d1.js";import"./DataTable-e31a825a.js";import"./BaseRadioInput-a7ac3557.js";import"./BaseLabel-a1c0ca00.js";import"./AIText-891d4f7b.js";import"./InputCheckbox-81cb3ca6.js";import"./BreakSlashes-925eef0e.js";import"./UnignoreIssue-5dff8957.js";import"./CreateTicketModal-c14deeb1.js";import"./ManualInputSearchDropdown-6a7ece3e.js";import"./InputSearchDropdown-02988f6b.js";import"./repoName-872812ed.js";import"./taskTrackerNaming-55adac3e.js";import"./taskTrackerIcon-504ea566.js";import"./autofixable-c6560249.js";import"./autofixSastIssues-779ec5b4.js";import"./lock-files-cdbb050f.js";import"./BaseCodeBlock-cec75629.js";import"./string-814c5ffd.js";import"./ButtonMultiOption-12e505fb.js";import"./transform-c376ec3f.js";import"./linear-efb37b7f.js";import"./arc-12e4470a.js";import"./BaseForm-4c6fa06f.js";import"./XTabs-d492da26.js";import"./BaseCard-471d3203.js";import"./AccordionContainer-09dc0ed4.js";import"./trycatch-83445d5b.js";import"./licenses-6ab38515.js";import"./BaseStatusLabel-0ccd2806.js";import"./DataTableSeverityIndicator-48ffb8dc.js";import"./IssueGroupTypeColumn-03f014b0.js";import"./BracesIcon-0a8568f4.js";import"./BoxIcon-9908469f.js";import"./StackedAvatars-4925baeb.js";import"./languages-12749071.js";import"./GenericIllustration-4aca88e5.js";const K={components:{QueueTable:Q,QueueSidebar:N,InputSearch:k,FilterButton:B,ActionMenu:U,QueueQuickFilter:G,OverviewEmptyState:V,DastIllustration:M,SlaEmptyState:P,BaseCallout:x},props:{domainId:{type:Number,required:!0},lastScannedAt:{type:String,default:""},shouldShowReAuthBanner:{type:Boolean,default:!1},shouldShowWhiteListIpBanner:{type:Boolean,default:!1},scanType:{type:String,default:""}},data(){return{groupedIssues:[],isLoading:!0,showLoadingState:!0,searchTerm:m("search",""),filters:{quickFilter:m("filter",void 0)}}},async mounted(){await Promise.all([this.loadGroupedIssues()]),this.showLoadingState=!1},created(){n.on("issueUpdated",this.handleIssueUpdated),n.on("DomainScanFinished",this.loadGroupedIssues),n.on("dastScanCompleted",this.loadGroupedIssues)},beforeUnmount(){n.off("issueUpdated",this.handleIssueUpdated),n.off("DomainScanFinished",this.loadGroupedIssues),n.off("dastScanCompleted",this.loadGroupedIssues)},watch:{async domainId(){this.domainId&&(this.showLoadingState=!0,await Promise.all([this.loadGroupedIssues()]),this.showLoadingState=!1)}},computed:{emptystateTitle(){return this.hasActiveFilters?"No issues found":this.hasAlreadyScanned?"Great! No issues found on this domain.":"No scan results yet."},emptyStateDescription(){return this.hasActiveFilters?"We could not find any issues which match the filters you provided. Try a different filter or search term.":this.hasAlreadyScanned?"Aikido scans your domains nightly. You can also start a scan manually.":"Results are shown with 3-5 minutes after a scan has started."},hasAlreadyScanned(){return!!this.lastScannedAt},hasActiveFilters(){return this.searchTerm!=""?!0:!!this.filters.quickFilter},shouldUseSlaEmptyState(){return q(this.filters.quickFilter)},actions(){const e=[{label:"Refresh Table",onClick:this.loadGroupedIssues,icon:"icon-refresh",iconClass:"w-16px"}];return this.scanType==="akto"&&e.push({visible:this.canExportOpenApiSpec,label:"Download OpenAPI spec",onClick:this.handleDownloadOpenapiSpec,icon:"icon-download"}),[{title:"Actions",items:e.filter(s=>s.visible!==!1)}]},canExportOpenApiSpec(){return!this.$groupUser.only_team_related_issues}},methods:{async onItemSelected(e){L.replace({path:this.$route.path,query:{...this.$route.query,sidebarIssue:e.id}})},onSearchTermChanged(){this.loadGroupedIssues(),C({search:this.searchTerm})},async handleIssueUpdated(){await this.loadGroupedIssues()},async loadGroupedIssues(){this.isLoading=!0;const e=await D({filter_domain_id:this.domainId,search_term:this.searchTerm,quick_filter:this.filters.quickFilter});this.groupedIssues=this.enhanceStatus(e),this.isLoading=!1},async onQueueQuickFilterSelected(e){this.filters=e,await this.loadGroupedIssues()},enhanceStatus(e){return["ignored","closed"].includes(this.filters.quickFilter)?e.map(a=>({...a,enhanced_status:this.filters.quickFilter})):e},handleDownloadOpenapiSpec(){this.$modal.show("DownloadOpenApiSpecModal",{domainId:this.domainId})}}},W={key:0,class:"mb-24px"},R={key:1,class:"mb-24px"},H={class:"flex align-center gap-8px mb-16px"},Y=f("i",{class:"icon icon-caret_down icon-12px"},null,-1);function j(e,s,a,z,t,r){const p=i("BaseCallout"),I=i("InputSearch"),S=i("QueueQuickFilter"),y=i("FilterButton"),T=i("ActionMenu"),A=i("SlaEmptyState"),g=i("DastIllustration"),_=i("OverviewEmptyState"),O=i("QueueTable"),w=i("QueueSidebar");return u(),c(E,null,[a.shouldShowWhiteListIpBanner?(u(),c("div",W,[o(p,{title:e.$t("DOMAIN.AKTO.CALLOUT.WHITELIST_IP.TITLE"),description:e.$t("DOMAIN.AKTO.CALLOUT.WHITELIST_IP.DESC"),actionLabel:e.$t("DOMAIN.AKTO.CALLOUT.WHITELIST_IP.ACTION"),onAction:s[0]||(s[0]=l=>e.$emit("whitelistIp")),variation:"danger"},null,8,["title","description","actionLabel"])])):a.shouldShowReAuthBanner?(u(),c("div",R,[o(p,{title:e.$t("DOMAIN.AKTO.CALLOUT.TITLE"),description:e.$t("DOMAIN.AKTO.CALLOUT.DESC"),actionLabel:e.$t("DOMAIN.AKTO.CALLOUT.ACTION"),onAction:s[1]||(s[1]=l=>e.$emit("authenticate")),variation:"danger"},null,8,["title","description","actionLabel"])])):v("",!0),f("div",H,[o(I,{modelValue:t.searchTerm,"onUpdate:modelValue":[s[2]||(s[2]=l=>t.searchTerm=l),r.onSearchTermChanged],spacing:"compact"},null,8,["modelValue","onUpdate:modelValue"]),o(S,{onFilterSelected:r.onQueueQuickFilterSelected,hideCriticalOption:!0,hideNewOption:!0,hideLanguageFilter:!0,hideAttackSurfaceFilters:!0,"initial-filter":t.filters.quickFilter,persistFilterToQueryParams:!0},null,8,["onFilterSelected","initial-filter"]),o(T,{class:"ml-auto",sections:r.actions,placement:"bottom-end",useBaseIcon:!0},{trigger:d(l=>[o(y,{onClick:()=>l.toggle()},{default:d(()=>[b(" Actions "),Y]),_:2},1032,["onClick"])]),_:1},8,["sections"])]),o(O,{onItemClicked:r.onItemSelected,filterDomainId:a.domainId,groupedIssues:t.groupedIssues,isLoading:t.showLoadingState,showEmptyState:t.groupedIssues.length==0,quickFilter:t.filters.quickFilter},{emptyState:d(()=>[r.shouldUseSlaEmptyState?(u(),h(A,{key:0})):(u(),h(_,{key:1,title:r.emptystateTitle,description:r.emptyStateDescription,variation:"empty"},{default:d(()=>[o(g)]),_:1},8,["title","description"]))]),_:1},8,["onItemClicked","filterDomainId","groupedIssues","isLoading","showEmptyState","quickFilter"]),o(w,{groupedIssues:t.groupedIssues,filterDomainId:a.domainId,showIgnoredOnly:t.filters.quickFilter==="ignored",showClosedOnly:t.filters.quickFilter==="closed",filterOutOfSla:t.filters.quickFilter==="out_of_sla",filterDueSoon:t.filters.quickFilter==="due_soon"},null,8,["groupedIssues","filterDomainId","showIgnoredOnly","showClosedOnly","filterOutOfSla","filterDueSoon"])],64)}const $e=F(K,[["render",j]]);export{$e as default};
