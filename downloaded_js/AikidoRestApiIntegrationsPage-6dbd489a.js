import{_ as A,r as a,q as u,k as m,w as t,aa as v,B as x,a2 as M,e as S,d as $,a3 as b,o as e,n as f,s as n,u as d,ai as U,f as L,x as H,X as O,an as p,ft as N,m as T,p as y,F as B,t as X}from"./index-13ff96f4.js";import{D as V,a as F}from"./DataTable-e31a825a.js";import{P as j}from"./PageHeader-46c38a32.js";import{a as P,D as z}from"./DataTableCell-51c0104f.js";import{A as Y}from"./ActionMenu-3e4470bf.js";import{O as W}from"./OverviewEmptyState-c8440b9c.js";import{E as q}from"./EmptyMetricsIllutstration-491e438a.js";const G={props:{credentials:Object},components:{ActionMenu:Y},computed:{actions(){return[{title:"Actions",items:[{label:"Edit",onClick:this.handleEdit,icon:"icon-settings"},{label:"Rotate secret",onClick:this.handleRegenerateCredentials,icon:"icon-refresh"},{label:"Delete",onClick:this.handleDeleteCredentials,destructive:!0}]}]}},methods:{async handleDeleteCredentials(){this.$modal.show("PublicApiClientCredentialsDeleteConfirmationModal",{credentials:this.credentials})},handleRegenerateCredentials(){this.$modal.show("PublicApiClientCredentialsRegenerateConfirmationModal",{credentials:this.credentials})},handleEdit(){this.$modal.show("RegisterPublicApiClientCredentialsModal",{credentials:this.credentials})}}};function J(i,h,c,w,C,l){const s=a("ActionMenu");return u(),m(s,{sections:l.actions,placement:"bottom-end"},{trigger:t(_=>[v(i.$slots,"trigger",{toggle:_.toggle})]),_:3},8,["sections"])}const K=A(G,[["render",J]]),Q={props:{client:Object},components:{DataTableRow:P,DataTableCell:z,BaseParagraph:x,XTooltip:M,AikidoRestApiIntegrationClientsActionMenu:K,BaseIconButton:S,BasePill:$},computed:{scopes(){return this.client.scopes.join(", ")},timestamp(){return b.fromUnix(this.client.created_at).format(b.US_FRIENDLY_DATE_WITH_TIME)},lastUsedTimestamp(){return this.client.last_used_at<0?"-":b.fromUnix(this.client.last_used_at).format(b.US_FRIENDLY_DATE_WITH_TIME)}}},Z={class:"flex gap-4px"};function ee(i,h,c,w,C,l){const s=a("BaseParagraph"),_=a("BasePill"),o=a("DataTableCell"),g=a("XTooltip"),r=a("BaseIconButton"),R=a("AikidoRestApiIntegrationClientsActionMenu"),k=a("DataTableRow");return u(),m(k,null,{default:t(()=>[e(o,null,{default:t(()=>[f("div",Z,[e(s,{class:"ws-break-spaces"},{default:t(()=>[n(d(c.client.description),1)]),_:1}),e(_,{title:c.client.app_type,size:"compact"},null,8,["title"])])]),_:1}),e(o,null,{default:t(()=>[e(s,{truncate:""},{default:t(()=>[n(d(c.client.client_id)+" ",1),e(g,null,{default:t(()=>[n(d(c.client.client_id),1)]),_:1})]),_:1})]),_:1}),e(o,null,{default:t(()=>[e(s,null,{default:t(()=>[n(d(c.client.client_secret),1)]),_:1})]),_:1}),e(o,null,{default:t(()=>[e(s,{truncate:""},{default:t(()=>[n(d(l.scopes)+" ",1),e(g,{class:"ws-break-spaces"},{default:t(()=>[n(d(l.scopes),1)]),_:1})]),_:1})]),_:1}),e(o,null,{default:t(()=>[e(s,null,{default:t(()=>[n(d(l.timestamp),1)]),_:1})]),_:1}),e(o,null,{default:t(()=>[e(s,null,{default:t(()=>[n(d(l.lastUsedTimestamp),1)]),_:1})]),_:1}),e(o,{spacing:"compact",alignment:"center"},{default:t(()=>[f("div",{class:"data-table__row__action-container",onClick:h[0]||(h[0]=U(()=>i.$refs.trigger.click(),["stop"]))},[e(R,{credentials:c.client},{trigger:t(I=>[e(r,{icon:"icon-actions",onClicked:I.toggle,class:"data-table__row__action",ref:"trigger"},null,8,["onClicked"])]),_:1},8,["credentials"])])]),_:1})]),_:1})}const te=A(Q,[["render",ee]]),ae={components:{OverviewEmptyState:W,EmptyMetricsIllustration:q},methods:{async handleRegisterApiClient(){const i=await this.$modal.show("RegisterPublicApiClientCredentialsModal");i.type==="saved"&&this.$modal.show("RegisterPublicApiClientCredentialsResultModal",{clientId:i.value.client_id,clientSecret:i.value.client_secret})}}};function ne(i,h,c,w,C,l){const s=a("EmptyMetricsIllustration"),_=a("OverviewEmptyState");return u(),m(_,{title:"No api clients registered",description:"You don't seem to have configured any API client credentials yet",variation:"empty",actionLabel:"Register client",onOnAction:l.handleRegisterApiClient},{default:t(()=>[e(s)]),_:1},8,["onOnAction"])}const ie=A(ae,[["render",ne]]),le={components:{PageHeader:j,DataTable:V,BaseButton:L,BaseIcon:H,DataTableHeader:F,XPreloader:O,AikidoRestApiIntegrationClientsRow:te,AikidoRestApiIntegrationClientsEmptyState:ie,DataTableRow:P},data(){return{clients:[],isLoading:!0}},created(){p.on("oauthClientCredentialsCreated",this.loadClientCredentials),p.on("oauthClientCredentialsDeleted",this.loadClientCredentials),p.on("oauthClientCredentialsUpdated",this.loadClientCredentials)},beforeUnmount(){p.off("oauthClientCredentialsCreated",this.loadClientCredentials),p.off("oauthClientCredentialsDeleted",this.loadClientCredentials),p.off("oauthClientCredentialsUpdated",this.loadClientCredentials)},async mounted(){await this.loadClientCredentials(),this.isLoading=!1},computed:{breadcrumbs(){return[{label:"Settings",href:"/settings"},{label:"Integrations",href:"/settings/integrations"},{label:"API"},{label:"Aikido"},{label:"Rest"}]},showEmptyState(){return!this.isLoading&&this.clients.length===0}},methods:{async loadClientCredentials(){this.clients=await N()},async handleAddClient(){const i=await this.$modal.show("RegisterPublicApiClientCredentialsModal");i.type==="saved"&&this.$modal.show("RegisterPublicApiClientCredentialsResultModal",{clientId:i.value.client_id,clientSecret:i.value.client_secret})}}},se={class:"page-content"},oe={class:"flex align-center mb-24px gap-12px"},ce={colspan:"7"};function re(i,h,c,w,C,l){const s=a("XPreloader"),_=a("PageHeader"),o=a("BaseButton"),g=a("BaseIcon"),r=a("DataTableHeader"),R=a("AikidoRestApiIntegrationClientsRow"),k=a("AikidoRestApiIntegrationClientsEmptyState"),I=a("DataTableRow"),E=a("DataTable");return u(),T(B,null,[C.isLoading?(u(),m(s,{key:0,theme:"light",class:"supercenter"})):y("",!0),e(_,{title:"Aikido public REST API integration",breadcrumbs:l.breadcrumbs},null,8,["breadcrumbs"]),f("div",se,[f("div",oe,[e(o,{size:"small",variation:"blue",class:"ml-auto",as:"outside-link",href:"https://apidocs.aikido.dev/",target:"_blank"},{default:t(()=>[n("View API docs")]),_:1}),e(o,{size:"small",onClick:l.handleAddClient},{default:t(()=>[e(g,{icon:"icon-add",class:"flex"}),n(" Add client ")]),_:1},8,["onClick"])]),e(E,null,{header:t(()=>[e(r,{width:"auto"},{default:t(()=>[n("App name")]),_:1}),e(r,{width:"auto"},{default:t(()=>[n("Client ID")]),_:1}),e(r,{width:"125px"},{default:t(()=>[n("Client secret")]),_:1}),e(r,{width:"auto"},{default:t(()=>[n("Scopes")]),_:1}),e(r,{width:"200px"},{default:t(()=>[n("Created at")]),_:1}),e(r,{width:"200px"},{default:t(()=>[n("Last Used at")]),_:1}),e(r,{width:"48px",alignment:"center"})]),body:t(()=>[(u(!0),T(B,null,X(C.clients,D=>(u(),m(R,{client:D,key:D.id},null,8,["client"]))),128)),l.showEmptyState?(u(),m(I,{key:0},{default:t(()=>[f("td",ce,[e(k)])]),_:1})):y("",!0)]),_:1})])],64)}const fe=A(le,[["render",re]]);export{fe as default};
