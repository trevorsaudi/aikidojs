import{_ as T,M as V,B as R,H as O,r as l,q as u,k as w,w as t,o as e,s as o,u as _,n as d,a1 as E,N,f as $,dq as H,bK as U,m,c7 as z,p as j,F as g,t as S}from"./index-13ff96f4.js";import{D as K,a as q}from"./DataTable-e31a825a.js";import{D as G,a as W}from"./DataTableCell-51c0104f.js";import{D as Y}from"./DataTableSeverityIndicator-48ffb8dc.js";import{c as B}from"./autofixable-c6560249.js";import{I as Z}from"./InputFilterDropdown-674351d9.js";import"./FilterButton-bb5393a7.js";import"./ActionMenu-3e4470bf.js";const J={components:{BaseModal:V,BaseParagraph:R,BaseHeading:O},methods:{handleCloseModal(){this.$emit("close")}}},Q={class:"flex flex-column gap-12px"},X={class:"flex gap-4px flex-column"},ee=d("pre",{class:"ws-break-spaces"},'".tf", ".yml", ".yaml", ".json", ".template", ".bicep", ".hcl", "Dockerfile"',-1);function te(n,s,b,D,a,c){const r=l("BaseParagraph"),y=l("BaseHeading"),I=l("BaseModal");return u(),w(I,{width:600,onClose:c.handleCloseModal},{header:t(()=>[e(r,{color:"gray"},{default:t(()=>[o(_(this.$t("SUPPORTED_IAC_FILES_MODAL.TITLE")),1)]),_:1})]),content:t(()=>[d("div",Q,[e(y,{as:"h3"},{default:t(()=>[o(_(this.$t("SUPPORTED_IAC_FILES_MODAL.DESCRIPTION")),1)]),_:1}),d("div",X,[e(r,{class:"ws-pre"},{default:t(()=>[o(_(n.$t("SUPPORTED_IAC_FILES_MODAL.BODY")),1)]),_:1}),e(r,{class:"mt-4px"},{default:t(()=>[o(" In practice, that means files with the following extensions will be scanned for IaC misconfigurations. "),ee]),_:1})])])]),_:1},8,["onClose"])}const ae=T(J,[["render",te]]),le={components:{BaseParagraph:R,DataTable:K,DataTableCell:G,DataTableHeader:q,DataTableRow:W,LoadingSkeleton:E,DataTableSeverityIndicator:Y,BaseSelect:N,BaseButton:$,SupportedIacFilesModal:ae,InputFilterDropdown:Z},data(){return{loading:!0,iacRules:[],languageFilter:void 0,languageSelectValues:[{id:"AWS",title:"AWS"},{id:"GCP",title:"GCP"},{id:"AZURE",title:"Azure"},{id:"Docker",title:"Docker"},{id:"Kubernetes",title:"Kubernetes"},{id:"Ansible",title:"Ansible"}],showSupportedIacFilesModal:!1,typeFilter:void 0,typeOptions:[{value:void 0,label:"All types",default:!0},{value:"autofix_support_only",label:"Autofix supported rules"}]}},computed:{filteredIacRules(){let n=this.iacRules;this.languageFilter&&(n={[this.languageFilter]:this.iacRules[this.languageFilter]});const s={};for(const[b,D]of Object.entries(n)){let a=D;this.typeFilter&&(a=a.filter(c=>this.typeFilter=="autofix_support_only"?B(c.rule_id):!0)),s[b]=a}return s}},async created(){this.loading=!0,this.iacRules=await H(),this.loading=!1},methods:{getSeverityText(n){return this.$t(U(n))},getAutofixableText(n){return B(n.rule_id)?"Yes":"No"},getAutofixableVariation(n){return B(n.rule_id)?"green":"gray-fill"}}},oe={class:"flex gap-16px align-center px-16px mb-24px"},se={class:"flex gap-16px align-center"},ne={class:"flex flex-column"},ie={class:"w-full flex align-center justify-center"},re={class:"px-4px text--semi"};function ue(n,s,b,D,a,c){const r=l("BaseParagraph"),y=l("BaseSelect"),I=l("InputFilterDropdown"),A=l("BaseButton"),h=l("DataTableHeader"),p=l("DataTableCell"),v=l("BasePill"),C=l("DataTableSeverityIndicator"),F=l("DataTableRow"),x=l("LoadingSkeleton"),k=l("DataTable"),M=l("SupportedIacFilesModal");return u(),m(g,null,[d("div",oe,[d("div",se,[e(r,{size:"small"},{default:t(()=>[o("Language")]),_:1}),e(y,{class:"w-150px",id:"language",modelValue:a.languageFilter,"onUpdate:modelValue":s[0]||(s[0]=i=>a.languageFilter=i),options:a.languageSelectValues},null,8,["modelValue","options"]),e(I,{modelValue:a.typeFilter,"onUpdate:modelValue":s[1]||(s[1]=i=>a.typeFilter=i),options:a.typeOptions},null,8,["modelValue","options"])]),e(A,{onClicked:s[2]||(s[2]=i=>a.showSupportedIacFilesModal=!0),size:"small",variation:"tertiary"},{default:t(()=>[o(" Show more info ")]),_:1})]),e(k,null,z({header:t(()=>[e(h,{width:"128px"},{default:t(()=>[o("Language")]),_:1}),e(h,{width:"auto"},{default:t(()=>[o("Description")]),_:1}),e(h,{width:"100px"},{default:t(()=>[o("Autofix")]),_:1}),e(h,{width:"96px"},{default:t(()=>[o("Score")]),_:1})]),_:2},[a.loading?{name:"body",fn:t(()=>[(u(),m(g,null,S(10,i=>e(F,{key:i},{default:t(()=>[e(p,null,{default:t(()=>[e(x)]),_:1}),e(p,null,{default:t(()=>[e(x,{width:"256px"})]),_:1}),e(p,null,{default:t(()=>[e(x)]),_:1}),e(p,null,{default:t(()=>[e(x)]),_:1})]),_:2},1024)),64))]),key:"1"}:{name:"body",fn:t(()=>[(u(!0),m(g,null,S(Object.entries(c.filteredIacRules),([i,P])=>(u(),m(g,null,[(u(!0),m(g,null,S(P,(f,L)=>(u(),w(F,{key:`${i}-${L}`},{default:t(()=>[e(p,null,{default:t(()=>[e(r,{class:"text-programming-language",bold:""},{default:t(()=>[o(_(i),1)]),_:2},1024)]),_:2},1024),e(p,null,{default:t(()=>[d("div",ne,[e(r,null,{default:t(()=>[o(_(f.title),1)]),_:2},1024),e(r,{size:"small",color:"subdued"},{default:t(()=>[o(_(f.description),1)]),_:2},1024)])]),_:2},1024),e(p,null,{default:t(()=>[d("div",ie,[e(v,{variation:c.getAutofixableVariation(f),size:"compact"},{default:t(()=>[d("span",re,_(c.getAutofixableText(f)),1)]),_:2},1032,["variation"])])]),_:2},1024),e(C,{priority:f.base_score},null,8,["priority"])]),_:2},1024))),128))],64))),256))]),key:"0"}]),1024),a.showSupportedIacFilesModal?(u(),w(M,{key:0,onClose:s[3]||(s[3]=i=>a.showSupportedIacFilesModal=!1)})):j("",!0)],64)}const xe=T(le,[["render",ue]]);export{xe as default};
