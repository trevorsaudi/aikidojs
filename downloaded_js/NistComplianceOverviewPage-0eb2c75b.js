import{i as x}from"./reports-ed4978a9.js";import{P as R}from"./PageHeader-46c38a32.js";import{_ as I,H as B,X as M,dv as T,B as F,aV as L,r as t,m as l,o as r,w as o,n as s,k as f,F as c,t as H,p as E,q as a,s as u,S as N,u as y}from"./index-13ff96f4.js";import{A as D}from"./ActionMenu-3e4470bf.js";import{F as q}from"./FilterButton-bb5393a7.js";import{C as O}from"./ComplianceSection-1226ea47.js";import{C as K}from"./CompliancePrintHeader-341b18be.js";import{P as V}from"./PdfDownloadButton-072addbd.js";import"./AccordionContainer-09dc0ed4.js";import"./DataTable-e31a825a.js";import"./DataTableCell-51c0104f.js";import"./BracesIcon-0a8568f4.js";const z={components:{PageHeader:R,BaseHeading:B,XPreloader:M,ProgressBar:T,ComplianceSection:O,CompliancePrintHeader:K,ActionMenu:D,FilterButton:q,BaseParagraph:F,PdfDownloadButton:V},data(){return{isLoading:!0,overview:{},groupReference:void 0,mode:void 0}},provide(){return{filter_team_id:L(()=>this.$teamContext)}},async mounted(){await Promise.allSettled([this.loadComplianceOverview()])},watch:{async $teamContext(){this.$globalLoadingIndicator.show();try{await this.loadComplianceOverview()}finally{this.$globalLoadingIndicator.hide()}}},computed:{breadcrumbs(){return[{label:"Reports",href:"/reports"},{label:"Nist compliance"}]},compliance(){const e=this.overview.total_complying_rule_count??0,n=this.overview.total_rule_count??0;return e===0||this.isLoading?0:Math.round(e/n*100)},sections(){return this.mode?this.overview[this.mode]??{}:["access_control_result","access_enforcement_result","information_flow_enforcement_result","least_privilege_result","remote_access_result","data_mining_protection_result","audit_record_review_analysis_and_reporting_result","protection_and_audit_information_result","audit_record_retention_result","audit_record_generation_result","continuous_monitoring_result","access_restrictions_for_change_result","least_functionality_result","system_backup_result","identification_and_authentication_org_users_result","authencticator_management_result","adaptive_authentication_result","indicent_monitoring_result","maintenance_result","physical_and_environmental_protection_result","planning_result","insider_threat_program_result","pesonnel_security_result","personally_identifiable_information_processing_and_transparency_result","threat_hunting_result","system_development_life_cycle_result","denial_of_service_protection_result","boundary_protection_result","cryptographic_key_establishment_and_management_result","transmission_of_security_and_privacy_attributes_result","secure_resolution_service_authoritative_source_result","secure_resolution_service_recursive_or_caching_resolver_result","architecture_and_provisioning_for_resolution_service_result","session_authenticity_result","fail_in_known_state_result","protection_of_information_at_rest_result","non_modifiadble_excecutable_programs_result","system_and_information_integrity_result"].reduce((n,d)=>({...n,...this.overview[d]??{}}),{})},filterLabel(){return{access_control_result:"1.2 Access Control",access_enforcement_result:"1.3 Access Enforcement",information_flow_enforcement_result:"1.4 Information Flow Enforcement",least_privilege_result:"1.6 Least Privilege",remote_access_result:"1.17 Remote Access",data_mining_protection_result:"1.23 Data Mining Protection",awareness_and_training_result:"2. Awareness and Training",audit_record_review_analysis_and_reporting_result:"3.6 Audit Record Review, Analysis, and Reporting",protection_and_audit_information_result:"3.9 Protection of Audit Information",audit_record_retention_result:"3.11 Audit Record Retention",audit_record_generation_result:"3.12 Audit Record Generation",continuous_monitoring_result:"4.7 Continuous Monitoring",access_restrictions_for_change_result:"5.5 Access Restrictions for Change",least_functionality_result:"5,7 Least Functionality",system_backup_result:"6.9 System Backup",identification_and_authentication_org_users_result:"7.2 Identification and Authentication of Organization Users",authencticator_management_result:"7.5 Authenticator Management",adaptive_authentication_result:"7.10 Adaptive Authentication",indicent_monitoring_result:"8.5 Incident Monitoring",maintenance_result:"9. Maintenance",media_protection_result:"10. Media Protection",physical_and_environmental_protection_result:"11. Physical and Environmental Protection",planning_result:"12. Planning",insider_threat_program_result:"13.12 Insider Threat Program",pesonnel_security_result:"14. Personnel Security",personally_identifiable_information_processing_and_transparency_result:"15. Personally Identifiable Information Processing and Transparency",threat_hunting_result:"16.10 Threat Hunting",system_development_life_cycle_result:"17.3 System Development Life Cycle",denial_of_service_protection_result:"18.5 Denial of Service Protection",boundary_protection_result:"18.7 Boundary Protection",cryptographic_key_establishment_and_management_result:"18.12 Cryptographic Key Establishment and Management",transmission_of_security_and_privacy_attributes_result:"18.16 Transmission of Security and Privacy Attributes",secure_resolution_service_authoritative_source_result:"18.20 Secure Resolution Service Authoritative Source",secure_resolution_service_recursive_or_caching_resolver_result:"18.21 Secure Resolution Service Recursive or Caching Resolver",architecture_and_provisioning_for_resolution_service_result:"18.22 Architecture and Provisioning for Resolution Service",session_authenticity_result:"18.23 Session Authenticity",fail_in_known_state_result:"18.24 Fail in Known State",protection_of_information_at_rest_result:"18.28 Protection of Information at Rest",non_modifiadble_excecutable_programs_result:"18.34 Non Modifiable Executable Programs",system_and_information_integrity_result:"19. System and Information Integrity"}[this.mode]||"Filter controls"},actions(){return[{title:"Controls",action:{label:"Clear filter",onClick:()=>this.mode=void 0},items:[{label:"1.2 Access Control",key:"access_control_result"},{label:"1.3 Access Enforcement",key:"access_enforcement_result"},{label:"1.4 Information Flow Enforcement",key:"information_flow_enforcement_result"},{label:"1.6 Least Privilege",key:"least_privilege_result"},{label:"1.17 Remote Access",key:"remote_access_result"},{label:"1.23 Data Mining Protection",key:"data_mining_protection_result"},{label:"2. Awareness and Training",key:"awareness_and_training_result"},{label:"3.6 Audit Record Review, Analysis, and Reporting",key:"audit_record_review_analysis_and_reporting_result"},{label:"3.9 Protection of Audit Information",key:"protection_and_audit_information_result"},{label:"3.11 Audit Record Retention",key:"audit_record_retention_result"},{label:"3.12 Audit Record Generation",key:"audit_record_generation_result"},{label:"4.7 Continuous Monitoring",key:"continuous_monitoring_result"},{label:"5.5 Access Restrictions for Change",key:"access_restrictions_for_change_result"},{label:"5.7 Least Functionality",key:"least_functionality_result"},{label:"6.9 System Backup",key:"system_backup_result"},{label:"7.2 Identification and Authentication of Organization Users",key:"identification_and_authentication_org_users_result"},{label:"7.5 Authenticator Management",key:"authencticator_management_result"},{label:"7.10 Adaptive Authentication",key:"adaptive_authentication_result"},{label:"8.5 Incident Monitoring",key:"indicent_monitoring_result"},{label:"9. Maintenance",key:"maintenance_result"},{label:"10. Media Protection",key:"media_protection_result"},{label:"11. Physical and Environmental Protection",key:"physical_and_environmental_protection_result"},{label:"12. Planning",key:"planning_result"},{label:"13.12 Insider Threat Program",key:"insider_threat_program_result"},{label:"14. Personnel Security",key:"pesonnel_security_result"},{label:"15. Personally Identifiable Information Processing and Transparency",key:"personally_identifiable_information_processing_and_transparency_result"},{label:"16.10 Threat Hunting",key:"threat_hunting_result"},{label:"17.3 System Development Life Cycle",key:"system_development_life_cycle_result"},{label:"18.5 Denial of Service Protection",key:"denial_of_service_protection_result"},{label:"18.7 Boundary Protection",key:"boundary_protection_result"},{label:"18.12 Cryptographic Key Establishment and Management",key:"cryptographic_key_establishment_and_management_result"},{label:"18.16 Transmission of Security and Privacy Attributes",key:"transmission_of_security_and_privacy_attributes_result"},{label:"18.20 Secure Resolution Service Authoritative Source",key:"secure_resolution_service_authoritative_source_result"},{label:"18.21 Secure Resolution Service Recursive or Caching Resolver",key:"secure_resolution_service_recursive_or_caching_resolver_result"},{label:"18.22 Architecture and Provisioning for Resolution Service",key:"architecture_and_provisioning_for_resolution_service_result"},{label:"18.23 Session Authenticity",key:"session_authenticity_result"},{label:"18.24 Fail in Known State",key:"fail_in_known_state_result"},{label:"18.28 Protection of Information at Rest",key:"protection_of_information_at_rest_result"},{label:"18.34 Non Modifiable Executable Programs",key:"non_modifiadble_excecutable_programs_result"},{label:"19. System and Information Integrity",key:"system_and_information_integrity_result"}].map(n=>({label:n.label,onClick:()=>this.handleChangeFilter(n.key),active:this.mode===n.key}))}]},emptyControlsMessage(){if(this.mode==="awareness_and_training_result"||this.mode==="maintenance_result"||this.mode==="media_protection_result"||this.mode==="physical_and_environmental_protection_result"||this.mode==="planning_result"||this.mode==="pesonnel_security_result"||this.mode==="personally_identifiable_information_processing_and_transparency_result"||this.mode==="system_and_information_integrity_result")return"This requirement is external to the scope of Aikido."}},methods:{async loadComplianceOverview(){this.overview=await x({teamId:null}),this.isLoading=!1},handleChangeFilter(e){if(this.mode===e){this.mode=void 0;return}this.mode=e}}},X={class:"flex gap-32px align-center"},G={class:"page-content"},U={class:"mb-16px flex align-center gap-12px"},W=s("i",{class:"icon icon-caret_down icon-12px"},null,-1),j={class:"flex flex-column gap-12px",id:"ComplianceSectionWrapper"},J={key:0,class:"flex rounded-8px py-32px px-16px bg-white border-1 border-carbon-20"};function Q(e,n,d,Y,m,i){const g=t("BaseHeading"),h=t("ProgressBar"),v=t("PdfDownloadButton"),b=t("PageHeader"),k=t("XPreloader"),P=t("FilterButton"),A=t("ActionMenu"),C=t("CompliancePrintHeader"),w=t("ComplianceSection"),S=t("BaseParagraph");return a(),l(c,null,[r(b,{breadcrumbs:i.breadcrumbs},{title:o(()=>[s("div",X,[r(g,{as:"h1"},{default:o(()=>[u("NIST compliance overview")]),_:1}),r(h,{progress:i.compliance},null,8,["progress"])])]),rightContent:o(()=>[r(v,{exportType:"nist"})]),_:1},8,["breadcrumbs"]),s("div",G,[m.isLoading?(a(),f(k,{key:0,class:"absolute-centered",theme:"transparent"})):(a(),l(c,{key:1},[s("div",U,[r(A,{sections:i.actions,placement:"bottom-start"},{trigger:o(_=>[r(P,{onClick:_.toggle,class:N({"filter-button--active":!!m.mode})},{default:o(()=>[u(y(i.filterLabel)+" ",1),W]),_:2},1032,["onClick","class"])]),_:1},8,["sections"])]),s("div",j,[r(C,{title:"NIST compliance overview"}),(a(!0),l(c,null,H(i.sections??{},(_,p)=>(a(),f(w,{key:p,section:_,code:p},null,8,["section","code"]))),128)),i.emptyControlsMessage?(a(),l("div",J,[r(S,{size:"medium"},{default:o(()=>[u(y(i.emptyControlsMessage),1)]),_:1})])):E("",!0)])],64))])],64)}const ce=I(z,[["render",Q]]);export{ce as default};
