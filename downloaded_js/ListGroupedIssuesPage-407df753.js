import{f as H}from"./focusModePreference-150f170e.js";import{u as Y}from"./useInfiniteScroll-47c60c9e.js";import{aw as P,cj as z,an as f,bG as W,_ as S,B as C,ck as Z,r as s,q as c,k as _,w as a,o as r,s as p,u as y,cl as X,cm as j,n as i,H as K,m as T,cn as J,A as w,Z as x,co as ee,S as R,a2 as te,cp as se,I as ie,al as re,cq as F,aV as ne,cr as A,cs as oe,ct as ae,K as le,p as $,F as ue,cu as ce}from"./index-13ff96f4.js";import{g as de,M as he}from"./insights-9f746568.js";import{M as b}from"./MiniStatsCard-7a2dcbd6.js";import{B as pe}from"./BulletPoint-1404881f.js";import{P as _e}from"./PieChart-d893d03a.js";import{Q as me}from"./QueueTable-de6aabd1.js";import{Q as fe}from"./QueueSidebar-47492277.js";import{Q as ye}from"./QueueMultiSelectTypeFilter-a1a475d7.js";import{Q as Se}from"./QueueQuickFilter-70881bd4.js";import{F as ge}from"./FeedActionsMenu-6d8ea3a2.js";import{s as Fe}from"./slaEmptyState-e877fc05.js";import{O as Te}from"./OverviewEmptyState-c8440b9c.js";import{G as B}from"./GenericIllustration-4aca88e5.js";import{C as Ce}from"./CloudsIllustration-273aabb4.js";import{C as Ie}from"./ContainersIllustration-8126771c.js";import{S as Le}from"./SnoozedIllustration-a91c1ac9.js";import{D as we}from"./DastIllustration-f420fa73.js";import{S as ve}from"./SolvedIllustration-3f250925.js";import{c as be,e as Ee}from"./ScmSecurity-27bd32ff.js";import{_ as ke}from"./ripples-df807ff5.js";import{s as Me}from"./licenses-6ab38515.js";import{a as Ae}from"./DataTableCell-51c0104f.js";import{S as $e}from"./SlidingButtonGroup-ee0f3352.js";import{F as Pe}from"./FilterButton-bb5393a7.js";import"./transform-c376ec3f.js";import"./arc-12e4470a.js";import"./dateFns-a344cb79.js";import"./index-b87db690.js";import"./IssueGroupSeverityColumn-7631c77a.js";import"./ActionMenu-3e4470bf.js";import"./SidebarActionMenu-1bf6804b.js";import"./CreateAutoFixProgressFlow-8111d22c.js";import"./RadioButtonList-1d4cdaad.js";import"./EnableIntegrationModal-48b01f56.js";import"./TableListHeader-e50d01d1.js";import"./DataTable-e31a825a.js";import"./BaseRadioInput-a7ac3557.js";import"./BaseLabel-a1c0ca00.js";import"./AIText-891d4f7b.js";import"./InputCheckbox-81cb3ca6.js";import"./BreakSlashes-925eef0e.js";import"./UnignoreIssue-5dff8957.js";import"./CreateTicketModal-c14deeb1.js";import"./ManualInputSearchDropdown-6a7ece3e.js";import"./InputSearchDropdown-02988f6b.js";import"./repoName-872812ed.js";import"./taskTrackerNaming-55adac3e.js";import"./taskTrackerIcon-504ea566.js";import"./autofixable-c6560249.js";import"./autofixSastIssues-779ec5b4.js";import"./lock-files-cdbb050f.js";import"./BaseCodeBlock-cec75629.js";import"./string-814c5ffd.js";import"./ButtonMultiOption-12e505fb.js";import"./linear-efb37b7f.js";import"./BaseForm-4c6fa06f.js";import"./XTabs-d492da26.js";import"./BaseCard-471d3203.js";import"./AccordionContainer-09dc0ed4.js";import"./trycatch-83445d5b.js";import"./BaseStatusLabel-0ccd2806.js";import"./DataTableSeverityIndicator-48ffb8dc.js";import"./IssueGroupTypeColumn-03f014b0.js";import"./BracesIcon-0a8568f4.js";import"./BoxIcon-9908469f.js";import"./StackedAvatars-4925baeb.js";import"./languages-12749071.js";import"./InputMultiSelect-21584437.js";import"./DateRangePicker-89d26e9f.js";import"./export-427c6d83.js";const E=e=>{const o=P(e,750,!1);z(()=>{f.on("refreshQueue",o),f.on("refreshMiniStats",o)}),W(()=>{f.off("refreshQueue",o),f.off("refreshMiniStats",o)})},xe={components:{MiniStatsCard:b,BaseParagraph:C},data(){return{countNewCriticals:0,countNewIssues:0,loaded:!1}},inject:["relatedTypeFilters"],async created(){E(this.handleGetStats),await this.handleGetStats(),this.loaded=!0},computed:{title(){return this.$t("X_NEW_DETECTED",this.countNewIssues)},description(){return this.$t("IN_LAST_7_DAYS")}},watch:{relatedTypeFilters:{handler(){this.handleGetStats()},deep:!0}},methods:{async handleGetStats(){const{count_new_criticals:e,count_new_total:o}=await Z(this.relatedTypeFilters);this.countNewCriticals=e,this.countNewIssues=o},goToNewIssues(){f.emit("setFilter",{quickFilter:"new"})}}};function Ne(e,o,l,d,n,t){const u=s("BaseParagraph"),h=s("MiniStatsCard");return c(),_(h,{title:t.title,variation:"new",icon:"icon-add",class:"cursor-pointer",isLoading:!n.loaded,onClick:t.goToNewIssues},{default:a(()=>[r(u,{color:"subdued",class:"sidebar-open_hide-height max-h-40px"},{default:a(()=>[p(y(t.description),1)]),_:1})]),_:1},8,["title","isLoading","onClick"])}const Ge=S(xe,[["render",Ne]]),Re={components:{MiniStatsCard:b,BaseParagraph:C},data(){return{closedIssueCountNow:0,closedIssueCountInLastWeek:0,loaded:!1}},inject:["relatedTypeFilters"],async created(){E(this.handleGetStats),await this.handleGetStats(),this.loaded=!0},computed:{title(){return this.$t("X_ISSUES_CLOSED",this.closedIssueCountNow)},description(){return this.$t("X_IN_LAST_7_DAYS",this.closedIssueCountInLastWeek)}},watch:{relatedTypeFilters:{handler(){this.handleGetStats()},deep:!0}},methods:{async handleGetStats(){const{closed_issue_count_now:e,new_closed_issue_count_since_last_week:o}=await X(this.relatedTypeFilters);this.closedIssueCountNow=e,this.closedIssueCountInLastWeek=o},goToSolvedIssues(){this.$router.push("/issues/closed")}}};function Be(e,o,l,d,n,t){const u=s("BaseParagraph"),h=s("MiniStatsCard");return c(),_(h,{title:t.title,variation:"positive",icon:"icon-shield_check",class:"cursor-pointer",isLoading:!n.loaded,onClick:t.goToSolvedIssues},{default:a(()=>[r(u,{color:"subdued",class:"sidebar-open_hide-height max-h-40px"},{default:a(()=>[p(y(t.description),1)]),_:1})]),_:1},8,["title","isLoading","onClick"])}const Oe=S(Re,[["render",Be]]),De={components:{MiniStatsCard:b,BaseParagraph:C},data(){return{savedHours:0,countAutoIgnoredIssues:0,loaded:!1}},inject:["relatedTypeFilters"],async created(){E(this.handleGetStats),await this.handleGetStats(),this.loaded=!0},computed:{title(){return this.$t("X_AUTO_IGNORED",this.countAutoIgnoredIssues)},description(){return this.$t("SAVING_YOU_X_HOURS",this.savedHours)}},watch:{relatedTypeFilters:{handler(){this.handleGetStats()},deep:!0}},methods:{async handleGetStats(){const e={disable_toasts:!0},o=this.relatedTypeFilters.length>0?this.relatedTypeFilters.join(","):null;o&&(e.related_type_filters=o);const{total_in_hours:l,count_auto_ignored_issues:d}=await de(e);this.savedHours=l,this.countAutoIgnoredIssues=d},goToIgnoredIssues(){this.$router.push("/issues/ignored")}}};function Qe(e,o,l,d,n,t){const u=s("BaseParagraph"),h=s("MiniStatsCard");return c(),_(h,{title:t.title,description:t.description,icon:"icon-hidden",variation:"neutral",isLoading:!n.loaded,class:"cursor-pointer",onClick:t.goToIgnoredIssues},{default:a(()=>[r(u,{color:"subdued",class:"sidebar-open_hide-height max-h-40px"},{default:a(()=>[p(y(t.description),1)]),_:1})]),_:1},8,["title","description","isLoading","onClick"])}const Ue=S(De,[["render",Qe]]),Ve={components:{MiniStatsCard:b,PieChart:_e,BaseParagraph:C,BulletPoint:pe},data(){return{countBySeverity:{},loaded:!1}},inject:["relatedTypeFilters"],async created(){E(this.handleGetStats),await this.handleGetStats(),this.loaded=!0},computed:{totalCount(){return Object.values(this.countBySeverity).reduce((e,o)=>e+o,0)},criticalCount(){return this.countBySeverity.CRITICAL??0},highCount(){return this.countBySeverity.HIGH??0},mediumCount(){return this.countBySeverity.MEDIUM??0},lowCount(){return this.countBySeverity.LOW??0},chartValues(){return this.totalCount==0?[{value:1,key:"noCount",color:"#bfbfc8"}]:[{value:this.lowCount,key:"lowCount",color:"#00c07d"},{value:this.mediumCount,key:"mediumCount",color:"#0090ff"},{value:this.highCount,key:"highCount",color:"#ff9715"},{value:this.criticalCount,key:"criticalCount",color:"#ff4a3e"}]}},watch:{relatedTypeFilters:{handler(){this.handleGetStats()},deep:!0}},methods:{async handleGetStats(){this.countBySeverity=await j(this.relatedTypeFilters)}}},qe={class:"mini-stats__card__issues"},He={class:"flex flex-column flex-grow gap-4px"},Ye={class:"mini-stats__card__issue"},ze={class:"mini-stats__card__issue"},We={class:"flex flex-column flex-grow gap-4px"},Ze={class:"mini-stats__card__issue"},Xe={class:"mini-stats__card__issue"};function je(e,o,l,d,n,t){const u=s("PieChart"),h=s("BulletPoint"),m=s("BaseParagraph"),g=s("MiniStatsCard");return c(),_(g,{variation:"positive",isLoading:!n.loaded,class:"mini-stats__card--total-issues"},{icon:a(()=>[r(u,{data:t.chartValues,thickness:4,class:"w-54px"},null,8,["data"])]),default:a(()=>[i("div",qe,[i("div",He,[i("div",Ye,[r(h,{size:"small",color:"#ff4a3e"}),r(m,null,{default:a(()=>[p(y(e.$t("X_CRITICAL",this.criticalCount)),1)]),_:1})]),i("div",ze,[r(h,{size:"small",color:"#ff9715"}),r(m,null,{default:a(()=>[p(y(e.$t("X_HIGH",this.highCount)),1)]),_:1})])]),i("div",We,[i("div",Ze,[r(h,{size:"small",color:"#0090ff"}),r(m,null,{default:a(()=>[p(y(e.$t("X_MEDIUM",this.mediumCount)),1)]),_:1})]),i("div",Xe,[r(h,{size:"small",color:"#00c07d"}),r(m,null,{default:a(()=>[p(y(e.$t("X_LOW",this.lowCount)),1)]),_:1})])])])]),_:1},8,["isLoading"])}const Ke=S(Ve,[["render",je]]),Je={components:{TotalIssuesCard:Ke,SolvedIssuesCard:Oe,NewDetectionsCard:Ge,TotalIgnoredCard:Ue,MiniStatsSection:he}};function et(e,o,l,d,n,t){const u=s("TotalIssuesCard"),h=s("SolvedIssuesCard"),m=s("NewDetectionsCard"),g=s("TotalIgnoredCard"),I=s("MiniStatsSection",!0);return c(),_(I,{key:`MiniStatsSection_${e.$teamContext}`},{default:a(()=>[r(u),r(h),r(m),r(g)]),_:1})}const tt=S(Je,[["render",et]]),st={computed:{scmOrg(){return this.scmType==="github"?"GitHub organization":this.scmType==="gitlab"?"GitLab group":"Git setup"}},props:{scmType:String},components:{BaseParagraph:C,BaseHeading:K,GenericIllustration:B}},it={class:"empty-state-overview"},rt={class:"empty-state-overview__container"},nt={class:"empty-state-overview__illustration"},ot=i("div",{class:"my-12px"},[i("img",{src:ke,width:"30"})],-1);function at(e,o,l,d,n,t){const u=s("GenericIllustration"),h=s("BaseHeading"),m=s("BaseParagraph");return c(),T("div",it,[i("div",rt,[i("div",nt,[r(u)]),r(h,{as:"h5",class:"mb-12px"},{default:a(()=>[p("Protect your "+y(t.scmOrg),1)]),_:1}),r(m,{loose:!0},{default:a(()=>[p("Waiting for scan to finish...")]),_:1}),ot])])}const lt=S(st,[["render",at]]),ut={components:{OverviewEmptyState:Te,GenericIllustration:B,CloudsIllustration:Ce,ContainersIllustration:Ie,SnoozedIllustration:Le,DastIllustration:we,SolvedIllustration:ve,ScmSecurityScanPendingEmptyState:lt},props:{hasIssueHistory:Boolean,isLoading:Boolean,issueCount:Number,isFiltering:Boolean,relatedTypeFilter:Object,quickFilter:Object},setup(){const{isScanning:e}=J(w.data.groupId);return{isPerformingScmSecurityScan:e}},computed:{showPendingScmSecurityScannerEmptyState(){return this.relatedTypeFilter==="scm_security"&&this.isPerformingScmSecurityScan},isPayingCustomer(){const{group:e={}}=w.data;return e.status!=="trial"},isSelfScanAccount(){const{group:e={}}=w.data;return e.scm_type==="selfscan"},isFilteringSlaWithSlaSettingDisabled(){return Fe(this.quickFilter)},hasEmptySearchResults(){return!this.isLoading&&this.issueCount===0&&this.isFiltering},emptyStateVariation(){return this.isFiltering||!this.hasIssueHistory?"empty":"solved"},showEnableScmSecurityScannerEmptyState(){return this.relatedTypeFilter==="scm_security"&&be()&&!x.data.scmSecurityScanner},showRescanScmSecurityScannerEmptyState(){return this.relatedTypeFilter==="scm_security"&&x.data.scmSecurityScanner},emptyStateTitle(){return this.relatedTypeFilter==="surface_monitoring"?"No DAST issues that require attention":this.relatedTypeFilter==="eol"?"No Outdated Runtimes":this.relatedTypeFilter==="cloud"?"No cloud issues that require attention":this.relatedTypeFilter==="docker_container"?"No container issues that require attention":this.relatedTypeFilter==="open_source"?"No issues found":this.relatedTypeFilter==="leaked_secret"?"No secrets exposed":this.relatedTypeFilter==="sast"?"No SAST issues found":this.relatedTypeFilter==="iac"?"No IaC issues found":this.relatedTypeFilter==="malware"?"Malware Scan: All Clear":this.relatedTypeFilter==="mobile"?"No Mobile Issues":this.showEnableScmSecurityScannerEmptyState?"Grant Aikido extra permissions to analyze access controls":this.relatedTypeFilter==="scm_security"?"No Access Control Issues Detected":this.relatedTypeFilter==="license"?"No License Issues":this.isFilteringSlaWithSlaSettingDisabled?this.$t("SLA_SETTINGS.EMPTY_STATE.TITLE"):this.isFiltering?this.$t("QUEUE.EMPTY_STATE.NO_SEARCH_RESULTS.TITLE"):this.emptyStateVariation==="empty"?this.isSelfScanAccount?"Get Started with Local Scanning":"No issues yet":this.issueCount==0?this.isPayingCustomer?this.$t("QUEUE.EMPTY_STATE.PAYING_CUSTOMER.TITLE"):this.$t("QUEUE.EMPTY_STATE.TRIAL_CUSTOMER.TITLE"):"Getting there.."},emptyStateDescription(){return this.relatedTypeFilter==="surface_monitoring"?"Connect more domains for an even more comprehensive security overview.":this.relatedTypeFilter==="eol"?"No runtime issues detected. Your runtimes are up-to-date. It is important to have active container registry monitoring in order to show results.":this.relatedTypeFilter==="cloud"?"Peek at 'Ignored Issues' on the left if you think we've missed something or connect more clouds for an even more comprehensive security overview.":this.relatedTypeFilter==="docker_container"?"Peek at 'Ignored Issues' on the left if you think we've missed something or connect more containers for an even more comprehensive security overview.":this.relatedTypeFilter==="open_source"||this.relatedTypeFilter==="leaked_secret"||this.relatedTypeFilter==="sast"?"Connect more repositories to get more insights in the vulnerabilities in your codebase.":this.relatedTypeFilter==="iac"?"Aikido scans your terraform, cloudformation and other IaC files for security issues. Connect more repositories to get more insights in the vulnerabilities in your codebase.":this.relatedTypeFilter==="malware"?"Malware is rare but critical. We're on the lookout and will alert you the moment anything crops up.":this.relatedTypeFilter==="mobile"?"Aikido scans your mobile app for security issues.":this.showEnableScmSecurityScannerEmptyState?this.scmType==="github"?"Aikido needs more access to scan your GitHub settings, such as branch protection rules. Please proceed to GitHub to grant the necessary permissions.":"":this.relatedTypeFilter==="scm_security"?this.scmType==="github"?"All clear! No issues found in your GitHub configuration settings.":this.scmType==="gitlab"?"All clear! No issues found in your GitLab configuration settings.":"All clear! No issues found in your Git configuration settings":this.relatedTypeFilter==="license"?"No license issues found.":this.isFilteringSlaWithSlaSettingDisabled?this.$t("SLA_SETTINGS.EMPTY_STATE.DESC"):this.isFiltering?this.$t("QUEUE.EMPTY_STATE.NO_SEARCH_RESULTS.DESCRIPTION"):this.emptyStateVariation==="empty"?this.isSelfScanAccount?this.$t("QUEUE.EMPTY_STATE.SELFSCAN.NO_HISTORY.DESCRIPTION"):this.$t("QUEUE.EMPTY_STATE.NO_HISTORY.DESCRIPTION"):this.isPayingCustomer?this.$t("QUEUE.EMPTY_STATE.PAYING_CUSTOMER.DESCRIPTION"):this.$t("QUEUE.EMPTY_STATE.TRIAL_CUSTOMER.DESCRIPTION")},emptyStateActionLabel(){if(this.relatedTypeFilter==="surface_monitoring")return"Connect Domain";if(this.relatedTypeFilter==="eol")return"Show all Runtimes";if(this.relatedTypeFilter==="cloud")return"Connect Clouds";if(this.relatedTypeFilter==="docker_container")return"Connect Registry";if(this.relatedTypeFilter==="open_source"||this.relatedTypeFilter==="leaked_secret"||this.relatedTypeFilter==="sast")return"Connect More Repos";if(this.relatedTypeFilter==="iac")return"View IaC Checks";if(this.relatedTypeFilter==="malware")return"View Malware Monitor";if(this.relatedTypeFilter==="mobile")return"View Mobile Checks";if(this.showRescanScmSecurityScannerEmptyState)return"Scan now";if(this.showEnableScmSecurityScannerEmptyState)return this.scmType==="github"?"Authorize on GitHub":"Authorize";if(this.relatedTypeFilter==="scm_security")return null;if(this.relatedTypeFilter==="license")return"Start License Issue Scan";if(this.isFilteringSlaWithSlaSettingDisabled)return this.$t("SLA_SETTINGS.EMPTY_STATE.ACTION");if(!this.isFiltering)return this.emptyStateVariation==="empty"?this.isSelfScanAccount?this.$t("QUEUE.EMPTY_STATE.SELFSCAN.NO_HISTORY.ACTION_LABEL"):this.$t("QUEUE.EMPTY_STATE.NO_HISTORY.ACTION_LABEL"):this.isPayingCustomer?this.$t("QUEUE.EMPTY_STATE.PAYING_CUSTOMER.ACTION_LABEL"):this.$t("QUEUE.EMPTY_STATE.TRIAL_CUSTOMER.ACTION_LABEL")},scmType(){return w.data.group.scm_type}},methods:{handleEmptyStateAction(){if(this.relatedTypeFilter==="surface_monitoring")return this.$router.push("/settings/domains?add_domain=true");if(this.relatedTypeFilter==="eol")return this.$router.push("/containers/checks/runtimes");if(this.relatedTypeFilter==="cloud")return this.$router.push("/clouds?connect_cloud=true");if(this.relatedTypeFilter==="docker_container")return this.$router.push("/containers?connect_registry=true");if(this.relatedTypeFilter==="open_source")return this.$router.push("/settings/integrations/repositories");if(this.relatedTypeFilter==="leaked_secret")return this.$router.push("/settings/integrations/repositories");if(this.relatedTypeFilter==="sast")return this.$router.push("/settings/integrations/repositories");if(this.relatedTypeFilter==="iac")return this.$router.push("/repositories/iac");if(this.relatedTypeFilter==="malware")return this.$router.push("/reports/malware/software-supply-chain-attacks");if(this.relatedTypeFilter==="mobile")return this.$router.push("/repositories/mobile");if(this.relatedTypeFilter==="license"){Me().then(()=>{this.$toast.success({title:"License scan started",description:"We will notify you once the scan is complete"})});return}if(this.showEnableScmSecurityScannerEmptyState)return w.isPaying()?Ee():this.$modal.show("UpgradeAccountModal");if(this.showRescanScmSecurityScannerEmptyState){ee().then(()=>{this.$toast.success({title:this.$t("NOTIFICATIONS.SCAN_STARTED.TITLE"),description:"Scan started successfully, we'll report back soon."})});return}if(this.isFilteringSlaWithSlaSettingDisabled)return this.$router.push("/settings/sla");if(this.emptyStateVariation==="empty")return this.isSelfScanAccount?this.$router.push("/settings/integrations/localscan"):this.$router.push("/settings/integrations/repositories");if(!this.isPayingCustomer)return this.$router.push("/settings/integrations/repositories");this.$router.push("/repositories/checks")}}};function ct(e,o,l,d,n,t){const u=s("ScmSecurityScanPendingEmptyState"),h=s("CloudsIllustration"),m=s("ContainersIllustration"),g=s("SnoozedIllustration"),I=s("DastIllustration"),k=s("GenericIllustration"),M=s("SolvedIllustration"),L=s("OverviewEmptyState");return t.showPendingScmSecurityScannerEmptyState?(c(),_(u,{key:0,scmType:t.scmType},null,8,["scmType"])):(c(),_(L,{key:1,title:t.emptyStateTitle,description:t.emptyStateDescription,actionLabel:t.emptyStateActionLabel,onOnAction:t.handleEmptyStateAction},{default:a(()=>[l.relatedTypeFilter==="cloud"?(c(),_(h,{key:0})):l.relatedTypeFilter==="docker_container"?(c(),_(m,{key:1})):l.relatedTypeFilter==="eol"?(c(),_(g,{key:2})):l.relatedTypeFilter==="surface_monitoring"?(c(),_(I,{key:3})):t.emptyStateVariation==="empty"?(c(),_(k,{key:4})):(c(),_(M,{key:5}))]),_:1},8,["title","description","actionLabel","onOnAction"]))}const dt=S(ut,[["render",ct]]),ht={props:{height:{type:Number,default:110}}},pt=["height"],_t=i("line",{x1:"2",y1:"0",x2:"2",y2:"100",stroke:"#E5E5E9","stroke-width":"2px","stroke-dasharray":"2 2 5 5",class:"opacity-40"},null,-1),mt=[_t];function ft(e,o,l,d,n,t){return c(),T("svg",{id:"chart",viewBox:"0 0 2 100",height:l.height},mt,8,pt)}const yt=S(ht,[["render",ft]]),St={props:{percentage:{type:Number,required:!0}}},gt={key:0,width:"243",height:"41",viewBox:"0 0 243 41",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ft=i("path",{opacity:"0.2",d:"M0 37.5146V3C0 1.34315 1.34314 0 3 0L78.1652 0C78.4219 0 78.678 0.0247179 78.93 0.0738114L154.368 14.7703C154.683 14.8317 155.003 14.8626 155.324 14.8626L242 14.8626C242.552 14.8626 243 15.3103 243 15.8626V25.6521C243 26.2044 242.552 26.6521 242 26.6521L155.292 26.6521C154.993 26.6521 154.693 26.679 154.399 26.7326L78.8172 40.4663C78.6402 40.4985 78.4607 40.5146 78.2808 40.5146L3 40.5146C1.34314 40.5146 0 39.1715 0 37.5146Z",fill:"#A397F8"},null,-1),Tt=i("path",{opacity:"0.5",d:"M0 33.67V7C0 5.34315 1.34314 4 3 4L78.209 4C78.4367 4 78.664 4.01944 78.8883 4.0581L154.42 17.0739C154.701 17.1223 154.985 17.1466 155.27 17.1466L242 17.1466C242.552 17.1466 243 17.5943 243 18.1466V23.5234C243 24.0757 242.552 24.5234 242 24.5234L155.237 24.5234C154.974 24.5234 154.711 24.5442 154.451 24.5856L78.7855 36.6326C78.6295 36.6575 78.4718 36.67 78.3138 36.67L3 36.67C1.34314 36.67 0 35.3268 0 33.67Z",fill:"#A397F8"},null,-1),Ct=i("path",{opacity:"0.7",d:"M0 29.8835V12C0 10.3431 1.34314 9 3 9L78.5512 9L154.842 18.5901L242 18.5901C242.552 18.5901 243 19.0378 243 19.5901V22.2934C243 22.8457 242.543 23.2934 241.991 23.2934L154.842 23.2934L78.5512 32.8835H3C1.34314 32.8835 0 31.5404 0 29.8835Z",fill:"#A397F8"},null,-1),It=i("path",{d:"M0 26V16C0 14.3431 1.34314 13 3 13L78.5512 13L154.842 20.5L242.4 20.5C242.731 20.5 243 20.7686 243 21.1C243 21.3209 242.821 21.5 242.6 21.5L154.842 21.5L78.5512 29L3 29C1.34314 29 0 27.6569 0 26Z",fill:"#A397F8"},null,-1),Lt=[Ft,Tt,Ct,It],wt={key:1,width:"243",height:"41",viewBox:"0 0 243 41",fill:"none",xmlns:"http://www.w3.org/2000/svg"},vt=i("path",{opacity:"0.2",d:"M0 37.5146V3C0 1.34315 1.34314 0 3 0L78.5512 0L154.842 10.8626L242 10.8626C242.552 10.8626 243 11.3103 243 11.8626V29.6521C243 30.2044 242.552 30.6521 242 30.6521L154.842 30.6521L78.5512 40.5146L3 40.5146C1.34314 40.5146 0 39.1715 0 37.5146Z",fill:"#A397F8"},null,-1),bt=i("path",{opacity:"0.5",d:"M0 33.67V7C0 5.34315 1.34314 4 3 4L78.5512 4L154.842 14.1466L242 14.1466C242.552 14.1466 243 14.5943 243 15.1466V26.5234C243 27.0757 242.552 27.5234 242 27.5234L154.842 27.5234L78.5512 36.67L3 36.67C1.34314 36.67 0 35.3268 0 33.67Z",fill:"#A397F8"},null,-1),Et=i("path",{opacity:"0.7",d:"M0 28.8835V13C0 11.3431 1.34314 10 3 10L78.5512 10L154.842 16.787L242 16.787C242.552 16.787 243 17.2347 243 17.787V24.0965C243 24.6488 242.552 25.0965 242 25.0965L154.842 25.0965L78.5512 31.8835L3 31.8835C1.34314 31.8835 0 30.5404 0 28.8835Z",fill:"#A397F8"},null,-1),kt=i("path",{d:"M0 26.0443V16C0 14.3431 1.34314 13 3 13L78.5512 13L154.842 18.5L242 18.5C242.552 18.5 243 18.9477 243 19.5V22.5C243 23.0523 242.552 23.5 242 23.5L155.1 23.5C154.928 23.5 154.784 23.5061 154.613 23.5236C151.066 23.8866 107.154 28.3352 78.5512 29C52.4223 29.6073 13.7916 29.1797 2.93335 29.0399C1.29404 29.0188 0 27.6838 0 26.0443Z",fill:"#A397F8"},null,-1),Mt=[vt,bt,Et,kt],At=i("path",{opacity:"0.2",d:"M0 37.5146V3C0 1.34315 1.34314 0 3 0L78.5512 0L154.842 8.86258L241 8.86258C242.105 8.86258 243 9.75801 243 10.8626V30.6521C243 31.7566 242.105 32.6521 241 32.6521L154.842 32.6521L78.5512 40.5146L3 40.5146C1.34314 40.5146 0 39.1715 0 37.5146Z",fill:"#A397F8"},null,-1),$t=i("path",{opacity:"0.5",d:"M0 33.67V7C0 5.34315 1.34314 4 3 4L78.5512 4L154.842 12.1466L241 12.1466C242.105 12.1466 243 13.042 243 14.1466V27.5234C243 28.628 242.105 29.5234 241 29.5234L154.842 29.5234L78.5512 36.67L3 36.67C1.34314 36.67 0 35.3268 0 33.67Z",fill:"#A397F8"},null,-1),Pt=i("path",{opacity:"0.7",d:"M0 28.8835V13C0 11.3431 1.34314 10 3 10L78.5512 10L154.842 14.787L241 14.787C242.105 14.787 243 15.6824 243 16.787V25.0965C243 26.2011 242.105 27.0965 241 27.0965L154.842 27.0965L78.5512 31.8835L3 31.8835C1.34314 31.8835 0 30.5404 0 28.8835Z",fill:"#A397F8"},null,-1),xt=i("path",{d:"M0 28V14C0 13.4477 0.447708 13 1 13L78.5512 13L154.842 16.5L242 16.5C242.552 16.5 243 16.9477 243 17.5V24.5C243 25.0523 242.552 25.5 242 25.5L154.842 25.5L78.5512 29L1 29C0.447708 29 0 28.5523 0 28Z",fill:"#A397F8"},null,-1),Nt=[At,$t,Pt,xt];function Gt(e,o,l,d,n,t){return l.percentage>=66?(c(),T("svg",gt,Lt)):66>l.percentage&&l.percentage>=33?(c(),T("svg",wt,Mt)):(c(),T("svg",{key:2,width:"243",height:"41",viewBox:"0 0 243 41",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:R({"opacity-40":l.percentage==0})},Nt,2))}const Rt=S(St,[["render",Gt]]),Bt={components:{XTooltip:te,VerticalDivider:yt,LineAreaImageBasedGraph:Rt},props:{allIssuesCount:{type:Number,default:0},focusModeCount:{type:Number,default:0}},computed:{reductionPercentage(){return this.allIssuesCount==0?0:100-Math.round(this.focusModeCount/this.allIssuesCount*100)},reductionInPercentText(){return this.reductionPercentage==0?"-0%":this.reductionPercentage<0?`+${Math.abs(this.reductionPercentage)}%`:`-${this.reductionPercentage}%`}}},Ot={class:"pt-14px pb-6px px-9px min-w-264px"},Dt={class:"relative"},Qt={class:"flex justify-between"},Ut={class:"w-calc-50p-24px"},Vt={class:"flex mt-5px"},qt={class:"w-calc-50p-24px"},Ht={class:"flex mt-5px"},Yt={class:"text-primary-aik-80"},zt={class:"absolute pin-b-8px"},Wt={class:"mt-4px"};function Zt(e,o,l,d,n,t){const u=s("BaseParagraph"),h=s("VerticalDivider"),m=s("LineAreaImageBasedGraph"),g=s("XTooltip");return c(),_(g,{noOpacity:!0,color:"#141031",class:"rounded-8px md-tooltip--no-p-margin"},{default:a(()=>[i("div",Ot,[i("div",Dt,[i("div",Qt,[i("div",Ut,[r(u,{size:"tiny",color:"light-gray"},{default:a(()=>[p("All findings")]),_:1}),i("div",Vt,[r(u,{class:"mr-3px",color:"white",size:"large",bold:""},{default:a(()=>[p(y(l.allIssuesCount),1)]),_:1}),r(u,{size:"tiny",color:"subdued"},{default:a(()=>[p("100%")]),_:1})])]),r(h,{height:"110"}),i("div",qt,[r(u,{size:"tiny",color:"light-gray"},{default:a(()=>[p("Aikido refined")]),_:1}),i("div",Ht,[r(u,{class:"mr-3px",color:"white",size:"large",bold:""},{default:a(()=>[p(y(l.focusModeCount),1)]),_:1}),r(u,{bold:"",size:"tiny"},{default:a(()=>[i("span",Yt,y(t.reductionInPercentText),1)]),_:1})])])]),i("div",zt,[r(m,{percentage:t.reductionPercentage},null,8,["percentage"])])]),i("div",Wt,[r(u,{size:"tiny",color:"subdued"},{default:a(()=>[p("Aikido reduced false positives by "+y(t.reductionPercentage)+"%.",1)]),_:1})])])]),_:1})}const Xt=S(Bt,[["render",Zt]]),jt=()=>{const{pendingScanTypes:e}=se();return{isScanning:e.value.length>0}},Kt={props:{getContainerRef:{type:Function,default:()=>({})}},data(){return{containerRef:null,observer:null,showButton:!1}},async mounted(){this.containerRef=this.getContainerRef(),this.observer=new IntersectionObserver(e=>{e.forEach(o=>{o.isIntersecting&&(this.showButton=!1),o.isIntersecting||(this.showButton=!0)})},{root:null,rootMargin:"300px",threshold:1}),this.observer.observe(this.containerRef)},components:{FilterButton:Pe}};function Jt(e,o,l,d,n,t){const u=s("FilterButton");return c(),_(u,{class:R(["center_page-content scroll-up-button",{"scroll-up-button--visible":n.showButton}])},{default:a(()=>[p(" Scroll to top ")]),_:1},8,["class"])}const es=S(Kt,[["render",Jt]]),ts={mixins:[H],components:{QueueTable:me,QueueSidebar:fe,MiniStatsSection:tt,InputSearch:ie,QueueMultiSelectTypeFilter:ye,QueueQuickFilter:Se,FeedActionsMenu:ge,FeedEmptyState:dt,DataTableRow:Ae,SlidingButtonGroup:$e,FloatingScrollButton:es,LoadingSpinner:re,BaseParagraph:C,FeedFocusModeTooltip:Xt},data(){return{isRepositoriesLoading:!0,activeRepositories:[],quickFilter:F("filter",void 0),attackSurfaceFilter:F("attack_surface_filter",void 0),relatedTypeFilters:F("issue_type_filter",[]),issueIdFilter:this.$route.query.issue_id_filter?this.$route.query.issue_id_filter.split(","):"",searchTerm:F("search",""),queueMetadata:{},languageFilter:F("language_filter",void 0),focusModeLoaded:!1,isLoading:!0,pageActions:[{},{}],severityFilter:F("severity_filter",void 0),enhancedStatusFilter:F("status_filter",void 0)}},provide(){return{relatedTypeFilters:ne(()=>this.relatedTypeFilters)}},setup(){const{records:e,isLoading:o,fetch:l,reset:d,refresh:n,watchElement:t,isFuzzySearch:u,isLoadingWithDebouncedFinish:h}=Y(ce,20,g=>g.grouped_issues),{isScanning:m}=jt();return{isScanning:m,records:e,isFetchingRecords:o,fetchGroupedIssues:l,resetGroupedIssues:d,refreshGroupedIssues:n,watchElement:t,isFuzzySearch:u,isLoadingWithDebouncedFinish:h}},async mounted(){if(this.$user.accepted_tos_at<=0){go("/onboarding/terms-of-service");return}this.$route.query.filter=="new"&&this.setPreferredFocusMode("all_issues_mode"),this.$route.query.filter=="critical"&&(this.severityFilter="critical",this.quickFilter=void 0),this.$route.query.q&&(this.searchTerm=this.$route.query.q),this.$route.query.issue_type_filter&&(this.relatedTypeFilters=[this.$route.query.issue_type_filter.replace("exposed_secret","leaked_secret")]);const e=F("focus_mode",null);e&&this.setPreferredFocusMode(e),this.focusModeLoaded=!0,Breadcrumbs.show({message:this.$user.full_name.split(" ")[0]}),this.loadQueueMetadata(),await Promise.all([this.fetchGroupedIssues(this.filters),this.loadRepositories()]),this.isLoading=!1,await this.$nextTick(),this.watchElement(this.$refs.tableBottom,{threshold:0,rootMargin:"400px"})},unmounted(){Breadcrumbs.hide()},created(){this.debouncedRefresh=P(this.handleRefresh,750,!1),f.on("dependencyScanFinished",this.handleDependencyScanFinished),f.on("issueUpdated",this.handleIssueUpdated),f.on("refreshQueue",this.debouncedRefresh)},beforeUnmount(){f.off("dependencyScanFinished",this.handleDependencyScanFinished),f.off("issueUpdated",this.handleIssueUpdated),f.off("refreshQueue",this.debouncedRefresh),this.setPreferredFocusMode("aikido_mode")},watch:{focusMode(){this.resetGroupedIssues(this.filters)},async $teamContext(){this.isLoading=!0,this.loadQueueMetadata(),await Promise.all([this.resetGroupedIssues(this.filters),this.loadRepositories()]),this.isLoading=!1}},computed:{groupedIssues(){return this.quickFilter=="ignored"?this.records.map(e=>({...e,enhanced_status:"ignored"})):this.records},showFeedEmptyState(){return this.showLoadingState||this.isLoadingWithDebouncedFinish?!1:this.groupedIssues.length===0?!0:!(this.isFiltering||this.$teamContext!=null||this.activeRepositories.length>=3||this.groupedIssues.length>0)},showLoadingState(){return this.isScanning&&!this.groupedIssues.length&&!this.isFiltering?!0:this.isScanning&&this.groupedIssues.length?!1:this.isLoading||this.isRepositoriesLoading},accountHasIssueHistory(){var e;return((e=this.queueMetadata)==null?void 0:e.account_has_issues)===!0},isFiltering(){const o=[this.quickFilter,this.attackSurfaceFilter,this.languageFilter,this.severityFilter,this.enhancedStatusFilter].some(n=>!!n),l=!!this.searchTerm,d=this.relatedTypeFilters.length>0;return o||l||d},focusModeActions(){return[{key:"all_issues_mode",label:"All findings",onAction:()=>{this.setPreferredFocusMode("all_issues_mode"),A({focusMode:"all_issues_mode"})}},{key:"aikido_mode",label:"Aikido refined",onAction:()=>{this.setPreferredFocusMode("aikido_mode"),A({focusMode:"aikido_mode"})}}]},filters(){return{search_term:this.searchTerm,quick_filter:this.quickFilter,issue_type_filters:this.relatedTypeFilters,filter_attack_surface:this.attackSurfaceFilter,filter_language:this.languageFilter,focus_mode:this.focusMode,filter_issue_ids:this.issueIdFilter,return_fuzzy_used:!0,filter_severity:this.severityFilter,filter_enhanced_status:this.enhancedStatusFilter}},hasIssueTrackerIntegrationEnabled(){return!!x.data.issueTracker},relatedTypeFilter(){return this.relatedTypeFilters.length==1?this.relatedTypeFilters[0]:""}},methods:{async onItemSelected(e){oe.replace({path:this.$route.path,query:{...this.$route.query,sidebarIssue:e.id}})},onSearchTermChanged(){this.resetGroupedIssues(this.filters),A({search:this.searchTerm})},onQueueTypeFilterSelected(e){if(this.relatedTypeFilters=e.relatedTypeFilters||[],this.relatedTypeFilters.length>0){this.resetGroupedIssuesDebounched(this.filters);return}this.resetGroupedIssues(this.filters)},onQueueQuickFilterSelected(e){this.quickFilter=e.quickFilter||void 0,this.attackSurfaceFilter=e.attackSurfaceFilter||void 0,this.languageFilter=e.languageFilter||void 0,this.issueIdFilter=e.issueIdFilter||void 0,this.severityFilter=e.severityFilter||void 0,this.enhancedStatusFilter=e.enhancedStatusFilter||void 0,this.resetGroupedIssues(this.filters)},async handleIssueUpdated(){await this.refreshGroupedIssues(this.filters)},async loadQueueMetadata(){this.queueMetadata=await ae()},async loadRepositories(){this.isRepositoriesLoading=!0,this.activeRepositories=await le(void 0,!1,!0,{limit:3},void 0,void 0,void 0,void 0,void 0,0),this.isRepositoriesLoading=!1},async handleDependencyScanFinished(){const e=new Date;this.queueMetadata.last_scanned_at=e.getTime()/1e3},async handleRefresh(){f.emit("refreshMiniStats"),this.$globalLoadingIndicator.show();try{this.loadQueueMetadata(),await Promise.allSettled([this.refreshGroupedIssues(this.filters)])}finally{this.$globalLoadingIndicator.hide()}},handleScrollToTop(){scrollTo({behavior:"smooth",top:0})},resetGroupedIssuesDebounched:P(async function(){await this.resetGroupedIssues(this.filters)},25)}},ss={class:"bg-white px-40px pt-8px"},is={class:"page-content bg-white"},rs={ref:"filters",class:"flex align-center mb-16px wide-tablet_align-start wide-tablet_flex-column gap-8px flex-wrap"},ns={class:"flex gap-8px align-center flex-1 flex-wrap"},os={class:"relative"},as=["colspan"],ls={ref:"tableBottom"},us={key:0,class:"data-table__bottom"},cs=i("hr",null,null,-1),ds={key:0,class:"flex align-center gap-8px"},hs=i("hr",null,null,-1);function ps(e,o,l,d,n,t){var N,G;const u=s("MiniStatsSection"),h=s("InputSearch"),m=s("SlidingButtonGroup"),g=s("FeedFocusModeTooltip"),I=s("QueueMultiSelectTypeFilter"),k=s("QueueQuickFilter"),M=s("FeedActionsMenu"),L=s("BaseParagraph"),O=s("DataTableRow"),D=s("FeedEmptyState"),Q=s("LoadingSpinner"),U=s("QueueTable"),V=s("FloatingScrollButton"),q=s("QueueSidebar");return c(),T(ue,null,[i("div",ss,[r(u)]),i("div",is,[i("div",rs,[r(h,{modelValue:n.searchTerm,"onUpdate:modelValue":[o[0]||(o[0]=v=>n.searchTerm=v),t.onSearchTermChanged],spacing:"compact"},null,8,["modelValue","onUpdate:modelValue"]),i("div",ns,[i("div",null,[n.focusModeLoaded?(c(),_(m,{key:0,actions:t.focusModeActions,"initial-selected-button":e.focusMode},null,8,["actions","initial-selected-button"])):$("",!0),r(g,{allIssuesCount:((N=n.queueMetadata.issue_count_by_focus_mode)==null?void 0:N.all_issues_mode)??0,focusModeCount:((G=n.queueMetadata.issue_count_by_focus_mode)==null?void 0:G.aikido_mode)??0},null,8,["allIssuesCount","focusModeCount"])]),r(I,{onFilterSelected:t.onQueueTypeFilterSelected,"initial-related-type-filter":n.relatedTypeFilters,persistFilterToQueryParams:!0},null,8,["onFilterSelected","initial-related-type-filter"]),r(k,{onFilterSelected:t.onQueueQuickFilterSelected,includeQuickFixFilter:"",showStatusFilter:"",initialFilter:n.quickFilter,"initial-issue-id-filter":n.issueIdFilter,includeAutoignoreInStatusFilter:e.focusMode=="all_issues_mode",initialAttackSurfaceFilter:n.attackSurfaceFilter,initialLanguageFilter:n.languageFilter,initialSeverityFilter:n.severityFilter,initialStatusFilter:n.enhancedStatusFilter,persistFilterToQueryParams:!0},null,8,["onFilterSelected","initialFilter","initial-issue-id-filter","includeAutoignoreInStatusFilter","initialAttackSurfaceFilter","initialLanguageFilter","initialSeverityFilter","initialStatusFilter"]),r(M,{class:"ml-auto tablet_ml-0",initialSeverityFilter:n.severityFilter,onRefresh:t.handleRefresh},null,8,["initialSeverityFilter","onRefresh"])])],512),i("div",os,[r(U,{onItemClicked:t.onItemSelected,groupedIssues:t.groupedIssues,isLoading:t.showLoadingState,showEmptyState:t.showFeedEmptyState,onReachContentEnd:o[1]||(o[1]=()=>d.fetchGroupedIssues(t.filters)),"is-fetching-records":d.isLoadingWithDebouncedFinish,quickFilter:n.quickFilter},{fixedRow:a(()=>[d.isFuzzySearch&&d.records.length>0?(c(),_(O,{key:0,class:"data-table__row--section-subheader"},{default:a(()=>[i("td",{colspan:t.hasIssueTrackerIntegrationEnabled?8:7},[r(L,{color:"primary"},{default:a(()=>[p("No exact matches, showing results that are close matches.")]),_:1})],8,as)]),_:1})):$("",!0)]),emptyState:a(()=>[r(D,{issueCount:t.groupedIssues.length,isLoading:t.showLoadingState,isFiltering:t.isFiltering,hasIssueHistory:t.accountHasIssueHistory,relatedTypeFilter:t.relatedTypeFilter,quickFilter:n.quickFilter},null,8,["issueCount","isLoading","isFiltering","hasIssueHistory","relatedTypeFilter","quickFilter"])]),bottomContent:a(v=>[i("div",ls,[!v.isLoading&&!v.showEmptyState?(c(),T("div",us,[cs,d.isLoadingWithDebouncedFinish?(c(),T("div",ds,[r(Q,{color:"#6551F3",backgroundColor:"#E0DCFD"}),r(L,{color:"gray"},{default:a(()=>[p("Hang on, we're fetching more issues for you")]),_:1})])):(c(),_(L,{key:1,color:"gray"},{default:a(()=>[p("We have no more issues to show")]),_:1})),hs])):$("",!0)],512)]),_:1},8,["onItemClicked","groupedIssues","isLoading","showEmptyState","is-fetching-records","quickFilter"]),r(V,{onClick:t.handleScrollToTop,"get-container-ref":()=>e.$refs.filters},null,8,["onClick","get-container-ref"])]),r(q,{groupedIssues:t.groupedIssues,showIgnoredOnly:n.quickFilter==="ignored","filter-my-teams":n.quickFilter==="my_team",filterOutOfSla:n.quickFilter==="out_of_sla",filterDueSoon:n.quickFilter==="due_soon",severityFilter:n.severityFilter},null,8,["groupedIssues","showIgnoredOnly","filter-my-teams","filterOutOfSla","filterDueSoon","severityFilter"])])],64)}const $i=S(ts,[["render",ps]]);export{$i as default};
