import{_ as S,B as x,J as X,e as $,d as P,r as i,q as r,k as d,w as a,o as e,n as c,s as T,u as b,p as g,m as R,t as v,F as w,a_ as j,aa as M,S as H,a2 as O,ai as L,a1 as Y,K as J,aR as K,a$ as Q,b0 as Z,b1 as ee,b2 as te,Q as ae,b3 as se,X as ie,H as ne,I as le,b4 as oe,L as re,b5 as de,b6 as ce}from"./index-13ff96f4.js";import{P as ue}from"./PageHeader-46c38a32.js";import{D as V,a as N}from"./DataTable-e31a825a.js";import{a as D,D as C}from"./DataTableCell-51c0104f.js";import{I as F}from"./InputCheckbox-81cb3ca6.js";import{X as me}from"./XTabs-d492da26.js";import{D as E}from"./DataTableSeverityIndicator-48ffb8dc.js";import{D as A}from"./DataTableCellSelectable-71ffdbc4.js";import{T as _e}from"./TableListActionMenu-8ca3c15b.js";import{g as he}from"./repoName-872812ed.js";import{O as pe}from"./OverviewEmptyState-c8440b9c.js";import{G as fe}from"./GenericIllustration-4aca88e5.js";import"./ActionMenu-3e4470bf.js";const be={props:{user:Object},emits:["addUser"],components:{DataTableRow:D,DataTableCell:C,BaseParagraph:x,AvatarImage:X,BaseIconButton:$,BasePill:P}},Te={class:"flex flex-1 justify-between gap-8px"},ge={class:"flex flex-column gap-2px"};function Ie(s,o,t,f,u,n){const p=i("AvatarImage"),l=i("DataTableCell"),m=i("BaseParagraph"),_=i("BasePill"),h=i("DataTableRow");return r(),d(h,{class:"hover-trigger",clickable:"",onClick:o[0]||(o[0]=y=>s.$emit("addUser",t.user.id))},{default:a(()=>[e(l,{spacing:"compact",class:"mobile_min-h-50px"},{default:a(()=>[e(p,{class:"size-32 inline-block rounded-full absolute-centered",name:t.user.full_name,src:t.user.avatar},null,8,["name","src"])]),_:1}),e(l,null,{default:a(()=>[c("div",Te,[c("div",ge,[e(m,null,{default:a(()=>[T(b(t.user.full_name),1)]),_:1}),t.user.email?(r(),d(m,{key:0,color:"gray"},{default:a(()=>[T(b(t.user.email),1)]),_:1})):g("",!0)]),e(_,{iconSuffix:"icon-caret_left",title:"Add to team",class:"show-on-hover align-self-center"})])]),_:1})]),_:1})}const ye=S(be,[["render",Ie]]),Re={props:{users:Array,animate:Boolean},emits:["addUserToTeam"],components:{DataTable:V,DataTableHeader:N,TeamDetailAllUsersTableRow:ye},computed:{animation(){return this.animate?"row-slide-right-":""}}};function Se(s,o,t,f,u,n){const p=i("DataTableHeader"),l=i("TeamDetailAllUsersTableRow"),m=i("DataTable");return r(),d(m,{class:"overflow-hidden"},{header:a(()=>[e(p,{width:"48px",alignment:"center",spacing:"compact"}),e(p,{width:"auto"},{default:a(()=>[T("User")]),_:1})]),body:a(()=>[e(j,{name:n.animation},{default:a(()=>[(r(!0),R(w,null,v(t.users,_=>(r(),d(l,{key:_.id,user:_,onAddUser:o[0]||(o[0]=h=>s.$emit("addUserToTeam",h))},null,8,["user"]))),128))]),_:1},8,["name"])]),_:1})}const ke=S(Re,[["render",Se]]),we={props:{mode:{type:String,default:"display",validator:s=>["display","edit"].includes(s)}},emits:["select"],components:{DataTableCell:C,InputCheckbox:F},computed:{modeClass(){return this.mode==="display"?"data-table__cell__action--mode-display":"data-table__cell__action--mode-edit"}}},De={class:"data-table__cell__action__display"},Ce={class:"data-table__cell__action__action"};function ve(s,o,t,f,u,n){const p=i("DataTableCell");return r(),d(p,{spacing:"compact",alignment:"center",class:H(["mobile_min-h-50px data-table__cell__action cursor-pointer",[n.modeClass]])},{default:a(()=>[c("div",De,[M(s.$slots,"display")]),c("div",Ce,[M(s.$slots,"action")])]),_:3},8,["class"])}const xe=S(we,[["render",ve]]),Le={props:{user:Object,readOnly:String},emits:["removeUser"],components:{DataTableRow:D,DataTableCell:C,BaseParagraph:x,AvatarImage:X,DataTableCellActionable:xe,BaseIconButton:$,BasePill:P},computed:{enableActions(){return!this.readOnly}},methods:{handleAction(){this.readOnly||this.$emit("removeUser",this.user.id)}}},Pe={class:"flex flex-1 justify-between gap-8px"},Be={class:"flex flex-column gap-2px"};function Ue(s,o,t,f,u,n){const p=i("AvatarImage"),l=i("DataTableCell"),m=i("BaseParagraph"),_=i("BasePill"),h=i("DataTableRow");return r(),d(h,{class:"hover-trigger",clickable:n.enableActions,onClick:n.handleAction},{default:a(()=>[e(l,{spacing:"compact",class:"mobile_min-h-50px"},{default:a(()=>[e(p,{class:"size-32 inline-block rounded-full absolute-centered",name:t.user.full_name,src:t.user.avatar},null,8,["name","src"])]),_:1}),e(l,null,{default:a(()=>[c("div",Pe,[c("div",Be,[e(m,null,{default:a(()=>[T(b(t.user.full_name),1)]),_:1}),t.user.email?(r(),d(m,{key:0,color:"gray"},{default:a(()=>[T(b(t.user.email),1)]),_:1})):g("",!0)]),n.enableActions?(r(),d(_,{key:0,iconSuffix:"icon-close",title:"Remove from team",class:"show-on-hover align-self-center"})):g("",!0)])]),_:1})]),_:1},8,["clickable","onClick"])}const Ee=S(Le,[["render",Ue]]),Ae={props:{users:Array,animate:Boolean,readOnly:Boolean},emits:["removeUserFromTeam"],components:{DataTable:V,DataTableHeader:N,TeamDetailTeamUsersTableRow:Ee},computed:{animation(){return this.animate?"row-slide-left-":""}}};function Oe(s,o,t,f,u,n){const p=i("DataTableHeader"),l=i("TeamDetailTeamUsersTableRow"),m=i("DataTable");return r(),d(m,{class:"overflow-hidden"},{header:a(()=>[e(p,{width:"48px",alignment:"center",spacing:"compact"}),e(p,{width:"auto"},{default:a(()=>[T("User")]),_:1})]),body:a(()=>[e(j,{name:n.animation},{default:a(()=>[(r(!0),R(w,null,v(t.users,_=>(r(),d(l,{key:_.id,user:_,"read-only":t.readOnly,onRemoveUser:o[0]||(o[0]=h=>s.$emit("removeUserFromTeam",h))},null,8,["user","read-only"]))),128))]),_:1},8,["name"])]),_:1})}const Ge=S(Ae,[["render",Oe]]),Ve={props:{repository:Object,isSelected:{type:Boolean,default:!1},team:Object},components:{BaseParagraph:x,DataTableCell:C,DataTableSeverityIndicator:E,DataTableRow:D,DataTableCellSelectable:A,TableListActionMenu:_e,XTooltip:O},inject:["disabled"],data:function(){return{showLockfilesModal:!1,showFaultyLockfileModal:!1}},computed:{priority(){return this.repository.max_issue_severity},repositoryPath(){if(!this.repository.repo_path)return"";let s=this.repository.repo_path.split("/");return s.shift(),s.join(" / ")+" / "},actions(){const s=[];return this.team.source_kind!="backstage_io"&&s.push({label:"Limit Access By Path",onClick:this.showTeamPathModal,icon:"icon-gh_branch"}),s.length==0?null:[{title:"Actions",items:s}]},teamPathsXmore(){let s=this.repository.team_paths[0];return this.repository.team_paths.length>1&&(s+=` + ${this.repository.team_paths.length-1} more`),s}},methods:{getRepoName:he,selectRepo(){this.$emit("toggleSelectRepo",this.repository.id)},async showTeamPathModal(){(await this.$modal.show("TeamResponsibilitiesLimitedByPathModal",{teamId:this.team.id,teamName:this.team.name,repoId:this.repository.id,repoName:this.getRepoName(this.repository),teamPaths:this.repository.team_paths,teamPathsIsExcluded:this.repository.team_paths_is_excluded})).type=="saved"&&this.$emit("teamPathsChanged")}}},Ne={class:"flex justify-between align-center w-full"},Me={class:"text-carbon-60"},Xe={class:"ws-pre"},$e={class:"hidden sm:block"},je={class:"block sm:hidden"};function He(s,o,t,f,u,n){const p=i("DataTableCellSelectable"),l=i("BaseParagraph"),m=i("XTooltip"),_=i("BasePill"),h=i("DataTableCell"),y=i("DataTableSeverityIndicator"),k=i("TableListActionMenu"),B=i("DataTableRow");return r(),d(B,{href:`/repositories/${t.repository.id}`,clickable:"",class:"group"},{default:a(()=>[e(p,{mode:t.isSelected?"edit":"display",selected:t.isSelected,onSelect:n.selectRepo,onClick:o[0]||(o[0]=L(()=>{},["prevent"]))},null,8,["mode","selected","onSelect"]),e(h,null,{default:a(()=>[c("div",Ne,[e(l,{class:"truncate"},{default:a(()=>[c("span",Me,b(n.repositoryPath),1),T(b(n.getRepoName(t.repository)),1)]),_:1}),t.repository.team_paths.length>0?(r(),d(_,{key:0,title:n.teamPathsXmore,variation:"gray-fill",onClick:L(n.showTeamPathModal,["prevent"])},{default:a(()=>[e(m,null,{default:a(()=>[c("span",Xe,b(t.repository.team_paths.join(`
`)),1)]),_:1})]),_:1},8,["title","onClick"])):g("",!0)])]),_:1}),e(y,{priority:n.priority},null,8,["priority"]),e(h,null,{default:a(()=>[e(l,{class:"truncate"},{default:a(()=>[c("span",$e,b(t.repository.open_issues),1),c("span",je,b(s.$t("REPO_OVERVIEW.NUM_OPEN_ISSUES",{n:t.repository.open_issues})),1)]),_:1})]),_:1}),e(h,null,{default:a(()=>[n.actions?(r(),d(k,{key:0,iconButtonClass:"opacity-0 group_hover_opacity-100",sections:n.actions,onClick:o[1]||(o[1]=L(()=>{},["prevent","stop"]))},null,8,["sections"])):g("",!0)]),_:1})]),_:1},8,["href"])}const Fe=S(Ve,[["render",He]]),ze={props:{cloud:Object,isSelected:{type:Boolean,default:!1}},components:{BaseParagraph:x,DataTableCell:C,DataTableSeverityIndicator:E,DataTableRow:D,DataTableCellSelectable:A},computed:{actions(){return[{title:"Actions",items:[{label:"remove responsibility",destructive:!0,onClick:()=>this.$emit("removeCloud",this.cloud.id)}]}]}},methods:{selectCloud(){this.$emit("toggleSelectCloud",this.cloud.id)}}},We={class:"hidden sm:block"},qe={class:"block sm:hidden"};function Ye(s,o,t,f,u,n){const p=i("DataTableCellSelectable"),l=i("BaseParagraph"),m=i("DataTableCell"),_=i("DataTableSeverityIndicator"),h=i("DataTableRow");return r(),d(h,{href:`/clouds/${t.cloud.id}`,clickable:""},{default:a(()=>[e(p,{mode:t.isSelected?"edit":"display",selected:t.isSelected,onSelect:n.selectCloud,onClick:o[0]||(o[0]=L(()=>{},["prevent"]))},null,8,["mode","selected","onSelect"]),e(m,null,{default:a(()=>[e(l,{class:"truncate"},{default:a(()=>[T(b(t.cloud.name),1)]),_:1})]),_:1}),e(_,{priority:t.cloud.max_issue_severity},null,8,["priority"]),e(m,null,{default:a(()=>[e(l,{class:"truncate"},{default:a(()=>[c("span",We,b(t.cloud.open_issue_count),1),c("span",qe,b(s.$t("REPO_OVERVIEW.NUM_OPEN_ISSUES",{n:t.cloud.open_issue_count})),1)]),_:1})]),_:1}),e(m)]),_:1},8,["href"])}const Je=S(ze,[["render",Ye]]),Ke={props:{image:Object,isSelected:{type:Boolean,default:!1}},components:{BaseParagraph:x,DataTableCell:C,DataTableSeverityIndicator:E,DataTableRow:D,DataTableCellSelectable:A,BasePill:P,XTooltip:O},computed:{actions(){return[{title:"Actions",items:[{label:"remove responsibility",destructive:!0,onClick:()=>this.$emit("removeImage",this.image.id)}]}]},connectedToText(){return this.image.linked_to_team_via=="repo"?"Connected to Repo":this.image.linked_to_team_via=="cloud"?"Connected to Cloud":null},connectedToTooltip(){return this.image.linked_to_team_via=="repo"&&this.image.code_repo_name?`Connected to ${this.image.code_repo_name}`:this.image.linked_to_team_via=="cloud"&&this.image.cloud_name?`Connected to ${this.image.cloud_name}`:null}},methods:{selectImage(){this.$emit("toggleSelectImage",this.image.id)}}},Qe={class:"text--semi-bold"},Ze={class:"hidden sm:block"},et={class:"block sm:hidden"};function tt(s,o,t,f,u,n){const p=i("DataTableCellSelectable"),l=i("BaseParagraph"),m=i("XTooltip"),_=i("BasePill"),h=i("DataTableCell"),y=i("DataTableSeverityIndicator"),k=i("DataTableRow");return r(),d(k,{href:`/container/${t.image.id}`,clickable:""},{default:a(()=>[e(p,{mode:t.isSelected?"edit":"display",selected:t.isSelected,onSelect:n.selectImage,disabled:t.image.linked_to_team_via!="direct_link",onClick:o[0]||(o[0]=L(()=>{},["prevent"]))},null,8,["mode","selected","onSelect","disabled"]),e(h,null,{default:a(()=>[e(l,{class:"truncate"},{default:a(()=>[T(b(t.image.name),1)]),_:1}),n.connectedToText?(r(),d(_,{key:0,class:"ml-auto",variation:"gray-fill"},{default:a(()=>[c("span",Qe,b(n.connectedToText),1),e(m,null,{default:a(()=>[T(b(n.connectedToTooltip),1)]),_:1})]),_:1})):g("",!0)]),_:1}),e(y,{priority:t.image.max_issue_severity},null,8,["priority"]),e(h,null,{default:a(()=>[e(l,{class:"truncate"},{default:a(()=>[c("span",Ze,b(t.image.open_issue_count),1),c("span",et,b(s.$t("REPO_OVERVIEW.NUM_OPEN_ISSUES",{n:t.image.open_issue_count})),1)]),_:1})]),_:1}),e(h)]),_:1},8,["href"])}const at=S(Ke,[["render",tt]]),st={props:{domain:Object,isSelected:{type:Boolean,default:!1}},components:{BaseParagraph:x,DataTableCell:C,DataTableSeverityIndicator:E,DataTableRow:D,DataTableCellSelectable:A,BasePill:P,XTooltip:O},computed:{actions(){return[{title:"Actions",items:[{label:"remove responsibility",destructive:!0,onClick:()=>this.$emit("removeDomain",this.domain.domain_id)}]}]},connectedToText(){return this.domain.scm_repo_id>0?"Connected to Repo":this.domain.cloud_repo_id>0?"Connected to Container":null},connectedToTooltip(){return this.domain.scm_repo_id>0&&this.domain.scm_repo_name?`Connected to ${this.domain.scm_repo_name}`:this.domain.cloud_repo_id>0&&this.domain.cloud_repo_name?`Connected to ${this.domain.cloud_repo_name}`:null},isDirectLinked(){return!(this.domain.scm_repo_id>0||this.domain.cloud_repo_id>0)}},methods:{selectDomain(){this.$emit("toggleSelectDomain",this.domain.domain_id)}}},it={class:"text--semi-bold"},nt={class:"hidden sm:block"},lt={class:"block sm:hidden"};function ot(s,o,t,f,u,n){const p=i("DataTableCellSelectable"),l=i("BaseParagraph"),m=i("XTooltip"),_=i("BasePill"),h=i("DataTableCell"),y=i("DataTableSeverityIndicator"),k=i("DataTableRow");return r(),d(k,{href:`/domain/${t.domain.domain_id}`,clickable:""},{default:a(()=>[e(p,{mode:t.isSelected?"edit":"display",selected:t.isSelected,onSelect:n.selectDomain,disabled:!n.isDirectLinked,onClick:o[0]||(o[0]=L(()=>{},["prevent"]))},null,8,["mode","selected","onSelect","disabled"]),e(h,null,{default:a(()=>[e(l,{class:"truncate"},{default:a(()=>[T(b(t.domain.domain_name),1)]),_:1}),n.connectedToText?(r(),d(_,{key:0,class:"ml-auto",variation:"gray-fill"},{default:a(()=>[c("span",it,b(n.connectedToText),1),e(m,null,{default:a(()=>[T(b(n.connectedToTooltip),1)]),_:1})]),_:1})):g("",!0)]),_:1}),e(y,{priority:t.domain.max_issue_severity},null,8,["priority"]),e(h,null,{default:a(()=>[e(l,{class:"truncate"},{default:a(()=>[c("span",nt,b(t.domain.open_issue_count),1),c("span",lt,b(s.$t("REPO_OVERVIEW.NUM_OPEN_ISSUES",{n:t.domain.open_issue_count})),1)]),_:1})]),_:1}),e(h)]),_:1},8,["href"])}const rt=S(st,[["render",ot]]),dt={props:{instanceGroup:Object,isSelected:{type:Boolean,default:!1}},components:{BaseParagraph:x,DataTableCell:C,DataTableSeverityIndicator:E,DataTableRow:D,DataTableCellSelectable:A,BasePill:P,XTooltip:O},computed:{actions(){return[{title:"Actions",items:[{label:"remove responsibility",destructive:!0,onClick:()=>this.$emit("removeInstanceGroup",this.instanceGroup.id)}]}]},connectedToText(){return this.instanceGroup.cloud_id>0?"Connected to Cloud":null},connectedToTooltip(){return this.instanceGroup.cloud_id>0&&this.instanceGroup.cloud_name?`Connected to ${this.instanceGroup.cloud_name}`:null},isDirectLinked(){return!(this.instanceGroup.cloud_id>0)}},methods:{selectInstanceGroup(){this.$emit("toggleSelectInstanceGroup",this.instanceGroup.id)}}},ct={class:"text--semi-bold"},ut={class:"hidden sm:block"},mt={class:"block sm:hidden"};function _t(s,o,t,f,u,n){const p=i("DataTableCellSelectable"),l=i("BaseParagraph"),m=i("XTooltip"),_=i("BasePill"),h=i("DataTableCell"),y=i("DataTableSeverityIndicator"),k=i("DataTableRow");return r(),d(k,{href:`/clouds/${t.instanceGroup.cloud_id}/virtual-machines/${t.instanceGroup.id}`,clickable:""},{default:a(()=>[e(p,{mode:t.isSelected?"edit":"display",selected:t.isSelected,onSelect:n.selectInstanceGroup,disabled:!n.isDirectLinked,onClick:o[0]||(o[0]=L(()=>{},["prevent"]))},null,8,["mode","selected","onSelect","disabled"]),e(h,null,{default:a(()=>[e(l,{class:"truncate"},{default:a(()=>[T(b(t.instanceGroup.name),1)]),_:1}),n.connectedToText?(r(),d(_,{key:0,class:"ml-auto",variation:"gray-fill"},{default:a(()=>[c("span",ct,b(n.connectedToText),1),e(m,null,{default:a(()=>[T(b(n.connectedToTooltip),1)]),_:1})]),_:1})):g("",!0)]),_:1}),e(y,{priority:t.instanceGroup.max_issue_severity},null,8,["priority"]),e(h,null,{default:a(()=>[e(l,{class:"truncate"},{default:a(()=>[c("span",ut,b(t.instanceGroup.count_open_issues),1),c("span",mt,b(s.$t("REPO_OVERVIEW.NUM_OPEN_ISSUES",{n:t.instanceGroup.count_open_issues})),1)]),_:1})]),_:1}),e(h)]),_:1},8,["href"])}const ht=S(dt,[["render",_t]]),pt={components:{DataTableRow:D,DataTableCell:C,LoadingSkeleton:Y}};function ft(s,o,t,f,u,n){const p=i("LoadingSkeleton"),l=i("DataTableCell"),m=i("DataTableRow");return r(),R(w,null,v(3,_=>e(m,{key:_},{default:a(()=>[e(l,null,{default:a(()=>[e(p,{height:"14px"})]),_:1}),e(l,null,{default:a(()=>[e(p,{height:"14px"})]),_:1}),e(l,null,{default:a(()=>[e(p,{height:"14px"})]),_:1}),e(l,null,{default:a(()=>[e(p,{height:"14px"})]),_:1}),e(l,null,{default:a(()=>[e(p,{height:"14px"})]),_:1})]),_:2},1024)),64)}const bt=S(pt,[["render",ft]]),Tt={components:{DataTable:V,DataTableHeader:N,DataTableRow:D,OverviewEmptyState:pe,GenericIllustration:fe,TeamDetailResponsibilitiesTabTableRow:Fe,TeamDetailResponsibilitiesTabTableRowCloud:Je,TeamDetailResponsibilitiesTabTableRowImage:at,TeamDetailResponsibilitiesTabTableRowDomain:rt,TeamDetailResponsibilitiesTabTableRowInstanceGroup:ht,TeamDetailResponsibilitiesTabTableRowLoading:bt,InputCheckbox:F},props:{isLoading:Boolean,repositories:Array,clouds:Array,images:Array,domains:Array,instanceGroups:Array,team:Object,selectedRepoIds:Array,selectedCloudIds:Array,selectedImageIds:Array},computed:{showEmptyState(){return!(this.isLoading||this.repositories.length>0||this.clouds.length>0||this.images.length>0||this.domains.length>0||this.instanceGroups.length>0)},hasSelectedResources(){return this.isLoading?!1:this.selectedRepoIds.length>0||this.selectedCloudIds.length>0||this.selectedImageIds.length>0},selectableImages(){return this.images.filter(s=>s.linked_to_team_via=="direct_link")},allResourcesSelected(){return!(!this.hasSelectedResources||this.selectedRepoIds.length<this.repositories.length||this.selectedCloudIds.length<this.clouds.length||this.selectedImageIds.length<this.selectableImages.length)}},methods:{handleToggleSelectAllResources(s){s?(this.$emit("update:selectedRepoIds",this.repositories.map(o=>o.id)),this.$emit("update:selectedCloudIds",this.clouds.map(o=>o.id)),this.$emit("update:selectedImageIds",this.selectableImages.map(o=>o.id))):this.clearSelectedResources()},clearSelectedResources(){this.$emit("update:selectedRepoIds",[]),this.$emit("update:selectedCloudIds",[]),this.$emit("update:selectedImageIds",[])},isRepoSelected(s){return this.selectedRepoIds.includes(s)},onToggleSelectRepo(s){if(!this.isRepoSelected(s)){this.$emit("update:selectedRepoIds",[...this.selectedRepoIds,s]);return}const o=this.selectedRepoIds.findIndex(f=>f==s),t=[...this.selectedRepoIds];t.splice(o,1),this.$emit("update:selectedRepoIds",t)},isCloudSelected(s){return this.selectedCloudIds.includes(s)},isImageSelected(s){return this.selectedImageIds.includes(s)},onToggleSelectCloud(s){if(!this.isCloudSelected(s)){this.$emit("update:selectedCloudIds",[...this.selectedCloudIds,s]);return}const o=this.selectedCloudIds.findIndex(f=>f==s),t=[...this.selectedCloudIds];t.splice(o,1),this.$emit("update:selectedCloudIds",t)},onToggleSelectImage(s){if(!this.isImageSelected(s)){this.$emit("update:selectedImageIds",[...this.selectedImageIds,s]);return}const o=this.selectedImageIds.findIndex(f=>f==s),t=[...this.selectedImageIds];t.splice(o,1),this.$emit("update:selectedImageIds",t)}}},gt={class:"flex flex-column data-table--rounded-none"},It={colspan:"5"},yt={colspan:"5"},Rt={colspan:"5"},St={colspan:"5"},kt={colspan:"5"},wt={colspan:"5"};function Dt(s,o,t,f,u,n){const p=i("InputCheckbox"),l=i("DataTableHeader"),m=i("DataTable"),_=i("BaseParagraph"),h=i("DataTableRow"),y=i("TeamDetailResponsibilitiesTabTableRowLoading"),k=i("TeamDetailResponsibilitiesTabTableRow"),B=i("TeamDetailResponsibilitiesTabTableRowCloud"),G=i("TeamDetailResponsibilitiesTabTableRowImage"),U=i("TeamDetailResponsibilitiesTabTableRowDomain"),z=i("TeamDetailResponsibilitiesTabTableRowInstanceGroup"),W=i("GenericIllustration"),q=i("OverviewEmptyState");return r(),R("div",gt,[e(m,null,{header:a(()=>[e(l,{width:"48px",alignment:"center",spacing:"compact"},{default:a(()=>[e(p,{"semi-checked":n.hasSelectedResources,modelValue:n.allResourcesSelected,"onUpdate:modelValue":n.handleToggleSelectAllResources,name:"all-resources"},null,8,["semi-checked","modelValue","onUpdate:modelValue"])]),_:1}),e(l,{width:"auto"},{default:a(()=>[T("Name")]),_:1}),e(l,{width:"113px",alignment:"center"},{default:a(()=>[T("Severity")]),_:1}),e(l,{width:"109px"},{default:a(()=>[T(" Open ")]),_:1}),e(l,{width:"48px"})]),_:1}),t.repositories.length>0||t.isLoading?(r(),d(m,{key:0,class:"data-table--no-header"},{header:a(()=>[e(l,{width:"48px"}),e(l,{width:"auto"}),e(l,{width:"113px",alignment:"center"}),e(l,{width:"109px"}),e(l,{width:"48px"})]),body:a(()=>[e(h,{class:"data-table__row--section-header"},{default:a(()=>[c("td",It,[e(_,null,{default:a(()=>[T("Repositories")]),_:1})])]),_:1}),t.isLoading?(r(),d(y,{key:0})):(r(!0),R(w,{key:1},v(t.repositories,I=>(r(),d(k,{key:I.id,repository:I,team:t.team,isSelected:n.isRepoSelected(I.id),onToggleSelectRepo:n.onToggleSelectRepo,onTeamPathsChanged:o[0]||(o[0]=zt=>s.$emit("teamPathsChanged"))},null,8,["repository","team","isSelected","onToggleSelectRepo"]))),128))]),_:1})):g("",!0),t.clouds.length>0||t.isLoading?(r(),d(m,{key:1,class:"data-table--no-header"},{header:a(()=>[e(l,{width:"48px"}),e(l,{width:"auto"}),e(l,{width:"113px",alignment:"center"}),e(l,{width:"109px"}),e(l,{width:"48px"})]),body:a(()=>[e(h,{class:"data-table__row--section-header"},{default:a(()=>[c("td",yt,[e(_,null,{default:a(()=>[T("Clouds")]),_:1})])]),_:1}),t.isLoading?(r(),d(y,{key:0})):g("",!0),(r(!0),R(w,null,v(t.clouds,I=>(r(),d(B,{key:I.id,cloud:I,isSelected:n.isCloudSelected(I.id),onToggleSelectCloud:n.onToggleSelectCloud},null,8,["cloud","isSelected","onToggleSelectCloud"]))),128))]),_:1})):g("",!0),t.images.length>0||t.isLoading?(r(),d(m,{key:2,class:"data-table--no-header"},{header:a(()=>[e(l,{width:"48px"}),e(l,{width:"auto"}),e(l,{width:"113px",alignment:"center"}),e(l,{width:"109px"}),e(l,{width:"48px"})]),body:a(()=>[e(h,{class:"data-table__row--section-header"},{default:a(()=>[c("td",Rt,[e(_,null,{default:a(()=>[T("Containers")]),_:1})])]),_:1}),t.isLoading?(r(),d(y,{key:0})):g("",!0),(r(!0),R(w,null,v(t.images,I=>(r(),d(G,{key:I.id,image:I,isSelected:n.isImageSelected(I.id),onToggleSelectImage:n.onToggleSelectImage},null,8,["image","isSelected","onToggleSelectImage"]))),128))]),_:1})):g("",!0),t.domains.length>0||t.isLoading?(r(),d(m,{key:3,class:"data-table--no-header"},{header:a(()=>[e(l,{width:"48px"}),e(l,{width:"auto"}),e(l,{width:"113px",alignment:"center"}),e(l,{width:"109px"}),e(l,{width:"48px"})]),body:a(()=>[e(h,{class:"data-table__row--section-header"},{default:a(()=>[c("td",St,[e(_,null,{default:a(()=>[T("Domains")]),_:1})])]),_:1}),t.isLoading?(r(),d(y,{key:0})):g("",!0),(r(!0),R(w,null,v(t.domains,I=>(r(),d(U,{key:I.domain_id,domain:I},null,8,["domain"]))),128))]),_:1})):g("",!0),t.instanceGroups.length>0||t.isLoading?(r(),d(m,{key:4,class:"data-table--no-header"},{header:a(()=>[e(l,{width:"48px"}),e(l,{width:"auto"}),e(l,{width:"113px",alignment:"center"}),e(l,{width:"109px"}),e(l,{width:"48px"})]),body:a(()=>[e(h,{class:"data-table__row--section-header"},{default:a(()=>[c("td",kt,[e(_,null,{default:a(()=>[T("Virtual Machines")]),_:1})])]),_:1}),t.isLoading?(r(),d(y,{key:0})):g("",!0),(r(!0),R(w,null,v(t.instanceGroups,I=>(r(),d(z,{key:I.id,instanceGroup:I},null,8,["instanceGroup"]))),128))]),_:1})):g("",!0),n.showEmptyState?(r(),d(m,{key:5,class:"data-table--no-header"},{header:a(()=>[e(l,{width:"auto"}),e(l,{width:"113px",alignment:"center"}),e(l,{width:"109px"}),e(l,{width:"48px"})]),body:a(()=>[n.showEmptyState?(r(),d(h,{key:0},{default:a(()=>[c("td",wt,[e(q,{title:s.$t("TEAM_DETAIL.RESPONSIBILITIES_OVERVIEW.EMPTY_STATE.TITLE"),description:s.$t("TEAM_DETAIL.RESPONSIBILITIES_OVERVIEW.EMPTY_STATE.DESCRIPTION"),variation:"empty"},{default:a(()=>[e(W)]),_:1},8,["title","description"])])]),_:1})):g("",!0)]),_:1})):g("",!0)])}const Ct=S(Tt,[["render",Dt]]),vt={props:{team:Object},components:{TeamResponsibilitiesList:Ct},data(){return{isLoading:!0,repositories:[],clouds:[],images:[],selectedRepoIds:[],selectedCloudIds:[],selectedImageIds:[],importedTeam:this.team.source_kind!=null,imagesLinkedToRepoInfo:[],imagesLinkedToCloudInfo:[],domains:[],instanceGroups:[]}},async mounted(){await this.loadLinkedResources(),this.isLoading=!1},computed:{teamId(){return this.$route.params.teamId},showEmptyState(){return this.isLoading===!1&&this.repositories.length===0&&this.clouds.length===0},hasSelectedResources(){return this.isLoading?!1:this.selectedRepoIds.length>0||this.selectedCloudIds.length>0||this.selectedImageIds.length>0},enhancedImages(){return this.images.map(s=>{const o=this.getImageLinkedViaInfo(s.id);return{...s,...o}})}},methods:{async loadRepos(){this.repositories=await J("",!0,void 0,void 0,void 0,void 0,this.teamId,{dont_pass_team_context:!0},!0,void 0)},async loadClouds(){this.clouds=await K(void 0,this.teamId,{dont_pass_team_context:!0})},async loadImages(){this.images=await Q({activeOnly:!0,filter_team_id:this.teamId})},async loadImageLinkSources(){const{images_linked_to_repos_info:s,images_linked_to_clouds_info:o}=await Z(this.teamId,{disable_toasts:!0});this.imagesLinkedToRepoInfo=s,this.imagesLinkedToCloudInfo=o},async loadDomains(){this.domains=await ee({filter_team_id:this.teamId})},async loadInstanceGroups(){this.instanceGroups=await te({filter_team_id:this.teamId})},async loadLinkedResources(){await Promise.allSettled([this.loadRepos(),this.loadClouds(),this.loadImages(),this.loadImageLinkSources(),this.loadDomains(),this.loadInstanceGroups()])},async handleLinkResourceToTeam(){(await this.$modal.show("LinkResourceToTeamModal",{team:this.team,linkedClouds:this.clouds,linkedRepositories:this.repositories,linkedImages:this.images})).type==="saved"&&await this.loadLinkedResources()},async unlinkResourcesBulk(){const s=this.selectedRepoIds.length+this.selectedCloudIds.length+this.selectedImageIds.length;if(await ae({headerText:"Remove Resources from Team",title:`Are you sure you want to remove ${s} ${this.$t("N_RESOURCES",s).toLowerCase()} from ${this.team.name}`,description:`Removing these resources from ${this.team.name} will also revoke access for all team-only users of this team.`,buttonSubmitText:"Remove Resources From Team"})){this.isLoading=!0,this.repositories=[],this.clouds=[];try{await se(this.team.id,this.selectedRepoIds,this.selectedCloudIds,this.selectedImageIds)}catch{}this.selectedRepoIds=[],this.selectedCloudIds=[],this.selectedImageIds=[],await this.loadLinkedResources(),this.isLoading=!1}},getImageLinkedViaInfo(s){const o=this.imagesLinkedToCloudInfo.find(f=>f.image_id==s);if(o)return{linked_to_team_via:"cloud",...o};const t=this.imagesLinkedToRepoInfo.find(f=>f.image_id==s);return t?{linked_to_team_via:"repo",...t}:{linked_to_team_via:"direct_link"}}}},xt={class:"flex align-center mb-24px"},Lt=c("i",{class:"icon icon-add"},null,-1);function Pt(s,o,t,f,u,n){const p=i("BaseIcon"),l=i("BaseButton"),m=i("TeamResponsibilitiesList");return r(),R("div",null,[c("div",xt,[n.hasSelectedResources?(r(),d(l,{key:0,class:"ml-auto",size:"small",variation:"destructive",onClick:n.unlinkResourcesBulk},{default:a(()=>[e(p,{class:"icon-12px",icon:"icon-delete",size:12}),T(" Remove Responsibilities ")]),_:1},8,["onClick"])):g("",!0),!u.importedTeam||s.$featureflags.disable_github_repo_team_sync?(r(),d(l,{key:1,size:"small",onClick:n.handleLinkResourceToTeam,class:H(n.hasSelectedResources?"ml-8px":"ml-auto")},{default:a(()=>[Lt,T(" Link resource ")]),_:1},8,["onClick","class"])):g("",!0)]),e(m,{isLoading:u.isLoading,repositories:u.repositories,clouds:u.clouds,images:n.enhancedImages,domains:u.domains,instanceGroups:u.instanceGroups,team:t.team,selectedRepoIds:u.selectedRepoIds,"onUpdate:selectedRepoIds":o[0]||(o[0]=_=>u.selectedRepoIds=_),selectedCloudIds:u.selectedCloudIds,"onUpdate:selectedCloudIds":o[1]||(o[1]=_=>u.selectedCloudIds=_),selectedImageIds:u.selectedImageIds,"onUpdate:selectedImageIds":o[2]||(o[2]=_=>u.selectedImageIds=_),onResourcesUnlinked:n.loadLinkedResources,onTeamPathsChanged:n.loadLinkedResources},null,8,["isLoading","repositories","clouds","images","domains","instanceGroups","team","selectedRepoIds","selectedCloudIds","selectedImageIds","onResourcesUnlinked","onTeamPathsChanged"])])}const Bt=S(vt,[["render",Pt]]),Ut={components:{PageHeader:ue,BaseParagraph:x,XPreloader:ie,BaseHeading:ne,TeamDetailAllUsersTable:ke,TeamDetailTeamUsersTable:Ge,InputSearch:le,BasePill:P,XTabs:me,TeamDetailResponsibilitiesTab:Bt},data(){return{isLoading:!0,team:{},users:[],userSearchTerm:"",isSearching:!1,tab:this.$route.query.team_detail_tab??"users"}},watch:{async teamId(){this.isLoading=!0;try{await this.loadTeam()}finally{this.isLoading=!1}},tab(){history.pushState({},"",`/settings/teams/${this.teamId}?team_detail_tab=${this.tab}`)}},async mounted(){await Promise.allSettled([this.loadTeam(),this.loadUsers()]),this.isLoading=!1},computed:{tabs(){return[{title:"People",id:"users"},{title:"Responsibilities",id:"responsibilities"}]},teamId(){return this.$route.params.teamId},breadcrumbs(){return[{label:"Settings",href:"/settings"},{label:"Teams",href:"/settings/teams"},{label:this.team.name}]},usersNotInTeam(){const s=this.team.users.map(t=>t.id);return(this.users??[]).filter(t=>s.includes(t.id)===!1)},usersInTeam(){if(!this.userSearchTerm)return this.team.users;const o=(this.users??[]).map(t=>t.id);return this.team.users.filter(t=>o.includes(t.id))},shouldAnimateList(){return!this.isSearching},isImported(){return this.teamImportSourceLabel!==null},teamImportSourceLabel(){return this.team.source_kind==="github"?"GitHub":this.team.source_kind==="bitbucket"?"Bitbucket":this.team.source_kind==="azure_devops"?"Azure Devops":null},teamImportSourceIcon(){return this.team.source_kind==="github"?"icon-github":this.team.source_kind==="bitbucket"?"icon-bitbucket":this.team.source_kind==="azure_devops"?"icon-azure":null},teamExternalRef(){return this.team.external_ref?`${this.team.external_ref}`:!1}},methods:{async loadTeam(){this.team=await oe(this.teamId)},async loadUsers(){this.users=await re(!0,this.userSearchTerm,{dont_pass_team_context:!0})},async handleSearchUsers(){this.isSearching=!0;try{await this.loadUsers()}finally{this.isSearching=!1}},async handleAddUserToTeam(s){const o=this.users.find(t=>t.id===s);if(o&&!this.team.users.some(t=>t.id===s))try{this.team.users=[o,...this.team.users],await de({teamId:this.teamId,userId:s}),await this.loadTeam()}catch{this.team.users=this.team.users.filter(f=>f.id!==s)}},async handleRemoveUserFromTeam(s){if(!this.users.find(f=>f.id===s))return;const t=this.team.users;try{this.team.users=this.team.users.filter(f=>f.id!==s),await ce({teamId:this.teamId,userId:s}),await this.loadTeam()}catch{this.team.users=t}}}},Et={class:"flex align-center gap-8px"},At={class:"page-content h-full scroll-y-auto"},Ot={key:0,class:"flex align-start gap-24px wide-tablet_flex-column wide-tablet_scroll-y-auto h-full"},Gt={class:"flex flex-column gap-12px flex-1"},Vt={class:"min-h-36px flex align-center"},Nt={class:"text--semi"},Mt={class:"scroll-y-auto"},Xt={key:0,class:"flex flex-column gap-12px flex-1"},$t={class:"flex align-center gap-12px justify-between"},jt={class:"scroll-y-auto"},Ht={key:1};function Ft(s,o,t,f,u,n){const p=i("XPreloader"),l=i("BasePill"),m=i("XTabs"),_=i("PageHeader"),h=i("BaseHeading"),y=i("TeamDetailTeamUsersTable"),k=i("InputSearch"),B=i("TeamDetailAllUsersTable"),G=i("TeamDetailResponsibilitiesTab");return u.isLoading?(r(),d(p,{key:0,class:"supercenter",theme:"transparent"})):(r(),R(w,{key:1},[e(_,{breadcrumbs:n.breadcrumbs,title:u.team.name},{subTitle:a(()=>[c("div",Et,[n.teamImportSourceLabel?(r(),d(l,{key:0,title:s.$t("TEAMS.OVERVIEW.IMPORTED_FROM",{source:n.teamImportSourceLabel}),icon:n.teamImportSourceIcon,variation:"gray-fill"},null,8,["title","icon"])):g("",!0),n.teamExternalRef?(r(),d(l,{key:1,title:n.teamExternalRef,variation:"gray-fill"},null,8,["title"])):g("",!0)])]),tabs:a(()=>[e(m,{tabs:n.tabs,modelValue:u.tab,"onUpdate:modelValue":o[0]||(o[0]=U=>u.tab=U),class:"page-tabs"},null,8,["tabs","modelValue"])]),_:1},8,["breadcrumbs","title"]),c("div",At,[u.tab==="users"?(r(),R("div",Ot,[c("div",Gt,[c("div",Vt,[e(h,{as:"h3"},{default:a(()=>[T("Users in "),c("span",Nt,b(u.team.name),1),T("("+b(u.team.users.length)+")",1)]),_:1})]),c("div",Mt,[e(y,{users:n.usersInTeam,onRemoveUserFromTeam:n.handleRemoveUserFromTeam,animate:n.shouldAnimateList,"read-only":n.isImported},null,8,["users","onRemoveUserFromTeam","animate","read-only"])])]),n.isImported?g("",!0):(r(),R("div",Xt,[c("div",$t,[e(h,{as:"h3"},{default:a(()=>[T("All users("+b(n.usersNotInTeam.length)+")",1)]),_:1}),e(k,{modelValue:u.userSearchTerm,"onUpdate:modelValue":[o[1]||(o[1]=U=>u.userSearchTerm=U),n.handleSearchUsers],spacing:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),c("div",jt,[e(B,{users:n.usersNotInTeam,onAddUserToTeam:n.handleAddUserToTeam,animate:n.shouldAnimateList},null,8,["users","onAddUserToTeam","animate"])])]))])):g("",!0),u.tab==="responsibilities"?(r(),R("div",Ht,[e(G,{team:u.team},null,8,["team"])])):g("",!0)])],64))}const la=S(Ut,[["render",Ft]]);export{la as default};
