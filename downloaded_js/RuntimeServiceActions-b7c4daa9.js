import{A as l}from"./ActionMenu-3e4470bf.js";import{_ as a,e as c,bo as r,r as d,q as h,k as g,w as m,aa as u}from"./index-13ff96f4.js";const b={emits:["regenerateToken","configure","delete"],components:{BaseIconButton:c,ActionMenu:l},props:{service:{type:Object,required:!0},redirectAfterDelete:{type:Boolean,default:!1}},computed:{actions(){const e=this.$user.is_aikido_support||this.$user.email.endsWith("@aikido.dev");return[{title:"Actions",items:[{label:this.blockingModeEnabled?"Disable Blocking":"Enable Blocking",onClick:this.handleToggleBlocking,icon:"icon-shield_check",iconColor:this.blockingModeEnabled?void 0:"green"},{label:"Token Settings",onClick:this.handleTokenSettings,icon:"icon-secrets"},{label:this.$t("RUNTIME_PROTECTION.SERVICE_ACTIONS.CONFIGURE"),onClick:this.handleConfigure,icon:"icon-settings"},{label:"Installation Instructions",onClick:()=>this.$modal.show("RuntimeInstallInstructionsModal",{serviceId:this.service.id}),icon:"icon-information"},{label:"Download OpenAPI Spec",onClick:this.downloadOpenApiSpec,icon:"icon-download"},{label:this.$t("RUNTIME_PROTECTION.SERVICE_ACTIONS.DELETE"),onClick:this.handleDelete,icon:"icon-delete",iconColor:"red",destructive:!0},{hidden:!e,label:"Debug Config",onClick:this.handleDebugConfig,icon:"icon-settings"}].filter(i=>!i.hidden)}]},disableAction(){return this.actions[0].items.length===0},blockingModeEnabled(){let e=!1;return this.service.agent&&(e=!this.service.agent.dry_mode),this.service.mode!=="unknown"&&(e=this.service.mode==="block"),e}},methods:{handleConfigure(){this.$modal.show("UpdateRuntimeServiceModal",{service:this.service})},handleTokenSettings(){this.$modal.show("UpdateRuntimeServiceTokenModal",{service:this.service})},async handleDebugConfig(){const e=await r({serviceId:this.service.id});console.log(e)},async handleDelete(){if(!this.$groupUser.admin){await this.$modal.show("AdminOnlyModal",{action:"Deleting apps"});return}await this.$modal.show("DeleteZenAppModal",{service:this.service,redirectAfterDelete:this.redirectAfterDelete})},async downloadOpenApiSpec(){this.service.schemas===0||this.service.routes===0?this.$modal.show("RuntimeNoApiSpecsFoundModal",{service:this.service}):this.$modal.show("RuntimeDownloadOpenApiSpecConfirmationModal",{service:this.service})},async handleEnableBlocking(){this.service.agent&&this.service.agent.serverless?await this.$modal.show("HowToEnableRuntimeProtectModal"):await this.$modal.show("EnableBlockingMode",{serviceId:this.service.id})},async handleDisableBlocking(){this.service.agent&&this.service.agent.serverless?await this.$modal.show("HowToDisableRuntimeProtectModal"):await this.$modal.show("DisableBlockingMode",{serviceId:this.service.id})},async handleToggleBlocking(){this.blockingModeEnabled?await this.handleDisableBlocking():await this.handleEnableBlocking()}}};function p(e,t,i,v,k,s){const n=d("ActionMenu");return h(),g(n,{sections:s.actions,placement:"bottom-end",useBaseIcon:""},{trigger:m(o=>[u(e.$slots,"trigger",{toggle:o.toggle,disabled:s.disableAction})]),_:3},8,["sections"])}const C=a(b,[["render",p]]);export{C as R};
