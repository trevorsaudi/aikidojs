import{g as V,u as I,s as E}from"./vanta-0e87e3ec.js";import{_ as b,X as v,f as A,H as y,A as m,aE as S,Q as w,r as n,k,m as r,o as a,w as s,p as N,F as P,a as C,q as o,s as c}from"./index-13ff96f4.js";import{P as B}from"./PageHeader-46c38a32.js";import{S as U}from"./SettingsEmptyState-8e8644cd.js";import{E as x}from"./EmptyUsersIllustration-1a5638d0.js";const $={components:{XPreloader:v,BaseButton:A,SettingsEmptyState:U,EmptyUsersIllustration:x,PageHeader:B,BaseHeading:y},data(){return{activeVantaIntegration:null,loaded:!1,isSending:!1}},created(){this.init()},computed:{breadcrumbs(){return[{label:"Settings",href:"/settings"},{label:"Integrations",href:"/settings/integrations"},{label:"Vanta"}]},subtitle(){return this.activeVantaIntegration?"Active":""},canAlwaysUseVanta(){return!!this.$featureflags.force_enable_vanta}},methods:{async init(){this.activeVantaIntegration=await V(),this.loaded=!0},addVantaIntegration(){if(!m.isPayingAndNoProTrial()&&!this.canAlwaysUseVanta)return this.$modal.show("UpgradeAccountModal",{title:"This integration is available on all paid plans",msg:"Upgrade now to any paid plan to start integrating with your compliancy tool."});let i="vci_383d078ac88ab755eb1390f9dd956fd2cb1ff357ff877a53",l="https://app.local.aikido.io/settings/integrations/compliance/vanta/callback";C()==="production"&&(l="https://app.aikido.dev/settings/integrations/compliance/vanta/callback");const d="connectors.self:write-resource",p="code",e=this.$group.id,t=S("vanta");window.location=`https://app.vanta.com/oauth/authorize?client_id=${i}&scope=${d}&redirect_uri=${l}&response_type=${p}&state=${t}&source_id=${e}`},async deactivateVanta(){await w({headerText:"Vanta Integration",description:"Do you want to deactivate the Vanta integration?",buttonSubmitText:"Yes, deactivate"})&&(await I(this.activeVantaIntegration.id),this.init(),Toast.success({title:this.$t("NOTIFICATIONS.INTEGRATION_DEACTIVATED.TITLE"),description:this.$t("VANTA_DEACTIVATED")}))},async sendToVanta(){if(!m.isPayingAndNoProTrial()&&!this.canAlwaysUseVanta)return this.$modal.show("UpgradeAccountModal",{title:"This integration is available on all paid plans",msg:"Upgrade now to any paid plan to start integrating with your compliancy tool."});this.isSending=!0,await E(),this.isSending=!1,Toast.success({title:this.$t("SUCCESS"),description:"We've successfully sent vulnerabilities to Vanta"})}}},D={key:0,class:"page-content"},L={key:0},O={key:1};function H(i,l,d,p,e,t){const T=n("XPreloader"),_=n("PageHeader"),f=n("EmptyUsersIllustration"),h=n("SettingsEmptyState"),u=n("BaseHeading"),g=n("BaseButton");return e.loaded?(o(),r(P,{key:1},[a(_,{title:"Vanta integration",breadcrumbs:t.breadcrumbs,subtitle:t.subtitle},null,8,["breadcrumbs","subtitle"]),e.loaded?(o(),r("div",D,[e.activeVantaIntegration==null?(o(),r("div",L,[a(h,{title:i.$t("SETTINGS.VANTA.OVERVIEW.EMPTY_STATE_TITLE"),description:i.$t("SETTINGS.VANTA.OVERVIEW.EMPTY_STATE_DESCRIPTION"),actionLabel:i.$t("SETTINGS.VANTA.OVERVIEW.EMPTY_STATE_ACTION_LABEL"),onAction:t.addVantaIntegration},{default:s(()=>[a(f)]),_:1},8,["title","description","actionLabel","onAction"])])):(o(),r("div",O,[a(u,{as:"h4",class:"flex justify-between mb-8px"},{default:s(()=>[c("Actions")]),_:1}),a(g,{class:"mt-4px",size:"small",onClick:t.sendToVanta,isLoading:e.isSending},{default:s(()=>[c("Send vulnerabilities to Vanta")]),_:1},8,["onClick","isLoading"]),a(u,{as:"h4",class:"flex justify-between mt-36px mb-8px"},{default:s(()=>[c("Danger zone")]),_:1}),a(g,{class:"mt-4px",variation:"destructive",size:"small",onClick:t.deactivateVanta},{default:s(()=>[c("Deactivate")]),_:1},8,["onClick"])]))])):N("",!0)],64)):(o(),k(T,{key:0,class:"supercenter",theme:"transparent"}))}const X=b($,[["render",H]]);export{X as default};
