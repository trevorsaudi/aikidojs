import{_ as k,B as F,r as c,q as i,k as f,w as o,o as t,n,s as h,u as p,p as _,m as u,t as O,S as B,F as z,e as G,an as L,cv as W,cw as U,cx as A,cy as E,cz as Y,cA as Z,cB as K,aa as q,af as ee,cC as se,en as V,f as X,g as te,bK as ie,Q as ne,a8 as oe,eo as ae,au as re,x as D,d as J,a2 as le,bs as ce,al as de,ep as ue,eq as H}from"./index-13ff96f4.js";import{P as _e}from"./PageHeader-46c38a32.js";import{D as N,a as R}from"./DataTable-e31a825a.js";import{a as $,D as he}from"./DataTableCell-51c0104f.js";import{B as fe}from"./BracesIcon-0a8568f4.js";import{B as pe}from"./BoxIcon-9908469f.js";import{D as me}from"./DataTableSeverityIndicator-48ffb8dc.js";import{j as ge,k as Ie,G as xe,r as Se,l as ye}from"./SidebarActionMenu-1bf6804b.js";import{B as be}from"./BaseCodeBlock-cec75629.js";import{A as ve}from"./ActionMenu-3e4470bf.js";import{Q as Ce}from"./QueueSidebar-47492277.js";import{O as ke}from"./OverviewEmptyState-c8440b9c.js";import"./CreateAutoFixProgressFlow-8111d22c.js";import"./RadioButtonList-1d4cdaad.js";import"./EnableIntegrationModal-48b01f56.js";import"./focusModePreference-150f170e.js";import"./TableListHeader-e50d01d1.js";import"./BaseRadioInput-a7ac3557.js";import"./BaseLabel-a1c0ca00.js";import"./AIText-891d4f7b.js";import"./InputCheckbox-81cb3ca6.js";import"./BreakSlashes-925eef0e.js";import"./UnignoreIssue-5dff8957.js";import"./CreateTicketModal-c14deeb1.js";import"./ManualInputSearchDropdown-6a7ece3e.js";import"./InputSearchDropdown-02988f6b.js";import"./repoName-872812ed.js";import"./taskTrackerNaming-55adac3e.js";import"./taskTrackerIcon-504ea566.js";import"./autofixable-c6560249.js";import"./autofixSastIssues-779ec5b4.js";import"./index-b87db690.js";import"./dateFns-a344cb79.js";import"./lock-files-cdbb050f.js";import"./string-814c5ffd.js";import"./ButtonMultiOption-12e505fb.js";import"./transform-c376ec3f.js";import"./linear-efb37b7f.js";import"./arc-12e4470a.js";import"./BaseForm-4c6fa06f.js";import"./XTabs-d492da26.js";import"./BaseCard-471d3203.js";import"./AccordionContainer-09dc0ed4.js";import"./trycatch-83445d5b.js";import"./licenses-6ab38515.js";const we={emits:["issueClicked"],components:{DataTable:N,DataTableHeader:R,DataTableRow:$,BaseParagraph:F,DataTableCell:he,BracesIcon:fe,BoxIcon:pe,DataTableSeverityIndicator:me},props:{title:String,emptyState:String,issues:Array,selectedIssue:Object,status:String},computed:{amountIssues(){return this.issues.length},atrs(){return this.$attrs},statusData(){return this.status=="new"?{color:"orange"}:this.status=="closed"?{color:"green",icon:"icon-shield_check"}:{}}},methods:{isSelected(s){return JSON.stringify(s)==JSON.stringify(this.selectedIssue)},isIssueAutoIgnored(s){return s.aikido_scoring.aikido_action==="autoignore"||s.aikido_scoring.aikido_action==="rule_ignore"},isMobileLanguage(s){return["Android","iOS"].includes(s.programming_language)}}},ze={colspan:"3"},Be={colspan:"3",class:"py-14px px-16px"},Te={key:0,class:"absolute h-full pin-t pin-l bg-purple-accent w-5px"},Fe={key:0,class:"flex align-center justify-center"},Pe=n("i",{class:"icon icon-cloud text-carbon-60"},null,-1),Oe=[Pe],De={key:1,class:"flex align-center justify-center"},Ne=n("i",{class:"icon icon-secrets text-carbon-60"},null,-1),Re=[Ne],Me={key:2,class:"flex align-center justify-center"},Le={key:0,class:"icon icon-IasC text-carbon-60"},Ue={key:3,class:"flex align-center justify-center text-center bg-inherit text-carbon-60"},Ae={class:"valign-middle"},Ee={class:"h-36px flex flex-column justify-center"};function qe(s,r,a,S,d,e){const l=c("DataTableHeader"),m=c("BaseParagraph"),g=c("DataTableRow"),x=c("BaseIcon"),b=c("BracesIcon"),C=c("BoxIcon"),v=c("DataTableCell"),w=c("DataTableSeverityIndicator"),y=c("DataTable");return i(),f(y,{class:"data-table--no-header"},{header:o(()=>[t(l,{width:"48px"}),t(l,{width:"auto"}),t(l,{width:"100px"})]),body:o(()=>[t(g,{class:"data-table__row--section-header"},{default:o(()=>[n("td",ze,[t(m,null,{default:o(()=>[h(p(a.title),1)]),_:1})])]),_:1}),e.amountIssues==0?(i(),f(g,{key:0},{default:o(()=>[n("td",Be,[t(m,null,{default:o(()=>[h(p(a.emptyState),1)]),_:1})])]),_:1})):_("",!0),(i(!0),u(z,null,O(a.issues,(I,P)=>(i(),f(g,{key:`${a.title}_${P}`,onClick:M=>s.$emit("issueClicked",I),clickable:!0,faded:I.snoozed},{default:o(()=>[t(v,{alignment:"center"},{default:o(()=>[e.isSelected(I)?(i(),u("span",Te)):_("",!0),t(m,null,{default:o(()=>[I.type==="cloud"?(i(),u("div",Fe,Oe)):I.type==="leaked_secret"?(i(),u("div",De,Re)):I.type==="sast"?(i(),u("div",Me,[I.scanner==="checkov"?(i(),u("i",Le)):e.isMobileLanguage(I)?(i(),f(x,{key:1,icon:"icon-mobile",color:"#737283",size:20})):(i(),f(b,{key:2,text:I.programming_language},null,8,["text"]))])):(i(),u("div",Ue,[t(C,{text:I.programming_language},null,8,["text"])]))]),_:2},1024)]),_:2},1024),t(v,null,{default:o(()=>[n("span",{class:B(["status-tag small mr-8px",e.statusData.color])},[n("span",Ae,p(s.$t(`STATUSTAG_${a.status}`)),1),e.statusData.icon?(i(),u("i",{key:0,class:B(["icon icon-8px valign-middle ml-4px",e.statusData.icon])},null,2)):_("",!0)],2),n("div",Ee,[t(m,null,{default:o(()=>[h(p(I.title),1)]),_:2},1024),I.file?(i(),f(m,{key:0,color:"gray"},{default:o(()=>[h("in "+p(I.file),1)]),_:2},1024)):_("",!0)])]),_:2},1024),t(w,{priority:I.severity,isAutoIgnored:e.isIssueAutoIgnored(I)},null,8,["priority","isAutoIgnored"])]),_:2},1032,["onClick","faded"]))),128))]),_:1})}const He=k(we,[["render",qe]]),je={props:{itemsList:Array,selectedItem:String},computed:{nextId(){const s=this.itemsList.indexOf(this.selectedItem);return s>=this.itemsList.length-1?null:this.itemsList[s+1]},previousId(){const s=this.itemsList.indexOf(this.selectedItem);return s<=0?null:this.itemsList[s-1]}},methods:{onPreviousClick(){this.$emit("previousClick")},onNextClick(){this.$emit("nextClick")}}},Ge={class:"sidebar__footer-container"},Ve={class:"sidebar__footer"},Xe={class:"flex align-center"},Je=n("i",{class:"icon icon-arrow-left"},null,-1),$e=[Je],Qe=n("i",{class:"icon icon-arrow-right"},null,-1),We=[Qe],Ye=n("span",null,null,-1);function Ze(s,r,a,S,d,e){return i(),u("div",Ge,[n("div",Ve,[n("div",Xe,[n("span",{class:B(["link link-hover text--normal flex align-center px-8px py-12px gap-8px text-primary-aik-20",{disabled:e.previousId===null}]),onClick:r[0]||(r[0]=(...l)=>e.onPreviousClick&&e.onPreviousClick(...l))},$e,2),n("span",{class:B(["link link-hover text--normal flex align-center px-8px py-12px gap-8px text-primary-aik-20",{disabled:e.nextId===null}]),onClick:r[1]||(r[1]=(...l)=>e.onNextClick&&e.onNextClick(...l))},We,2)]),Ye])])}const Ke=k(je,[["render",Ze]]),es={emits:["update:showSidebar"],components:{BaseIconButton:G,SidebarFooter:Ke},props:{showSidebar:{type:Boolean,required:!0},hideFooter:{type:Boolean,default:!1},itemsList:Array,selectedItem:String},data(){return{isMounted:!1}},async created(){document.addEventListener("keydown",this.escapeHandler),L.on("request-queue-sidebar-close",this.onRequestSidebarClose)},setup(){const{width:s}=W();return{width:s}},mounted(){this.isMounted=!0},beforeUnmount(){U(),this.width>A&&E(),document.removeEventListener("keydown",this.escapeHandler),L.off("request-queue-sidebar-close",this.onRequestSidebarClose)},watch:{showSidebar(){this.showSidebar?(Y(),Z()):(U(),this.width>A&&E())}},methods:{escapeHandler(s){s.key==="Escape"&&this.handleCloseSidebar()},handleCloseSidebar(s=!1){this.showSidebar&&(!s&&K()||this.$emit("update:showSidebar",!1))},onRequestSidebarClose(s={}){const r=s.ignoreOpenModal||!1;this.handleCloseSidebar(r)}}},ss={key:0,class:"sidebar scrollbar-simple-carbon-60--inverted"},ts={class:"p-24px pt-16px"},is={class:"mb-32px flex justify-between align-center"},ns={class:"text-14px flex gap-12px"};function os(s,r,a,S,d,e){const l=c("BaseIconButton"),m=c("SidebarFooter");return d.isMounted?(i(),f(se,{key:0,to:"#queue-sidebar-portal"},[t(ee,{name:"sidebar-slide"},{default:o(()=>[a.showSidebar?(i(),u("div",ss,[n("div",ts,[n("div",is,[n("div",ns,[t(l,{inverted:"",size:"large",icon:"icon-close text-white",onClick:e.handleCloseSidebar},null,8,["onClick"])]),q(s.$slots,"header")]),q(s.$slots,"default")]),a.selectedItem&&!a.hideFooter?(i(),f(m,{key:0,itemsList:a.itemsList,selectedItem:a.selectedItem,onPreviousClick:r[0]||(r[0]=g=>s.$emit("previousClick")),onNextClick:r[1]||(r[1]=g=>s.$emit("nextClick"))},null,8,["itemsList","selectedItem"])):_("",!0)])):_("",!0)]),_:3})])):_("",!0)}const as=k(es,[["render",os]]),rs={emits:["cancel","snoozed"],props:{ciIssue:Object},components:{SnoozeIssueDuration:ge,SnoozeIssueReason:Ie},data(){return{showSnoozeIssueDurationModal:!0,showSnoozeIssueReasonModal:!1,snoozeUntil:void 0,snoozeReason:void 0}},methods:{handleCancel(){this.$emit("cancel")},handleShowSnoozeIssueReasonModal({snoozeUntil:s}){this.snoozeUntil=s,this.showSnoozeIssueDurationModal=!1,this.showSnoozeIssueReasonModal=!0},handleShowSnoozeReasonModal(){this.showSnoozeIssueDurationModal=!0,this.showSnoozeIssueReasonModal=!1},async handleSnoozeIssue({snoozeReason:s}){this.snoozeReason=s,await V(this.ciIssue,this.snoozeUntil,this.snoozeReason),this.$emit("snoozed"),Toast.success({title:this.$t("NOTIFICATIONS.ISSUE_SNOOZED.TITLE"),description:this.$t("NOTIFICATIONS.ISSUES.ISSUE_SNOOZED_SUCCESS")})}}};function ls(s,r,a,S,d,e){const l=c("SnoozeIssueDuration"),m=c("SnoozeIssueReason");return i(),u(z,null,[d.showSnoozeIssueDurationModal?(i(),f(l,{key:0,onSubmit:e.handleShowSnoozeIssueReasonModal,onCancel:e.handleCancel},null,8,["onSubmit","onCancel"])):_("",!0),d.showSnoozeIssueReasonModal?(i(),f(m,{key:1,onCancel:e.handleCancel,onBack:e.handleShowSnoozeReasonModal,onSubmit:e.handleSnoozeIssue,snoozeUntil:d.snoozeUntil},null,8,["onCancel","onBack","onSubmit","snoozeUntil"])):_("",!0)],64)}const cs=k(rs,[["render",ls]]),ds={emits:["issueSnoozed","issueUnsnoozed"],components:{BaseSidebar:as,GaugeChart:xe,BaseParagraph:F,BaseCodeBlock:be,BaseButton:X,SnoozeCiIssue:cs,ActionMenu:ve,BaseIconButton:G,BaseLink:te},props:{issue:Object,issues:Array},provide(){return{theme:"dark"}},data(){return{showSnoozeIssueFlow:!1,priorityRanges:[{start:this.$severity.low_min,end:this.$severity.medium_min,colorClass:"text-color-success"},{start:this.$severity.medium_min,end:this.$severity.high_min,colorClass:"text-blue-accent"},{start:this.$severity.high_min,end:this.$severity.critical_min,colorClass:"text-color-primary"},{start:this.$severity.critical_min,end:this.$severity.critical_max,colorClass:"text-color-danger"}]}},computed:{showSidebar(){return!!this.issue},severity(){return this.issue.aikido_scoring.aikido_action==="autoignore"?this.issue.aikido_scoring.initial_severity:this.issue.aikido_scoring.aikido_action==="rule_ignore"?this.issue.aikido_scoring.initial_severity:this.issue.severity},severityText(){return this.$t(ie(this.severity)+"_RISK")},tldr(){if(this.issue.type=="sast")return this.issue.description;if(this.issue.type==="open_source")return this.issue.aikido_cve_analysis?this.issue.aikido_cve_analysis.tldr:Se(this.issue.original_description);if(this.issue.type==="malware")for(const s of Object.keys(this.issue.indicators??{})){const r=ye[s];if(r)return r}return""},how_to_fix(){return this.issue.type==="sast"?this.issue.remediation:this.issue.type==="open_source"?this.howToFixOpenSource:this.issue.type==="leaked_secret"?"Rewrite the Git history of the affected branch to remove the exposed secret using force push, ensuring it's completely purged from the branch. ":this.issue.type==="malware"?"Uninstall the package as soon as possible.":""},fileAndLineNumber(){return this.issue.end_line>this.issue.start_line?`Line ${this.issue.start_line} - ${this.issue.end_line} in ${this.issue.file}`:`Line ${this.issue.start_line} in ${this.issue.file}`},howToFixOpenSource(){return this.issue.type!=="open_source"?"":this.issue.aikido_cve_analysis?this.issue.aikido_cve_analysis.how_to_fix:this.issue.nearest_patch_version?`We recommend updating from ${this.issue.installed_version} to ${this.issue.nearest_patch_version}.`:""},paragraphColor(){return"light-gray"},titleColor(){return"white"},title(){return this.issue.type==="open_source"?this.issue.package_name:this.issue.type==="leaked_secret"?this.issue.description.split(",")[0]:this.issue.title},appliedScoreReasons(){return this.issue.aikido_score_reasons.filter(s=>s.applied!==!1)},actions(){const s=[];if(this.issue.snoozed){const r=this.issue.snoozed_info.reason=="ignored";s.push({label:r?"Unignore":"Unsnooze",onClick:this.unsnoozeIssue,icon:r?"icon-hidden":"icon-snooze"})}else s.push({label:"Snooze in CI",onClick:this.openSnoozeIssueFlow,icon:"icon-snooze"},{label:"Ignore in CI",onClick:this.ignoreIssue,icon:"icon-hidden"});return[{title:"Actions",items:s}]},isFixedIssue(){return this.issue?!!this.issue.is_fixed_issue:!1}},methods:{closeSidebar(){this.$emit("update:issue",null)},openSnoozeIssueFlow(){this.showSnoozeIssueFlow=!0},closeSnoozedIssueFlow(){this.showSnoozeIssueFlow=!1},onIssueSnoozed(){this.closeSnoozedIssueFlow(),this.$emit("issueSnoozed")},onNextClick(){const r=this.issues.findIndex(a=>JSON.stringify(a)===JSON.stringify(this.issue))+1;r>=this.issues.length||this.$emit("update:issue",this.issues[r])},onPreviousClick(){const r=this.issues.findIndex(a=>JSON.stringify(a)===JSON.stringify(this.issue))-1;r<0||this.$emit("update:issue",this.issues[r])},async ignoreIssue(){if(!await ne({headerText:"Ignore issue",description:"Do you want to ignore this issue?",buttonSubmitText:"Yes, ignore"}))return;const s=32503726800,r="ignored";await V(this.issue,s,r),Toast.success({title:this.$t("NOTIFICATIONS.GROUPED_ISSUE_IGNORED.TITLE"),description:this.$t("NOTIFICATIONS.ISSUES.ISSUE_IGNORED_SUCCESS")}),this.$emit("issueSnoozed")},async unsnoozeIssue(){await oe({headerText:"Reopen issue",description:"Do you want reopen this issue?",buttonSubmitText:"Yes, reopen"})&&(await ae(this.issue.snoozed_info.id),Toast.success("Issue successfully reopened"),this.$emit("issueUnsnoozed"))}}},us={key:0,class:"flex gap-8px align-center"},_s={key:0,class:"flex align-center gap-12px"},hs={class:"button button-brand button--small button--rounded text-white",disabled:""},fs=n("i",{class:"icon icon-hidden"},null,-1),ps=n("i",{class:"icon icon-snooze"},null,-1),ms=n("i",{class:"icon icon-caret_down text-white"},null,-1),gs={class:"issue-detail__column issue-detail--theme-dark"},Is={class:"issue-detail__card"},xs={class:"issue-detail__card-body"},Ss={class:"flex gap-24px"},ys={class:"text-center"},bs={class:"flex flex-column gap-16px"},vs={class:"flex flex-column gap-4px"},Cs={key:0,class:"issue-detail__card readability_big_fonts"},ks={class:"issue-detail__card__title-container"},ws={class:"issue-detail__card-body"},zs={class:"issue-detail__card-section"},Bs={class:"flex flex-column gap-8px"},Ts={key:1,class:"issue-detail__card readability_big_fonts"},Fs={class:"issue-detail__card__title-container"},Ps={class:"issue-detail__card-body"},Os={class:"issue-detail__card-section"},Ds={key:2,class:"issue-detail__card readability_big_fonts"},Ns={class:"issue-detail__card__title-container"},Rs={class:"issue-detail__card-body"},Ms={class:"issue-detail__card-section"},Ls={key:3,class:"issue-detail__card readability_big_fonts"},Us={class:"issue-detail__card__title-container"},As={class:"issue-detail__card-body"},Es={class:"issue-detail__card-section"},qs={class:"issue-detail__card readability_big_fonts"},Hs={class:"issue-detail__card__title-container"},js={class:"issue-detail__card-body"},Gs={key:0,class:"issue-detail__card-section"},Vs=n("i",{class:"icon icon-openLink text-12px pl-4px text-deco-none"},null,-1),Xs={key:1,class:"issue-detail__card-section"},Js={key:4,class:"issue-detail__card readability_big_fonts"},$s={class:"issue-detail__card__title-container"},Qs={class:"issue-detail__card-body"},Ws={class:"issue-detail__card-section"};function Ys(s,r,a,S,d,e){const l=c("BaseParagraph"),m=c("BaseButton"),g=c("ActionMenu"),x=c("GaugeChart"),b=c("BaseCodeBlock"),C=c("BaseLink"),v=c("SnoozeCiIssue"),w=c("BaseSidebar");return i(),f(w,{showSidebar:e.showSidebar,"onUpdate:showSidebar":e.closeSidebar,itemsList:a.issues.map(JSON.stringify),selectedItem:JSON.stringify(a.issue),onPreviousClick:e.onPreviousClick,onNextClick:e.onNextClick,hideFooter:e.isFixedIssue},{header:o(()=>[a.issue.type!="malware"?(i(),u("span",us,[a.issue.snoozed?(i(),u("div",_s,[n("button",hs,[a.issue.snoozed_info.reason=="ignored"?(i(),u(z,{key:0},[fs,h(" Ignored ")],64)):(i(),u(z,{key:1},[ps,h(" Snoozed ")],64))])])):_("",!0),e.isFixedIssue?_("",!0):(i(),f(g,{key:1,sections:e.actions,placement:"bottom-end"},{trigger:o(y=>[t(m,{size:"small",variation:"secondary",altHover:!0,onClick:y.toggle},{default:o(()=>[t(l,{color:"white"},{default:o(()=>[h(p(s.$t("ACTIONS")),1)]),_:1}),ms]),_:2},1032,["onClick"])]),_:1},8,["sections"]))])):_("",!0)]),default:o(()=>[n("div",gs,[n("div",Is,[n("div",xs,[n("div",Ss,[n("div",ys,[t(x,{data:d.priorityRanges,value:e.severity},null,8,["data","value"]),t(l,{size:"small",color:e.titleColor,class:"flex align-center justify-center"},{default:o(()=>[h(p(e.severityText),1)]),_:1},8,["color"])]),n("div",bs,[n("div",vs,[t(l,{"semi-bold":"",color:e.paragraphColor,size:"medium",class:"issue-detail__card__title flex align-center gap-4px"},{default:o(()=>[n("span",null,p(e.title),1)]),_:1},8,["color"]),t(l,{color:e.paragraphColor},{default:o(()=>[h(" This issue is not active on the default branch ")]),_:1},8,["color"]),a.issue.type==="open_source"?(i(),f(l,{key:0,color:e.paragraphColor},{default:o(()=>[h(p(a.issue.cve_id),1)]),_:1},8,["color"])):_("",!0)])])])])]),e.tldr?(i(),u("div",Cs,[n("div",ks,[t(l,{"semi-bold":"",color:e.titleColor,class:"issue-detail__card__title"},{default:o(()=>[h("TL;DR")]),_:1},8,["color"])]),n("div",ws,[n("div",zs,[n("div",Bs,[a.issue.type==="open_source"&&!a.issue.aikido_cve_analysis?(i(),f(l,{key:0,color:e.paragraphColor,class:"italic issue-detail__card__paragraph"},{default:o(()=>[h(" This is the package maintainer's summary. ")]),_:1},8,["color"])):_("",!0),t(l,{color:e.paragraphColor,class:"issue-detail__card__paragraph ws-break-spaces"},{default:o(()=>[h(p(e.tldr),1)]),_:1},8,["color"])])])])])):_("",!0),e.how_to_fix?(i(),u("div",Ts,[n("div",Fs,[t(l,{"semi-bold":"",color:e.titleColor,class:"issue-detail__card__title"},{default:o(()=>[h("How do I fix it?")]),_:1},8,["color"])]),n("div",Ps,[n("div",Os,[t(l,{color:e.paragraphColor,class:"issue-detail__card__paragraph"},{default:o(()=>[h(p(e.how_to_fix),1)]),_:1},8,["color"])])])])):_("",!0),a.issue.installed_version?(i(),u("div",Ds,[n("div",Ns,[t(l,{"semi-bold":"",color:e.titleColor,class:"issue-detail__card__title"},{default:o(()=>[h("Installed version")]),_:1},8,["color"])]),n("div",Rs,[n("div",Ms,[t(l,{color:e.paragraphColor,class:"issue-detail__card__paragraph"},{default:o(()=>[h(p(a.issue.installed_version),1)]),_:1},8,["color"])])])])):_("",!0),a.issue.installed_version?(i(),u("div",Ls,[n("div",Us,[t(l,{"semi-bold":"",color:e.titleColor,class:"issue-detail__card__title"},{default:o(()=>[h("Patched versions")]),_:1},8,["color"])]),n("div",As,[n("div",Es,[a.issue.patched_versions.length>0?(i(),f(l,{key:0,color:e.paragraphColor,class:"issue-detail__card__paragraph"},{default:o(()=>[h(p(a.issue.patched_versions.join(", ")),1)]),_:1},8,["color"])):(i(),f(l,{key:1,color:e.paragraphColor,class:"issue-detail__card__paragraph"},{default:o(()=>[h("No patch version available yet")]),_:1},8,["color"]))])])])):_("",!0),n("div",qs,[n("div",Hs,[t(l,{"semi-bold":"",color:e.titleColor,class:"issue-detail__card__title"},{default:o(()=>[h("Location")]),_:1},8,["color"])]),n("div",js,[a.issue.type=="sast"||a.issue.type=="leaked_secret"?(i(),u("div",Gs,[t(l,{color:e.paragraphColor},{default:o(()=>[h(p(e.fileAndLineNumber),1)]),_:1},8,["color"]),a.issue.snippet.trim()!=""&&!a.issue.snippet.startsWith("SNIPPETHASH_")?(i(),f(b,{key:0,class:"mt-8px"},{default:o(()=>[h(p(a.issue.snippet),1)]),_:1})):_("",!0),a.issue.reference_url?(i(),f(C,{key:1,href:a.issue.reference_url,target:"_blank",class:"mt-8px block leading-18px text--semi"},{default:o(()=>[h(" View commit "),Vs]),_:1},8,["href"])):_("",!0)])):_("",!0),a.issue.type=="open_source"||a.issue.type=="malware"?(i(),u("div",Xs,[a.issue.container_image_name?(i(),f(l,{key:0,color:e.paragraphColor},{default:o(()=>[h("Image: "+p(a.issue.container_image_name),1)]),_:1},8,["color"])):_("",!0),t(l,{color:e.paragraphColor},{default:o(()=>[h("Path: "+p(a.issue.target_path),1)]),_:1},8,["color"])])):_("",!0)])]),e.appliedScoreReasons.length>0?(i(),u("div",Js,[n("div",$s,[t(l,{"semi-bold":"",color:e.titleColor,class:"issue-detail__card__title"},{default:o(()=>[h("How did we score this issue?")]),_:1},8,["color"])]),n("div",Qs,[n("div",Ws,[n("ul",{class:B(["list-disc pl-8px flex flex-column gap-4px",e.paragraphColor])},[(i(!0),u(z,null,O(e.appliedScoreReasons,(y,I)=>(i(),u("li",{key:`sr_${I}`},[t(l,{color:e.paragraphColor},{default:o(()=>[h(p(y.rule_info),1)]),_:2},1032,["color"])]))),128))],2)])])])):_("",!0)]),d.showSnoozeIssueFlow?(i(),f(v,{key:0,onSnoozed:e.onIssueSnoozed,onCancel:e.closeSnoozedIssueFlow,ciIssue:a.issue},null,8,["onSnoozed","onCancel","ciIssue"])):_("",!0)]),_:1},8,["showSidebar","onUpdate:showSidebar","itemsList","selectedItem","onPreviousClick","onNextClick","hideFooter"])}const Zs=k(ds,[["render",Ys]]),Ks={components:{BaseConfirmModal:re,BaseIcon:D,BaseParagraph:F,BasePill:J,XTooltip:le},props:{prInfo:{type:Object,required:!0},isManualScan:{type:Boolean,default:!1}},computed:{severityVariation(){switch(this.prInfo.from_severity.toLowerCase()){case"low":return"green";case"medium":return"blue";case"high":return"orange";case"critical":default:return"red"}},severityTitle(){switch(this.prInfo.from_severity.toLowerCase()){case"low":return"Low";case"medium":return"Medium";case"high":return"High";case"critical":default:return"Critical"}},isImageScan(){return this.prInfo.is_image_scan===!0}}},et={class:"flex flex-column gap-16px w-full"},st={key:0,class:"p-4px flex align-center gap-8px text-center w-full"},tt=n("span",{class:"text--semi"},"Retaining issues even if they are present in the base branch",-1),it={key:1,class:"p-4px flex align-center gap-8px text-center w-full"},nt=n("span",{class:"text--semi"},"Scan failure for minimum severity",-1),ot={key:2,class:"p-4px flex align-center gap-8px text-center w-full"},at=n("span",{class:"text--semi"},"Dependency Scan",-1),rt={key:3,class:"p-4px flex align-center gap-8px text-center w-full"},lt=n("span",{class:"text--semi"},"SAST Scan",-1),ct={key:4,class:"p-4px flex align-center gap-8px text-center w-full"},dt=n("span",{class:"text--semi"},"IaC Scan",-1),ut={class:"ml-auto flex gap-8px"},_t={key:5,class:"p-4px flex align-center gap-8px text-center w-full"},ht=n("span",{class:"text--semi"},"Secrets Scan",-1),ft={key:6,class:"p-4px flex align-center gap-8px text-center w-full"},pt=n("span",{class:"text--semi"},"Malware Scan",-1);function mt(s,r,a,S,d,e){const l=c("BaseIcon"),m=c("BaseParagraph"),g=c("BasePill"),x=c("XTooltip"),b=c("BaseConfirmModal");return i(),f(b,{width:600,headerText:"Scanning Configuration",title:"Information on Scanning Configuration",description:"This shows the scanning configuration while the scan was active.",buttonSubmitText:"All Clear!",onSubmit:r[0]||(r[0]=C=>s.$emit("close")),hideSecondaryButton:!0,onClose:r[1]||(r[1]=C=>s.$emit("close"))},{default:o(()=>[n("div",et,[s.$featureflags.always_show_all_findings_for_ci?(i(),u("div",st,[t(l,{class:"h-12px",icon:"icon-information",size:12}),t(m,{size:"medium"},{default:o(()=>[tt]),_:1}),t(g,{variation:"orange",title:"ON",class:"ml-auto"})])):_("",!0),a.isManualScan?_("",!0):(i(),u("div",it,[t(l,{class:"h-12px",icon:"icon-gh_branch",size:12}),t(m,{size:"medium"},{default:o(()=>[nt]),_:1}),t(g,{variation:e.severityVariation,title:e.severityTitle,class:"ml-auto"},null,8,["variation","title"])])),e.isImageScan?_("",!0):(i(),u("div",ot,[t(l,{class:"h-12px",icon:"icon-box",size:12}),t(m,{size:"medium"},{default:o(()=>[at]),_:1}),t(g,{variation:a.prInfo.fail_on_dependency_scan?"green":"gray-fill",title:a.prInfo.fail_on_dependency_scan?"ON":"OFF",class:"ml-auto"},null,8,["variation","title"])])),e.isImageScan?_("",!0):(i(),u("div",rt,[t(l,{class:"h-12px",icon:"icon-code",size:12}),t(m,{size:"medium"},{default:o(()=>[lt]),_:1}),t(g,{variation:a.prInfo.fail_on_sast_scan?"green":"gray-fill",title:a.prInfo.fail_on_sast_scan?"ON":"OFF",class:"ml-auto"},null,8,["variation","title"])])),e.isImageScan?_("",!0):(i(),u("div",ct,[t(l,{class:"h-12px",icon:"icon-IasC",size:12}),t(m,{size:"medium"},{default:o(()=>[dt]),_:1}),n("div",ut,[a.prInfo.fail_on_iac_scan&&a.prInfo.no_iac_files_changed?(i(),f(g,{key:0,variation:"gray-fill",title:"Skipped"},{default:o(()=>[t(x,null,{default:o(()=>[h("No IaC files changed")]),_:1})]),_:1})):_("",!0),t(g,{variation:a.prInfo.fail_on_iac_scan?"green":"gray-fill",title:a.prInfo.fail_on_iac_scan?"ON":"OFF"},null,8,["variation","title"])])])),e.isImageScan?_("",!0):(i(),u("div",_t,[t(l,{class:"h-12px",icon:"icon-secrets",size:12}),t(m,{size:"medium"},{default:o(()=>[ht]),_:1}),t(g,{variation:a.prInfo.fail_on_secrets_scan?"green":"gray-fill",title:a.prInfo.fail_on_secrets_scan?"ON":"OFF",class:"ml-auto"},null,8,["variation","title"])])),e.isImageScan?_("",!0):(i(),u("div",ft,[t(l,{class:"h-12px",icon:"icon-critical",size:12}),t(m,{size:"medium"},{default:o(()=>[pt]),_:1}),t(g,{variation:a.prInfo.fail_on_malware_scan?"green":"gray-fill",title:a.prInfo.fail_on_malware_scan?"ON":"OFF",class:"ml-auto"},null,8,["variation","title"])]))])]),_:1})}const gt=k(Ks,[["render",mt]]),It={},xt={width:"212",height:"64",viewBox:"0 0 212 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},St=ce('<rect x="0.280457" width="211.439" height="63.881" rx="7.41053" fill="#F7F6FE"></rect><g filter="url(#filter0_d_17241_14324)"><rect x="7.28046" y="11" width="197.439" height="41.881" rx="5.92842" fill="white" shape-rendering="crispEdges"></rect><rect x="14.691" y="22.3069" width="19.2674" height="19.2674" rx="2.96421" fill="#6551F3"></rect><path fill-rule="evenodd" clip-rule="evenodd" d="M22.5836 26.8342L23.5836 27.84L23.4435 28.1288C23.2271 28.575 23.1055 29.0765 23.1055 29.6079C23.1055 31.4742 24.6098 32.9872 26.4655 32.9872H26.9135V33.8882H26.4655C24.115 33.8882 22.2095 31.9719 22.2095 29.6079C22.2095 29.0521 22.3151 28.5201 22.5074 28.032L22.3965 27.9204C21.0734 28.6424 20.1763 30.0513 20.1763 31.6701C20.1763 34.0245 22.074 35.9332 24.415 35.9332C26.1334 35.9332 27.6139 34.9048 28.2794 33.4247L28.464 33.0142L29.2803 33.3855L29.0957 33.796C28.2905 35.5867 26.4981 36.8342 24.415 36.8342C21.5792 36.8342 19.2803 34.5222 19.2803 31.6701C19.2803 29.5751 20.5207 27.7725 22.3013 26.9626L22.5836 26.8342Z" fill="white"></path><rect x="41.3689" y="24.53" width="97.8189" height="5.18737" fill="#F5F5F6"></rect><rect x="41.3689" y="34.1638" width="44.3111" height="5.18737" fill="#F5F5F6"></rect></g><defs><filter id="filter0_d_17241_14324" x="5.79835" y="9.51789" width="203.368" height="47.8095" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"></feColorMatrix><feOffset dx="1.48211" dy="1.48211"></feOffset><feGaussianBlur stdDeviation="1.48211"></feGaussianBlur><feComposite in2="hardAlpha" operator="out"></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"></feColorMatrix><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_17241_14324"></feBlend><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_17241_14324" result="shape"></feBlend></filter></defs>',3),yt=[St];function bt(s,r){return i(),u("svg",xt,yt)}const vt=k(It,[["render",bt]]),Ct={props:{prInfo:Object},emits:["onRefreshInfo"],components:{DataTable:N,BaseIcon:D,DataTableHeader:R,DataTableRow:$,LoadingSpinner:de,NightIllustration:vt,OverviewEmptyState:ke},computed:{completedScanTypes(){return this.prInfo.completed_scans??[]},pendingScanTypes(){return this.prInfo.pending_scans??[]},scanTypesInfo(){return{dependency_scan:{label:"Dependencies"},sast_scan:{label:"SAST"},iac_scan:{label:"IaC"},secrets_scan:{label:"Secrets"},malware_scan:{label:"Malware"}}},scanProgress(){let s=[];for(const[r,a]of Object.entries(this.scanTypesInfo)){const S=this.getStatusForScanType(r);S!==null&&s.push({label:a.label,status:S})}return s}},methods:{getStatusForScanType(s){return this.completedScanTypes.includes(s)?"completed":this.pendingScanTypes.includes(s)?"pending":null}}},kt={colspan:"3"},wt={class:"flex flex-column gap-16px"},zt={class:"flex gap-32px align-center justify-center mt-32px mobile_flex-wrap"},Bt={key:1,class:"bg-surface-green-100 rounded-4px inline-flex w-14px h-14px align-center justify-center"},Tt={key:0,class:"flex justify-center align-center gap-12px"};function Ft(s,r,a,S,d,e){const l=c("DataTableHeader"),m=c("NightIllustration"),g=c("LoadingSpinner"),x=c("BaseIcon"),b=c("BaseParagraph"),C=c("OverviewEmptyState"),v=c("DataTableRow"),w=c("DataTable");return i(),f(w,{class:"data-table--no-header"},{header:o(()=>[t(l,{width:"48px"}),t(l,{width:"auto"}),t(l,{width:"100px"})]),body:o(()=>[t(v,null,{default:o(()=>[n("td",kt,[t(C,{title:"Scan in Progress",description:"Your newly introduced and solved issues will appear here soon.",actionLabel:"Refresh Page",onOnAction:r[0]||(r[0]=y=>s.$emit("onRefreshInfo"))},{subdescription:o(()=>[n("div",wt,[n("div",zt,[(i(!0),u(z,null,O(e.scanProgress,(y,I)=>(i(),u("div",{key:I,class:"flex gap-12px align-center"},[y.status==="pending"?(i(),f(g,{key:0,width:14,height:14})):(i(),u("div",Bt,[t(x,{icon:"icon-check",color:"#fff",size:12})])),t(b,{bold:""},{default:o(()=>[h(p(y.label),1)]),_:2},1024)]))),128))]),e.pendingScanTypes.length===0?(i(),u("div",Tt,[t(g,{width:14,height:14}),t(b,null,{default:o(()=>[h("Processing results...")]),_:1})])):_("",!0)])]),default:o(()=>[t(m)]),_:1})])]),_:1})]),_:1})}const Pt=k(Ct,[["render",Ft]]),j=s=>new Promise(r=>setTimeout(r,s)),Ot={components:{PageHeader:_e,DataTable:N,DataTableHeader:R,BasePill:J,PullRequestDiffsTable:He,DiffsSidebar:Zs,QueueSidebar:Ce,BaseIcon:D,BaseParagraph:F,BaseButton:X,ScanConfigurationInfoModal:gt,PendingScanEmptyState:Pt},data(){return{scanId:this.$route.params.scanId,prInfo:null,loaded:!1,selectedIntroducedIssue:null,selectedFixedIssue:null,showScanConfigurationModal:!1}},created(){this.loadPrInfo()},watch:{"$route.query.sidebarIssue"(){this.$route.query.sidebarIssue||this.hideFixedIssueSidebar()}},computed:{scanHasCompleted(){return this.prInfo.scan_status==="completed"},isManualScan(){return this.$route.name==="diffsPageManual"},title(){return this.prInfo.is_release_gating?"Release gate on commit "+this.prInfo.end_commit_id.substring(0,7):this.prInfo.branch_name},breadcrumbs(){var s;return this.prInfo.is_release_gating?[{label:this.prInfo.repo_name,href:`/repositories/${this.prInfo.repo_id}`},{label:(s=this.prInfo.end_commit_id)==null?void 0:s.substring(0,7)}]:this.isImageScan?[{label:this.prInfo.image_name},{label:this.prInfo.start_commit_id.substring(0,7)}]:[{label:this.prInfo.repo_name,href:`/repositories/${this.prInfo.repo_id}`},{label:this.prInfo.branch_name},{label:this.prInfo.start_commit_id.substring(0,7)}]},amountIssuesSolved(){var s;return((s=this.prInfo.diffs.issues_removed)==null?void 0:s.length)??0},amountIssuesIntroduced(){var s;return((s=this.prInfo.diffs.issues_added)==null?void 0:s.length)??0},prLink(){return this.prInfo.pull_request_url?this.prInfo.pull_request_url:""},diffUrl(){if(!this.prInfo.pull_request_url)return"";const r=this.prInfo.pull_request_url.split("/pull/");if(r.length!=2)return"";const a=r[0],S=this.getShortenedCommitId(this.prInfo.start_commit_id),d=this.getShortenedCommitId(this.prInfo.end_commit_id);return`${a}/compare/${S}..${d}`},isGithubPR(){return this.prInfo.pull_request_url&&this.prInfo.pull_request_url.indexOf("github.com")>-1},isImageScan(){return this.prInfo.is_image_scan===!0},filesInPrChangedAmount(){return this.prInfo.changed_files.length}},methods:{async loadPrInfo(){try{this.prInfo=await ue(this.scanId)}catch{this.$toast.error("Scan not found or it didn't complete yet."),this.$router.push("/queue");return}this.loaded=!0},async handleRefreshPrInfo(){this.$globalLoadingIndicator.show();try{await this.loadPrInfo()}finally{this.$globalLoadingIndicator.hide()}},async selectIntroducedIssue(s){this.hideFixedIssueSidebar(),await j(0),this.selectedIntroducedIssue=s},hideIntroducedIssueSidebar(){this.selectedIntroducedIssue=null},async selectFixedIssue(s){if(!s.related_issue_ids){this.selectIntroducedIssue(s);return}this.hideIntroducedIssueSidebar(),await j(0),this.selectedFixedIssue=s,this.$router.replace({path:this.$route.path,query:{...this.$route.query,sidebarIssue:s.related_issue_ids.grouped_issue_id,sidebarSingleIssueFilter:s.related_issue_ids.single_issue_id}})},hideFixedIssueSidebar(){this.$route.query.sidebarIssue&&this.$router.replace({path:this.$route.path,query:{...this.$route.query,sidebarIssue:void 0}}),this.selectedFixedIssue=null},async onIssueSnoozed(){this.loadPrInfo(),this.hideIntroducedIssueSidebar(),H(this.scanId)},async onIssueUnsnoozed(){await this.loadPrInfo(),this.selectedIntroducedIssue.snoozed=!1,this.selectedIntroducedIssue.snoozed_info=null,H(this.scanId)},getShortenedCommitId(s){return s.substring(0,7)},openFilesChangedModal(){this.$modal.show("FilesChangedModal",{changedFiles:this.prInfo.changed_files})}}},Dt={class:"flex gap-8px"},Nt={class:"flex gap-16px align-center"},Rt={class:"text--semi-bold"},Mt={class:"page-content text-gray-900"},Lt={class:"mb-16px flex gap-32px"},Ut={key:0,class:"flex gap-8px align-center"},At=["href"],Et={key:1,class:"flex gap-2px align-center"},qt={key:2,class:"flex gap-2px align-center"},Ht=["href"],jt={class:"flex gap-8px align-center"},Gt=n("div",null,"Scanning Configuration",-1),Vt={ref:"container",class:"flex flex-column"};function Xt(s,r,a,S,d,e){const l=c("XPreloader"),m=c("BasePill"),g=c("BaseIcon"),x=c("BaseParagraph"),b=c("PageHeader"),C=c("BaseButton"),v=c("DataTableHeader"),w=c("DataTable"),y=c("PendingScanEmptyState"),I=c("PullRequestDiffsTable"),P=c("DiffsSidebar"),M=c("QueueSidebar"),Q=c("ScanConfigurationInfoModal");return d.loaded?(i(),u(z,{key:1},[t(b,{breadcrumbs:e.breadcrumbs,title:e.title},{subTitle:o(()=>[n("div",Dt,[t(m,{title:s.$t("X_ISSUES_SOLVED",e.amountIssuesSolved),variation:"green"},null,8,["title"]),t(m,{title:s.$t("X_ISSUES_INTRODUCED",e.amountIssuesIntroduced),variation:"red"},null,8,["title"]),e.filesInPrChangedAmount>0?(i(),f(m,{key:0,title:s.$t("X_FILES_CHANGED",e.filesInPrChangedAmount),variation:"gray-fill",class:"cursor-pointer",onClick:e.openFilesChangedModal},null,8,["title","onClick"])):_("",!0)])]),rightContent:o(()=>[!e.isManualScan&&e.scanHasCompleted?(i(),u("div",{key:0,class:B(["border-1 p-16px rounded-16px w-200px",{"bg-green-lightest border-surface-green-100":!d.prInfo.has_scan_failed,"bg-red-lightest border-surface-red-100":d.prInfo.has_scan_failed}])},[n("div",Nt,[t(g,{icon:"icon-shield_check",size:12,class:B(["icon-circle-28",{"bg-surface-green-60 text-surface-green-140":!d.prInfo.has_scan_failed,"bg-surface-red-60 text-surface-red-140":d.prInfo.has_scan_failed}])},null,8,["class"]),t(x,{color:d.prInfo.has_scan_failed?"danger":"success",size:"medium"},{default:o(()=>[n("span",Rt,"CI Gate "+p(d.prInfo.has_scan_failed?"Failed":"Passed"),1)]),_:1},8,["color"])])],2)):_("",!0)]),_:1},8,["breadcrumbs","title"]),n("div",Mt,[n("div",Lt,[d.prInfo.is_release_gating?_("",!0):(i(),u("div",Ut,[t(g,{icon:e.isGithubPR?"icon-github":"icon-gh_branch",size:18},null,8,["icon"]),e.prLink?(i(),u("a",{key:1,href:e.prLink,class:"link",target:"_blank"},p(d.prInfo.branch_name),9,At)):(i(),f(x,{key:0,semiBold:!0},{default:o(()=>[h(p(d.prInfo.branch_name||d.prInfo.image_name),1)]),_:1}))])),d.prInfo.is_release_gating?(i(),u("div",Et,[t(x,{semiBold:!0},{default:o(()=>[h("Commit: "+p(e.getShortenedCommitId(d.prInfo.end_commit_id)),1)]),_:1})])):(i(),u("div",qt,[t(x,{semiBold:!0},{default:o(()=>[h("Commits:")]),_:1}),e.diffUrl?(i(),u("a",{key:1,href:e.diffUrl,class:"link",target:"_blank"},p(e.getShortenedCommitId(d.prInfo.start_commit_id))+" vs. "+p(e.getShortenedCommitId(d.prInfo.end_commit_id)),9,Ht)):(i(),f(x,{key:0,semiBold:!0},{default:o(()=>[h(p(e.getShortenedCommitId(d.prInfo.start_commit_id))+" vs. "+p(e.getShortenedCommitId(d.prInfo.end_commit_id)),1)]),_:1}))])),t(C,{variation:"filter",class:"ml-auto",onClicked:r[0]||(r[0]=T=>d.showScanConfigurationModal=!0)},{default:o(()=>[n("div",jt,[t(g,{icon:"icon-information",size:12,class:"h-16px"}),Gt])]),_:1})]),n("div",Vt,[t(w,{class:"rounded-b-none"},{header:o(()=>[t(v,{width:"48px",alignment:"center"},{default:o(()=>[h("Type")]),_:1}),t(v,{width:"auto"},{default:o(()=>[h("Name")]),_:1}),t(v,{width:"100px"},{default:o(()=>[h("Severity")]),_:1})]),_:1}),e.scanHasCompleted?_("",!0):(i(),f(y,{key:0,"pr-info":d.prInfo,onOnRefreshInfo:e.handleRefreshPrInfo},null,8,["pr-info","onOnRefreshInfo"])),e.scanHasCompleted?(i(),f(I,{key:1,class:"data-table--rounded-none",title:"Issues Introduced",emptyState:"No newly introduced issues",issues:d.prInfo.diffs.issues_added,selectedIssue:d.selectedIntroducedIssue,onIssueClicked:e.selectIntroducedIssue,status:"new"},null,8,["issues","selectedIssue","onIssueClicked"])):_("",!0),!d.prInfo.is_release_gating&&e.scanHasCompleted?(i(),f(I,{key:2,class:"data-table--rounded-none data-table--rounded-b",title:"Issues Solved",emptyState:"No solved issues",issues:d.prInfo.diffs.issues_removed,selectedIssue:d.selectedFixedIssue||d.selectedIntroducedIssue,onIssueClicked:e.selectFixedIssue,status:"closed"},null,8,["issues","selectedIssue","onIssueClicked"])):_("",!0)],512)]),t(P,{issue:d.selectedIntroducedIssue,"onUpdate:issue":r[1]||(r[1]=T=>d.selectedIntroducedIssue=T),onClose:r[2]||(r[2]=T=>e.selectIntroducedIssue(null)),onIssueSnoozed:e.onIssueSnoozed,onIssueUnsnoozed:e.onIssueUnsnoozed,issues:d.prInfo.diffs.issues_added??[]},null,8,["issue","onIssueSnoozed","onIssueUnsnoozed","issues"]),t(M),d.showScanConfigurationModal?(i(),f(Q,{key:0,prInfo:d.prInfo,isManualScan:e.isManualScan,onClose:r[3]||(r[3]=T=>d.showScanConfigurationModal=!1)},null,8,["prInfo","isManualScan"])):_("",!0)],64)):(i(),f(l,{key:0,class:"supercenter",theme:"transparent"}))}const Ui=k(Ot,[["render",Xt]]);export{Ui as default};
