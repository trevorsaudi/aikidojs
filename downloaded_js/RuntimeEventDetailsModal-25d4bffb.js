import{B as q}from"./BaseCodeBlock-cec75629.js";import{_ as C,a2 as S,B as w,H as P,au as b,gt as D,bC as M,r as h,q as s,k as T,w as t,o as a,s as n,u,n as o,m as l,F as v,p as d,t as k,S as z}from"./index-13ff96f4.js";import{a as H,g as N}from"./event-11956904.js";import{s as I}from"./string-814c5ffd.js";const V={components:{XTooltip:S,BaseParagraph:w,BaseHeading:P,BaseCodeBlock:q,BaseConfirmModal:b},props:{event:{type:Object,required:!0}},computed:{title(){return H(this.event)},tryDecodePayload(){if(!this.event.attack)return"";try{return JSON.parse(this.event.attack.payload)}catch{return this.event.attack.payload}},icon(){const c=N(this.event);return c.name=="information"?"":`icon-${c.name} ${c.color}`}},methods:{getDateString(c){return"On "+D(M(c.received_at),"yyyy/MM/dd 'at' HH:mm:ss")},highlightMetadataValue(c){let m=this.tryDecodePayload;return typeof m!="string"&&(m=JSON.stringify(m)),I(c,m).map(e=>({value:e,highlight:e.toLowerCase()===m.toLowerCase()}))}}},L={class:"flex flex-column gap-16px"},O={key:0},U={key:1},R={class:"text-color-danger"},A={key:2},X={key:3},j={key:5},F={key:0},J={key:1},E={key:2},G={key:0,style:{"line-height":"14px"}},K=["src","alt"],Q={key:0},W={key:3},Y={key:0},Z={class:"list-disc pl-8px text-14px"},p=o("hr",{class:"divider my-16px"},null,-1),$={class:"list-disc pl-8px text-14px"};function ee(c,m,e,te,ae,f){const i=h("BaseParagraph"),r=h("BaseCodeBlock"),g=h("XTooltip"),x=h("BaseConfirmModal");return s(),T(x,{width:800,title:f.title,buttonSubmitText:"Got It",hideSecondaryButton:!0,onSubmit:m[0]||(m[0]=_=>c.$emit("close")),onClose:m[1]||(m[1]=_=>c.$emit("close"))},{default:t(()=>[a(i,{color:"subdued",class:"mb-12px"},{default:t(()=>[n(u(f.getDateString(e.event)),1)]),_:1}),o("div",L,[e.event.attack?(s(),l(v,{key:0},[e.event.attack.source&&e.event.attack.path?(s(),l("div",O,[a(i,{semi:!0},{default:t(()=>[n("Source")]),_:1}),a(r,null,{default:t(()=>[n(u(e.event.attack.source)+u(e.event.attack.path),1)]),_:1})])):d("",!0),e.event.attack.payload?(s(),l("div",U,[a(i,{semi:!0},{default:t(()=>[n("Payload")]),_:1}),a(r,null,{default:t(()=>[o("span",R,u(f.tryDecodePayload),1)]),_:1})])):d("",!0),e.event.attack.operation?(s(),l("div",A,[a(i,{semi:!0},{default:t(()=>[n("Operation")]),_:1}),a(r,null,{default:t(()=>[n(u(e.event.attack.operation),1)]),_:1})])):e.event.attack.module?(s(),l("div",X,[a(i,{semi:!0},{default:t(()=>[n("Module")]),_:1}),a(r,null,{default:t(()=>[n(u(e.event.attack.module),1)]),_:1})])):d("",!0),e.event.attack.metadata?(s(!0),l(v,{key:4},k(e.event.attack.metadata,(_,B)=>(s(),l("div",null,[a(i,{semi:!0},{default:t(()=>[n(u(B),1)]),_:2},1024),a(r,null,{default:t(()=>[(s(!0),l(v,null,k(f.highlightMetadataValue(_),y=>(s(),l("span",null,[o("span",{class:z({"text-color-danger":y.highlight})},u(y.value),3)]))),256))]),_:2},1024)]))),256)):d("",!0),e.event.attack.stack?(s(),l("div",j,[a(i,{semi:!0},{default:t(()=>[n("Stacktrace")]),_:1}),a(r,null,{default:t(()=>[n(u(e.event.attack.stack),1)]),_:1})])):d("",!0)],64)):d("",!0),e.event.request?(s(),l(v,{key:1},[e.event.request.url?(s(),l("div",F,[a(i,{semi:!0},{default:t(()=>[n("URL")]),_:1}),a(r,null,{default:t(()=>[n(u(e.event.request.url),1)]),_:1})])):d("",!0),e.event.request.method?(s(),l("div",J,[a(i,{semi:!0},{default:t(()=>[n("HTTP Method")]),_:1}),a(r,null,{default:t(()=>[n(u(e.event.request.method),1)]),_:1})])):d("",!0),e.event.request.ip_address?(s(),l("div",E,[a(i,{semi:!0},{default:t(()=>[n("IP Address")]),_:1}),a(r,{class:"flex align-center justify-between gap-8px"},{default:t(()=>[o("span",null,u(e.event.request.ip_address),1),e.event.request.location?(s(),l("span",G,[o("img",{class:"rounded-2px valign-top",src:`https://aikido-production-staticfiles-public.s3.eu-west-1.amazonaws.com/flags/${e.event.request.location.country.iso_code.toLowerCase()}.svg`,height:"14",alt:e.event.request.location.country.name},null,8,K),a(g,null,{default:t(()=>[e.event.request.location.country?(s(),l("span",Q,u(e.event.request.location.country.name),1)):d("",!0)]),_:1})])):d("",!0)]),_:1})])):d("",!0),e.event.request.user_agent?(s(),l("div",W,[a(i,{semi:!0},{default:t(()=>[n("User Agent")]),_:1}),a(r,null,{default:t(()=>[n(u(e.event.request.user_agent),1)]),_:1})])):d("",!0)],64)):d("",!0),e.event.user?(s(),l(v,{key:2},[o("div",null,[a(i,{semi:!0},{default:t(()=>[n("User ID")]),_:1}),a(r,null,{default:t(()=>[n(u(e.event.user.id),1)]),_:1})]),e.event.user.name?(s(),l("div",Y,[a(i,{semi:!0},{default:t(()=>[n("User Name")]),_:1}),a(r,null,{default:t(()=>[n(u(e.event.user.name),1)]),_:1})])):d("",!0)],64)):d("",!0),e.event.instance?(s(),l(v,{key:3},[o("div",null,[a(i,{size:"medium"},{default:t(()=>[n("Received from server with")]),_:1}),o("ul",Z,[o("li",null,[a(i,{size:"medium"},{default:t(()=>[n("Hostname: "+u(e.event.instance.hostname),1)]),_:1})]),o("li",null,[a(i,{size:"medium"},{default:t(()=>[n("IP: "+u(e.event.instance.ip_address),1)]),_:1})])])]),(s(!0),l(v,null,k(e.event.subEvents||[],_=>(s(),l("div",null,[p,a(i,{color:"subdued",class:"mb-12px"},{default:t(()=>[n(u(f.getDateString(_)),1)]),_:2},1024),a(i,{size:"medium"},{default:t(()=>[n("Received from server with")]),_:1}),o("ul",$,[o("li",null,[a(i,{size:"medium"},{default:t(()=>[n("Hostname: "+u(_.instance.hostname),1)]),_:2},1024)]),o("li",null,[a(i,{size:"medium"},{default:t(()=>[n("IP: "+u(_.instance.ip_address),1)]),_:2},1024)])])]))),256))],64)):d("",!0)])]),_:1},8,["title"])}const ie=C(V,[["render",ee]]);export{ie as default};
