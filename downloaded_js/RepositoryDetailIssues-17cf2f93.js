import{_ as b,I as G,z as L,a2 as E,al as U,cq as o,an as l,cs as V,cr as F,r as i,m as f,n as a,o as s,k as _,w as u,p as S,c7 as R,F as B,q as d,U as O,aQ as P,s as g,cu as A}from"./index-13ff96f4.js";import{u as D}from"./useInfiniteScroll-47c60c9e.js";import{s as M}from"./slaEmptyState-e877fc05.js";import{Q as N}from"./QueueTable-de6aabd1.js";import{Q as z}from"./QueueSidebar-47492277.js";import{Q as X}from"./QueueTypeFilter-e6985ed4.js";import{Q as j}from"./QueueQuickFilter-70881bd4.js";import{F as H}from"./FilterButton-bb5393a7.js";import{F as W}from"./FeedActionsMenu-6d8ea3a2.js";import{S as J}from"./SlaEmptyState-a5a9e243.js";import"./dateFns-a344cb79.js";import"./index-b87db690.js";import"./DataTableCell-51c0104f.js";import"./IssueGroupSeverityColumn-7631c77a.js";import"./ActionMenu-3e4470bf.js";import"./SidebarActionMenu-1bf6804b.js";import"./CreateAutoFixProgressFlow-8111d22c.js";import"./RadioButtonList-1d4cdaad.js";import"./EnableIntegrationModal-48b01f56.js";import"./focusModePreference-150f170e.js";import"./TableListHeader-e50d01d1.js";import"./DataTable-e31a825a.js";import"./BaseRadioInput-a7ac3557.js";import"./BaseLabel-a1c0ca00.js";import"./AIText-891d4f7b.js";import"./InputCheckbox-81cb3ca6.js";import"./BreakSlashes-925eef0e.js";import"./UnignoreIssue-5dff8957.js";import"./CreateTicketModal-c14deeb1.js";import"./ManualInputSearchDropdown-6a7ece3e.js";import"./InputSearchDropdown-02988f6b.js";import"./repoName-872812ed.js";import"./taskTrackerNaming-55adac3e.js";import"./taskTrackerIcon-504ea566.js";import"./autofixable-c6560249.js";import"./autofixSastIssues-779ec5b4.js";import"./lock-files-cdbb050f.js";import"./BaseCodeBlock-cec75629.js";import"./string-814c5ffd.js";import"./ButtonMultiOption-12e505fb.js";import"./transform-c376ec3f.js";import"./linear-efb37b7f.js";import"./arc-12e4470a.js";import"./BaseForm-4c6fa06f.js";import"./XTabs-d492da26.js";import"./BaseCard-471d3203.js";import"./AccordionContainer-09dc0ed4.js";import"./trycatch-83445d5b.js";import"./licenses-6ab38515.js";import"./BaseStatusLabel-0ccd2806.js";import"./DataTableSeverityIndicator-48ffb8dc.js";import"./IssueGroupTypeColumn-03f014b0.js";import"./BracesIcon-0a8568f4.js";import"./BoxIcon-9908469f.js";import"./StackedAvatars-4925baeb.js";import"./ScmSecurity-27bd32ff.js";import"./languages-12749071.js";import"./InputMultiSelect-21584437.js";import"./DateRangePicker-89d26e9f.js";import"./export-427c6d83.js";import"./OverviewEmptyState-c8440b9c.js";import"./GenericIllustration-4aca88e5.js";const K={components:{QueueTable:N,QueueSidebar:z,InputSearch:G,QueueTypeFilter:X,QueueQuickFilter:j,InputSwitch:L,FilterButton:H,FeedActionsMenu:W,XTooltip:E,LoadingSpinner:U,SlaEmptyState:J},props:{repository:{type:Object,required:!0}},data(){return o("include_containers_filter",localStorage.getItem("repodetail.excludeContainers")!=="true"),{isLoading:!0,showLoadingState:!0,scanningProgress:null,quickFilter:o("filter",void 0),attackSurfaceFilter:o("attack_surface_filter",void 0),relatedTypeFilter:o("type_filter",void 0),languageFilter:o("language_filter",void 0),severityFilter:o("severity_filter",void 0),searchTerm:o("search",""),isBookmarked:!1,tab:"issues",includeContainers:o("include_containers_filter",localStorage.getItem("repodetail.excludeContainers")!=="true")}},setup(){const{records:r,isLoading:n,fetch:c,reset:p,refresh:e,watchElement:t,isFuzzySearch:h}=D(A,25);return{records:r,isFetchingRecords:n,fetchGroupedIssues:c,resetGroupedIssues:p,refreshGroupedIssues:e,watchElement:t,isFuzzySearch:h}},created(){l.on("dependencyScanFinished",this.reloadGroupedIssues),l.on("issueUpdated",this.handleIssueUpdated)},beforeUnmount(){l.off("dependencyScanFinished",this.reloadGroupedIssues),l.off("issueUpdated",this.handleIssueUpdated)},async mounted(){this.isLoading=!0,await this.fetchGroupedIssues(this.filters),this.isLoading=!1,await this.$nextTick(),this.watchElement(this.$refs.tableBottom,{threshold:0,rootMargin:"400px"})},watch:{async repositoryId(){this.repositoryId&&(this.isLoading=!0,await Promise.all([this.reloadGroupedIssues()]),this.isLoading=!1)},excludeContainers(){localStorage.setItem("repodetail.excludeContainers",this.excludeContainers),this.reloadGroupedIssues()}},computed:{excludeContainers(){return!this.includeContainers},repositoryId(){return this.$route.params.id},showEmptyState(){return!(this.isLoading||this.isFetchingRecords||this.groupedIssues.length>0)},hasActiveFilter(){return!!(this.searchTerm||this.relatedTypeFilter||this.quickFilter||this.attackSurfaceFilter||this.languageFilter||this.severityFilter||this.repository.has_connected_images&&this.excludeContainers)},filters(){return{filter_repo_id:this.repositoryId,search_term:this.searchTerm,quick_filter:this.quickFilter,filter_attack_surface:this.attackSurfaceFilter,filter_language:this.languageFilter,issue_type_filter:this.relatedTypeFilter,exclude_containers:this.excludeContainers,filter_severity:this.severityFilter}},groupedIssues(){return this.quickFilter=="ignored"?this.records.map(r=>({...r,enhanced_status:"ignored"})):this.quickFilter=="closed"?this.records.map(r=>({...r,enhanced_status:"closed"})):this.records},shouldUseSlaEmptyState(){return M(this.quickFilter)}},methods:{async onItemSelected(r){V.replace({path:this.$route.path,query:{...this.$route.query,sidebarIssue:r.id}})},reloadGroupedIssues(){return this.resetGroupedIssues(this.filters)},onQueueTypeFilterSelected(r){this.relatedTypeFilter=r.relatedTypeFilter||void 0,this.reloadGroupedIssues()},onQueueQuickFilterSelected(r){l.emit("request-queue-sidebar-close"),this.quickFilter=r.quickFilter||void 0,this.attackSurfaceFilter=r.attackSurfaceFilter||void 0,this.languageFilter=r.languageFilter||void 0,this.severityFilter=r.severityFilter||void 0,this.reloadGroupedIssues()},async handleIssueUpdated(){await this.refreshGroupedIssues(this.filters)},async handleRefresh(){this.$globalLoadingIndicator.show();try{await this.refreshGroupedIssues(this.filters)}finally{this.$globalLoadingIndicator.hide()}},onSearchTermChanged(){this.reloadGroupedIssues(),F({search:this.searchTerm})},onIncludeContainerIssuesChange(){F({includeContainers:this.includeContainers})}}},Y={class:"flex justify-between align-center mb-16px"},Z={class:"flex gap-8px align-center"},$=a("span",{class:"input-switch__label input-switch__label--right sidebar-open_hide-width max-w-150px ws-nowrap"},[a("span",null,"Show container issues")],-1),ee={ref:"tableBottom"},te={key:0,class:"data-table__bottom"},re=a("hr",null,null,-1),ie={key:0,class:"flex align-center gap-8px"},se=a("hr",null,null,-1);function oe(r,n,c,p,e,t){const h=i("InputSearch"),I=i("QueueTypeFilter"),k=i("QueueQuickFilter"),w=i("XTooltip"),C=i("InputSwitch"),T=i("FeedActionsMenu"),Q=i("SlaEmptyState"),v=i("QueueTable"),x=i("LoadingSpinner"),y=i("BaseParagraph"),q=i("QueueSidebar");return d(),f(B,null,[a("div",Y,[a("div",Z,[s(h,{modelValue:e.searchTerm,"onUpdate:modelValue":[n[0]||(n[0]=m=>e.searchTerm=m),t.onSearchTermChanged],spacing:"compact"},null,8,["modelValue","onUpdate:modelValue"]),s(I,{onFilterSelected:t.onQueueTypeFilterSelected,"initial-related-type-filter":e.relatedTypeFilter,persistFilterToQueryParams:!0},null,8,["onFilterSelected","initial-related-type-filter"]),s(k,{onFilterSelected:t.onQueueQuickFilterSelected,"initial-filter":e.quickFilter,"initial-attack-surface-filter":e.attackSurfaceFilter,"initial-language-filter":e.languageFilter,"initial-severity-filter":e.severityFilter,persistFilterToQueryParams:!0},null,8,["onFilterSelected","initial-filter","initial-attack-surface-filter","initial-language-filter","initial-severity-filter"]),c.repository.has_connected_images?(d(),_(C,{key:0,class:"ml-8px",modelValue:e.includeContainers,"onUpdate:modelValue":[n[1]||(n[1]=m=>e.includeContainers=m),t.onIncludeContainerIssuesChange]},{default:u(()=>[$,O(s(w,null,{default:u(()=>[g("Show container issues")]),_:1},512),[[P,r.$route.query.sidebarIssue]])]),_:1},8,["modelValue","onUpdate:modelValue"])):S("",!0)]),s(T,{repository:c.repository,initialSeverityFilter:e.severityFilter,onRefresh:t.handleRefresh},null,8,["repository","initialSeverityFilter","onRefresh"])]),s(v,{onItemClicked:t.onItemSelected,onSearchTermChanged:t.reloadGroupedIssues,groupedIssues:t.groupedIssues,isLoading:e.isLoading,filterRepoId:t.repositoryId,quickFilter:e.quickFilter,showEmptyState:t.showEmptyState,hasActiveFilter:t.hasActiveFilter},R({_:2},[t.shouldUseSlaEmptyState?{name:"emptyState",fn:u(()=>[s(Q)]),key:"0"}:void 0]),1032,["onItemClicked","onSearchTermChanged","groupedIssues","isLoading","filterRepoId","quickFilter","showEmptyState","hasActiveFilter"]),a("div",ee,[!e.isLoading&&!t.showEmptyState?(d(),f("div",te,[re,p.isFetchingRecords?(d(),f("div",ie,[s(x,{color:"#6551F3",backgroundColor:"#E0DCFD"}),s(y,{color:"gray"},{default:u(()=>[g("Hang on, we're fetching more issues for you")]),_:1})])):(d(),_(y,{key:1,color:"gray"},{default:u(()=>[g("We have no more issues to show")]),_:1})),se])):S("",!0)],512),s(q,{groupedIssues:t.groupedIssues,filterRepoId:t.repositoryId,showIgnoredOnly:e.quickFilter==="ignored",excludeContainers:t.excludeContainers,showClosedOnly:e.quickFilter==="closed",filterOutOfSla:e.quickFilter==="out_of_sla",filterDueSoon:e.quickFilter==="due_soon",severityFilter:e.severityFilter},null,8,["groupedIssues","filterRepoId","showIgnoredOnly","excludeContainers","showClosedOnly","filterOutOfSla","filterDueSoon","severityFilter"])],64)}const mt=b(K,[["render",oe]]);export{mt as default};
