import{c as t}from"./ScmSecurity-27bd32ff.js";import{_ as a,cr as c,r as l,q as h,k as T,w as s,o as E,s as d,u as F,S as _,n as S}from"./index-13ff96f4.js";import{F as u}from"./FilterButton-bb5393a7.js";import{A as g}from"./ActionMenu-3e4470bf.js";const I={props:{cloud:{type:Object},initialRelatedTypeFilter:String,refreshQueryParams:{type:Boolean,default:!0},persistFilterToQueryParams:{type:Boolean,default:!1}},components:{ActionMenu:g,FilterButton:u},data(){return{relatedTypeFilter:this.initialRelatedTypeFilter,ignoreReasonFilter:this.$route.query.ignore_reason_filter}},emits:["filterSelected"],computed:{label(){return this.relatedTypeFilter?this.$t("QUEUE.QUICK_FILTER.LABEL",{filter:this.$t(`QUEUE.FILTER.LABEL_SHORTHAND.${this.relatedTypeFilter}`)}):"All types"},actions(){return[{title:this.$t("QUEUE.TYPE_FILTER.TITLE"),action:{label:"Clear filter",onClick:()=>this.handleClearFilter()},items:[...this.ignoreReasonFilter?[{label:"Ignore reason",icon:"icon-hidden",onClick:this.handleToggleIgnoreReasonFilter,active:!0}]:[],{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.OPEN_SOURCE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("open_source"),icon:"icon-box",active:this.isActive("open_source")},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.SAST_ISSUES"),onClick:()=>this.handleToggleTypeFilter("sast"),icon:"icon-code",active:this.isActive("sast")},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.IAC_ISSUES"),onClick:()=>this.handleToggleTypeFilter("iac"),icon:"icon-IasC",active:this.isActive("iac")},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.LEAKED_SECRETS"),onClick:()=>this.handleToggleTypeFilter("leaked_secret"),icon:"icon-secrets",active:this.isActive("leaked_secret")},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.SURFACE_MONITORING_ISSUES"),onClick:()=>this.handleToggleTypeFilter("surface_monitoring"),icon:"icon-group",active:this.isActive("surface_monitoring")}]},{divider:!0,items:[{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.CLOUD_CONFIG_ISSUES"),onClick:()=>this.handleToggleTypeFilter("cloud"),icon:"icon-cloud",active:this.isActive("cloud")},{label:this.$t("QUEUE.QUICK_FILTER.ACTIONS.DOCKER"),onClick:()=>this.handleToggleTypeFilter("docker_container"),icon:"icon-container",active:this.isActive("docker_container")},...this.$featureflags.aws_ebs_scanning||this.$featureflags.azure_vm_scanning?[{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.CLOUD_INSTANCE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("cloud_instance"),icon:"icon-cloud-server",active:this.isActive("cloud_instance"),hidden:t()===!1}]:[]]},{divider:!0,items:[{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.MOBILE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("mobile"),icon:"icon-mobile",active:this.isActive("mobile")},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.MALWARE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("malware"),icon:"icon-critical",active:this.isActive("malware")},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.EOL_ISSUES"),onClick:()=>this.handleToggleTypeFilter("eol"),icon:"icon-eol",active:this.isActive("eol")},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.SCM_SECURITY_ISSUES"),onClick:()=>this.handleToggleTypeFilter("scm_security"),icon:"icon-git",active:this.isActive("scm_security"),hidden:t()===!1},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.LICENSE_ISSUES"),onClick:()=>this.handleToggleTypeFilter("license"),icon:"icon-license",active:this.isActive("license"),hidden:!this.$featureflags.licenses_in_feed}]}]},hasFilter(){return!!this.relatedTypeFilter||!!this.ignoreReasonFilter}},methods:{isActive(e){return this.relatedTypeFilter===e},handleClearFilter(){this.relatedTypeFilter=void 0,this.clearIgnoreReasonFilter(),this.emitSelectedFilter()},handleToggleTypeFilter(e){this.relatedTypeFilter===e?this.relatedTypeFilter=void 0:this.relatedTypeFilter=e,this.emitSelectedFilter()},clearIgnoreReasonFilter(){this.ignoreReasonFilter=void 0,this.refreshQueryParams&&this.$router.replace({query:{}})},handleToggleIgnoreReasonFilter(){this.clearIgnoreReasonFilter(),this.emitSelectedFilter()},emitSelectedFilter(){const e={relatedTypeFilter:this.relatedTypeFilter,ignoreReasonFilter:this.ignoreReasonFilter};this.$emit("filterSelected",e),this.persistFilterToQueryParams&&c(e)}}},p=S("i",{class:"icon icon-caret_down icon-12px"},null,-1);function C(e,U,m,y,A,i){const r=l("FilterButton"),n=l("ActionMenu");return h(),T(n,{sections:i.actions,placement:"bottom-start",useBaseIcon:!0},{trigger:s(o=>[E(r,{onClick:o.toggle,class:_({"filter-button--active":i.hasFilter})},{default:s(()=>[d(F(i.label)+" ",1),p]),_:2},1032,["onClick","class"])]),_:1},8,["sections"])}const b=a(I,[["render",C]]);export{b as Q};
