import{_ as D,X as L,I as T,f as F,B as M,an as p,a3 as h,bK as I,Z as U,cu as Q,r,m as w,o as t,w as s,n,k as b,F as A,q as f,p as V,s as u}from"./index-13ff96f4.js";import{g as E}from"./slaSettings-fece48e7.js";import{P as R}from"./PageHeader-46c38a32.js";import{Q as W}from"./QueueTable-de6aabd1.js";import{Q as N}from"./QueueSidebar-47492277.js";import{E as j}from"./EmptyUsersIllustration-1a5638d0.js";import{S as q}from"./SettingsEmptyState-8e8644cd.js";import{a as X}from"./DataTableCell-51c0104f.js";import{P as H}from"./PdfDownloadButton-072addbd.js";import"./dateFns-a344cb79.js";import"./index-b87db690.js";import"./IssueGroupSeverityColumn-7631c77a.js";import"./ActionMenu-3e4470bf.js";import"./SidebarActionMenu-1bf6804b.js";import"./CreateAutoFixProgressFlow-8111d22c.js";import"./RadioButtonList-1d4cdaad.js";import"./EnableIntegrationModal-48b01f56.js";import"./focusModePreference-150f170e.js";import"./TableListHeader-e50d01d1.js";import"./DataTable-e31a825a.js";import"./BaseRadioInput-a7ac3557.js";import"./BaseLabel-a1c0ca00.js";import"./AIText-891d4f7b.js";import"./InputCheckbox-81cb3ca6.js";import"./BreakSlashes-925eef0e.js";import"./UnignoreIssue-5dff8957.js";import"./CreateTicketModal-c14deeb1.js";import"./ManualInputSearchDropdown-6a7ece3e.js";import"./InputSearchDropdown-02988f6b.js";import"./repoName-872812ed.js";import"./taskTrackerNaming-55adac3e.js";import"./taskTrackerIcon-504ea566.js";import"./autofixable-c6560249.js";import"./autofixSastIssues-779ec5b4.js";import"./lock-files-cdbb050f.js";import"./BaseCodeBlock-cec75629.js";import"./string-814c5ffd.js";import"./ButtonMultiOption-12e505fb.js";import"./transform-c376ec3f.js";import"./linear-efb37b7f.js";import"./arc-12e4470a.js";import"./BaseForm-4c6fa06f.js";import"./XTabs-d492da26.js";import"./BaseCard-471d3203.js";import"./AccordionContainer-09dc0ed4.js";import"./trycatch-83445d5b.js";import"./licenses-6ab38515.js";import"./BaseStatusLabel-0ccd2806.js";import"./DataTableSeverityIndicator-48ffb8dc.js";import"./IssueGroupTypeColumn-03f014b0.js";import"./BracesIcon-0a8568f4.js";import"./BoxIcon-9908469f.js";import"./StackedAvatars-4925baeb.js";const O={props:{insight:Object},components:{QueueTable:W,QueueSidebar:N,PageHeader:R,SettingsEmptyState:q,EmptyUsersIllustration:j,XPreloader:L,InputSearch:T,BaseButton:F,BaseParagraph:M,DataTableRow:X,PdfDownloadButton:H},data(){return{isLoading:!0,issues:[],slaSettings:[],hasConfiguredSlaSettings:!1,searchTerm:""}},created(){p.on("issueUpdated",this.fetchAllIssues),p.on("refreshQueue",this.fetchAllIssues),p.on("dependencyScanFinished",this.fetchAllIssues)},beforeUnmount(){p.off("issueUpdated",this.fetchAllIssues),p.off("refreshQueue",this.fetchAllIssues),p.off("dependencyScanFinished",this.fetchAllIssues)},async mounted(){try{await this.fetchSlaSettings(),await this.fetchAllIssues()}finally{this.isLoading=!1}},watch:{$teamContext(){this.fetchAllIssues()}},computed:{breadcrumbs(){return[{label:"Reports",href:"/reports"},{label:"Issues outside of SLA"}]},issueIds(){return this.insight.metadata.issue_ids},issuesBefore2WeeksPastSla(){const o=h.now();return this.issues.filter(i=>{const d=I(i.aikido_priority),a=this.getDurationInDaysForSeverity(d),l=h.fromUnix(i.timestamp).addDays(a).addDays(14);return o.isBefore(l)})},issuesBetween2WeeksAnd2MonthsPastSla(){const o=h.now();return this.issues.filter(i=>{const d=I(i.aikido_priority),a=this.getDurationInDaysForSeverity(d),l=h.fromUnix(i.timestamp).addDays(a),_=l.addDays(14),S=l.addMonths(2);return o.isAfter(_)&&o.isBefore(S)})},issues2MonthsPastSla(){const o=h.now();return this.issues.filter(i=>{const d=I(i.aikido_priority),a=this.getDurationInDaysForSeverity(d),_=h.fromUnix(i.timestamp).addDays(a).addMonths(2);return o.isAfter(_)})},isAssigneeColumnVisible(){return!!U.data.issueTracker},colspan(){return this.isAssigneeColumnVisible?8:7}},methods:{async fetchSlaSettings(){const o=await E();this.hasConfiguredSlaSettings=o.is_enabled,this.slaSettings=o.settings},async fetchAllIssues(){if(this.hasConfiguredSlaSettings){this.$globalLoadingIndicator.show();try{this.issues=await Q({search_term:this.searchTerm,quick_filter:"out_of_sla",dont_pass_team_context:!1})}finally{this.$globalLoadingIndicator.hide()}}},handleConfigureSla(){this.$router.push("/settings/sla")},getDurationInDaysForSeverity(o){return this.slaSettings.find(i=>o.toLowerCase()===i.issue_priority_level.toLowerCase()).duration_in_days},async onItemSelected(o){this.$router.replace({path:this.$route.path,query:{...this.$route.query,sidebarIssue:o.id}})}}},z={class:"page-content"},G={ref:"filters",class:"flex align-center mb-16px gap-8px flex-wrap"},K={class:"ml-auto flex align-center gap-12px"},Y=n("i",{class:"icon icon-settings"},null,-1),Z={class:"flex flex-column gap-16px"},J=["colspan"],$={class:"flex justify-center my-12px"},ee=["colspan"],te={class:"flex justify-center my-12px"},se=["colspan"],oe={class:"flex justify-center my-12px"};function ae(o,c,i,d,a,e){const l=r("PdfDownloadButton"),_=r("PageHeader"),S=r("XPreloader"),C=r("EmptyUsersIllustration"),k=r("SettingsEmptyState"),x=r("InputSearch"),B=r("BaseButton"),g=r("QueueTable"),m=r("BaseParagraph"),y=r("DataTableRow"),P=r("QueueSidebar");return f(),w(A,null,[t(_,{title:"Issues outside of SLA",breadcrumbs:e.breadcrumbs},{rightContent:s(()=>[a.hasConfiguredSlaSettings?(f(),b(l,{key:0,exportType:"sla_compliance"})):V("",!0)]),_:1},8,["breadcrumbs"]),n("div",z,[a.isLoading?(f(),b(S,{key:0,class:"absolute-centered",size:"medium",theme:"transparent"})):(f(),w(A,{key:1},[!a.hasConfiguredSlaSettings&&!a.isLoading?(f(),b(k,{key:0,title:"You don't seem to have configured any SLAs",description:"Configure Service Level Agreements to make sure issues are resolved in a timely manner",actionLabel:"Configure SLAs",onAction:e.handleConfigureSla},{default:s(()=>[t(C)]),_:1},8,["onAction"])):(f(),w(A,{key:1},[n("div",G,[t(x,{modelValue:a.searchTerm,"onUpdate:modelValue":[c[0]||(c[0]=v=>a.searchTerm=v),e.fetchAllIssues],spacing:"compact"},null,8,["modelValue","onUpdate:modelValue"]),n("div",K,[t(B,{size:"small",as:"link",to:"/settings/sla"},{default:s(()=>[Y,u("Configure SLAs")]),_:1})])],512),n("div",Z,[t(g,{groupedIssues:[],"show-body":!1}),t(g,{onItemClicked:e.onItemSelected,groupedIssues:e.issuesBefore2WeeksPastSla,"show-empty-state":e.issuesBefore2WeeksPastSla.length===0,"hide-header":""},{fixedRow:s(()=>[t(y,{class:"data-table__row--section-header"},{default:s(()=>[n("td",{colspan:e.colspan},[t(m,null,{default:s(()=>[u("Less than 2 weeks past SLA")]),_:1})],8,J)]),_:1})]),emptyState:s(()=>[n("div",$,[t(m,null,{default:s(()=>[u("There are no issue past their SLA within this timeframe")]),_:1})])]),_:1},8,["onItemClicked","groupedIssues","show-empty-state"]),t(g,{onItemClicked:e.onItemSelected,groupedIssues:e.issuesBetween2WeeksAnd2MonthsPastSla,"show-empty-state":e.issuesBetween2WeeksAnd2MonthsPastSla.length===0,"hide-header":""},{fixedRow:s(()=>[t(y,{class:"data-table__row--section-header"},{default:s(()=>[n("td",{colspan:e.colspan},[t(m,null,{default:s(()=>[u("Between 2 weeks and 2 months past SLA")]),_:1})],8,ee)]),_:1})]),emptyState:s(()=>[n("div",te,[t(m,null,{default:s(()=>[u("There are no issue past their SLA within this timeframe")]),_:1})])]),_:1},8,["onItemClicked","groupedIssues","show-empty-state"]),t(g,{onItemClicked:e.onItemSelected,groupedIssues:e.issues2MonthsPastSla,"show-empty-state":e.issues2MonthsPastSla.length===0,"hide-header":""},{fixedRow:s(()=>[t(y,{class:"data-table__row--section-header"},{default:s(()=>[n("td",{colspan:e.colspan},[t(m,null,{default:s(()=>[u("More than 2 months past SLA")]),_:1})],8,se)]),_:1})]),emptyState:s(()=>[n("div",oe,[t(m,null,{default:s(()=>[u("There are no issue past their SLA within this timeframe")]),_:1})])]),_:1},8,["onItemClicked","groupedIssues","show-empty-state"])]),t(P,{"grouped-issues":a.issues},null,8,["grouped-issues"])],64))],64))])],64)}const at=D(O,[["render",ae]]);export{at as default};
