import{_,H as f,f as k,M as w,V as y,g as C,g8 as g,g9 as v,r as o,q as c,k as i,w as n,o as l,s as d,n as m,m as x,ai as V,p as S}from"./index-13ff96f4.js";const E={emits:["close","submit","secondaryButtonClicked"],components:{BaseHeading:f,BaseButton:k,BaseModal:w,InputText:y,BaseLink:C},props:{repository:Object},data(){return{rawBranch:"",branch:"",secondbranch:"",showSecondBranchField:!1,secondBranchError:""}},created(){this.rawBranch=this.repository.scm_repo_default_branch,this.branch=this.repository.scm_repo_default_branch},methods:{async save(){if(this.showSecondBranchField){if(this.secondbranch==this.branch){this.secondBranchError="second branch cannot be the same as the default branch";return}const a=await g({repo_id:this.repository.id,default_branch:this.secondbranch});this.$toast.success("Repository successfully cloned with selected branch"),this.$router.push(`/repositories/${a}?startscan=true`),this.$emit("close");return}await v({repo_id:this.repository.id,default_branch:this.branch}),this.$toast.success("Branch successfully updated"),this.$emit("saved")},close(){this.$emit("close")},multipleBranchesScanClicked(){if(this.$featureflags.enable_multi_branch_scanning)this.secondbranch=this.branch,this.branch=this.rawBranch,this.showSecondBranchField=!0;else{const a="Hi, I would like to request multi-branch scanning.";window.Intercom("showNewMessage",a)}}}},M=m("p",{class:"text-underline"},"Scan multiple Branches",-1);function I(a,e,F,H,s,t){const p=o("BaseHeading"),h=o("InputText"),b=o("BaseLink"),u=o("BaseButton"),B=o("BaseModal");return c(),i(B,{width:400,onClose:t.close,allowBackgroundClose:!1},{header:n(()=>[l(p,{as:"h3"},{default:n(()=>[d("Update branch to scan")]),_:1})]),content:n(()=>[m("div",null,[l(h,{title:"Branch name",placeholder:"main",modelValue:s.branch,"onUpdate:modelValue":e[0]||(e[0]=r=>s.branch=r),modelModifiers:{trim:!0},name:"branch",onEnterKeyPress:t.save,disabled:s.showSecondBranchField},null,8,["modelValue","onEnterKeyPress","disabled"]),["github","gitlab","gitlab_server","bitbucket","azure_devops"].includes(a.$group.scm_type)?(c(),x("div",{key:0,onClick:e[3]||(e[3]=V(()=>{},["stop"]))},[s.showSecondBranchField?(c(),i(h,{key:1,class:"mt-24px",title:"Second branch to scan",placeholder:"production",modelValue:s.secondbranch,"onUpdate:modelValue":[e[1]||(e[1]=r=>s.secondbranch=r),e[2]||(e[2]=r=>s.secondBranchError="")],modelModifiers:{trim:!0},error:s.secondBranchError,name:"secondbranch",onEnterKeyPress:t.save},null,8,["modelValue","error","onEnterKeyPress"])):(c(),i(b,{key:0,as:"button",class:"mt-8px block text--normal text-carbon-60",size:"small",onClick:t.multipleBranchesScanClicked},{default:n(()=>[M]),_:1},8,["onClick"]))])):S("",!0)])]),footer:n(()=>[l(u,{onClicked:t.close,variation:"tertiary",class:"ml-auto"},{default:n(()=>[d("Cancel")]),_:1},8,["onClicked"]),l(u,{onClicked:t.save},{default:n(()=>[d("Save")]),_:1},8,["onClicked"])]),_:1},8,["onClose"])}const K=_(E,[["render",I]]);export{K as default};
