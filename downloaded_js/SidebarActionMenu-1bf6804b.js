import{C as rs,I as us}from"./CreateAutoFixProgressFlow-8111d22c.js";import{f as ls}from"./focusModePreference-150f170e.js";import{T as Le,a as Be}from"./TableListHeader-e50d01d1.js";import{_ as C,bk as se,B as E,d as $,r,q as i,m as _,n as h,o as a,w as n,s as c,u as g,S as A,ai as X,k as m,p as I,F as w,f as L,M as B,aw as Ue,cE as Pe,t as N,H as U,cF as J,an as T,cG as cs,cH as ds,N as _e,a3 as O,cI as hs,cJ as _s,cK as ps,cL as gs,cM as fs,bU as ms,a8 as Is,cN as Ss,cO as ys,i as D,a2 as z,cP as ks,cQ as Cs,A as ne,cR as Me,aa as F,bK as De,bC as Se,Z as ee,z as bs,aV as ws,cS as de,cT as vs,cU as Es,au as xs,g as P,cV as Rs,bn as Fe,cW as Ts,e as pe,ag as ye,U as Ge,aQ as $e,cX as Os,ah as As,cY as ke,cZ as Ns,a0 as ie,J as ze,Q as Ve,X as je,c_ as Ls,x as ae,bI as Ce,bA as be,c$ as Bs,d0 as Us,d1 as Ps,co as Ms,bg as Ds,ar as Fs,bh as Gs,bS as $s}from"./index-13ff96f4.js";import{A as re}from"./ActionMenu-3e4470bf.js";import{B as ge}from"./BaseRadioInput-a7ac3557.js";import{B as te}from"./BaseLabel-a1c0ca00.js";import{I as zs,A as Vs}from"./AIText-891d4f7b.js";import{I as He,B as fe}from"./BreakSlashes-925eef0e.js";import{U as js}from"./UnignoreIssue-5dff8957.js";import Hs from"./CreateTicketModal-c14deeb1.js";import{g as qs}from"./taskTrackerIcon-504ea566.js";import{i as Ws,a as Ks,b as Xs}from"./autofixable-c6560249.js";import{a as Ys}from"./autofixSastIssues-779ec5b4.js";import{d as we}from"./index-b87db690.js";import{b as Z,c as Js}from"./dateFns-a344cb79.js";import{g as me,a as Qs}from"./lock-files-cdbb050f.js";import{B as qe}from"./BaseCodeBlock-cec75629.js";import{j as K}from"./string-814c5ffd.js";import{B as Zs}from"./ButtonMultiOption-12e505fb.js";import{s as ve}from"./transform-c376ec3f.js";import{l as We}from"./linear-efb37b7f.js";import{a as et}from"./arc-12e4470a.js";import{B as st}from"./BaseForm-4c6fa06f.js";import{X as tt}from"./XTabs-d492da26.js";import{B as Ke}from"./BaseCard-471d3203.js";import{A as ot}from"./AccordionContainer-09dc0ed4.js";import{I as nt}from"./InputCheckbox-81cb3ca6.js";import{c as it}from"./trycatch-83445d5b.js";import{s as at}from"./licenses-6ab38515.js";const rt={props:{forId:String,title:String,modelValue:String,ignoreCount:Number,theme:{type:String,default:"dark",validator:e=>["dark","light"].includes(e)},isLoading:Boolean},emits:["select","update:modelValue"],data(){return{showInput:!1}},updated(){this.showInput&&this.$refs.input.focus()},components:{BaseLabel:te,BaseRadioInput:ge,BaseBody:se,BaseParagraph:E,BasePill:$},computed:{themeClass(){return this.theme==="dark"?"field--theme-dark":"field--theme-light"},isPathEmpty(){return this.modelValue.trim().length===0}},methods:{handleBlurInputField(){this.showInput&&(this.showInput=!1)},handleToggleInputVisibility(){this.showInput=!this.showInput,this.showInput&&(this.$refs.radioButton.$refs.input.checked=!0,this.$emit("select",this.modelValue))},handleInputChanges(e){this.$emit("update:modelValue",e.target.value),this.$emit("select",e.target.value)},handleKeyPress(e){e.which===13&&(this.handleBlurInputField(),e.stopPropagation(),e.preventDefault())}}},ut={key:0,class:"ignore-issue__path__input-container"},lt=["value"],ct=h("span",{class:"ml-4px text-blue-accent flex align-center"},[h("i",{class:"icon icon-edit icon-10px mr-4px"}),c("Edit Path")],-1);function dt(e,t,s,d,u,o){const l=r("BasePill"),p=r("BaseBody"),f=r("BaseLabel"),S=r("BaseParagraph"),k=r("BaseRadioInput");return i(),_(w,null,[h("div",{class:A(["flex flex-column max-w-full gap-4px flex-1 mr-8px cursor-pointer",o.themeClass])},[a(p,{bold:"",color:s.theme==="light"?"black":"white",class:"flex align-center gap-8px"},{default:n(()=>[c(g(s.title)+" ",1),a(l,{class:A([s.isLoading?"collapse":"visible animate-fade-in"]),variation:"gray",title:e.$t("X_ISSUES",s.ignoreCount)},null,8,["class","title"])]),_:1},8,["color"]),a(f,{color:"gray",class:"text-break-all mb-2px"},{default:n(()=>[c("Will ignore all code issue types in this path")]),_:1}),u.showInput?(i(),_("div",ut,[h("input",{ref:"input",typ:"text",value:this.modelValue,autocomple:"off",onInput:t[0]||(t[0]=(...y)=>o.handleInputChanges&&o.handleInputChanges(...y)),onBlur:t[1]||(t[1]=(...y)=>o.handleBlurInputField&&o.handleBlurInputField(...y)),onKeypress:t[2]||(t[2]=X((...y)=>o.handleKeyPress&&o.handleKeyPress(...y),["stop"]))},null,40,lt),h("i",{class:"icon icon-tick-circle icon-16px",onClick:t[3]||(t[3]=X((...y)=>o.handleToggleInputVisibility&&o.handleToggleInputVisibility(...y),["stop","prevent"]))})])):(i(),m(f,{key:1,color:"subdued",class:"ignore-issue__path__label",onClick:X(o.handleToggleInputVisibility,["stop","prevent"])},{default:n(()=>[c(" Path: "+g(s.modelValue)+" ",1),ct]),_:1},8,["onClick"])),o.isPathEmpty?(i(),m(S,{key:2,size:"small",color:"danger"},{default:n(()=>[c("Path cannot be empty")]),_:1})):I("",!0)],2),a(k,{ref:"radioButton",name:"ignore_level",id:s.forId,value:s.modelValue,onSelect:t[4]||(t[4]=()=>e.$emit("select",s.modelValue))},null,8,["id","value"])],64)}const Xe=C(rt,[["render",dt]]),ht={components:{BaseButton:L,BaseRadioInput:ge,BaseParagraph:E,BaseLabel:te,BaseModal:B,IgnorePathAction:Xe,BaseBody:se,BasePill:$},props:{groupedIssue:{type:Object,required:!0}},emits:["cancel","confirm"],data(){let e=this.groupedIssue.issues[0].target_path;if(this.groupedIssue.type==="leaked_secret"||this.groupedIssue.type==="sast"){for(let s=0;s<this.groupedIssue.issues.length;s++)if(this.groupedIssue.issues[s].status=="open"||this.groupedIssue.issues[s].status=="snoozed"){e=this.groupedIssue.issues[s].file;break}}let t=this.groupedIssue.package_name;return{isLoading:!0,targetPath:e,packageName:t,selectedOption:null,ignoreCountForPath:0,ignoreCountForRepo:0,ignoreCountForCloudRule:0,ignoreCountForSastRule:0,ignoreCountForScmSecurityRule:0,ignoreCountForPackageName:0}},async created(){this.fetchDebouncedIssueCounts=Ue(async()=>{await this.fetchIssueCounts()},300),await this.fetchIssueCounts()},watch:{async targetPath(){this.targetPath&&await this.fetchDebouncedIssueCounts()},async packageName(){this.packageName&&await this.fetchDebouncedIssueCounts()}},methods:{handleCancel(){this.selectedOption=null,this.$emit("cancel")},handleConfirm(){const e=this.selectedOption;this.$emit("confirm",e),this.selectedOption=null},handleSelectOption(e,t){this.selectedOption={target:e,value:t}},showIgnorePathOption(){if(this.groupedIssue.type==="leaked_secret"||this.groupedIssue.type==="sast"||this.groupedIssue.type==="open_source"||this.groupedIssue.type==="malware")return!0;const e=this.groupedIssue.issues.map(s=>s.target_path||s.file);return e.every(s=>s===e[0])&&this.showIgnoreRepoOption()},showIgnoreRepoOption(){const e=this.groupedIssue.issues.map(s=>s.repo_id);return e.every(s=>s===e[0])},handleSelectTargetPath(e){this.handleSelectOption("path",e)},handleSelectPackageName(e){this.handleSelectOption("package",e)},async fetchIssueCounts(){this.isLoading=!0;const e=this.groupedIssue.issues.filter(p=>p.status==="open"||p.status==="snoozed"),{count_by_path:t,count_by_package_name:s,count_by_repo:d,count_by_cloud_rule:u,count_by_sast_rule_id:o,count_by_scm_security_rule:l}=await Pe({repo_id:e[0].repo_id,image_id:e[0].cloud_repo_id,target_path:this.targetPath,package_name:this.packageName,cloud_rule_code:e[0].aikido_rule_code,sast_rule_id:e[0].rule_id,scm_security_rule_code:e[0].rule_id});this.ignoreCountForPath=t,this.ignoreCountForPackageName=s,this.ignoreCountForRepo=d,this.ignoreCountForCloudRule=u,this.ignoreCountForSastRule=o,this.ignoreCountForScmSecurityRule=l,this.isLoading=!1}},computed:{showEditableTargetPath(){return this.groupedIssue.type==="leaked_secret"||this.groupedIssue.type==="sast"||this.groupedIssue.type==="open_source"||this.groupedIssue.type==="malware"},actions(){const e=this.groupedIssue.issues.filter(S=>["open","snoozed"].includes(S.status)),t=[{title:this.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.IGNORE_THIS_GROUPED_ISSUE"),id:"grouped_issue_id",label:this.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.IGNORE_THIS_GROUPED_ISSUE.DESCRIPTION"),value:this.groupedIssue.id,ignoreCount:e.length,pillVariation:"gray"}],s=this.groupedIssue.type==="cloud",d=this.groupedIssue.type==="sast",u=this.groupedIssue.type==="surface_monitoring",o=this.groupedIssue.type==="scm_security",l=this.groupedIssue.issues[0].repo_id&&this.groupedIssue.issues[0].repo_id>0,p=this.groupedIssue.issues[0].cloud_repo_id&&this.groupedIssue.issues[0].cloud_repo_id>0,f=this.groupedIssue.detailed_related_type==="docker_container";return s&&t.push({title:this.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.IGNORE_FROM_CLOUD_RULE"),id:"cloud_rule",label:`Rule: ${this.groupedIssue.issues[0].title}`,value:this.groupedIssue.issues[0].aikido_rule_code,ignoreCount:this.ignoreCountForCloudRule,pillVariation:"red"}),o&&t.push({title:this.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.IGNORE_FROM_SCM_SECURITY_RULE"),id:"scm_security_rule",label:`Rule: ${this.groupedIssue.issues[0].title}`,value:this.groupedIssue.issues[0].rule_id,ignoreCount:this.ignoreCountForScmSecurityRule,pillVariation:"red"}),!s&&!u&&this.showIgnorePathOption()&&(l||p)&&t.push({title:this.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.IGNORE_FROM_PATH"),id:"path",label:this.targetPath,value:this.targetPath,ignoreCount:this.ignoreCountForPath,pillVariation:"gray"}),d&&t.push({title:this.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.IGNORE_FROM_SAST_RULE"),id:"sast_rule",label:`Rule: ${this.groupedIssue.issues[0].title}`,value:this.groupedIssue.issues[0].rule_id,ignoreCount:this.ignoreCountForSastRule,pillVariation:"red"}),f&&t.push({title:this.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.IGNORE_FROM_PACKAGE_NAME"),id:"package",label:this.packageName,value:this.packageName,ignoreCount:this.ignoreCountForPackageName,pillVariation:"gray"}),t},canContinue(){return!(!this.$groupUser.can_ignore_issues||!this.selectedOption)}}},_t=["for"],pt={class:"flex flex-column max-w-full gap-4px"};function gt(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("IgnorePathAction"),f=r("BasePill"),S=r("BaseBody"),k=r("BaseLabel"),y=r("BaseRadioInput"),v=r("BaseButton"),R=r("BaseModal");return i(),m(R,{width:700,onClose:o.handleCancel,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c(g(e.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.TITLE")),1)]),_:1})]),content:n(()=>[h("form",null,[(i(!0),_(w,null,N(o.actions,b=>(i(),_("label",{key:b.id,for:b.id,class:"flex justify-between align-center py-16px px-8px gap-8px border-bottom-1 border-carbon-20 cursor-pointer"},[o.showEditableTargetPath&&b.id==="path"?(i(),m(p,{key:0,"for-id":b.id,"ignore-count":b.ignoreCount,modelValue:u.targetPath,"onUpdate:modelValue":t[0]||(t[0]=x=>u.targetPath=x),title:b.title,onSelect:o.handleSelectTargetPath,theme:"light",isLoading:u.isLoading},null,8,["for-id","ignore-count","modelValue","title","onSelect","isLoading"])):(i(),_(w,{key:1},[h("div",pt,[a(S,{bold:"",class:"flex align-center gap-8px"},{default:n(()=>[c(g(b.title)+" ",1),a(f,{class:A([u.isLoading?"collapse":"visible animate-fade-in"]),variation:b.pillVariation,title:e.$t("X_ISSUES",b.ignoreCount)},null,8,["class","variation","title"])]),_:2},1024),a(k,{color:"gray",class:"text-break-all"},{default:n(()=>[c(g(b.label),1)]),_:2},1024)]),a(y,{name:"ignore_level",id:b.id,value:b.value,onSelect:()=>o.handleSelectOption(b.id,b.value)},null,8,["id","value","onSelect"])],64))],8,_t))),128))]),e.$groupUser.can_ignore_issues?I("",!0):(i(),m(l,{key:0,color:"danger"},{default:n(()=>[c("Your account doesn't have permission to ignore issues")]),_:1}))]),footer:n(()=>[a(v,{onClicked:o.handleCancel,variation:"plain",class:"ml-auto"},{default:n(()=>[c(g(e.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.CANCEL")),1)]),_:1},8,["onClicked"]),a(v,{onClicked:o.handleConfirm,disabled:!o.canContinue},{default:n(()=>[c(g(e.$t("IGNORE_GROUPED_ISSUE_RULE_MODAL.NEXT")),1)]),_:1},8,["onClicked","disabled"])]),_:1},8,["onClose"])}const ft=C(ht,[["render",gt]]),mt={props:{show:Boolean,selectedRule:Object,groupedIssue:Object},components:{BaseModal:B,BaseButton:L,BaseParagraph:E,BaseHeading:U},emits:["cancel","confirm"],computed:{issueCount(){return this.groupedIssue.issues.filter(e=>e.status==="open"||e.status==="snoozed").length},ruleType(){return this.selectedRule.target=="cve_id"?"CVE":this.selectedRule.target=="path"?"path":"rule"}},methods:{handleCancel(){this.$emit("cancel")},handleConfirm(){this.$emit("confirm")}}},It={class:"flex flex-column gap-12px"},St={class:"text-break-word"},yt={class:"text-break-all"};function kt(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("BaseButton"),S=r("BaseModal");return s.show?(i(),m(S,{key:0,width:600,onClose:o.handleCancel,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_CONFIRMATION_MODAL.TITLE")),1)]),_:1})]),content:n(()=>[h("div",It,[s.selectedRule.target==="grouped_issue_id"?(i(),m(p,{key:0,as:"h3"},{default:n(()=>[c(" Are you sure you want to permanently ignore this grouped issue and its "),h("strong",St,g(e.$t("X_SUBISSUES",o.issueCount)),1),c(" ? ")]),_:1})):(i(),m(p,{key:1,as:"h3"},{default:n(()=>{var k;return[c(" Are you sure you want to permanently ignore issues from "),h("strong",yt,g((k=s.selectedRule)==null?void 0:k.value),1),c(" ? ")]}),_:1})),a(l,{size:"medium",loose:""},{default:n(()=>[c(" You can edit your rules from settings any time, but you won't see any new issues from this "+g(o.ruleType)+" in your dashboard. ",1)]),_:1})])]),footer:n(()=>[a(f,{onClicked:o.handleCancel,variation:"plain",class:"ml-auto"},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_CONFIRMATION_MODAL.CANCEL")),1)]),_:1},8,["onClicked"]),a(f,{onClicked:o.handleConfirm},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_CONFIRMATION_MODAL.NEXT")),1)]),_:1},8,["onClicked"])]),_:1},8,["onClose"])):I("",!0)}const Ct=C(mt,[["render",kt]]),bt={props:{show:Boolean,groupedIssue:Object,selectedRule:Object,filterRepoId:{type:[Number,String],default:void 0},filterImageId:{type:[Number,String],default:void 0},filterCloudId:{type:[Number,String],default:void 0},filterDomainId:{type:[Number,String],default:void 0},filterInstanceGroupId:{type:[Number,String],default:void 0}},components:{BaseModal:B,BaseButton:L,BaseParagraph:E,InputTextArea:J,BaseHeading:U,InputCheckbox:nt},emits:["cancel","confirm"],data(){return{reason:"",error:void 0,isFlaggedAsFalsePositive:!1,isIgnoring:!1}},methods:{handleCancel(){this.$emit("cancel"),this.reason=""},async handleFinish(){const{target:e}=this.selectedRule;this.isIgnoring=!0,this.reason=this.reason.trim();let t=null;e==="grouped_issue_id"?t=this.handleIngoreGroupedIssue():t=this.handleCreateIgnoreRule(),await t.then(()=>{this.$emit("confirm"),this.reason="",T.emit("issueUpdated")}).catch(s=>{this.error=s.response.data.reason_phrase}),this.isIgnoring=!1},async handleIngoreGroupedIssue(){const e=await cs(this.groupedIssue.id,this.reason,{disable_toasts:!0},this.filterRepoId,this.filterImageId,this.filterCloudId,this.filterDomainId,this.isFlaggedAsFalsePositive,this.filterInstanceGroupId);this.$toast.success(`Successfully ignored ${this.$t("X_ISSUES",e.data.amount_ignored)}`)},async handleCreateIgnoreRule(){const{target:e,value:t}=this.selectedRule;let s="exact_match";(this.groupedIssue.type==="leaked_secret"||this.groupedIssue.type==="sast"||this.groupedIssue.type==="open_source"||this.groupedIssue.type==="malware")&&(s="starts_with");const d=this.groupedIssue.issues.filter(u=>u.status==="open"||u.status==="snoozed");await ds(e,t,"ignore",this.reason,d[0].repo_id,s,{disable_toasts:!0},d[0].cloud_repo_id,this.isFlaggedAsFalsePositive),Toast.success({title:this.$t("NOTIFICATIONS.GROUPED_ISSUE_IGNORED.TITLE"),description:this.$t("NOTIFICATIONS.ISSUES.ISSUE_IGNORED_SUCCESS")})}}},wt={class:"flex flex-column gap-12px"};function vt(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("InputTextArea"),S=r("InputCheckbox"),k=r("BaseButton"),y=r("BaseModal");return s.show?(i(),m(y,{key:0,width:600,onClose:o.handleCancel,error:u.error,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_FEEDBACK_MODAL.TITLE")),1)]),_:1})]),content:n(()=>[h("div",wt,[a(p,{as:"h3"},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_FEEDBACK_MODAL.BODY")),1)]),_:1}),a(l,{size:"medium",loose:""},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_FEEDBACK_MODAL.LABEL")),1)]),_:1})]),a(f,{name:"reason",placeholder:e.$t("IGNORE_ISSUE_FEEDBACK_MODAL.PLACEHOLDER"),modelValue:u.reason,"onUpdate:modelValue":t[0]||(t[0]=v=>u.reason=v),rows:"5"},null,8,["placeholder","modelValue"])]),footer:n(()=>[h("div",null,[a(S,{modelValue:u.isFlaggedAsFalsePositive,"onUpdate:modelValue":t[1]||(t[1]=v=>u.isFlaggedAsFalsePositive=v),name:"falsePositive",class:"hover_bg-transparent"},{default:n(()=>[a(l,null,{default:n(()=>[c("Send to Aikido to flag as false positive")]),_:1})]),_:1},8,["modelValue"])]),a(k,{onClicked:o.handleFinish,class:"ml-auto",isLoading:u.isIgnoring},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_FEEDBACK_MODAL.FINISH")),1)]),_:1},8,["onClicked","isLoading"])]),_:1},8,["onClose","error"])):I("",!0)}const Et=C(bt,[["render",vt]]),xt={props:{show:Boolean,groupedIssue:{type:Object},filterRepoId:{type:[Number,String],default:void 0},filterImageId:{type:[Number,String],default:void 0},filterCloudId:{type:[Number,String],default:void 0},filterDomainId:{type:[Number,String],default:void 0},filterInstanceGroupId:{type:[Number,String],default:void 0}},emits:["cancel"],components:{IgnoreGroupedIssueRuleModal:ft,IgnoreGroupedIssueConfirmationModal:Ct,IgnoreGroupedIssueFeedbackModal:Et},data(){return{showIgnoreGroupedIssueRuleModal:!1,showIgnoreGroupedIssueConfirmation:!1,showIgnoreGroupedIssueFeedback:!1,selectedRule:null}},methods:{handleShowIgnoreGroupedIssueRule(){this.showIgnoreGroupedIssueRuleModal=!0},handleCloseIgnoreGroupedIssueRule(){this.showIgnoreGroupedIssueRuleModal=!1,this.$emit("cancel")},handleConfirmIgnoreGroupedIssueRule(e){this.selectedRule=e,this.handleCloseIgnoreGroupedIssueRule(),e.target=="grouped_issue_id"?this.handleShowIgnoreGroupedIssueFeedback():this.handleShowIgnoreGroupedIssueConfirmation()},handleShowIgnoreGroupedIssueConfirmation(){this.showIgnoreGroupedIssueConfirmation=!0},handleCloseIgnoreGroupedIssueConfirmation(){this.showIgnoreGroupedIssueConfirmation=!1},handleConfirmIgnoreGroupedIssueConfirmation(){this.handleCloseIgnoreGroupedIssueConfirmation(),this.handleShowIgnoreGroupedIssueFeedback()},handleShowIgnoreGroupedIssueFeedback(){this.showIgnoreGroupedIssueFeedback=!0},handleCloseIgnoreGroupedIssueFeedback(){this.showIgnoreGroupedIssueFeedback=!1},handleConfirmIgnoreGroupedIssueFeedback(){this.handleCloseIgnoreGroupedIssueFeedback()}}};function Rt(e,t,s,d,u,o){const l=r("IgnoreGroupedIssueRuleModal"),p=r("IgnoreGroupedIssueConfirmationModal"),f=r("IgnoreGroupedIssueFeedbackModal");return i(),_(w,null,[s.show?(i(),m(l,{key:0,groupedIssue:s.groupedIssue,onCancel:o.handleCloseIgnoreGroupedIssueRule,onConfirm:o.handleConfirmIgnoreGroupedIssueRule},null,8,["groupedIssue","onCancel","onConfirm"])):I("",!0),a(p,{show:u.showIgnoreGroupedIssueConfirmation,groupedIssue:s.groupedIssue,selectedRule:u.selectedRule,onCancel:o.handleCloseIgnoreGroupedIssueConfirmation,onConfirm:o.handleConfirmIgnoreGroupedIssueConfirmation},null,8,["show","groupedIssue","selectedRule","onCancel","onConfirm"]),a(f,{show:u.showIgnoreGroupedIssueFeedback,selectedRule:u.selectedRule,groupedIssue:s.groupedIssue,filterRepoId:s.filterRepoId,filterImageId:s.filterImageId,filterCloudId:s.filterCloudId,filterDomainId:s.filterDomainId,filterInstanceGroupId:s.filterInstanceGroupId,onCancel:o.handleCloseIgnoreGroupedIssueFeedback,onConfirm:o.handleConfirmIgnoreGroupedIssueFeedback},null,8,["show","selectedRule","groupedIssue","filterRepoId","filterImageId","filterCloudId","filterDomainId","filterInstanceGroupId","onCancel","onConfirm"])],64)}const Tt=C(xt,[["render",Rt]]),Ot={emits:["cancel","submit"],components:{BaseButton:L,BaseModal:B,BaseParagraph:E,BaseSelect:_e,InputDatePicker:He,BaseHeading:U},data(){return{showModal:!1,snoozeUntil:O.now().addDays(1).toUTC(),snoozeCustom:void 0,options:[{title:"1 day",id:O.now().addDays(1).toUTC()},{title:"1 week",id:O.now().addWeeks(1).toUTC()},{title:"1 month",id:O.now().addMonths(1).toUTC()},{title:"3 months",id:O.now().addMonths(3).toUTC()},{title:"6 months",id:O.now().addMonths(6).toUTC()},{title:"1 year",id:O.now().addYears(1).toUTC()},{title:"Custom",id:"custom"}]}},methods:{handleCancel(){this.$emit("cancel")},handleSnoozeIssue(){this.$emit("submit",{snoozeUntil:this.snoozeCustom?O.fromISOString(this.snoozeCustom).toUTC():this.snoozeUntil})}}},At={class:"flex flex-column gap-16px"};function Nt(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("BaseSelect"),S=r("InputDatePicker"),k=r("BaseButton"),y=r("BaseModal");return i(),m(y,{onClose:o.handleCancel,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c("Snooze issue group")]),_:1})]),content:n(()=>[h("div",At,[a(p,{as:"h3"},{default:n(()=>[c("Snooze until...")]),_:1}),a(l,{size:"medium"},{default:n(()=>[c("Let us know when you want to see this issue group again.")]),_:1}),a(f,{theme:"light",modelValue:u.snoozeUntil,"onUpdate:modelValue":t[0]||(t[0]=v=>u.snoozeUntil=v),id:"selectSnoozeDuration",options:u.options},null,8,["modelValue","options"]),u.snoozeUntil==="custom"?(i(),m(S,{key:0,theme:"light",modelValue:u.snoozeCustom,"onUpdate:modelValue":t[1]||(t[1]=v=>u.snoozeCustom=v),title:"Custom",name:"customSnoozeDuration"},null,8,["modelValue"])):I("",!0),e.$groupUser.can_snooze_issues?I("",!0):(i(),m(l,{key:1,color:"danger"},{default:n(()=>[c("Your account doesn't have permission to snooze issues")]),_:1}))])]),footer:n(()=>[a(k,{onClicked:o.handleCancel,variation:"plain",class:"ml-auto"},{default:n(()=>[c("Cancel")]),_:1},8,["onClicked"]),a(k,{onClicked:o.handleSnoozeIssue,disabled:!e.$groupUser.can_snooze_issues},{default:n(()=>[c("Next")]),_:1},8,["onClicked","disabled"])]),_:1},8,["onClose"])}const Lt=C(Ot,[["render",Nt]]),Bt={components:{BaseHeading:U,BaseButton:L,BaseModal:B,BaseParagraph:E,InputTextArea:J},props:{snoozeUntil:Number},emits:["cancel","back","submit"],data(){return{snoozeReason:void 0}},computed:{snoozeFormatted(){return O.fromUnix(this.snoozeUntil).format(O.SHORT_ISO_FORMAT)}},methods:{handleCancel(){this.$emit("cancel")},handleBack(){this.$emit("back")},handleSubmit(){this.$emit("submit",{snoozeReason:this.snoozeReason})}}};function Ut(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("InputTextArea"),S=r("BaseButton"),k=r("BaseModal");return i(),m(k,{onClose:o.handleCancel,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c("Snooze issue group")]),_:1})]),content:n(()=>[a(p,{as:"h3"},{default:n(()=>[c(" This issue group will be snoozed until "+g(o.snoozeFormatted),1)]),_:1}),a(l,{size:"medium"},{default:n(()=>[c(" Optionally, you can enter a reason for snoozing this issue group to the audit log. ")]),_:1}),a(f,{modelValue:u.snoozeReason,"onUpdate:modelValue":t[0]||(t[0]=y=>u.snoozeReason=y),title:"Reason for snoozing",placeholder:"Summary...",rows:"5",name:"snoozeIssueReason"},null,8,["modelValue"])]),footer:n(()=>[a(S,{size:"normal",variation:"tertiary",onClicked:o.handleCancel},{default:n(()=>[c("Cancel")]),_:1},8,["onClicked"]),a(S,{size:"normal",variation:"secondary",onClicked:o.handleBack,class:"ml-auto"},{default:n(()=>[c("Back")]),_:1},8,["onClicked"]),a(S,{size:"normal",variation:"primary",onClicked:o.handleSubmit},{default:n(()=>[c("Submit")]),_:1},8,["onClicked"])]),_:1},8,["onClose"])}const Pt=C(Bt,[["render",Ut]]),Mt={props:{groupedIssue:Object,filterRepoId:{type:[Number,String],default:void 0},filterImageId:{type:[Number,String],default:void 0},filterCloudId:{type:[Number,String],default:void 0},filterDomainId:{type:[Number,String],default:void 0},filterInstanceGroupId:{type:[Number,String],default:void 0}},components:{SnoozeGroupedIssueDuration:Lt,SnoozeGroupedIssueReason:Pt},emits:["cancel","snoozed"],data(){return{showSnoozeGroupedIssueDurationModal:!0,showSnoozeGroupedIssueReasonModal:!1,snoozeUntil:void 0,snoozeReason:void 0}},methods:{handleCancel(){this.$emit("cancel")},handleShowSnoozeGroupedIssueReasonModal({snoozeUntil:e}){this.snoozeUntil=e,this.showSnoozeGroupedIssueDurationModal=!1,this.showSnoozeGroupedIssueReasonModal=!0},handleShowSnoozeGroupedIssueDuration(){this.showSnoozeGroupedIssueDurationModal=!0,this.showSnoozeGroupedIssueReasonModal=!1},async handleSnoozeGroupedIssue({snoozeReason:e}){this.snoozeReason=e;const t=await hs(this.groupedIssue.id,this.snoozeUntil,this.snoozeReason,this.filterRepoId,this.filterImageId,this.filterCloudId,this.filterDomainId,this.filterInstanceGroupId);this.$emit("snoozed"),T.emit("issueUpdated",{id:this.groupedIssue.id}),Toast.success({title:this.$t("NOTIFICATIONS.ISSUE_SNOOZED.TITLE"),description:`Successfully snoozed ${this.$t("X_ISSUES",t.data.amount_snoozed)}`})}}};function Dt(e,t,s,d,u,o){const l=r("SnoozeGroupedIssueDuration"),p=r("SnoozeGroupedIssueReason");return i(),_(w,null,[u.showSnoozeGroupedIssueDurationModal?(i(),m(l,{key:0,onSubmit:o.handleShowSnoozeGroupedIssueReasonModal,onCancel:o.handleCancel},null,8,["onSubmit","onCancel"])):I("",!0),u.showSnoozeGroupedIssueReasonModal?(i(),m(p,{key:1,onCancel:o.handleCancel,onBack:o.handleShowSnoozeGroupedIssueDuration,onSubmit:o.handleSnoozeGroupedIssue,snoozeUntil:u.snoozeUntil},null,8,["onCancel","onBack","onSubmit","snoozeUntil"])):I("",!0)],64)}const Ft=C(Mt,[["render",Dt]]),Gt={emits:["cancel","submit"],components:{BaseModal:B,BaseParagraph:E,BaseHeading:U,BaseButton:L},props:{groupedIssue:Object},methods:{async handleUnsnoozeIssueGroup(){await _s(this.groupedIssue.id),this.$emit("submit"),T.emit("issueUpdated",{id:this.groupedIssue.id}),Toast.success({title:this.$t("NOTIFICATIONS.ISSUE_UNSNOOZED.TITLE"),description:this.$t("NOTIFICATIONS.ISSUES.ISSUE_GROUP_UNSNOOZED_SUCCESS")})}}},$t={class:"flex flex-column gap-16px"};function zt(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("BaseButton"),S=r("BaseModal");return i(),m(S,{onClose:t[1]||(t[1]=k=>e.$emit("cancel")),allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c("Unsnooze issue group")]),_:1})]),content:n(()=>[h("div",$t,[a(p,{as:"h3"},{default:n(()=>[c("Unsnooze this issue group")]),_:1}),a(l,{size:"medium"},{default:n(()=>[c(" Are you sure you want to unsnooze this issue group? You can always snooze it again later. ")]),_:1})])]),footer:n(()=>[a(f,{onClicked:t[0]||(t[0]=k=>e.$emit("cancel")),variation:"plain",class:"ml-auto"},{default:n(()=>[c("Cancel")]),_:1}),a(f,{onClicked:o.handleUnsnoozeIssueGroup},{default:n(()=>[c("Unsnooze")]),_:1},8,["onClicked"])]),_:1})}const Vt=C(Gt,[["render",zt]]),jt={props:{groupedIssue:Object,singleIssue:Object},components:{BaseModal:B,BaseButton:L,BaseParagraph:E,BaseHeading:U},emits:["cancel","solved"],methods:{handleCancel(){this.$emit("cancel")},async handleSolved(){let e=!1;if(this.groupedIssue)await ps(this.groupedIssue.id),e=!0;else{const{group_closed:t}=await gs(this.singleIssue.id);e=t}e&&T.emit("request-queue-sidebar-close",{ignoreOpenModal:!0}),this.$emit("solved"),T.emit("issueUpdated"),Toast.success({title:this.$t("NOTIFICATIONS.ISSUE_FIXED.TITLE"),description:"Successfully marked issue as solved"})}}},Ht={class:"flex flex-column gap-12px"};function qt(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("BaseButton"),S=r("BaseModal");return i(),m(S,{width:600,onClose:o.handleCancel},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c("Solve Issues")]),_:1})]),content:n(()=>[h("div",Ht,[a(p,{as:"h3"},{default:n(()=>[c("Mark this issue as solved?")]),_:1}),a(l,{size:"medium",loose:""},{default:n(()=>[c(" This secret was detected within your version history, which is permanent. Please ensure that you've invalidated the secret and then mark it as solved below and we will remove from your open vulnerabilities. ")]),_:1})])]),footer:n(()=>[a(f,{onClicked:o.handleCancel,variation:"tertiary",class:"ml-auto"},{default:n(()=>[c("Cancel")]),_:1},8,["onClicked"]),a(f,{onClicked:o.handleSolved},{default:n(()=>[c("Mark as solved")]),_:1},8,["onClicked"])]),_:1},8,["onClose"])}const Ye=C(jt,[["render",qt]]),Wt={props:{issueGroup:Object},components:{BaseModal:B,BaseButton:L,BaseParagraph:E,InputTextArea:J,BaseHeading:U},emits:["cancel","confirm"],data(){return{reason:""}},methods:{handleCancel(){this.$emit("cancel")},async handleFinish(){this.reason=this.reason.trim();const e=[];for(const d of this.issueGroup.issues)e.push(fs(d.id,this.reason));await Promise.all(e),this.$emit("confirm");const{sidebarIssue:t,...s}=ms();t&&t===`${this.issueGroup.id}`&&this.$router.replace({query:s}),Toast.success({title:this.$t("NOTIFICATIONS.ISSUE_GROUP_UNIGNORED.TITLE"),description:this.$t("NOTIFICATIONS.ISSUES.ISSUE_GROUP_UNIGNORED_SUCCESS")}),T.emit("issueUpdated",{id:this.issueGroup.id})}},computed:{canFinish(){return!this.reason}}},Kt={class:"flex flex-column gap-12px"};function Xt(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("InputTextArea"),S=r("BaseButton"),k=r("BaseModal");return i(),m(k,{onClose:o.handleCancel,"allow-background-close":!0,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c(g(e.$t("UNIGNORE_ISSUE_GROUP_FEEDBACK_MODAL.TITLE")),1)]),_:1})]),content:n(()=>[h("div",Kt,[a(p,{as:"h3"},{default:n(()=>[c(g(e.$t("UNIGNORE_ISSUE_GROUP_FEEDBACK_MODAL.BODY",s.issueGroup.issues.length??0)),1)]),_:1}),a(l,{size:"medium",loose:""},{default:n(()=>[c(g(e.$t("UNIGNORE_ISSUE_GROUP_FEEDBACK_MODAL.LABEL")),1)]),_:1})]),a(f,{placeholder:e.$t("UNIGNORE_ISSUE_GROUP_FEEDBACK_MODAL.PLACEHOLDER"),modelValue:u.reason,"onUpdate:modelValue":t[0]||(t[0]=y=>u.reason=y),rows:"5"},null,8,["placeholder","modelValue"])]),footer:n(()=>[a(S,{onClicked:o.handleCancel,variation:"tertiary",class:"ml-auto"},{default:n(()=>[c(g(e.$t("UNIGNORE_ISSUE_GROUP_FEEDBACK_MODAL.CANCEL")),1)]),_:1},8,["onClicked"]),a(S,{onClicked:o.handleFinish},{default:n(()=>[c(g(e.$t("UNIGNORE_ISSUE_GROUP_FEEDBACK_MODAL.FINISH")),1)]),_:1},8,["onClicked"])]),_:1},8,["onClose"])}const Yt=C(Wt,[["render",Xt]]),Jt={props:{issueGroup:{type:Object}},emits:["cancel"],components:{UnignoreIssueGroupFeedback:Yt}};function Qt(e,t,s,d,u,o){const l=r("UnignoreIssueGroupFeedback");return i(),m(l,{"issue-group":s.issueGroup,onCancel:t[0]||(t[0]=p=>e.$emit("cancel")),onConfirm:t[1]||(t[1]=p=>e.$emit("cancel"))},null,8,["issue-group"])}const Zt=C(Jt,[["render",Qt]]),Je=async(e,t=!1)=>{await Is({headerText:"Reopen Issue",description:"This secret was manually marked as solved before. By reopening this issue, it will be added again to your main feed.",buttonSubmitText:"Reopen"})&&(t?await Ss(e):(await ys(e),T.emit("request-queue-sidebar-close")),Toast.success("Successfully reopened the issue"),T.emit("issueUpdated"))},eo=(e,t="open")=>{if(e.type==="leaked_secret"){const{issues:s}=e,d=s.map(o=>o.rule_id);if(!d.every(o=>o===d[0])||d[0]==="generic-api-key"){let o=s;return t==="open"&&(o=s.filter(l=>l.status!=="closed")),t==="closed"&&(o=s.filter(l=>l.status==="closed")),o.length>50?D.global.t("ISSUES.LEAKED_SECRETS.FINDING.TITLE.MANY"):D.global.t("ISSUES.LEAKED_SECRETS.FINDING.TITLE",o.length)}return d[0]=="hashicorp-tf-password"||s[0].description.length>50?s[0].description:`${s[0].description} secret exposed`}return e.package_name},Q=e=>{const t=e.split("/");return t[t.length-1]},Uh=e=>{if(e.type==="sast"&&e.issues.some(s=>s.file=="repo-wide"))return"Repo-wide";if(e.type==="leaked_secret"||e.type==="sast"){const s=e.issues.map(u=>u.file),d=Array.from(new Set(s));return d.length===1?`in ${Q(d[0])}`:d.length===2?`in ${Q(d[0])} and ${Q(d[1])}`:`in ${Q(d[0])}, ${Q(d[1])} and ${d.length-2} others`}return e.issues.map(s=>s.cwe_descriptions).flat()[0]},Ph=e=>{if(e.type==="open_source"||e.type==="malware"||e.type==="eol"||e.type==="license"){const t=[];for(const d of e.issues)d.cloud_repo_name?t.push(d.cloud_repo_name+"||||"+d.cloud_repo_id):d.repo_name?t.push(d.repo_name):d.domain_name?t.push(d.domain_name):d.cloud_instance_group_name?t.push(`${d.cloud_instance_group_name} in ${d.cloud_name}`):d.cloud_name&&t.push(d.cloud_name);return[...new Set(t)].map(d=>d.split("||||")[0])}else if(e.type==="cloud"){const t=e.issues.map(d=>d.cloud_name);return[...new Set(t)]}else if(e.type==="sast"){const t=e.issues.map(d=>d.repo_name);return[...new Set(t)]}else if(e.type==="leaked_secret"){const t=e.issues.map(d=>d.repo_name);return[...new Set(t)]}else if(e.type==="surface_monitoring"){const t=e.issues.map(l=>l.cloud_repo_name),s=e.issues.map(l=>l.cloud_name),d=e.issues.map(l=>l.repo_name&&l.domain_name?l.domain_name:l.repo_name),u=e.issues.filter(l=>l.domain_id>0&&!l.cloud_repo_name&&!l.cloud_name&&!l.repo_name).map(l=>l.domain_name),o=[...d,...s,...t,...u].filter(Boolean);return[...new Set(o)]}else if(e.type==="scm_security"){const t=e.issues.map(d=>d.repo_name);return e.issues[0].resource_kind==="scm_organization"?[e.issues[0].resource_name]:[...new Set(t)]}return[]},so={components:{XTooltip:z,BasePill:$},props:{groupedIssue:Object,singleIssue:Object,preferLabelView:{type:Boolean,default:!1}},inject:["theme"],computed:{scanner(){var e;return this.singleIssue?this.singleIssue.scanner:(e=this.groupedIssue.issues[0])==null?void 0:e.scanner},locationPillVariation(){return this.theme=="light"?"gray-outline":"dark-purple"},locationText(){const e=this.locationsSortedByImportance;return!e[0]||e[0]==="cloud"?null:e[0]==="docker_container"?"container":e[0]==="cloud_instance"?"virtual machine":e[0]},useSvgIcon(){return["icon-git","icon-cloud-server"].includes(this.locationIcon)},locationIcon(){var t,s;const e=this.locationsSortedByImportance;if(!e[0])return null;if(e[0]==="docker_container")return"icon-docker";if(e[0]==="cloud_instance")return"icon-cloud-server";if(e[0]==="cloud"){const d=this.singleIssue?this.singleIssue.cloud_type:(t=this.groupedIssue.issues[0])==null?void 0:t.cloud_type;return d==="aws"?"icon-location_aws":d==="gcp"?"icon-gcp":(this.singleIssue?this.singleIssue.domain_id:(s=this.groupedIssue.issues[0])==null?void 0:s.domain_id)>0?"icon-ressources":"icon-cloud"}return e[0]==="scm"?"icon-git":`icon-${e[0]}`},locationsSortedByImportance(){if(this.singleIssue)return[this.singleIssue.attack_surface];const e=this.groupedIssue.issues.map(d=>d.attack_surface),t=[...new Set(e)],s=["backend","docker","frontend","scm_security","cloud_instance",null];return t.sort((d,u)=>{const o=s.indexOf(d),l=s.indexOf(u);return o==-1?1:l==-1?-1:o-l})}}},to={class:"text-11px desktop-small_text-10px"};function oo(e,t,s,d,u,o){const l=r("BasePill"),p=r("BaseIcon"),f=r("XTooltip");return o.locationText&&s.preferLabelView?(i(),m(l,{key:0,class:"mr-4px",variation:o.locationPillVariation},{default:n(()=>[h("span",to,g(o.locationText),1)]),_:1},8,["variation"])):o.useSvgIcon?(i(),m(p,{key:1,icon:o.locationIcon,class:"icon-12px valign-middle mr-4px issue-detail__subissues__location-icon"},null,8,["icon"])):o.locationIcon?(i(),_("i",{key:2,class:A(["icon icon-12px valign-middle mr-4px issue-detail__subissues__location-icon",o.locationIcon])},[a(f,null,{default:n(()=>[c(g(this.locationsSortedByImportance[0]),1)]),_:1})],2)):I("",!0)}const no=C(so,[["render",oo]]),io={components:{BaseButton:L,BaseRadioInput:ge,BaseParagraph:E,BaseLabel:te,BaseModal:B,IgnorePathAction:Xe,BaseBody:se,BasePill:$},props:{packageName:String,issue:{type:Object,required:!0}},emits:["cancel","confirm"],data(){let e=this.issue.target_path;return(this.issue.type==="leaked_secret"||this.issue.type==="sast")&&(e=this.issue.file),{isLoading:!0,targetPath:e,selectedOption:null,ignoreCountForPath:0,ignoreCountForRepo:0,ignoreCountForCloudRule:0,ignoreCountForScmSecurityRule:0,ignoreCountForCveId:0,ignoreCountForSastRule:0,ignoreCountForPackageName:0}},async created(){this.fetchDebouncedIssueCounts=Ue(async()=>{await this.fetchIssueCounts()},300),await this.fetchIssueCounts()},watch:{async targetPath(){this.targetPath&&await this.fetchDebouncedIssueCounts()},async packageName(){this.packageName&&await this.fetchDebouncedIssueCounts()}},methods:{handleCancel(){this.$emit("cancel"),this.selectedOption=null,this.targetPath=null},handleConfirm(){const e=this.selectedOption;this.$emit("confirm",e),this.selectedOption=null,this.targetPath=null},handleSelectOption(e,t){this.selectedOption={target:e,value:t}},handleSelectTargetPath(e){this.handleSelectOption("path",e)},handleSelectPackageName(e){this.handleSelectOption("package",e)},async fetchIssueCounts(){this.isLoading=!0;const{count_by_path:e,count_by_package_name:t,count_by_repo:s,count_by_cloud_rule:d,count_by_cve_id:u,count_by_sast_rule_id:o,count_by_scm_security_rule:l}=await Pe({repo_id:this.issue.repo_id,image_id:this.issue.cloud_repo_id,target_path:this.targetPath,package_name:this.packageName,cloud_rule_code:this.issue.aikido_rule_code,cve_id:this.issue.cve_id,sast_rule_id:this.issue.rule_id,scm_security_rule_code:this.issue.rule_id});this.ignoreCountForPath=e,this.ignoreCountForPackageName=t,this.ignoreCountForRepo=s,this.ignoreCountForCloudRule=d,this.ignoreCountForScmSecurityRule=l,this.ignoreCountForCveId=u,this.ignoreCountForSastRule=o,this.isLoading=!1}},computed:{showEditableTargetPath(){return this.issue.type==="leaked_secret"||this.issue.type==="sast"||this.issue.type==="open_source"},showIgnoreByPackageName(){return this.issue.type==="open_source"&&this.issue.attack_surface==="docker_container"},repositoryName(){return this.issue.repo_name},canContinue(){return!(!this.$groupUser.can_ignore_issues||!this.selectedOption)},actions(){return this.issue.type==="cloud"?[{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE"),id:"issue_id",label:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE.DESCRIPTION"),value:this.issue.id,ignoreCount:1,pillVariation:"gray"},{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_CLOUD_RULE"),id:"cloud_rule",label:`Rule: ${this.issue.title}`,value:this.issue.aikido_rule_code,ignoreCount:this.ignoreCountForCloudRule,pillVariation:"red"}]:this.issue.type==="scm_security"?[{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE"),id:"issue_id",label:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE.DESCRIPTION"),value:this.issue.id,ignoreCount:1,pillVariation:"gray"},{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_SCM_SECURITY_RULE"),id:"scm_security_rule",label:`Rule: ${this.issue.title}`,value:this.issue.rule_id,ignoreCount:this.ignoreCountForScmSecurityRule,pillVariation:"red"}]:this.issue.type==="surface_monitoring"?[{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE"),id:"issue_id",label:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE.DESCRIPTION"),value:this.issue.id,ignoreCount:1,pillVariation:"gray"}]:this.issue.type==="leaked_secret"?[{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE"),id:"issue_id",label:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE.DESCRIPTION"),value:this.issue.id,ignoreCount:1,pillVariation:"gray"},{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_FROM_PATH"),id:"path",label:this.targetPath,value:this.targetPath,ignoreCount:this.ignoreCountForPath,pillVariation:"gray"}]:this.issue.type==="sast"?[{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE"),id:"issue_id",label:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE.DESCRIPTION"),value:this.issue.id,ignoreCount:1,pillVariation:"gray"},{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_FROM_PATH"),id:"path",label:this.targetPath,value:this.targetPath,ignoreCount:this.ignoreCountForPath,pillVariation:"gray"},{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_FROM_SAST_RULE"),id:"sast_rule",label:`Rule: ${this.issue.title}`,value:this.issue.rule_id,ignoreCount:this.ignoreCountForSastRule,pillVariation:"red"}]:[{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE"),id:"issue_id",label:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_THIS_ISSUE.DESCRIPTION"),value:this.issue.id,ignoreCount:1,pillVariation:"gray"},{hide:this.issue.repo_id<=0&&this.issue.cloud_repo_id<=0,title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_FROM_PATH"),id:"path",label:this.targetPath,value:this.targetPath,ignoreCount:this.ignoreCountForPath,pillVariation:"gray"},{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_FROM_CVE_ID"),id:"cve_id",label:this.issue.cve_id,value:this.issue.cve_id,ignoreCount:this.ignoreCountForCveId,pillVariation:"gray"},{title:this.$t("IGNORE_ISSUE_RULE_MODAL.IGNORE_FROM_PACKAGE_NAME"),id:"package",hide:!this.showIgnoreByPackageName,label:this.packageName,value:this.packageName,ignoreCount:this.ignoreCountForPackageName,pillVariation:"gray"}].filter(e=>!e.hide)}}},ao=["for"],ro={class:"flex flex-column max-w-full gap-4px"};function uo(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("IgnorePathAction"),f=r("BasePill"),S=r("BaseBody"),k=r("BaseLabel"),y=r("BaseRadioInput"),v=r("BaseButton"),R=r("BaseModal");return i(),m(R,{width:700,onClose:o.handleCancel,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_RULE_MODAL.TITLE")),1)]),_:1})]),content:n(()=>[h("form",null,[(i(!0),_(w,null,N(o.actions,b=>(i(),_("label",{key:b.id,for:b.id,class:"flex justify-between align-center py-16px px-8px gap-8px border-bottom-1 border-carbon-20 cursor-pointer"},[o.showEditableTargetPath&&b.id==="path"?(i(),m(p,{key:0,"for-id":b.id,"ignore-count":b.ignoreCount,modelValue:u.targetPath,"onUpdate:modelValue":t[0]||(t[0]=x=>u.targetPath=x),title:b.title,onSelect:o.handleSelectTargetPath,theme:"light",isLoading:u.isLoading},null,8,["for-id","ignore-count","modelValue","title","onSelect","isLoading"])):(i(),_(w,{key:1},[h("div",ro,[a(S,{loose:!0,bold:"",class:"flex align-center gap-8px"},{default:n(()=>[c(g(b.title)+" ",1),a(f,{class:A([u.isLoading?"collapse":"visible animate-fade-in"]),variation:b.pillVariation,title:e.$t("X_ISSUES",b.ignoreCount)},null,8,["class","variation","title"])]),_:2},1024),a(k,{color:"gray",class:"text-break-all"},{default:n(()=>[c(g(b.label),1)]),_:2},1024)]),a(y,{name:"ignore_level",id:b.id,value:b.value,onSelect:()=>o.handleSelectOption(b.id,b.value)},null,8,["id","value","onSelect"])],64))],8,ao))),128))]),e.$groupUser.can_ignore_issues?I("",!0):(i(),m(l,{key:0,color:"danger"},{default:n(()=>[c("Your account doesn't have permission to ignore issues")]),_:1}))]),footer:n(()=>[a(v,{onClicked:o.handleCancel,variation:"tertiary",class:"ml-auto"},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_RULE_MODAL.CANCEL")),1)]),_:1},8,["onClicked"]),a(v,{onClicked:o.handleConfirm,disabled:!o.canContinue},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_RULE_MODAL.NEXT")),1)]),_:1},8,["onClicked","disabled"])]),_:1},8,["onClose"])}const lo=C(io,[["render",uo]]),co={props:{show:Boolean,selectedRule:Object},components:{BaseModal:B,BaseButton:L,BaseParagraph:E,BaseHeading:U},emits:["cancel","confirm"],computed:{ruleType(){return this.selectedRule.target=="cve_id"?"CVE":this.selectedRule.target=="path"?"path":"rule"}},methods:{handleCancel(){this.$emit("cancel")},handleConfirm(){this.$emit("confirm")}}},ho={class:"flex flex-column gap-12px"},_o={class:"text-break-all"},po={class:"text-break-all"};function go(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("BaseButton"),S=r("BaseModal");return s.show?(i(),m(S,{key:0,width:600,onClose:o.handleCancel,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_CONFIRMATION_MODAL.TITLE")),1)]),_:1})]),content:n(()=>[h("div",ho,[s.selectedRule.target==="issue_id"?(i(),m(p,{key:0,as:"h3"},{default:n(()=>{var k;return[c(" Are you sure you want to permanently ignore this issue "),h("strong",_o,g((k=s.selectedRule)==null?void 0:k.value),1),c(" ? ")]}),_:1})):(i(),m(p,{key:1,as:"h3"},{default:n(()=>{var k;return[c(" Are you sure you want to permanently ignore issues from "),h("strong",po,g((k=s.selectedRule)==null?void 0:k.value),1),c(" ? ")]}),_:1})),a(l,{size:"medium",loose:""},{default:n(()=>[c(" You can edit your rules from settings any time, but you won't see any new issues from this "+g(o.ruleType)+" in your dashboard. ",1)]),_:1})])]),footer:n(()=>[a(f,{onClicked:o.handleCancel,variation:"plain",class:"ml-auto"},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_CONFIRMATION_MODAL.CANCEL")),1)]),_:1},8,["onClicked"]),a(f,{onClicked:o.handleConfirm},{default:n(()=>[c(g(e.$t("IGNORE_ISSUE_CONFIRMATION_MODAL.NEXT")),1)]),_:1},8,["onClicked"])]),_:1},8,["onClose"])):I("",!0)}const fo=C(co,[["render",go]]),mo={props:{show:Boolean,issue:{type:Object},packageName:String},emits:["cancel"],components:{IgnoreIssueRuleModal:lo,IgnoreIssueConfirmationModal:fo,IgnoreIssueFeedbackModal:zs},data(){return{showIgnoreIssueRuleModal:!1,showIgnoreIssueConfirmation:!1,showIgnoreIssueFeedback:!1,selectedRule:null}},methods:{handleShowIgnoreIssueRule(){this.showIgnoreIssueRuleModal=!0},handleCloseIgnoreIssueRule(){this.showIgnoreIssueRuleModal=!1,this.$emit("cancel")},handleConfirmIgnoreIssueRule(e){this.selectedRule=e,this.handleCloseIgnoreIssueRule(),e.target=="issue_id"?this.handleShowIgnoreIssueFeedback():this.handleShowIgnoreIssueConfirmation()},handleShowIgnoreIssueConfirmation(){this.showIgnoreIssueConfirmation=!0},handleCloseIgnoreIssueConfirmation(){this.showIgnoreIssueConfirmation=!1},handleConfirmIgnoreIssueConfirmation(){this.handleCloseIgnoreIssueConfirmation(),this.handleShowIgnoreIssueFeedback()},handleShowIgnoreIssueFeedback(){this.showIgnoreIssueFeedback=!0},handleCloseIgnoreIssueFeedback(){this.showIgnoreIssueFeedback=!1},handleConfirmIgnoreIssueFeedback(){this.handleCloseIgnoreIssueFeedback()}}};function Io(e,t,s,d,u,o){const l=r("IgnoreIssueRuleModal"),p=r("IgnoreIssueConfirmationModal"),f=r("IgnoreIssueFeedbackModal");return i(),_(w,null,[s.show?(i(),m(l,{key:0,issue:s.issue,packageName:s.packageName,onCancel:o.handleCloseIgnoreIssueRule,onConfirm:o.handleConfirmIgnoreIssueRule},null,8,["issue","packageName","onCancel","onConfirm"])):I("",!0),a(p,{show:u.showIgnoreIssueConfirmation,selectedRule:u.selectedRule,onCancel:o.handleCloseIgnoreIssueConfirmation,onConfirm:o.handleConfirmIgnoreIssueConfirmation},null,8,["show","selectedRule","onCancel","onConfirm"]),a(f,{show:u.showIgnoreIssueFeedback,selectedRule:u.selectedRule,issue:s.issue,onCancel:o.handleCloseIgnoreIssueFeedback,onConfirm:o.handleConfirmIgnoreIssueFeedback},null,8,["show","selectedRule","issue","onCancel","onConfirm"])],64)}const So=C(mo,[["render",Io]]),yo={emits:["cancel","submit"],components:{BaseButton:L,BaseModal:B,BaseParagraph:E,BaseSelect:_e,InputDatePicker:He,BaseHeading:U},data(){return{showModal:!1,snoozeUntil:O.now().addDays(1).toUTC(),snoozeCustom:void 0,options:[{title:"1 day",id:O.now().addDays(1).toUTC()},{title:"1 week",id:O.now().addWeeks(1).toUTC()},{title:"1 month",id:O.now().addMonths(1).toUTC()},{title:"3 months",id:O.now().addMonths(3).toUTC()},{title:"6 months",id:O.now().addMonths(6).toUTC()},{title:"1 year",id:O.now().addYears(1).toUTC()},{title:"Custom",id:"custom"}]}},methods:{handleCancel(){this.$emit("cancel")},handleSubmit(){this.$emit("submit",{snoozeUntil:this.snoozeCustom?O.fromISOString(this.snoozeCustom).toUTC():this.snoozeUntil})}}},ko={class:"flex flex-column gap-16px"};function Co(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("BaseSelect"),S=r("InputDatePicker"),k=r("BaseButton"),y=r("BaseModal");return i(),m(y,{onClose:o.handleCancel,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c("Snooze issue")]),_:1})]),content:n(()=>[h("div",ko,[a(p,{as:"h3"},{default:n(()=>[c("Snooze until...")]),_:1}),a(l,{size:"medium"},{default:n(()=>[c("Let us know when you want to see this issue again.")]),_:1}),a(f,{theme:"light",modelValue:u.snoozeUntil,"onUpdate:modelValue":t[0]||(t[0]=v=>u.snoozeUntil=v),id:"selectSnoozeDuration",options:u.options},null,8,["modelValue","options"]),u.snoozeUntil==="custom"?(i(),m(S,{key:0,theme:"light",modelValue:u.snoozeCustom,"onUpdate:modelValue":t[1]||(t[1]=v=>u.snoozeCustom=v),title:"Custom",name:"customSnoozeDuration"},null,8,["modelValue"])):I("",!0),e.$groupUser.can_snooze_issues?I("",!0):(i(),m(l,{key:1,color:"danger"},{default:n(()=>[c("Your account doesn't have permission to snooze issues")]),_:1}))])]),footer:n(()=>[a(k,{onClicked:o.handleCancel,variation:"plain",class:"ml-auto"},{default:n(()=>[c("Cancel")]),_:1},8,["onClicked"]),a(k,{onClicked:o.handleSubmit,disabled:!e.$groupUser.can_snooze_issues},{default:n(()=>[c("Next")]),_:1},8,["onClicked","disabled"])]),_:1},8,["onClose"])}const bo=C(yo,[["render",Co]]),wo={components:{BaseHeading:U,BaseButton:L,BaseModal:B,BaseParagraph:E,InputTextArea:J},props:{snoozeUntil:Number},emits:["cancel","back","submit"],data(){return{snoozeReason:void 0}},computed:{snoozeFormatted(){return O.fromUnix(this.snoozeUntil).format(O.SHORT_ISO_FORMAT)}},methods:{handleCancel(){this.$emit("cancel")},handleBack(){this.$emit("back")},handleSubmit(){this.$emit("submit",{snoozeReason:this.snoozeReason})}}};function vo(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("InputTextArea"),S=r("BaseButton"),k=r("BaseModal");return i(),m(k,{onClose:o.handleCancel,allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c("Snooze issue")]),_:1})]),content:n(()=>[a(p,{as:"h3"},{default:n(()=>[c("This issue will be snoozed until "+g(o.snoozeFormatted),1)]),_:1}),a(l,{size:"medium"},{default:n(()=>[c(" Optionally, you can enter a reason for snoozing this issue to the audit log. ")]),_:1}),a(f,{modelValue:u.snoozeReason,"onUpdate:modelValue":t[0]||(t[0]=y=>u.snoozeReason=y),title:"Reason for snoozing",placeholder:"Summary...",rows:"5",name:"snoozeIssueReason"},null,8,["modelValue"])]),footer:n(()=>[a(S,{size:"normal",variation:"tertiary",onClicked:o.handleCancel},{default:n(()=>[c("Cancel")]),_:1},8,["onClicked"]),a(S,{size:"normal",variation:"secondary",onClicked:o.handleBack,class:"ml-auto"},{default:n(()=>[c("Back")]),_:1},8,["onClicked"]),a(S,{size:"normal",variation:"primary",onClicked:o.handleSubmit},{default:n(()=>[c("Submit")]),_:1},8,["onClicked"])]),_:1},8,["onClose"])}const Eo=C(wo,[["render",vo]]),xo={props:{id:Number},emits:["cancel","snoozed"],components:{SnoozeIssueDuration:bo,SnoozeIssueReason:Eo},data(){return{showSnoozeIssueDurationModal:!0,showSnoozeIssueReasonModal:!1,snoozeUntil:void 0,snoozeReason:void 0}},methods:{handleCancel(){this.$emit("cancel")},handleShowSnoozeIssueReasonModal({snoozeUntil:e}){this.snoozeUntil=e,this.showSnoozeIssueDurationModal=!1,this.showSnoozeIssueReasonModal=!0},handleShowSnoozeReasonModal(){this.showSnoozeIssueDurationModal=!0,this.showSnoozeIssueReasonModal=!1},async handleSnoozeIssue({snoozeReason:e}){this.snoozeReason=e,await ks(this.id,this.snoozeUntil,this.snoozeReason),this.$emit("snoozed"),T.emit("issueUpdated",{id:this.id}),Toast.success({title:this.$t("NOTIFICATIONS.ISSUE_SNOOZED.TITLE"),description:this.$t("NOTIFICATIONS.ISSUES.ISSUE_SNOOZED_SUCCESS")})}}};function Ro(e,t,s,d,u,o){const l=r("SnoozeIssueDuration"),p=r("SnoozeIssueReason");return i(),_(w,null,[u.showSnoozeIssueDurationModal?(i(),m(l,{key:0,onSubmit:o.handleShowSnoozeIssueReasonModal,onCancel:o.handleCancel},null,8,["onSubmit","onCancel"])):I("",!0),u.showSnoozeIssueReasonModal?(i(),m(p,{key:1,onCancel:o.handleCancel,onBack:o.handleShowSnoozeReasonModal,onSubmit:o.handleSnoozeIssue,snoozeUntil:u.snoozeUntil},null,8,["onCancel","onBack","onSubmit","snoozeUntil"])):I("",!0)],64)}const To=C(xo,[["render",Ro]]),Y=e=>{if(e.patched_versions.length==0)return"N/A";const t=e.patched_versions.slice().sort((s,d)=>Re(s)===Re(d)?s.startsWith(">")?1:d.startsWith(">")?-1:0:he(s,d)?-1:1);for(const s of t)if(he(e.installed_version,s))return s;return t.reverse()[0]??void 0};function Ee(e){let t=e.match(/(\d+)\.(\d+)\.(\d+)/);if(t==null&&(t=e.match(/(\d+)\.(\d+)/)),t==null&&(t=e.match(/(\d+)/)),t==null)return[0,0,0];const[s,d=0,u=0]=t[0].split(".").map(o=>parseInt(o));return[s,d,u]}const xe=e=>{if(e.length==0)return null;let t={installed_version:"0.0.0",patched_versions:["0.0.0"]};for(const s of e){const d=Y(t),u=Y(s);if(he(d,u)){t=s;continue}}return Y(t)};function he(e,t){const[s,d,u]=Ee(e),[o,l,p]=Ee(t);return s<o?!0:s>o?!1:d<l?!0:d>l?!1:u<p?!0:!(u>p)}function Re(e){return e=e.replace("~>",""),e=e.replace(">=",""),e=e.replace(">",""),e=e.replace("<=",""),e=e.replace("<",""),e=e.replace("v",""),e=e.trim(),e}const Oo={emits:["cancel","submit"],components:{BaseModal:B,BaseParagraph:E,BaseHeading:U,BaseButton:L},props:{id:Number},methods:{async handleUnsnoozeIssueGroup(){await Cs(this.id),this.$emit("submit"),T.emit("issueUpdated",{id:this.id}),Toast.success({title:this.$t("NOTIFICATIONS.ISSUE_UNSNOOZED.TITLE"),description:this.$t("NOTIFICATIONS.ISSUES.ISSUE_UNSNOOZED_SUCCESS")})}}},Ao={class:"flex flex-column gap-16px"};function No(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("BaseButton"),S=r("BaseModal");return i(),m(S,{onClose:t[1]||(t[1]=k=>e.$emit("cancel")),allowBackgroundClose:!1},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c("Unsnooze issue")]),_:1})]),content:n(()=>[h("div",Ao,[a(p,{as:"h3"},{default:n(()=>[c("Unsnooze this issue")]),_:1}),a(l,{size:"medium"},{default:n(()=>[c(" Are you sure you want to unsnooze this issue? You can always snooze it again later. ")]),_:1})])]),footer:n(()=>[a(f,{onClicked:t[0]||(t[0]=k=>e.$emit("cancel")),variation:"plain",class:"ml-auto"},{default:n(()=>[c("Cancel")]),_:1}),a(f,{onClicked:o.handleUnsnoozeIssueGroup},{default:n(()=>[c("Unsnooze")]),_:1},8,["onClicked"])]),_:1})}const Lo=C(Oo,[["render",No]]),Bo={props:{issue:{type:Object},programmingLanguage:String,packageName:String,sastAutofixEnabled:Boolean},components:{ActionMenu:re,IgnoreIssue:So,SnoozeIssue:To,UnignoreIssue:js,SolveIssue:Ye,CreateAutoFixProgressFlow:rs,UnsnoozeIssueModal:Lo,CreateTicketModal:Hs},data(){return{showIgnoreIssueFlow:!1,showSnoozeIssueFlow:!1,showUnsnoozeIssueFlow:!1,showSolveIssueFlow:!1,showUnignoreIssueFlow:!1,showCreateAutoFixFlow:!1,showCreateTicketFlow:!1}},computed:{actions(){var t;let e=[];return((t=this.issue)==null?void 0:t.status)==="ignored"?e=[{visible:this.$user.is_aikido_support&&this.showAutoFixOption,label:"Autofix issue",onClick:this.handleCreateFix,icon:"icon-shield_check",iconColor:"secondary"},{label:this.$t("ISSUE_ACTION_MENU.UNIGNORE"),onClick:this.openUnignoreIssueFlow,icon:"icon-shield_check"},{visible:this.issue.type=="sast"&&this.$user.is_aikido_support,label:"Start traces scan",onClick:this.startTracesScan,icon:"icon-arrow-right",iconColor:"secondary"}]:e=[{visible:this.showAutoFixOption,label:"Autofix issue",onClick:this.handleCreateFix,icon:"icon-shield_check",iconColor:"secondary"},{visible:this.showCreateTaskOption,label:"Add task",onClick:this.handleStartCreateTicketFlow,icon:this.taskTrackerIcon,iconColor:this.taskTrackerIcon=="icon-JIRA"?"blue":""},{visible:(this.issue.type==="leaked_secret"||this.issue.type==="malware")&&this.issue.status!=="closed",label:this.$t("ISSUE_ACTION_MENU.SOLVE"),onClick:this.openSolveIssueFlow,icon:"icon-tick-circle",iconColor:"green"},{visible:(this.issue.type==="leaked_secret"||this.issue.type==="malware")&&this.issue.status==="closed",label:this.$t("ISSUE_ACTION_MENU.UNSOLVE"),onClick:this.handleUnsolveIssue,icon:"icon-unsolve"},{visible:this.issue.status==="snoozed",label:this.$t("ISSUE_ACTION_MENU.UNSNOOZE"),onClick:this.openUnsnoozeIssueFlow,icon:"icon-notification_inactive"},{visible:this.issue.status==="open",label:this.$t("ISSUE_ACTION_MENU.SNOOZE"),onClick:this.openSnoozeIssueFlow,icon:"icon-snooze"},{label:this.$t("ISSUE_ACTION_MENU.IGNORE"),onClick:this.handleStartIgnoreIssueFlow,icon:"icon-hidden",disabled:this.issue.status!=="open"},{visible:this.issue.status==="open"&&this.$groupUser.can_change_issue_severity==1,label:this.$t("ISSUE_ACTION_MENU.ADJUST_SEVERITY"),onClick:this.handleAdjustSeverity,icon:"icon-edit"},{visible:this.issue.type=="sast"&&this.$user.is_aikido_support,label:"Start traces scan",onClick:this.startTracesScan,icon:"icon-arrow-right",iconColor:"secondary"}],[{title:this.$t("ISSUE_ACTION_MENU.TITLE"),items:e.filter(s=>s.visible!==!1)}]},showAutoFixOption(){return Ws(this.issue,this.programmingLanguage,this.sastAutofixEnabled)},patchVersion(){if(this.showAutoFixOption)return Y(this.issue)},showCreateTaskOption(){return this.issue.status==="open"},taskTrackerIcon:qs},methods:{handleStartIgnoreIssueFlow(){if(this.issue.type=="license"){this.showContestLicenseScoringModal(!0);return}this.showIgnoreIssueFlow=!0},handleCloseIgnoreIssueFlow(){this.showIgnoreIssueFlow=!1},openSnoozeIssueFlow(){this.showSnoozeIssueFlow=!0},closeSnoozeIssueFlow(){this.showSnoozeIssueFlow=!1},openUnsnoozeIssueFlow(){this.showUnsnoozeIssueFlow=!0},closeUnsnoozeIssueFlow(){this.showUnsnoozeIssueFlow=!1},openUnignoreIssueFlow(){this.showUnignoreIssueFlow=!0},closeUnignoreIssueFlow(){this.showUnignoreIssueFlow=!1},openSolveIssueFlow(){this.showSolveIssueFlow=!0},closeSolveIssueFlow(){this.showSolveIssueFlow=!1},async handleCreateFix(){if(this.issue.type=="sast"){if(Ks(this.issue.rule_id)){await Ys([this.issue],!0,this.issue.title,!0);return}this.$modal.show("CreateSastAutofixModal",{issue:this.issue,programmingLanguage:this.programmingLanguage});return}this.showCreateAutoFixFlow=!0},async handleAdjustSeverity(){if(this.issue.type=="license"){this.showContestLicenseScoringModal();return}this.$modal.show("AdjustSeverityModal",{issue:this.issue})},handleStartCreateTicketFlow(){if(ne.hasExpiredFullTrial()&&!this.$featureflags.force_enable_task_trackers)return this.$modal.show("UpgradeAccountModal");this.showCreateTicketFlow=!0},async handleUnsolveIssue(){await Je(this.issue.id,!0)},async showContestLicenseScoringModal(e=!1){(await this.$modal.show("ContestLicenseScoringModal",{packageName:this.issue.package_name,isIgnore:e})).type=="saved"&&this.$modal.show("InfoModal",{headerText:this.issue.package_name,title:"License Scoring Updated",description:"The new license scoring will be reflected in the feed. This can take a couple of minutes.",buttonSubmitText:"Got It!",width:485})},async startTracesScan(){let e="";if(window.location.search.includes("autotriage_dev=true")){const t=sessionStorage.getItem("aik.autotriage.prompt")||"",s=await this.$modal.show("BaseInputTextAreaModal",{width:800,title:"Additional Prompt for AutoTriage",buttonSubmitText:"Start AutoTriage",initialText:t,placeholder:"Additional Prompt..."});if(s.type!="saved")return;e=s.value,sessionStorage.setItem("aik.autotriage.prompt",e)}await Me(-1,this.issue.id,-1,e),this.$toast.success("Traces scan started")}}};function Uo(e,t,s,d,u,o){const l=r("ActionMenu"),p=r("IgnoreIssue"),f=r("SnoozeIssue"),S=r("UnsnoozeIssueModal"),k=r("UnignoreIssue"),y=r("SolveIssue"),v=r("CreateAutoFixProgressFlow"),R=r("CreateTicketModal");return i(),_(w,null,[a(l,{sections:o.actions,useBaseIcon:!0,placement:"bottom-end"},{trigger:n(b=>[F(e.$slots,"trigger",{toggle:b.toggle})]),_:3},8,["sections"]),a(p,{onCancel:o.handleCloseIgnoreIssueFlow,show:u.showIgnoreIssueFlow,issue:s.issue,packageName:s.packageName},null,8,["onCancel","show","issue","packageName"]),u.showSnoozeIssueFlow?(i(),m(f,{key:0,onSnoozed:o.closeSnoozeIssueFlow,onCancel:o.closeSnoozeIssueFlow,id:s.issue.id},null,8,["onSnoozed","onCancel","id"])):I("",!0),u.showUnsnoozeIssueFlow?(i(),m(S,{key:1,onSubmit:o.closeUnsnoozeIssueFlow,onCancel:o.closeUnsnoozeIssueFlow,id:s.issue.id},null,8,["onSubmit","onCancel","id"])):I("",!0),u.showUnignoreIssueFlow?(i(),m(k,{key:2,onCancel:o.closeUnignoreIssueFlow,issue:s.issue,show:u.showUnignoreIssueFlow},null,8,["onCancel","issue","show"])):I("",!0),u.showSolveIssueFlow?(i(),m(y,{key:3,onCancel:o.closeSolveIssueFlow,singleIssue:s.issue},null,8,["onCancel","singleIssue"])):I("",!0),u.showCreateAutoFixFlow?(i(),m(v,{key:4,"package-name":s.packageName,issue:s.issue,onCancel:t[0]||(t[0]=b=>u.showCreateAutoFixFlow=!1)},null,8,["package-name","issue"])):I("",!0),u.showCreateTicketFlow?(i(),m(R,{key:5,issue:s.issue,isForSingleIssue:!0,onCreated:t[1]||(t[1]=b=>u.showCreateTicketFlow=!1),onCancel:t[2]||(t[2]=b=>u.showCreateTicketFlow=!1)},null,8,["issue"])):I("",!0)],64)}const Po=C(Bo,[["render",Uo]]),Mo={components:{BasePill:$,XTooltip:z},props:{singleIssue:Object,showSlaWarning:{type:Boolean,default:!1}},inject:["theme"],computed:{isIgnored(){return this.singleIssue.status==="ignored"},priority(){return this.isIgnored&&this.singleIssue.aikido_priority===1?this.singleIssue.initial_priority??this.singleIssue.aikido_priority:this.singleIssue.aikido_priority},severity(){return this.$t(De(this.priority))},severityClass(){return this.isIgnored?"gray-200":this.priority>=this.$severity.critical_min?"danger":this.priority>=this.$severity.high_min?"primary":this.priority>=this.$severity.medium_min?"blue-accent":"success"},isOutOfSla(){return!(this.singleIssue.sla_remediate_by_date>Date.now()/1e3)},isDueSoon(){var s;const e=we(Se(this.singleIssue.sla_remediate_by_date),new Date),t=((s=ee.data.slaThresholdSettings)==null?void 0:s.due_soon)??10;return 0<=e&&e<=t},isSlaEnabled(){return this.singleIssue.sla_remediate_by_date>0},outOfSlaSinceText(){return`Out of SLA since ${O.fromUnix(this.singleIssue.sla_remediate_by_date).format(O.SHORT_ISO_FORMAT)}`},dueTooltipText(){const e=we(Se(this.singleIssue.sla_remediate_by_date),new Date),t=O.fromUnix(this.singleIssue.sla_remediate_by_date).format(O.SHORT_ISO_FORMAT);return`Due in ${e} days
on ${t}`},shouldShowSlaPill(){return!(!this.showSlaWarning||!this.isSlaEnabled)},slaPillTitle(){return this.isOutOfSla?"Out of SLA":this.isDueSoon?"Due Soon":this.isSlaEnabled?"SLA":""},slaPillVariation(){return this.isOutOfSla?"orange-outline":"gray-outline"},slaPillTooltipText(){return this.isOutOfSla?this.outOfSlaSinceText:this.isDueSoon||this.isSlaEnabled?this.dueTooltipText:""}}},Do={class:"flex"},Fo={key:0,class:"icon icon-hidden icon-10px ml-4px"},Go={class:"ws-pre-line leading-16px"};function $o(e,t,s,d,u,o){const l=r("XTooltip"),p=r("BasePill");return i(),_("div",Do,[h("div",{class:A([o.severityClass,"inline-flex status-tag-basic small"])},[h("span",null,g(o.severity),1),o.isIgnored?(i(),_("i",Fo)):I("",!0)],2),F(e.$slots,"default"),o.shouldShowSlaPill?(i(),m(p,{key:0,class:"ml-6px px-6px cursor-default",variation:o.slaPillVariation,title:o.slaPillTitle,theme:o.theme,size:"compact"},{default:n(()=>[a(l,null,{default:n(()=>[h("div",Go,g(o.slaPillTooltipText),1)]),_:1})]),_:1},8,["variation","title","theme"])):I("",!0)])}const G=C(Mo,[["render",$o]]),zo={props:{pkg:Object,repoName:String},emits:["close"],components:{BaseLabel:te,BaseParagraph:E},data(){return{showMore:!1}},inject:["targetPath"],computed:{vulnerabilities(){const e=this.vulnerableFiles.map(s=>this.getDescriptionForFile(s));return[this.vulnerableFunctions?`vulnerable functions: ${this.vulnerableFunctions.join(", ")}`:void 0,...e].filter(Boolean)},vulnerableFiles(){const{files:e=[]}=this.pkg;return typeof e=="string"?[]:this.showMore||e.length===0?e:[e[0]]},vulnerableFunctions(){const{functions:e}=this.pkg;if(!(e==="SOME"||e==="ALL")&&Array.isArray(e))return e.filter(t=>t!=="unknown")},linkToNpmModule(){const{lib:e,version:t}=this.pkg;if(this.packageName!==this.repoName)return me(this.targetPath,e,t)},packageName(){const{lib:e,version:t}=this.pkg;return e!=="SCM_REPO"?`${e}@${t}`:this.repoName},showMoreLabel(){const{files:e=[]}=this.pkg;return typeof e=="string"?!1:e.length>1},toggleShowMorelabel(){return this.showMore?"Show less":"Show more"}},methods:{handleShowMore(){this.showMore=!this.showMore},getDescriptionForFile(e){const{lines:t=[],file:s}=e;return t.length===0?`${s}`:`${s} on lines ${t.join(", ")}`}}},Vo={class:"flex align-center"},jo=["href"],Ho=h("span",{class:"arrow"},null,-1),qo={class:"lib__more-info"};function Wo(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseLabel");return i(),_("div",{class:A(["lib",[s.pkg.nextUsed===!1?"not-connected":"connected"]])},[h("div",Vo,[o.linkToNpmModule?(i(),_("a",{key:0,href:o.linkToNpmModule,target:"_blank",class:"lib__package"},g(o.packageName),9,jo)):(i(),m(l,{key:1,bold:s.pkg.lib==="SCM_REPO"},{default:n(()=>[c(g(o.packageName),1)]),_:1},8,["bold"])),Ho]),s.pkg.nextUsed===!1?(i(),m(l,{key:0,color:"gray"},{default:n(()=>[c("No usage detected")]),_:1})):I("",!0),o.showMoreLabel?(i(),m(p,{key:1,onClick:X(o.handleShowMore,["stop"]),color:"gray",class:"lib__show-more"},{default:n(()=>[c(g(o.toggleShowMorelabel),1)]),_:1},8,["onClick"])):I("",!0),h("div",qo,[(i(!0),_(w,null,N(o.vulnerabilities,f=>(i(),m(l,{key:f,loose:!0},{default:n(()=>[c(g(f),1)]),_:2},1024))),128))])],2)}const Ko=C(zo,[["render",Wo]]),Xo={components:{BaseParagraph:E,BasePill:$,XTooltip:z},props:{pathPackageNames:Array,currentPackageName:String,isRepository:Boolean},inject:["targetPath"],computed:{isDevDependency(){return this.currentPackageName.startsWith("__devdep__")},cleanPackageName(){return this.currentPackageName.replace("__devdep__","")},hasFollowingPackages(){return this.pathPackageNames.indexOf(this.currentPackageName)<this.pathPackageNames.length-1},linkToNpmModule(){const[e,t,s]=this.cleanPackageName.split(":");if(!(!e||!t))return me(this.targetPath,e,t,s)}}},Yo={class:"flex align-center"},Jo=["href"],Qo=h("span",{class:"arrow"},null,-1);function Zo(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("XTooltip"),f=r("BasePill");return i(),_("div",{class:A(["lib",[o.hasFollowingPackages?"connected":"not-connected"]])},[h("div",Yo,[o.linkToNpmModule?(i(),_("a",{key:0,href:o.linkToNpmModule,target:"_blank",class:"lib__package"},g(o.cleanPackageName),9,Jo)):(i(),m(l,{key:1,bold:s.isRepository},{default:n(()=>[c(g(o.cleanPackageName),1)]),_:1},8,["bold"])),o.isDevDependency?(i(),m(f,{key:2,title:"devdep",size:"compact",class:"ml-4px cursor-help",variation:"purple"},{default:n(()=>[a(p,null,{default:n(()=>[c("Aikido detected that this package is not used in production. This library is used for building or testing your app.")]),_:1})]),_:1})):I("",!0),Qo])],2)}const en=C(Xo,[["render",Zo]]),sn={props:{issueId:Number,cveId:String,repoName:String,targetPath:String,programmingLanguage:String},emits:["close"],components:{BaseModal:B,BaseBody:se,BaseParagraph:E,PathEntry:Ko,BaseLabel:te,BaseButton:L,PathEntryDependencyPath:en,InputSwitch:bs},data(){return{analysisExclDevdeps:void 0,analysisInclDevdeps:void 0,isLoading:!0,errorMesssage:void 0,includeDevdeps:!1}},provide(){return{targetPath:ws(()=>this.targetPath)}},mounted(){this.fetchAnalysis()},computed:{canHaveDepTreeWithDevDeps(){var e;return!(this.programmingLanguage!=="JS"||(e=this.analysis)!=null&&e.reachability_analysis_found)},analysis(){return this.includeDevdeps?this.analysisInclDevdeps:this.analysisExclDevdeps},timestamp(){var e;return(e=this.analysis)!=null&&e.reported_at?`Results were found ${Z(this.analysis.reported_at)} ago`:"Aikido is still analyzing reachability of the exploit"},dependencyPaths(){if(this.analysis.reachability_analysis_found)return[];const e=Object.keys(this.analysis.dependency_paths_by_package)[0];let t=JSON.parse(JSON.stringify(this.analysis.dependency_paths_by_package[e]??[]));return t=t.map(s=>s.reverse()),t=t.map(s=>[...s,e]),t},isSelfScanAccount(){var e;return((e=this.$group)==null?void 0:e.scm_type)==="selfscan"}},methods:{async fetchAnalysis(){try{const e=[de(this.issueId,{include_dev_deps:!1,disable_toasts:!0})];this.canHaveDepTreeWithDevDeps&&e.push(de(this.issueId,{include_dev_deps:!0,disable_toasts:!0}));const[t,s]=await Promise.all(e);this.analysisExclDevdeps=t,this.analysisInclDevdeps=s,this.canHaveDepTreeWithDevDeps&&this.dependencyPaths.length==0&&(this.includeDevdeps=!0),this.isLoading=!1,this.errorMesssage=void 0}catch(e){e.response&&e.response.status===404&&(this.errorMesssage=this.$t("ISSUES.REACHABILITY_ANALYSIS.NOT_FOUND"),this.isLoading=!1)}},async handleRunAnalyses(){await vs(this.issueId),Es.track("Reachability Analysis Requested",{issueId:this.issueId}),Toast.success({title:this.$t("NOTIFICATIONS.SCAN_STARTED.TITLE"),description:this.$t("ISSUES.REACHABILITY_ANALYSIS.SCAN_STARTED")})}}},tn={key:0,class:"p-16px"},on={key:1,class:"p-16px"},nn={key:2,class:"reachability-analysis-visualizer"},an={class:"path"},rn={key:3,class:"text-gray-900 mt-8px"},un={key:4,class:"reachability-analysis-visualizer"},ln={class:"path"},cn={class:"flex justify-between align-center gap-16px w-full"},dn={key:1},hn={key:2,class:"flex align-center gap-16px"};function _n(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseBody"),f=r("PathEntry"),S=r("PathEntryDependencyPath"),k=r("InputSwitch"),y=r("BaseLabel"),v=r("BaseButton"),R=r("BaseModal");return i(),m(R,{maxWidth:"90%",width:"auto",onClose:t[1]||(t[1]=b=>e.$emit("close"))},{header:n(()=>[a(l,{color:"subdued"},{default:n(()=>[c(" Reachability analysis for issue with CVE: "),h("strong",null,g(s.cveId),1)]),_:1})]),content:n(()=>[u.isLoading?(i(),_("div",tn,[a(p,{bold:!0},{default:n(()=>[c("Loading...")]),_:1})])):u.errorMesssage?(i(),_("div",on,[a(p,{bold:!0},{default:n(()=>[c(g(u.errorMesssage),1)]),_:1})])):o.analysis.reachability_analysis_found?(i(),_("div",nn,[(i(!0),_(w,null,N(o.analysis.paths,b=>(i(),_("div",an,[(i(!0),_(w,null,N(b,x=>(i(),m(f,{key:x.lib,pkg:x,repoName:s.repoName},null,8,["pkg","repoName"]))),128))]))),256))])):o.dependencyPaths.length==0?(i(),_("div",rn,"No analysis found.")):(i(),_("div",un,[(i(!0),_(w,null,N(o.dependencyPaths,b=>(i(),_("div",ln,[a(S,{pathPackageNames:b,currentPackageName:s.repoName,isRepository:""},null,8,["pathPackageNames","currentPackageName"]),(i(!0),_(w,null,N(b,x=>(i(),m(S,{key:x,pathPackageNames:b,currentPackageName:x},null,8,["pathPackageNames","currentPackageName"]))),128))]))),256))]))]),footer:n(()=>[h("div",cn,[!u.isLoading&&o.canHaveDepTreeWithDevDeps?(i(),m(k,{key:0,modelValue:u.includeDevdeps,"onUpdate:modelValue":t[0]||(t[0]=b=>u.includeDevdeps=b),name:"include_devdeps",labelRight:"Include devdeps"},null,8,["modelValue"])):(i(),_("div",dn)),o.isSelfScanAccount?I("",!0):(i(),_("div",hn,[a(y,{color:"gray"},{default:n(()=>[c(g(o.timestamp),1)]),_:1}),a(v,{onClicked:o.handleRunAnalyses},{default:n(()=>[c("Run analysis again")]),_:1},8,["onClicked"])]))])]),_:1})}const Ie=C(sn,[["render",_n]]),pn={components:{BaseConfirmModal:xs,BaseLink:P,ReachabilityAnalysisVisualisationModal:Ie,AIText:Vs},emits:["close"],props:{appliedScoreReasons:{type:Array,required:!0},ignoreReason:{type:String,required:!0},snoozeReason:{type:String,required:!0},issue:{type:Object,required:!0},programmingLanguage:{type:String,default:""}},data(){return{isLoadingIgnoreReasons:!1,ignoreReasons:[],showDependencyPathModal:!1}},async mounted(){await this.loadIgnoreReasons()},computed:{shouldHideSecondaryButton(){return!this.appliedScoreReasons.some(({rule:e})=>typeof e=="string"&&e.startsWith("llm_assessment_"))},ignoreRuleCreatedByName(){return this.ignoreReasons.length<1?null:this.ignoreReasons[0].created_by_name},isIgnoredByRule(){return!(this.ignoreReasons.length<1||this.ignoreReasons[0].kind!="rule_ignore")},ignoreRuleDescription(){return this.isIgnoredByRule?this.ignoreReasons[0].title:""},userIgnoreReason(){return this.isIgnoredByRule?this.ignoreReasons[0].user_comment:""},shouldShowHowYoureUsingIt(){return this.appliedScoreReasons.some(s=>s.rule=="fake_dev_dependency")?["PY","JS"].includes(this.programmingLanguage):!1}},methods:{async loadIgnoreReasons(){this.isLoadingIgnoreReasons=!0,this.ignoreReasons=await Rs(this.issue.id),this.isLoadingIgnoreReasons=!1},sendFeedback(){this.$emit("close"),this.$nextTick(()=>{this.$modal.show("AutoTriageFeedbackModal",{issue:this.issue})})}}},gn={key:0,class:"valign-middle icon text-12px text--bold icon-arrow-up text-surface-red-100"},fn={key:1,class:"valign-middle icon text-12px text--bold icon-arrow-down text-surface-green-100"},mn={key:2,class:"text-surface-blue-100 text-18px"},In={key:3,class:"ml-4px"},Sn=h("span",{class:"text-surface-red-100 text--semi-bold"},"upgraded",-1),yn={key:4,class:"ml-4px"},kn=h("span",{class:"text-surface-green-100 text--semi-bold"},"downgraded",-1),Cn={key:5},bn=h("br",null,null,-1),wn={key:0,class:"mt-16px"},vn={key:1,class:"mt-16px"},En=h("span",{class:"group-hover:underline"},"See how you're using it",-1),xn=h("i",{class:"icon icon-arrow-right text-8px ml-4px text-deco-none"},null,-1);function Rn(e,t,s,d,u,o){const l=r("AIText"),p=r("BaseParagraph"),f=r("BaseLink"),S=r("BaseConfirmModal"),k=r("ReachabilityAnalysisVisualisationModal");return i(),_(w,null,[u.showDependencyPathModal?I("",!0):(i(),m(S,{key:0,title:"How did we score this issue?",buttonSubmitText:"Gotcha!",buttonSecondaryText:"Send Feedback",hideSecondaryButton:o.shouldHideSecondaryButton,onSecondaryButtonClicked:o.sendFeedback,onSubmit:t[1]||(t[1]=y=>e.$emit("close")),onClose:t[2]||(t[2]=y=>e.$emit("close")),width:"700"},{default:n(()=>[(i(!0),_(w,null,N(s.appliedScoreReasons,(y,v)=>(i(),m(p,{key:v,class:"mt-8px"},{default:n(()=>[y.severity_up_down=="up"?(i(),_("i",gn)):I("",!0),y.severity_up_down=="down"?(i(),_("i",fn)):I("",!0),y.severity_up_down=="none"?(i(),_("span",mn,"=")):I("",!0),y.severity_up_down=="up"?(i(),_("span",In,[c("Aikido "),Sn,c(" the severity of this issue:")])):I("",!0),y.severity_up_down=="down"?(i(),_("span",yn,[c("Aikido "),kn,c(" the severity of this issue:")])):I("",!0),c(" "+g(y.rule_info)+" ",1),y.llm_summary&&y.llm_summary.trim()!==""?(i(),_("div",Cn,[bn,a(l,null,{default:n(()=>[c("AutoTriage Reasoning: "+g(y.llm_summary),1)]),_:2},1024)])):I("",!0)]),_:2},1024))),128)),o.isIgnoredByRule?(i(),_(w,{key:0},[h("div",{class:A({"mt-8px":s.appliedScoreReasons.length==0,"mt-32px":s.appliedScoreReasons.length>0})},[a(p,{bold:"true"},{default:n(()=>[c("Ignore rule")]),_:1}),a(p,{class:"mt-4px"},{default:n(()=>[c(g(o.ignoreRuleDescription),1)]),_:1})],2),o.userIgnoreReason?(i(),_("div",wn,[a(p,{bold:"true"},{default:n(()=>[c("Ignore reason")]),_:1}),a(p,{class:"mt-4px"},{default:n(()=>[c(g(o.userIgnoreReason),1)]),_:1})])):I("",!0),o.ignoreRuleCreatedByName?(i(),_("div",vn,[a(p,{bold:"true"},{default:n(()=>[c("Created by")]),_:1}),a(p,{class:"mt-4px"},{default:n(()=>[c(g(o.ignoreRuleCreatedByName),1)]),_:1})])):I("",!0)],64)):s.ignoreReason?(i(),_("div",{key:1,class:A({"mt-8px":s.appliedScoreReasons.length==0,"mt-32px":s.appliedScoreReasons.length>0})},[a(p,{bold:"true"},{default:n(()=>[c("Ignore reason")]),_:1}),a(p,{class:"mt-4px"},{default:n(()=>[c(g(s.ignoreReason),1)]),_:1}),o.shouldShowHowYoureUsingIt?(i(),m(f,{key:0,as:"button",onClick:t[0]||(t[0]=y=>u.showDependencyPathModal=!0),class:"leading-18px group"},{default:n(()=>[En,xn]),_:1})):I("",!0)],2)):I("",!0),s.snoozeReason?(i(),_("div",{key:2,class:A({"mt-8px":s.appliedScoreReasons.length==0,"mt-32px":s.appliedScoreReasons.length>0})},[a(p,{bold:"true"},{default:n(()=>[c("Snooze Reason")]),_:1}),a(p,{class:"mt-4px"},{default:n(()=>[c(g(s.snoozeReason),1)]),_:1})],2)):I("",!0)]),_:1},8,["hideSecondaryButton","onSecondaryButtonClicked"])),u.showDependencyPathModal?(i(),m(k,{key:1,issueId:s.issue.id,cveId:s.issue.cve_id,repoName:s.issue.repo_name,"target-path":s.issue.target_path,programmingLanguage:s.programmingLanguage,onClose:t[3]||(t[3]=y=>u.showDependencyPathModal=!1)},null,8,["issueId","cveId","repoName","target-path","programmingLanguage"])):I("",!0)],64)}const Tn=C(pn,[["render",Rn]]),On={components:{BaseLink:P,BaseParagraph:E,XTooltip:z,SeverityReasonInfoModal:Tn},props:{subIssue:Object,programmingLanguage:{type:String,default:""}},data(){return{showModal:!1}},expose:["openModal"],computed:{isTotalPriorityUp(){const e=this.subIssue.aikido_priority,t=this.subIssue.initial_priority;return this.subIssue.status=="ignored"?!1:e>t&&e>1?!0:e<t?!1:e==100},priorityChangeIndicatorIconClasses(){return this.isTotalPriorityUp?["icon-arrow-up","text-surface-red-100"]:["icon-arrow-down","text-surface-green-100"]},message(){if(this.snoozeReasonText)return this.snoozeReasonText;if(this.subIssue.status==="ignored"){const s=this.subIssue.ignore_reasons;if(s.length>0){const d=s[0],u=this.getManuallyIgnoredText(d);return u||d.title}}const t=this.appliedScoreReasons[0].rule_title;return this.isTotalPriorityUp?`Upgraded: ${t}`:`Downgraded: ${t}`},appliedScoreReasons(){let e=this.subIssue.aikido_score_reasons.filter(s=>!(s.severity_up_down=="none"&&s.rule.startsWith("llm_assessment_")||s.applied===!1));const t=["down","none","up"];return e.sort((s,d)=>{const u=t.indexOf(s.severity_up_down),o=t.indexOf(d.severity_up_down);return u-o}),this.isTotalPriorityUp&&(e=e.reverse()),e},hasIgnoreReason(){return this.subIssue.ignore_reasons.some(s=>s.kind==="rule_ignore")||this.subIssue.ignore_reasons.some(s=>s.kind==="manual_ignore")?!0:!!this.subIssue.ignored_reason},ignoreReason(){return this.subIssue.ignored_reason?this.subIssue.ignored_reason:this.subIssue.ignore_reasons.length>0?this.subIssue.ignore_reasons[0].title:null},hasSnoozeReason(){return this.snoozeReasonText!=""},snoozeReason(){const e=this.subIssue.snooze_reason;return e.reason?e.reason:""},snoozeReasonText(){if(this.subIssue.status!="snoozed")return"";const e=this.subIssue.snooze_reason;let t="";return e.by_user_name&&(t+=`Snoozed by ${e.by_user_name}`),e.reason&&(t&&(t+=" |"),t+=` Reason:  ${e.reason}`),t}},methods:{close(){this.showModal=!1},getManuallyIgnoredText(e){if(!e.ignored_by_user_name)return"";const t=`Ignored by ${e.ignored_by_user_name}`;return this.subIssue.ignored_reason?t+` | Reason: ${this.subIssue.ignored_reason}`:t},openModal(){this.showModal=!0}}},An={key:0,class:"issue-detail__subissues__issue-severity-info"},Nn={class:"flex align-center gap-4px overflow-hidden"};function Ln(e,t,s,d,u,o){const l=r("XTooltip"),p=r("BaseParagraph"),f=r("SeverityReasonInfoModal");return o.appliedScoreReasons.length>0||o.hasIgnoreReason||o.hasSnoozeReason?(i(),_("div",An,[h("div",{class:"flex align-center gap-8px text-break-all max-w-350px cursor-pointer",onClick:t[0]||(t[0]=(...S)=>o.openModal&&o.openModal(...S))},[h("div",Nn,[o.hasSnoozeReason?I("",!0):(i(),_("i",{key:0,class:A(["icon text-12px text--bold",[o.priorityChangeIndicatorIconClasses]])},null,2)),a(p,{truncate:"",class:"text-break-all issue-detail__subissues__issue-severity-info__message"},{default:n(()=>[c(g(o.message)+" ",1),a(l,{class:"hidden wide-tablet_show"},{default:n(()=>[c(g(o.message),1)]),_:1})]),_:1})])]),u.showModal?(i(),m(f,{key:0,appliedScoreReasons:o.appliedScoreReasons,snoozeReason:o.snoozeReason,ignoreReason:o.ignoreReason,issue:s.subIssue,programmingLanguage:s.programmingLanguage,onClose:o.close},null,8,["appliedScoreReasons","snoozeReason","ignoreReason","issue","programmingLanguage","onClose"])):I("",!0)])):I("",!0)}const H=C(On,[["render",Ln]]),Bn={props:{href:String},components:{BaseParagraph:E}},Un=["href"],Pn=h("i",{class:"icon icon-viewDetails icon-12px"},null,-1),Mn=h("i",{class:"icon icon-viewDetails icon-12px"},null,-1);function Dn(e,t,s,d,u,o){const l=r("router-link"),p=r("BaseParagraph");return i(),m(p,{class:"issue-detail__subissues__issue-title"},{default:n(()=>[s.href&&s.href.startsWith("https://")?(i(),_("a",{key:0,href:s.href,target:"_blank"},[h("span",null,[F(e.$slots,"default")]),Pn],8,Un)):s.href?(i(),m(l,{key:1,to:s.href},{default:n(()=>[h("span",null,[F(e.$slots,"default")]),Mn]),_:3},8,["to"])):F(e.$slots,"default",{key:2})]),_:3})}const V=C(Bn,[["render",Dn]]),Fn={props:{href:String},components:{BaseParagraph:E}},Gn=h("i",{class:"icon icon-viewDetails icon-12px"},null,-1);function $n(e,t,s,d,u,o){const l=r("router-link"),p=r("BaseParagraph");return i(),m(p,{class:"issue-detail__subissues__issue-meta text-break-all"},{default:n(()=>[s.href?(i(),m(l,{key:0,to:s.href},{default:n(()=>[h("span",null,[F(e.$slots,"default")]),Gn]),_:3},8,["to"])):F(e.$slots,"default",{key:1})]),_:3})}const j=C(Fn,[["render",$n]]),zn={props:{label:String,value:[Object,String],issue:Object},components:{BaseParagraph:E},methods:{isJsonObject(e){return typeof e=="object"}}},Vn={key:0,class:"flex flex-column gap-4px"};function jn(e,t,s,d,u,o){const l=r("BaseParagraph");return o.isJsonObject(s.value)?(i(),_("div",Vn,[a(l,{color:"subdued",truncate:!0},{default:n(()=>[c(g(s.label)+":",1)]),_:1}),(i(!0),_(w,null,N(s.value,(p,f)=>(i(),m(l,{key:`${s.label}_${f}`,color:"subdued",truncate:!0},{default:n(()=>[c("  "+g(f)+": "+g(p),1)]),_:2},1024))),128))])):(i(),m(l,{key:1,color:"subdued"},{default:n(()=>[c(g(s.label)+": "+g(s.value),1)]),_:1}))}const Te=C(zn,[["render",jn]]),Hn={props:{value:[Object,Array],issue:Object},components:{BaseParagraph:E,BaseLink:P},computed:{isArray(){return Array.isArray(this.value)}},methods:{generateLinkToSecurityGroup(e){return`https://${this.issue.region}.console.aws.amazon.com/ec2/home?region=${this.issue.region}#SecurityGroup:group-id=${e}`}}};function qn(e,t,s,d,u,o){const l=r("BaseLink"),p=r("BaseParagraph");return o.isArray?(i(!0),_(w,{key:0},N(s.value,(f,S)=>(i(),m(p,{key:S,color:"subdued",truncate:!0},{default:n(()=>[c(" Vulnerable Security Group: "),a(l,{as:"link",href:o.generateLinkToSecurityGroup(f.security_group_id),target:"_blank"},{default:n(()=>[c(g(f.security_group_id),1)]),_:2},1032,["href"])]),_:2},1024))),128)):(i(),m(p,{key:1,color:"subdued",truncate:!0},{default:n(()=>[c(" Security group: "),a(l,{as:"link",href:o.generateLinkToSecurityGroup(s.value.id),target:"_blank"},{default:n(()=>[c(g(s.value.id),1)]),_:1},8,["href"])]),_:1}))}const Oe=C(Hn,[["render",qn]]),Wn={props:{value:Array,issue:Object},components:{BaseParagraph:E,BaseLink:P},computed:{isArray(){return Array.isArray(this.value)}},methods:{generateLinkToSecurityGroup(e){return`https://${this.issue.region}.console.aws.amazon.com/ec2/home?region=${this.issue.region}#SecurityGroup:group-id=${e}`},label(e){return e==="desync_mitigation_mode"?"HTTP desync mitigation mode":e==="drop_invalid_header_fields"?"Drop invalid HTTP header fields":"Unknown"},suggestedValue(e){return e==="desync_mitigation_mode"?"defend":e==="drop_invalid_header_fields"?"true":"Unknown"},moreInfoUrl(e){return e==="desync_mitigation_mode"?"https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/config-desync-mitigation-mode.html":e==="drop_invalid_header_fields"?"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#load-balancer-attributes":null}}},Kn={class:"flex gap-8px flex-column"};function Xn(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseLink");return i(),_("div",Kn,[(i(!0),_(w,null,N(s.value,f=>(i(),_("div",{class:"flex flex-column",key:f.type},[a(l,{color:"subdued",truncate:!0},{default:n(()=>[c(g(o.label(f.type))+": '"+g(f.value)+"' => '"+g(o.suggestedValue(f.type))+"' ",1)]),_:2},1024),a(p,{href:o.moreInfoUrl(f.type),target:"_blank"},{default:n(()=>[c("More info")]),_:2},1032,["href"])]))),128))])}const Yn=C(Wn,[["render",Xn]]),Jn={props:{value:Object},components:{BaseParagraph:E}};function Qn(e,t,s,d,u,o){const l=r("BaseParagraph");return i(),_(w,null,[a(l,{color:"subdued",truncate:!0},{default:n(()=>[c("Role: "+g(s.value.roleName),1)]),_:1}),a(l,{color:"subdued",truncate:!0},{default:n(()=>[c("Policies:")]),_:1}),(i(!0),_(w,null,N(s.value.policies,p=>(i(),m(l,{key:p.PolicyArn,color:"subdued",class:"pl-8px ws-break-all"},{default:n(()=>[c("  "+g(p.PolicyName),1)]),_:2},1024))),128))],64)}const Zn=C(Jn,[["render",Qn]]),ei={props:{issue:Object},components:{BaseLink:P},computed:{href(){return`https://${this.issue.region}.console.aws.amazon.com/guardduty/home?region=${this.issue.region}`}}};function si(e,t,s,d,u,o){const l=r("BaseLink");return i(),m(l,{as:"link",href:o.href,target:"_blank",class:"flex mt-8px"},{default:n(()=>[c(" See findings ")]),_:1},8,["href"])}const ti=C(ei,[["render",si]]),oi={props:{value:Object},components:{BaseParagraph:E},computed:{formattedTimestamp(){return this.value.last_used_at?Js(this.value.last_used_at):null}}};function ni(e,t,s,d,u,o){const l=r("BaseParagraph");return o.formattedTimestamp?(i(),m(l,{key:0,color:"subdued",truncate:!0},{default:n(()=>[c("Last used: "+g(o.formattedTimestamp)+" days ago",1)]),_:1})):I("",!0)}const ii=C(oi,[["render",ni]]),ai={props:{value:String},components:{BaseParagraph:E}};function ri(e,t,s,d,u,o){const l=r("BaseParagraph");return i(),m(l,{color:"subdued"},{default:n(()=>[c(g(s.value),1)]),_:1})}const ui=C(ai,[["render",ri]]),li={props:{issue:Object},components:{BaseParagraph:E,XTooltip:z},inject:["theme"],computed:{userAdjustedSeverity(){return!!this.issue.user_severity_adjusted},userAdjustment(){return this.issue.user_severity_adjustment},severityAdjustmentIcon(){return this.userAdjustment==="up"?["icon-arrow-up","text-surface-red-100"]:["icon-arrow-down","text-surface-green-100"]},label(){return this.userAdjustment==="up"?this.$t("ISSUE.USER_ADJUSTED_SEVERITY.UPGRADE"):this.$t("ISSUE.USER_ADJUSTED_SEVERITY.DOWNGRADE")}},methods:{handleShowModal(){this.$modal.show("UserAdjustedSeverityInfoModal",{issue:this.issue})}}};function ci(e,t,s,d,u,o){const l=r("XTooltip"),p=r("BaseParagraph");return o.userAdjustedSeverity?(i(),_("div",{key:0,onClick:t[0]||(t[0]=(...f)=>o.handleShowModal&&o.handleShowModal(...f)),class:"flex align-center gap-8px text-break-all sidebar_text_message cursor-pointer overflow-hidden"},[h("i",{class:A(["icon text-12px text--bold",[o.severityAdjustmentIcon]])},null,2),a(p,{color:o.theme==="light"?"dark-gray":"light-gray",truncate:"",class:"text-break-all"},{default:n(()=>[c(g(o.label)+" ",1),a(l,{class:"hidden wide-tablet_show"},{default:n(()=>[c(g(o.label),1)]),_:1})]),_:1},8,["color"])])):I("",!0)}const q=C(li,[["render",ci]]),di={components:{BaseParagraph:E,SeverityReasonInfo:H,IssueSeverityLabel:G,DefaultCloudIssueMetadata:Te,AwsSecurityGroupCloudIssueMetadata:Oe,IssueTitle:V,IssueMeta:j,UserAdjustedSeverityInfo:q,AwsSuspiciousApiCallMetadata:ti},props:{issue:Object},computed:{resourceName(){return this.issue.resource_id&&this.issue.resource_name?`${this.formattedResourceKind}: ${this.issue.resource_name}`:this.issue.resource_id?`Resource id: ${this.issue.resource_id}`:this.issue.resource_name},metadata(){return!this.issue.metadata||typeof this.issue.metadata!="object"?{}:this.issue.metadata},formattedResourceKind(){switch(this.issue.resource_kind){case"aws_ec2_instance":return this.$t("ISSUES.CLOUD.RESOURCE_KIND.AWS_EC2_INSTANCE");case"aws_user":return this.$t("ISSUES.CLOUD.RESOURCE_KIND.AWS_USER");case"aws_security_group":return this.$t("ISSUES.CLOUD.RESOURCE_KIND.AWS_SECURITY_GROUP");case"aws_s3_bucket":return this.$t("ISSUES.CLOUD.RESOURCE_KIND.AWS_S3_BUCKET");case"aws_ecr_repository":return this.$t("ISSUES.CLOUD.RESOURCE_KIND.AWS_ECR_REPOSITORY");case"aws_sqs_queue":return this.$t("ISSUES.CLOUD.RESOURCE_KIND.AWS_SQS_QUEUE");case"aws_account":return this.$t("ISSUES.CLOUD.RESOURCE_KIND.AWS_ACCOUNT");case"aws_rds_db_instance":return this.$t("ISSUES.CLOUD.RESOURCE_KIND.AWS_RDS_DB_INSTANCE");case"aws_lambda_function":return this.$t("ISSUES.CLOUD.RESOURCE_KIND.AWS_LAMBDA_FUNCTION");default:return`${this.formattedCloudType} resource`}},formattedCloudType(){return this.issue.cloud_type==="gcp"?"GCP":this.issue.cloud_type==="azure"?"Azure":this.issue.cloud_type==="digocean"?"Digital Ocean":"AWS"},showSuspiciousActivityMetadata(){return this.issue.aikido_rule_code==="aik_cloud_aws_035"}},methods:{getIssueMetadataComponent(e){switch(e){case"vulnerable_sg_rules":case"security_group":return Oe;case"vulnerable_load_balancer_attributes":return Yn;case"affected_policies":return Zn;case"accessKeyId":case"user_is_admin":return null;case"access_keys":return ii;case"vulnerable_gcp_role_message":return ui;default:return Te}},isJsonObject(e){return typeof e=="object"}}},hi={class:"td"},_i={class:"flex mb-2px gap-8px align-center text-break-all"};function pi(e,t,s,d,u,o){const l=r("IssueTitle"),p=r("IssueSeverityLabel"),f=r("IssueMeta"),S=r("AwsSuspiciousApiCallMetadata"),k=r("SeverityReasonInfo"),y=r("UserAdjustedSeverityInfo");return i(),_("div",hi,[h("div",_i,[a(l,null,{default:n(()=>[c(g(o.resourceName),1)]),_:1}),a(p,{singleIssue:s.issue,showSlaWarning:""},null,8,["singleIssue"])]),a(f,{color:"subdued"},{default:n(()=>[c(g(s.issue.resource_id),1)]),_:1}),o.showSuspiciousActivityMetadata?(i(),m(S,{key:0,issue:s.issue},null,8,["issue"])):I("",!0),(i(!0),_(w,null,N(o.metadata,(v,R)=>(i(),_("div",{key:R,class:"mt-8px"},[(i(),m(Fe(o.getIssueMetadataComponent(R)),{key:R,label:R,value:v,issue:s.issue},null,8,["label","value","issue"]))]))),128)),a(k,{subIssue:s.issue,class:"mt-8px"},null,8,["subIssue"]),a(y,{issue:s.issue},null,8,["issue"])])}const gi=C(di,[["render",pi]]),fi={props:{issue:Object,groupedIssue:Object},components:{ReachabilityAnalysisVisualisationModal:Ie,SeverityReasonInfo:H,IssueSeverityLabel:G,BaseLink:P,BaseParagraph:E,IssueTitle:V,IssueMeta:j,UserAdjustedSeverityInfo:q},data(){return{dependencyPath:void 0,showDependencyPathModal:!1}},inject:["theme"],computed:{programmingLanguage(){return this.groupedIssue.programming_language},parentPackages(){let e=[];for(const t of this.issue.aikido_score_reasons)t.parent_packages&&(e=[...e,...t.parent_packages]);return e},nearestPatchVersion(){return Y(this.issue)??"N/A"},targetPath(){const{attack_surface:e,cloud_repo_name:t,target_path:s}=this.issue;return s},paragraphColor(){return this.theme==="light"?"black":"white"},fixText(){let e=this.nearestPatchVersion.trim();return e.indexOf(">=")===0?e=e.replace(">=",""):e.indexOf(">")===0&&(e=e.replace(">","above ")),`${this.issue.installed_version} => ${e}`},fixTextClass(){let e=!1;for(const t of this.issue.aikido_score_reasons)if(t.rule==="known_safe_version_installed"||t.rule==="known_safe_version_installed_by_range"){e=!0;break}return{"ws-nowrap":this.fixText.length<25,"text-deco-line-through":e}},showHowYoureUsingIt(){var e;return((e=this.issue)==null?void 0:e.attack_surface)=="docker_container"?!!this.isDockerContainerJavaIssue:this.targetPath.endsWith("package.json")?!1:!!(this.parentPackages.length>0||this.programmingLanguage=="PY"||this.programmingLanguage=="JS"||this.issue.has_dependency_tree)},isDockerContainerJavaIssue(){var t,s;const e=[".jar",".war",".ear"];return((t=this.issue)==null?void 0:t.attack_surface)=="docker_container"&&((s=this.issue)==null?void 0:s.cloud_id)<0&&!this.issue.target_path.includes(this.groupedIssue.package_name)&&e.some(d=>this.issue.target_path.endsWith(d))}},methods:{async handleShowDependencyPathModal(){if(this.isDockerContainerJavaIssue)return this.$modal.show("ShowIssueVirtualPathModal",{issueId:this.issue.id});this.showDependencyPathModal=!0},handleCloseDependencyPathModal(){this.showDependencyPathModal=!1,this.dependencyPath=void 0},getCveHref(e){return e.cve_id.startsWith("AIKIDO-")?`https://security.aikido.dev/cve/${this.issue.cve_id}`:`/issues/${this.groupedIssue.id}/detail#${this.issue.cve_id}`}}},mi={class:"td"},Ii={class:"flex flex-column gap-2px"},Si={class:"flex align-center gap-8px"},yi={key:0},ki=["href"],Ci=h("span",{class:"group-hover:underline"},"See how you're using it",-1),bi=h("i",{class:"icon icon-arrow-right text-8px ml-4px text-deco-none"},null,-1),wi={class:"td collapsing"};function vi(e,t,s,d,u,o){const l=r("IssueTitle"),p=r("IssueSeverityLabel"),f=r("IssueMeta"),S=r("BaseLink"),k=r("SeverityReasonInfo"),y=r("UserAdjustedSeverityInfo"),v=r("BaseParagraph"),R=r("ReachabilityAnalysisVisualisationModal");return i(),_(w,null,[h("div",mi,[h("div",Ii,[h("div",Si,[a(l,{href:o.getCveHref(s.issue)},{default:n(()=>{var b;return[c(g(s.issue.cve_id)+" ",1),(b=s.issue.aikido_cve_analysis)!=null&&b.related_cve_id?(i(),_("span",yi,"| "+g(s.issue.aikido_cve_analysis.related_cve_id),1)):I("",!0)]}),_:1},8,["href"]),a(p,{class:"ml-8px",singleIssue:s.issue,showSlaWarning:""},null,8,["singleIssue"])]),s.issue.target_path_url?(i(),_("a",{key:0,href:s.issue.target_path_url,target:"_blank",class:"cursor-pointer underline-hover"},[a(f,null,{default:n(()=>[c(g(o.targetPath),1)]),_:1})],8,ki)):(i(),m(f,{key:1},{default:n(()=>[c(g(o.targetPath),1)]),_:1})),o.showHowYoureUsingIt?(i(),m(S,{key:2,as:"button",onClick:o.handleShowDependencyPathModal,class:"leading-18px group"},{default:n(()=>[Ci,bi]),_:1},8,["onClick"])):I("",!0),a(k,{subIssue:s.issue,programmingLanguage:o.programmingLanguage,class:"mt-8px"},null,8,["subIssue","programmingLanguage"]),a(y,{issue:s.issue},null,8,["issue"])])]),h("div",wi,[a(v,{color:o.paragraphColor,class:A(o.fixTextClass)},{default:n(()=>[c(g(o.fixText),1)]),_:1},8,["color","class"])]),u.showDependencyPathModal?(i(),m(R,{key:0,issueId:s.issue.id,cveId:s.issue.cve_id,repoName:s.issue.repo_name,"target-path":s.issue.target_path,programmingLanguage:s.groupedIssue.programming_language,onClose:o.handleCloseDependencyPathModal},null,8,["issueId","cveId","repoName","target-path","programmingLanguage","onClose"])):I("",!0)],64)}const Ei=C(fi,[["render",vi]]),xi={props:{issue:Object},components:{SeverityReasonInfo:H,IssueSeverityLabel:G,XTooltip:z,IssueTitle:V,IssueMeta:j,BaseLink:P,UserAdjustedSeverityInfo:q,BasePill:$},inject:["theme"],computed:{fileAndLineNumber(){return`Line ${this.issue.start_line} in ${this.issue.file}`},matchedLine(){const{matched_line:e,redacted_secret:t}=this.issue;if(e.startsWith("SNIPPETHASH_"))return t;if(t.length<=40)return e;const s=e.indexOf("*"),d=e.slice(0,s),u=t.slice(-4),o="(...)".padStart(20,"*").padEnd(35,"*")+u;return[d,o].join("")},isTokenLive(){return this.issue.aikido_score_reasons.some(e=>e.applied===!1?!1:["token_live_dangerous","token_live"].includes(e.rule))},secretTooltipText(){return this.issue.description.includes(",")?this.issue.description.split(",")[0]:this.issue.description}},methods:{openSeverityReasonsModal(){this.$refs.severityReasonInfo.openModal()},openCopyCommitModal(){this.$modal.show("BasicCopyTextModal",{text:this.issue.commit,headerText:"copy commit",title:"Commit hash"})}}},Ri={class:"td"},Ti={class:"flex flex-column gap-2px"},Oi={class:"flex gap-8px align-center"},Ai=["href"],Ni=h("span",{class:"group-hover:underline"},"View commit",-1),Li=h("i",{class:"icon icon-arrow-right text-8px pl-4px text-deco-none"},null,-1),Bi=h("span",{class:"group-hover:underline"},"View commit",-1),Ui=h("i",{class:"icon icon-arrow-right text-8px pl-4px text-deco-none"},null,-1),Pi={class:"td collapsing"};function Mi(e,t,s,d,u,o){const l=r("IssueTitle"),p=r("XTooltip"),f=r("BasePill"),S=r("IssueSeverityLabel"),k=r("IssueMeta"),y=r("BaseLink"),v=r("SeverityReasonInfo"),R=r("UserAdjustedSeverityInfo");return i(),_(w,null,[h("div",Ri,[h("div",Ti,[h("div",Oi,[a(l,{class:"text-12px text-break-all max-w-full"},{default:n(()=>[c(g(o.matchedLine),1)]),_:1}),a(S,{class:"ml-8px",singleIssue:s.issue,showSlaWarning:""},{default:n(()=>[o.isTokenLive?(i(),m(f,{key:0,class:"ml-6px px-6px cursor-pointer",variation:"orange-outline",title:"Live",theme:o.theme,size:"compact",onClick:o.openSeverityReasonsModal},{default:n(()=>[a(p,null,{default:n(()=>[c(g(o.secretTooltipText),1)]),_:1})]),_:1},8,["theme","onClick"])):I("",!0)]),_:1},8,["singleIssue"])]),a(k,{color:"subdued",class:"text-break-all"},{default:n(()=>[h("a",{href:s.issue.reference_url,target:"_blank",class:A({"no-link":!s.issue.reference_url})},g(o.fileAndLineNumber),11,Ai)]),_:1}),s.issue.reference_url?(i(),m(y,{key:0,href:s.issue.reference_url,target:"_blank",class:"leading-18px group"},{default:n(()=>[Ni,Li]),_:1},8,["href"])):s.issue.commit?(i(),m(y,{key:1,as:"button",class:"leading-18px group",onClick:o.openCopyCommitModal},{default:n(()=>[Bi,Ui]),_:1},8,["onClick"])):I("",!0),a(v,{ref:"severityReasonInfo",subIssue:s.issue,class:"mt-8px"},null,8,["subIssue"]),a(R,{issue:s.issue},null,8,["issue"])])]),h("div",Pi,[a(l,{truncate:!0},{default:n(()=>[c(g(s.issue.author),1)]),_:1})])],64)}const Di=C(xi,[["render",Mi]]),Fi={props:{issue:Object,groupedIssue:{type:Object,required:!0}},components:{SeverityReasonInfo:H,IssueSeverityLabel:G,XTooltip:z,BaseCodeBlock:qe,IssueTitle:V,IssueMeta:j,BaseLink:P,UserAdjustedSeverityInfo:q,BreakSlashes:fe},computed:{fileAndLineNumber(){const e=this.issue.file.split("/");return this.issue.end_line>this.issue.start_line?`Line ${this.issue.start_line} - ${this.issue.end_line} in ${e[e.length-1]}`:`Line ${this.issue.start_line} in ${e[e.length-1]}`},issueLines(){return[this.issue.start_line,this.issue.end_line]},shouldShowCodeAnalysis(){return!!(this.$user.is_aikido_support||["github","gitlab","azure_devops","bitbucket","gitlab_server"].includes(this.$group.scm_type)||this.issue.aikido_score_reasons.some(t=>t.rule.startsWith("llm_assessment_")))}},methods:{openCodeAnalysisModal(){this.$modal.show("CodeAnalysisModal",{issueId:this.issue.id,groupedIssueId:this.groupedIssue.id})}}},Gi={class:"td"},$i={class:"flex mb-2px gap-8px align-center"},zi=h("span",{class:"group-hover:underline"},"View file",-1),Vi=h("i",{class:"icon icon-arrow-right text-8px pl-4px text-deco-none text--semi-bold"},null,-1),ji=h("span",{class:"group-hover:underline"},"View code analysis",-1),Hi=h("i",{class:"icon icon-arrow-right text-8px pl-4px text-deco-none text--semi-bold"},null,-1);function qi(e,t,s,d,u,o){const l=r("BreakSlashes"),p=r("IssueTitle"),f=r("IssueSeverityLabel"),S=r("XTooltip"),k=r("IssueMeta"),y=r("BaseCodeBlock"),v=r("BaseLink"),R=r("SeverityReasonInfo"),b=r("UserAdjustedSeverityInfo");return i(),_("div",Gi,[h("div",$i,[a(p,null,{default:n(()=>[a(l,{text:s.issue.file_breakable},null,8,["text"])]),_:1}),a(f,{singleIssue:s.issue,showSlaWarning:""},null,8,["singleIssue"])]),s.issue.file!="repo-wide"?(i(),m(k,{key:0,color:"subdued"},{default:n(()=>[c(g(o.fileAndLineNumber)+" ",1),a(S,null,{default:n(()=>[c(g(s.issue.file),1)]),_:1})]),_:1})):I("",!0),s.issue.snippet.trim()!=""&&!s.issue.snippet.startsWith("SNIPPETHASH_")?(i(),m(y,{key:1},{default:n(()=>[c(g(s.issue.snippet),1)]),_:1})):I("",!0),s.issue.reference_url&&!o.shouldShowCodeAnalysis?(i(),m(v,{key:2,class:"leading-18px group",href:s.issue.reference_url,target:"_blank"},{default:n(()=>[zi,Vi]),_:1},8,["href"])):I("",!0),h("div",null,[o.shouldShowCodeAnalysis?(i(),m(v,{key:0,class:"leading-18px group",as:"button",onClick:o.openCodeAnalysisModal},{default:n(()=>[ji,Hi]),_:1},8,["onClick"])):I("",!0)]),a(R,{subIssue:s.issue,class:"mt-8px"},null,8,["subIssue"]),a(b,{issue:s.issue},null,8,["issue"])])}const Wi=C(Fi,[["render",qi]]),Ki={props:{issue:Object},components:{SeverityReasonInfo:H,IssueSeverityLabel:G,BaseParagraph:E,IssueTitle:V,IssueMeta:j,UserAdjustedSeverityInfo:q},data(){return{dependencyPath:void 0,showDependencyPathModal:!1}},inject:["theme"],computed:{targetPath(){return this.issue.target_path},paragraphColor(){return this.theme==="light"?"black":"white"}}},Xi={class:"td"},Yi={class:"flex flex-column gap-2px"},Ji={class:"flex align-center gap-8px"};function Qi(e,t,s,d,u,o){const l=r("IssueTitle"),p=r("IssueSeverityLabel"),f=r("IssueMeta"),S=r("SeverityReasonInfo"),k=r("UserAdjustedSeverityInfo");return i(),_("div",Xi,[h("div",Yi,[h("div",Ji,[a(l,null,{default:n(()=>[c(g(s.issue.package_name)+"@"+g(s.issue.package_version),1)]),_:1}),a(p,{class:"ml-8px",singleIssue:s.issue,showSlaWarning:""},null,8,["singleIssue"])]),a(f,null,{default:n(()=>[c(g(o.targetPath),1)]),_:1}),a(S,{subIssue:s.issue,class:"mt-8px"},null,8,["subIssue"]),a(k,{issue:s.issue},null,8,["issue"])])])}const Zi=C(Ki,[["render",Qi]]),ea={props:{issue:Object},components:{SeverityReasonInfo:H,IssueSeverityLabel:G,BaseParagraph:E,IssueTitle:V,IssueMeta:j,UserAdjustedSeverityInfo:q},data(){return{dependencyPath:void 0,showDependencyPathModal:!1}},inject:["theme"],computed:{targetPath(){return this.issue.target_path},paragraphColor(){return this.theme==="light"?"black":"white"},fixText(){var t;let e=(t=this.issue.fix_version_info)==null?void 0:t.package_version;return e?`${this.issue.package_version} => ${e}`:"No fix available"},fixTextClass(){return{"ws-nowrap":this.fixText.length<25}}}},sa={class:"td"},ta={class:"flex flex-column gap-2px"},oa={class:"flex align-center gap-8px"},na={class:"td collapsing"};function ia(e,t,s,d,u,o){const l=r("IssueTitle"),p=r("IssueSeverityLabel"),f=r("IssueMeta"),S=r("SeverityReasonInfo"),k=r("UserAdjustedSeverityInfo"),y=r("BaseParagraph");return i(),_(w,null,[h("div",sa,[h("div",ta,[h("div",oa,[a(l,null,{default:n(()=>[c(g(s.issue.package_name)+"@"+g(s.issue.package_version),1)]),_:1}),a(p,{class:"ml-8px",singleIssue:s.issue,showSlaWarning:""},null,8,["singleIssue"])]),a(f,null,{default:n(()=>[c(g(o.targetPath),1)]),_:1}),a(S,{subIssue:s.issue,class:"mt-8px"},null,8,["subIssue"]),a(k,{issue:s.issue},null,8,["issue"])])]),h("div",na,[a(y,{color:o.paragraphColor,class:A(o.fixTextClass)},{default:n(()=>[c(g(o.fixText),1)]),_:1},8,["color","class"])])],64)}const aa=C(ea,[["render",ia]]),ra={props:{issue:Object},computed:{metadata(){return this.issue.metadata},localStorageKey(){return this.metadata.localStorageKey},sessionStorageKey(){return this.metadata.sessionStorageKey}}};function ua(e,t,s,d,u,o){const l=r("BaseParagraph");return i(),_(w,null,[o.localStorageKey?(i(),m(l,{key:0,color:"subdued"},{default:n(()=>[c("Key in local storage: "+g(o.localStorageKey),1)]),_:1})):I("",!0),o.sessionStorageKey?(i(),m(l,{key:1,color:"subdued"},{default:n(()=>[c("Key in session storage: "+g(o.sessionStorageKey),1)]),_:1})):I("",!0)],64)}const Ae=C(ra,[["render",ua]]),la={props:{issue:Object},computed:{metadata(){return this.issue.metadata},cookieName(){return this.metadata.cookie.name}}};function ca(e,t,s,d,u,o){const l=r("BaseParagraph");return o.cookieName?(i(),m(l,{key:0,color:"subdued"},{default:n(()=>[c("Cookie: "+g(o.cookieName),1)]),_:1})):I("",!0)}const Ne=C(la,[["render",ca]]),da={props:{issue:Object},components:{AuthDastCredentialsInStorageMetadata:Ae,AuthDastCookieMetadata:Ne},computed:{authDastMetadataComponent(){return this.issue.scanner!=="auth-dast-checks"?null:this.issue.rule_id==="aik_dast_credentials_in_browser_storage"?Ae:["aik_dast_loosely_scoped_cookie","aik_dast_session_cookie_secured"].includes(this.issue.rule_id)?Ne:null}}};function ha(e,t,s,d,u,o){return i(),m(Fe(o.authDastMetadataComponent),{issue:s.issue},null,8,["issue"])}const _a=C(da,[["render",ha]]),pa={components:{BaseCodeBlock:qe,IssueMeta:j,BaseLink:P},props:{issue:{type:Object,required:!0}},computed:{shouldShowRequestPayload(){return this.issue.scanner!="akto"?!1:!!this.requestPayload},shouldShowResponseHeaders(){return this.issue.scanner!="akto"?!1:!!this.responseHeaders},requestPayload(){var s,d;const e=((d=(s=this.issue)==null?void 0:s.metadata)==null?void 0:d.request_payload)??null;if(!e)return null;const t=JSON.parse(e);return Object.keys(t).length==0?null:t},responseHeaders(){var s,d;const e=((d=(s=this.issue)==null?void 0:s.metadata)==null?void 0:d.response_headers)??null;if(!e)return null;const t=JSON.parse(e);return Object.keys(t).length==0?null:t},formattedRequestPayload(){return this.formatJson(this.requestPayload)},formattedResponseHeaders(){return this.formatJson(this.responseHeaders)},requestLogGuid(){var e,t;return((t=(e=this.issue)==null?void 0:e.metadata)==null?void 0:t.request_log_guid)??null},domainId(){var e;return((e=this.issue)==null?void 0:e.domain_id)??null},shouldShowViewRequestLog(){return this.domainId&&this.requestLogGuid}},methods:{formatJson(e){return e?JSON.stringify(e,null,4).trim():null},async openRequestLogModal(){const e=await Ts({domainId:this.domainId,guid:this.requestLogGuid});this.$modal.show("RequestLogDetailsModal",{requestLog:e})}}},ga={key:0},fa={key:1},ma=h("span",{class:"group-hover:underline"},"View request log",-1),Ia=h("i",{class:"icon icon-arrow-right text-8px pl-4px text-deco-none text--semi-bold"},null,-1);function Sa(e,t,s,d,u,o){const l=r("IssueMeta"),p=r("BaseCodeBlock"),f=r("BaseLink");return i(),_(w,null,[o.shouldShowRequestPayload?(i(),_("div",ga,[a(l,null,{default:n(()=>[c("Request Payload:")]),_:1}),a(p,null,{default:n(()=>[c(g(o.formattedRequestPayload),1)]),_:1})])):I("",!0),o.shouldShowResponseHeaders?(i(),_("div",fa,[a(l,null,{default:n(()=>[c("Response Headers:")]),_:1}),a(p,null,{default:n(()=>[c(g(o.formattedResponseHeaders),1)]),_:1})])):I("",!0),o.shouldShowViewRequestLog?(i(),m(f,{key:2,class:"leading-18px group",as:"button",onClick:o.openRequestLogModal},{default:n(()=>[ma,Ia]),_:1},8,["onClick"])):I("",!0)],64)}const ya=C(pa,[["render",Sa]]),ka={props:{issue:Object},components:{IssueTitle:V,IssueSeverityLabel:G,IssueMeta:j,BaseButton:L,SeverityReasonInfo:H,UserAdjustedSeverityInfo:q,AuthDastMetaData:_a,BreakSlashes:fe,AktoMetadata:ya},data(){return{isExpanded:!1}},computed:{isDASTIssue(){return["owasp-zap","nuclei","auth-dast-checks","akto"].includes(this.issue.scanner)},expandButtonContent(){return this.isExpanded?"Show less":"Show more"},showExpandButton(){var e,t;return((e=this.issue.metadata)==null?void 0:e.evidence)&&((t=this.issue.metadata)==null?void 0:t.other)},showExpandedContent(){var e;return(e=this.issue.metadata)!=null&&e.other?this.isExpanded:!0}},methods:{handleToggleExpand(){this.isExpanded=!this.isExpanded}}},Ca={class:"td"},ba={class:"flex align-center gap-8px"},wa={key:0,class:"mt-4px"},va={key:1},Ea=h("span",{class:"text--bold"},"Evidence:",-1),xa=h("br",null,null,-1),Ra={key:0,class:"flex w-full justify-center mt-8px"},Ta={key:0,class:"td"};function Oa(e,t,s,d,u,o){var x,M;const l=r("BreakSlashes"),p=r("IssueTitle"),f=r("IssueSeverityLabel"),S=r("IssueMeta"),k=r("BaseButton"),y=r("AuthDastMetaData"),v=r("AktoMetadata"),R=r("SeverityReasonInfo"),b=r("UserAdjustedSeverityInfo");return i(),_(w,null,[h("div",Ca,[h("div",ba,[a(p,null,{default:n(()=>[a(l,{text:s.issue.target_url},null,8,["text"])]),_:1}),a(f,{singleIssue:s.issue,showSlaWarning:""},null,8,["singleIssue"])]),s.issue.metadata?(i(),_("div",wa,[(x=s.issue.metadata)!=null&&x.other?(i(),m(S,{key:0},{default:n(()=>[c(g(s.issue.metadata.other),1)]),_:1})):I("",!0),(M=s.issue.metadata)!=null&&M.evidence?(i(),_("div",va,[a(S,{color:"subdued",class:A(["sidebar__sub-issues__sm__metadata",{"sidebar__sub-issues__sm__metadata--expanded":o.showExpandedContent}])},{default:n(()=>[Ea,xa,c(" "+g(s.issue.metadata.evidence),1)]),_:1},8,["class"]),o.showExpandButton?(i(),_("div",Ra,[a(k,{variation:"plain",size:"small",onClick:o.handleToggleExpand,inverted:""},{default:n(()=>[c(g(o.expandButtonContent),1)]),_:1},8,["onClick"])])):I("",!0)])):I("",!0),a(y,{issue:s.issue},null,8,["issue"]),a(v,{issue:s.issue},null,8,["issue"])])):I("",!0),a(R,{subIssue:s.issue,class:"mt-8px"},null,8,["subIssue"]),a(b,{issue:s.issue},null,8,["issue"])]),o.isDASTIssue?I("",!0):(i(),_("div",Ta,[a(p,null,{default:n(()=>[c(g(s.issue.target_domain),1)]),_:1})]))],64)}const Aa=C(ka,[["render",Oa]]),Na={props:{issue:Object},components:{IssueTitle:V,IssueSeverityLabel:G,SeverityReasonInfo:H,UserAdjustedSeverityInfo:q},computed:{issueTitle(){var e;if(["aik_scm_github_001"].includes(this.issue.rule_id))return this.$t("ISSUE.SCM_SECURITY.SUB_ISSUE.TITLE.AIK_SCM_GITHUB_001",{org:this.issue.resource_name});if(["aik_scm_github_003"].includes(this.issue.rule_id))return this.$t("ISSUE.SCM_SECURITY.SUB_ISSUE.TITLE.AIK_SCM_GITHUB_003",{org:this.issue.resource_name});if(["aik_scm_github_002","aik_scm_github_004","aik_scm_github_005","aik_scm_github_006"].includes(this.issue.rule_id)){const t=((e=this.issue.metadata)==null?void 0:e.affected_branches)||["default branch"];return this.$t(`ISSUE.SCM_SECURITY.SUB_ISSUE.TITLE.${this.issue.rule_id}`,{branches:K(t)})}return this.issue.resource_name}}},La={class:"td"},Ba={class:"flex flex-column gap-2px"},Ua={class:"flex align-center gap-8px"};function Pa(e,t,s,d,u,o){const l=r("IssueTitle"),p=r("IssueSeverityLabel"),f=r("SeverityReasonInfo"),S=r("UserAdjustedSeverityInfo");return i(),_("div",La,[h("div",Ba,[h("div",Ua,[a(l,null,{default:n(()=>[c(g(o.issueTitle),1)]),_:1}),a(p,{singleIssue:s.issue,showSlaWarning:""},null,8,["singleIssue"])]),a(f,{subIssue:s.issue,class:"mt-8px"},null,8,["subIssue"]),a(S,{issue:s.issue},null,8,["issue"])])])}const Ma=C(Na,[["render",Pa]]),Da={props:{issue:Object},components:{IssueTitle:V,IssueSeverityLabel:G,IssueMeta:j,BaseLink:P,XTooltip:z},computed:{issueTitle(){return this.issue.package_name},isSupportedLockfile(){return Qs(this.issue.target_path)!=null},packageUrl(){if(!this.isSupportedLockfile)return;const[e,t]=this.issue.package_name.split("@");if(!(!e||!t))return me(this.issue.target_path,e,t)}}},Fa={class:"td"},Ga={class:"flex flex-column gap-2px"},$a={class:"flex align-center gap-8px"},za=["href"],Va={class:"flex gap-4px"},ja=h("span",{class:"group-hover:underline"},"View info",-1),Ha=h("i",{class:"icon icon-arrow-right text-8px pl-4px text-deco-none text--semi-bold"},null,-1);function qa(e,t,s,d,u,o){const l=r("IssueTitle"),p=r("IssueSeverityLabel"),f=r("IssueMeta"),S=r("BaseLink");return i(),_("div",Fa,[h("div",Ga,[h("div",$a,[a(l,{href:o.packageUrl},{default:n(()=>[c(g(o.issueTitle),1)]),_:1},8,["href"]),a(p,{singleIssue:s.issue,showSlaWarning:""},null,8,["singleIssue"])]),s.issue.target_path_url?(i(),_("a",{key:0,href:s.issue.target_path_url,target:"_blank",class:"cursor-pointer underline-hover"},[a(f,{color:"subdued"},{default:n(()=>[c(g(s.issue.target_path),1)]),_:1})],8,za)):(i(),m(f,{key:1},{default:n(()=>[c(g(s.issue.target_path),1)]),_:1})),h("div",Va,[a(f,{color:"subdued",class:"truncate max-w-360px"},{default:n(()=>[c(g(s.issue.license_type)+"  ",1)]),_:1}),a(S,{class:"leading-18px group inline-flex align-center",onClick:t[0]||(t[0]=k=>e.$modal.show("LicenseRiskInfoModal",{licenseType:s.issue.license_type}))},{default:n(()=>[ja,Ha]),_:1})])])])}const Wa=C(Da,[["render",qa]]),Ka={components:{IssueActionMenu:Po,CloudSubIssueDetails:gi,OpenSourceSubIssueDetails:Ei,LeakedSecretSubIssueDetails:Di,SastFindingSubIssueDetails:Wi,BaseIconButton:pe,SurfaceMonitoringSubIssueDetails:Aa,MalwareSubIssueDetails:Zi,EolSubIssueDetails:aa,ScmSecuritySubIssueDetails:Ma,LicenseSubIssueDetails:Wa},props:{groupedIssue:Object,subIssue:Object},computed:{isOpenSourceIssue(){return this.subIssue.type==="open_source"},isCloudIssue(){return this.subIssue.type==="cloud"},isLeakedSecret(){return this.subIssue.type==="leaked_secret"},isSastFinding(){return this.subIssue.type==="sast"},isSurfaceMonitoringIssue(){return this.subIssue.type==="surface_monitoring"},isMalwareIssue(){return this.subIssue.type==="malware"},isEolIssue(){return this.subIssue.type==="eol"},isScmSecurityIssue(){return this.subIssue.type==="scm_security"},isLicenseIssue(){return this.subIssue.type==="license"}}},Xa={class:"td collapsing disabled--no-opacity"};function Ya(e,t,s,d,u,o){const l=r("OpenSourceSubIssueDetails"),p=r("CloudSubIssueDetails"),f=r("LeakedSecretSubIssueDetails"),S=r("SastFindingSubIssueDetails"),k=r("SurfaceMonitoringSubIssueDetails"),y=r("MalwareSubIssueDetails"),v=r("EolSubIssueDetails"),R=r("ScmSecuritySubIssueDetails"),b=r("LicenseSubIssueDetails"),x=r("BaseIconButton"),M=r("IssueActionMenu");return i(),_("div",{class:A(["tr issue-detail__subissues__row",{"issue-detail__subissues__row--disabled":s.subIssue.status==="ignored"}])},[o.isOpenSourceIssue?(i(),m(l,{key:0,issue:s.subIssue,groupedIssue:s.groupedIssue},null,8,["issue","groupedIssue"])):o.isCloudIssue?(i(),m(p,{key:1,issue:s.subIssue},null,8,["issue"])):o.isLeakedSecret?(i(),m(f,{key:2,issue:s.subIssue},null,8,["issue"])):o.isSastFinding?(i(),m(S,{key:3,issue:s.subIssue,groupedIssue:s.groupedIssue},null,8,["issue","groupedIssue"])):o.isSurfaceMonitoringIssue?(i(),m(k,{key:4,issue:s.subIssue},null,8,["issue"])):o.isMalwareIssue?(i(),m(y,{key:5,issue:s.subIssue},null,8,["issue"])):o.isEolIssue?(i(),m(v,{key:6,issue:s.subIssue},null,8,["issue"])):o.isScmSecurityIssue?(i(),m(R,{key:7,issue:s.subIssue},null,8,["issue"])):o.isLicenseIssue?(i(),m(b,{key:8,issue:s.subIssue},null,8,["issue"])):I("",!0),h("div",Xa,[a(M,{issue:s.subIssue,"programming-language":s.groupedIssue.programming_language,packageName:s.groupedIssue.package_name,sastAutofixEnabled:!0},{trigger:n(ue=>[a(x,{icon:"icon-actions",class:"issue-detail__subissues__action",onClicked:ue.toggle},null,8,["onClicked"])]),_:1},8,["issue","programming-language","packageName"])])],2)}const Ja=C(Ka,[["render",Ya]]),Qa=["aik_scm_github_001","aik_scm_github_003","aik_scm_gitlab_001"],Za={mixins:[ls],components:{SubIssueRow:Ja,TableList:Le,TableListHeader:Be,IssueLocationIcon:no,BaseParagraph:E,BaseLink:P},props:{groupedIssue:Object,showClosedOnly:{type:Boolean,default:!1},showSnoozedOnly:{type:Boolean,default:!1},showIgnoredOnly:{type:Boolean,default:!1},hideTitle:{type:Boolean,default:!1},showMoreLinkClass:{type:String,default:""}},inject:["theme"],data(){return{showHiddenSubIssues:!1,amountSubissuesVisibleByGroup:{}}},computed:{showMoreSubissuesLink(){if(this.showHiddenSubIssues||this.showOpenAndIgnoredIssueList||this.showClosedOnly||this.showSnoozedOnly||this.showIgnoredOnly)return"";let e="";return this.subIssuesListSnoozed.length>0&&(e+=this.$t("SHOW_MORE_SNOOZED",this.subIssuesListSnoozed.length)),this.subIssuesListIgnored.length>0&&(e!=""&&(e+=` ${this.$t("AND")} `),e+=this.$t("SHOW_MORE_IGNORED",this.subIssuesListIgnored.length)),e},subIssuesListSnoozed(){return this.groupedIssue.issues.filter(e=>e.status==="snoozed")},subIssuesListIgnored(){return this.groupedIssue.issues.filter(e=>e.status==="ignored")},subIssuesListOpen(){return this.groupedIssue.issues.filter(e=>e.status==="open")},subIssuesListClosed(){return this.groupedIssue.issues.filter(e=>e.status==="closed")},showOpenAndIgnoredIssueList(){return this.focusMode==="all_issues_mode"&&this.$route.name==="feed"},subIssuesList(){if(this.showClosedOnly)return this.subIssuesListClosed;if(this.showSnoozedOnly)return this.subIssuesListSnoozed;if(this.showIgnoredOnly)return this.subIssuesListIgnored;if(this.showOpenAndIgnoredIssueList)return[...this.subIssuesListOpen,...this.subIssuesListIgnored];let e=this.subIssuesListOpen;return this.showHiddenSubIssues&&(e=[...e,...this.subIssuesListSnoozed,...this.subIssuesListIgnored]),e},subIssueListByGroupingLimited(){const e={};for(const[t,s]of Object.entries(this.subIssueListByGrouping)){const d=this.amountSubissuesVisibleByGroup[t]||20;e[t]=[...this.filterOpenIssues(s).slice(0,d),...this.filterHiddenIssues(s)]}return e},subIssueListByGrouping(){if(this.groupedIssue.type==="cloud")return this.subIssueListByCloudAndRegion;if(this.groupedIssue.type==="surface_monitoring")return this.subIssueListBySurfaceMonitoringScanner;const e=Qa.includes(this.groupedIssue.issues[0].rule_id);return this.groupedIssue.type==="scm_security"&&e?this.subIssueListByResourceName:this.subIssueListByRepoName},subIssueListByCloudAndRegion(){const e={};for(const t of this.subIssuesList){const s=`${t.cloud_name} in ${t.cloud_account_purpose} @${t.region}`;e[s]||(e[s]=[]),e[s].push(t)}return e},subIssueListByRepoName(){const e={};for(const t of this.subIssuesList){let s="";t.cloud_repo_name?s=t.cloud_repo_name+"||||"+t.cloud_repo_id:t.type=="eol"&&t.domain_name?s=t.domain_name:t.scm_repo_uid&&t.scm_repo_uid.includes("_aikidoclone_")&&t.path_to_scan?s=t.repo_name+" - "+t.path_to_scan:t.scm_repo_uid&&t.scm_repo_uid.includes("_aikidoclone_")&&t.scm_repo_default_branch?s=t.repo_name+" - "+t.scm_repo_default_branch:t.attack_surface==="cloud_instance"?s=t.cloud_instance_group_name:s=t.repo_name,t.cloud_name&&(s?s+=" in "+t.cloud_name:s=t.cloud_name),e[s]||(e[s]=[]),e[s].push(t)}return e},subIssueListBySurfaceMonitoringScanner(){const e={};for(const t of this.subIssuesList){let s="unknown";t.scanner==="aik_domain_takeover"?s=t.cloud_name:(t.scanner==="owasp-zap"||t.scanner==="nuclei"||t.scanner==="auth-dast-checks"||["akto","akto_graphql"].includes(t.scanner))&&(s=t.domain_name),e[s]||(e[s]=[]),e[s].push(t)}return e},subIssueListByResourceName(){const e={};for(const t of this.subIssuesList){let s=t.resource_name;e[s]||(e[s]=[]),e[s].push(t)}return e},isDASTIssue(){var t;const e=(t=this.subIssuesList[0])==null?void 0:t.scanner;return["owasp-zap","nuclei","auth-dast-checks","akto"].includes(e)?this.groupedIssue.type==="surface_monitoring":!1},showTeamFilterActiveEmptyState(){return this.subIssuesList.length>0?!1:!!this.$teamContext},teamFilterTeamName(){return ye.teamName}},methods:{getSubissueGroupHeaderLink(e){if(e.domain_id>0)return`/domain/${e.domain_id}`;if(e.cloud_repo_id>0)return`/container/${e.cloud_repo_id}`;if(e.cloud_id>0)return e.attack_surface==="cloud_instance"?`/clouds/${e.cloud_id}/virtual-machines/${e.cloud_instance_group_id}`:`/clouds/${e.cloud_id}`;if(e.type==="scm_security"){if(e.repo_id>0)return this.getScmOrganizationRepoLink(e);if(e.resource_kind==="scm_organization")return this.getScmOrganizationLink(e)}return null},getInternalLink(e){if(e.cloud_repo_id>0)return`/container/${e.cloud_repo_id}`;const t=e.type==="surface_monitoring"&&e.scanner==="aik_domain_takeover";return e.type==="cloud"||t?`/clouds/${e.cloud_id}`:`/repositories/${e.repo_id}`},getShowMoreTextForGroup(e){const t=this.subIssueListByGrouping[e].length-this.subIssueListByGroupingLimited[e].length;return t<=0?"":t>=20?`Show 20 more (${t} not shown)`:`Show ${t} more`},showMoreForGroup(e){const t=this.amountSubissuesVisibleByGroup[e]||20;this.amountSubissuesVisibleByGroup[e]=t+20},filterOpenIssues(e){return e.filter(t=>t.status!=="ignored"&&t.status!=="snoozed")},filterHiddenIssues(e){return e.filter(t=>t.status==="ignored"||t.status==="snoozed")},getScmOrganizationLink(e){return this.$group.scm_type==="github"?`https://github.com/${e.resource_id}`:this.$group.scm_type==="gitlab"?"https://gitlab.com/dashboard/groups":null},getScmOrganizationRepoLink(e){return this.$group.scm_type==="github"?`${e.repo_url.replace("https://api.github.com/repos/","https://github.com/")}/settings`:this.$group.scm_type==="gitlab"?e.repo_url.replace(".git","/edit"):`/repositories/${e.repo_id}`},clearTeamContext(){ye.clearTeamId()}}},er={class:"issue-detail__card"},sr={key:0,class:"issue-detail__card__title-container flex align-center mb-4px"},tr={class:"issue-detail__card-body"},or={class:"issue-detail__card-section issue-detail__subissues"},nr={key:0,class:"mt-4px mb-8px"},ir={class:"thead mobile_hidden"},ar={key:0,class:"tr"},rr={key:1,class:"tr"},ur={key:2,class:"tr"},lr={key:3,class:"tr"},cr={key:4,class:"tr"},dr={key:5,class:"tr"},hr={key:6,class:"tr"},_r={key:7,class:"tr"},pr={key:8,class:"tr"},gr={key:9,class:"tr"},fr={class:"tbody"},mr={class:"tr"},Ir={colspan:"100%",class:"issue-detail__subissues__location-header"},Sr={class:"flex justify-between align-center"},yr=["href"],kr=h("i",{class:"icon icon-openLink icon-12px opacity-0"},null,-1),Cr=h("i",{class:"icon icon-openLink icon-12px opacity-0"},null,-1),br={key:0,class:"tr"},wr={colspan:"100%",class:"issue-detail__subissues__show-more-section"},vr=["onClick"];function Er(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BasePill"),f=r("BaseLink"),S=r("TableListHeader"),k=r("IssueLocationIcon"),y=r("router-link"),v=r("SubIssueRow"),R=r("TableList");return i(),_("div",er,[s.hideTitle?I("",!0):(i(),_("div",sr,[a(l,{"semi-bold":"",class:"issue-detail__card__title"},{default:n(()=>[c("Subissues")]),_:1}),a(p,{class:"ml-8px text-12px",variation:o.theme!="light"?"carbon-80":"gray-outline"},{default:n(()=>[c(g(o.subIssuesList.length>100?"100+":o.subIssuesList.length),1)]),_:1},8,["variation"])])),h("div",tr,[h("div",or,[o.showTeamFilterActiveEmptyState?(i(),_("div",nr,[a(l,{class:"issue-detail__card__paragraph"},{default:n(()=>[c(" No subissues for this team ("+g(o.teamFilterTeamName)+"). ",1)]),_:1}),a(l,{class:"issue-detail__card__paragraph mt-2px"},{default:n(()=>[a(f,{as:"button",onClick:o.clearTeamContext},{default:n(()=>[c("Reset Team Filter")]),_:1},8,["onClick"]),c(" to see all issues within this issue group. ")]),_:1})])):I("",!0),this.subIssuesList.length>0?(i(),m(R,{key:1,class:"bordered"},{default:n(()=>[h("div",ir,[s.groupedIssue.type==="leaked_secret"?(i(),_("div",ar,[a(S,null,{default:n(()=>[c("Subissue")]),_:1}),a(S,null,{default:n(()=>[c("Author")]),_:1}),a(S)])):s.groupedIssue.type==="cloud"?(i(),_("div",rr,[a(S,null,{default:n(()=>[c("Cloud")]),_:1}),a(S)])):s.groupedIssue.type==="sast"?(i(),_("div",ur,[a(S,null,{default:n(()=>[c("Subissue")]),_:1}),a(S)])):o.isDASTIssue?(i(),_("div",lr,[a(S,null,{default:n(()=>[c("URL")]),_:1}),a(S)])):s.groupedIssue.type==="surface_monitoring"?(i(),_("div",cr,[a(S,null,{default:n(()=>[c("URL")]),_:1}),a(S,null,{default:n(()=>[c("Target")]),_:1}),a(S)])):s.groupedIssue.type==="malware"?(i(),_("div",dr,[a(S,null,{default:n(()=>[c("Subissue")]),_:1}),a(S)])):s.groupedIssue.type==="eol"?(i(),_("div",hr,[a(S,null,{default:n(()=>[c("Subissue")]),_:1}),a(S,null,{default:n(()=>[c("Fix")]),_:1}),a(S)])):s.groupedIssue.type==="scm_security"?(i(),_("div",_r,[a(S,null,{default:n(()=>[c("SubIssue")]),_:1}),a(S)])):s.groupedIssue.type==="license"?(i(),_("div",pr,[a(S,null,{default:n(()=>[c("SubIssue")]),_:1}),a(S)])):(i(),_("div",gr,[a(S,null,{default:n(()=>[c("Subissue")]),_:1}),a(S,null,{default:n(()=>[c("Fix")]),_:1}),a(S)]))]),h("div",fr,[(i(!0),_(w,null,N(o.subIssueListByGroupingLimited,(b,x)=>(i(),_(w,null,[h("div",mr,[h("td",Ir,[h("div",Sr,[o.getSubissueGroupHeaderLink(b[0])?(i(),_("a",{key:0,class:"link text--normal",target:"_blank",href:o.getSubissueGroupHeaderLink(b[0])},[a(k,{singleIssue:b[0],preferLabelView:!0},null,8,["singleIssue"]),h("span",null,g(x.split("||||")[0]),1),kr],8,yr)):(i(),m(y,{key:1,class:"link text--normal",to:o.getInternalLink(b[0])},{default:n(()=>[a(k,{singleIssue:b[0],preferLabelView:!0},null,8,["singleIssue"]),h("span",null,g(x.split("||||")[0]),1),Cr]),_:2},1032,["to"]))])])]),(i(!0),_(w,null,N(o.filterOpenIssues(b),M=>(i(),m(v,{key:M.id,groupedIssue:s.groupedIssue,subIssue:M},null,8,["groupedIssue","subIssue"]))),128)),o.getShowMoreTextForGroup(x)!=""?(i(),_("div",br,[h("td",wr,[h("div",{class:"link",onClick:M=>o.showMoreForGroup(x)},g(o.getShowMoreTextForGroup(x)),9,vr)])])):I("",!0),(i(!0),_(w,null,N(o.filterHiddenIssues(b),M=>(i(),m(v,{key:M.id,groupedIssue:s.groupedIssue,subIssue:M},null,8,["groupedIssue","subIssue"]))),128))],64))),256))])]),_:1})):o.showTeamFilterActiveEmptyState&&o.showMoreSubissuesLink?(i(),_("hr",{key:2,class:A(["divider w-full border-carbon-20 mb-16px",{"border-carbon-60":o.theme!="light"}])},null,2)):I("",!0),Ge(h("div",{class:A(["link mt-8px",s.showMoreLinkClass]),onClick:t[0]||(t[0]=b=>u.showHiddenSubIssues=!0)},g(o.showMoreSubissuesLink),3),[[$e,o.showMoreSubissuesLink]])])])])}const Qe=C(Za,[["render",Er]]);var xr=function(e,t){t=t||{},t.listUnicodeChar=t.hasOwnProperty("listUnicodeChar")?t.listUnicodeChar:!1,t.stripListLeaders=t.hasOwnProperty("stripListLeaders")?t.stripListLeaders:!0,t.gfm=t.hasOwnProperty("gfm")?t.gfm:!0,t.useImgAltText=t.hasOwnProperty("useImgAltText")?t.useImgAltText:!0,t.abbr=t.hasOwnProperty("abbr")?t.abbr:!1,t.replaceLinksWithURL=t.hasOwnProperty("replaceLinksWithURL")?t.replaceLinksWithURL:!1,t.htmlTagsToSkip=t.hasOwnProperty("htmlTagsToSkip")?t.htmlTagsToSkip:[];var s=e||"";s=s.replace(/^(-\s*?|\*\s*?|_\s*?){3,}\s*/gm,"");try{t.stripListLeaders&&(t.listUnicodeChar?s=s.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,t.listUnicodeChar+" $1"):s=s.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,"$1")),t.gfm&&(s=s.replace(/\n={2,}/g,`
`).replace(/~{3}.*\n/g,"").replace(/~~/g,"").replace(/`{3}.*\n/g,"")),t.abbr&&(s=s.replace(/\*\[.*\]:.*\n/,"")),s=s.replace(/<[^>]*>/g,"");var d=new RegExp("<[^>]*>","g");if(t.htmlTagsToSkip.length>0){var u="(?!"+t.htmlTagsToSkip.join("|")+")";d=new RegExp("<"+u+"[^>]*>","ig")}s=s.replace(d,"").replace(/^[=\-]{2,}\s*$/g,"").replace(/\[\^.+?\](\: .*?$)?/g,"").replace(/\s{0,2}\[.*?\]: .*?$/g,"").replace(/\!\[(.*?)\][\[\(].*?[\]\)]/g,t.useImgAltText?"$1":"").replace(/\[([^\]]*?)\][\[\(].*?[\]\)]/g,t.replaceLinksWithURL?"$2":"$1").replace(/^\s{0,3}>\s?/gm,"").replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,"").replace(/^(\n)?\s{0,}#{1,6}\s+| {0,}(\n)?\s{0,}#{0,} #{0,}(\n)?\s{0,}$/gm,"$1$2$3").replace(/([\*]+)(\S)(.*?\S)??\1/g,"$2$3").replace(/(^|\W)([_]+)(\S)(.*?\S)??\2($|\W)/g,"$1$3$4$5").replace(/(`{3,})(.*?)\1/gm,"$2").replace(/`(.+?)`/g,"$1").replace(/~(.*?)~/g,"$1")}catch(o){return console.error(o),e}return s};const Ze=Os(xr),Rr={components:{BaseParagraph:E,TableList:Le,TableListHeader:Be,IssueSeverityLabel:G},props:{groupedIssue:Object,upperElementsLoaded:Boolean},async mounted(){this.scrollToHashIfSet()},watch:{upperElementsLoaded(){this.upperElementsLoaded&&this.scrollToHashIfSet()}},computed:{uniqueCves(){return Object.keys(this.descriptionsByCve)},descriptionsByCve(){const e=[{name:"Official GitHub advisory",value:"https://github.com/advisories"},{name:"HackerOne reports",value:"https://hackerone.com/reports/"},{name:"Official NVD advisory",value:"https://nvd.nist.gov/vuln/"}],t={},s=this.groupedIssue.issues;for(const d of s){if(d.status!="open"||t[d.cve_id])continue;let u=[];for(let o of(d==null?void 0:d.research_urls)??[])for(let l of e)o.startsWith(l.value)&&u.push({label:l.name,value:o});if(d.aikido_cve_analysis){t[d.cve_id]={text:d.aikido_cve_analysis.tldr,doest_this_affect_me:d.aikido_cve_analysis.doest_this_affect_me,how_to_fix:d.aikido_cve_analysis.how_to_fix,isAikidoAnalysis:!0,research_urls:u,related_subissue:d};continue}if(d.original_description){t[d.cve_id]={text:Ze(d.original_description),isAikidoAnalysis:!1,research_urls:u,related_subissue:d};continue}}return t}},methods:{scrollToHashIfSet(){if(!this.upperElementsLoaded||!this.$route.hash)return;const e=document.getElementById(this.$route.hash.replace("#",""));if(e){const t=e.getBoundingClientRect().top+window.scrollY-72;window.scrollTo({top:t,behavior:"smooth"})}}}},Tr={key:0,class:"issue-detail__card readability_big_fonts"},Or={class:"issue-detail__card__title-container"},Ar={class:"issue-detail__card-body"},Nr={class:"issue-detail__card-section"},Lr={class:"flex flex-column gap-16px"},Br=["href"],Ur={key:1,class:"text--semi-bold italic"},Pr={class:"mt-8px"},Mr={class:"mt-8px"},Dr={class:"my-8px"},Fr={class:"thead"},Gr={class:"tr"},$r={class:"tbody"},zr={class:"td"},Vr=["href"],jr=h("i",{class:"icon icon-10px icon-openLink ml-2px valign-middle opacity-0 group_hover_opacity-100"},null,-1);function Hr(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("IssueSeverityLabel"),f=r("TableListHeader"),S=r("TableList");return o.uniqueCves.length>0?(i(),_("div",Tr,[h("div",Or,[a(l,{"semi-bold":"",class:"issue-detail__card__title"},{default:n(()=>[c(g(e.$t("ISSUE_CONTAINS_X_UNIQUE_VULNS",o.uniqueCves.length)),1)]),_:1})]),h("div",Ar,[h("div",Nr,[h("div",Lr,[(i(!0),_(w,null,N(o.descriptionsByCve,(k,y)=>(i(),_("div",{key:y,class:"flex flex-column gap-8px"},[a(l,{class:"flex gap-16px",id:y},{default:n(()=>[y.startsWith("AIKIDO-")?(i(),_("a",{key:0,class:"text--semi-bold italic",href:`https://security.aikido.dev/cve/${y}`,target:"_blank"},g(y),9,Br)):(i(),_("span",Ur,g(y),1)),h("span",null,[a(p,{singleIssue:k.related_subissue},null,8,["singleIssue"])])]),_:2},1032,["id"]),k.isAikidoAnalysis?(i(),_(w,{key:1},[h("div",Pr,[a(l,{color:"gray",class:"italic"},{default:n(()=>[c("Aikido TLDR")]),_:1}),a(l,null,{default:n(()=>[c(g(k.text),1)]),_:2},1024)]),h("div",Mr,[a(l,{color:"gray",class:"italic"},{default:n(()=>[c("Does this affect me?")]),_:1}),a(l,{class:""},{default:n(()=>[c(g(k.doest_this_affect_me),1)]),_:2},1024)]),h("div",Dr,[a(l,{color:"gray",class:"italic"},{default:n(()=>[c("Aikido recommends")]),_:1}),a(l,null,{default:n(()=>[c(g(k.how_to_fix),1)]),_:2},1024)])],64)):(i(),_(w,{key:0},[a(l,{color:"gray",class:"italic mt-2px"},{default:n(()=>[c(" This is what the package maintainer tells us about this finding ")]),_:1}),a(l,{class:"my-8px ws-break-spaces"},{default:n(()=>[c(g(k.text),1)]),_:2},1024)],64)),k.research_urls.length>0?(i(),m(S,{key:2},{default:n(()=>[h("div",Fr,[h("div",Gr,[a(f,null,{default:n(()=>[c("External links with more info")]),_:1})])]),h("div",$r,[(i(!0),_(w,null,N(k.research_urls,v=>(i(),_("div",{class:"tr",key:v.value},[h("div",zr,[h("a",{href:v.value,target:"_blank",class:"link link-hover text--normal group"},[h("span",null,g(v.label),1),jr],8,Vr)])]))),128))])]),_:2},1024)):I("",!0)]))),128))])])])])):I("",!0)}const qr=C(Rr,[["render",Hr]]),Wr={components:{BaseParagraph:E},props:{color:{type:String,default:"light-gray"},maxHeight:{type:Number,default:100},paragraphClasses:{type:String,default:""}},data(){return{loadingShowMore:!1,shouldShowMore:!1,showMore:!1}},async mounted(){await this.calculateShouldShowMore()},computed:{showMoreText(){return this.showMore?"Show less":"Show more"},classes(){const e=[this.paragraphClasses];return!this.shouldShowMore||(this.showMore||e.push("text-fade-out"),this.loadingShowMore)||(this.showMore||e.push("transition-max-height-500-cubic-bezier"),this.showMore&&e.push("transition-max-height-500")),e.join(" ")},styles(){if(!this.shouldShowMore)return{};const e={};return this.showMore||(e["max-height"]=this.maxHeight+"px"),e}},methods:{async calculateShouldShowMore(){this.loadingShowMore=!0,this.shouldShowMore=!1,this.showMore=!1,await this.$nextTick();const e=this.$refs.showMoreParagraph.$el.clientHeight;this.shouldShowMore=e>this.maxHeight,await this.$nextTick(),this.loadingShowMore=!1}}};function Kr(e,t,s,d,u,o){const l=r("BaseParagraph");return i(),_("div",null,[a(l,{ref:"showMoreParagraph",color:s.color,class:A(["overflow-hidden max-h-4000px relative",o.classes]),style:As(o.styles)},{default:n(()=>[F(e.$slots,"default")]),_:3},8,["color","class","style"]),u.shouldShowMore?(i(),_("div",{key:0,onClick:t[0]||(t[0]=p=>u.showMore=!u.showMore),class:"text-gray-100 hover_text-carbon-20 text-12px cursor-pointer mt-4px"},g(o.showMoreText),1)):I("",!0)])}const es=C(Wr,[["render",Kr]]),Xr={"apache http server":"apache","debian linux":"debian","ubuntu linux":"ubuntu","amazon linux":"amazon-linux","alpine linux":"alpine","craft cms":"craft-cms",".net framework":"dotnetfx",".net":"dotnet","ionic framework":"ionic","next.js":"nextjs","ruby on rails":"rails"},Yr=e=>{const t=e.toLowerCase(),s=Xr[t]||null;return s||e},Jr={components:{BaseParagraph:E,ShowMoreParagraph:es,BreakSlashes:fe},props:{groupedIssue:{type:Object,required:!0},isDetailPage:Boolean,forStatus:String},inject:["theme"],computed:{subIssues(){return this.groupedIssue.issues.filter(e=>e.status==this.forStatus)},hasMultipleSubissues(){return this.subIssues.length>1},hasAtLeastOneOpenIssue(){return this.subIssues.length>0},issue(){return this.subIssues[0]},tldr(){if(!this.hasAtLeastOneOpenIssue)return"";if(this.groupedIssue.type==="license")return this.issue.description||"Some of these packages may be licensed in a way that may carry legal risk to your company.";if(this.groupedIssue.type==="leaked_secret"){const e=[...new Set(this.subIssues.map(d=>d.file_breakable))],t=[...new Set(this.subIssues.map(d=>d.repo_name))];if(!this.hasMultipleSubissues)return`We detected secret ${this.issue.redacted_secret.replace(/\*+/g,"*****")} in the git history of the ${this.issue.repo_name} repository. The secret was found in ${K(e.slice(0,5))}`;const s=e.slice(0,5);return e.length>5&&s.push("more"),`We detected some exposed secrets in the git history of ${K(t)}. The secrets were found in ${K(s)}`}if(this.groupedIssue.type==="open_source"){const e=[...new Set(this.subIssues.map(t=>t.cve_id))];return e.length>1?`${this.groupedIssue.package_name} is affected by ${this.$t("X_VULNERABILITIES",e.length)}. To learn more about each one, consult the table below.`:this.issue.aikido_cve_analysis?this.issue.aikido_cve_analysis.tldr:Ze(this.issue.original_description)}return this.groupedIssue.type==="cloud"?this.issue.description:this.groupedIssue.type==="sast"?this.issue.description:this.groupedIssue.type==="eol"&&this.issue.fix_version_info?this.issue.fix_version_info.is_eol?this.$t("ISSUE.EOL.DESCRIPTION.TLDR.END_OF_LIFE",{package_name:this.issue.package_name,eol_date:this.issue.eol_date}):this.$t("ISSUE.EOL.DESCRIPTION.TLDR.ALMOST_END_OF_LIFE",{package_name:this.issue.package_name,eol_date:this.issue.eol_date}):""},worstCaseImpact(){if(this.groupedIssue.type!=="open_source"||!this.hasMultipleSubissues&&this.issue.aikido_cve_analysis)return"";let e={};for(const d of this.subIssues)Object.assign(e,d.cwe_descriptions_by_cwe);const t=Object.values(e).filter(d=>!!d),s=[...new Set(t)];return s.length==0?"":`The worst case impact for these vulnerabilities can be ${K(s.slice(0,3).map(d=>`"${d}"`))}.`},link(){return this.groupedIssue.type==="eol"?{title:"More info",href:`https://endoflife.date/${Yr(this.issue.package_name)}`}:this.subIssues.length!==1?null:this.groupedIssue.type==="leaked_secret"&&this.subIssues[0].reference_url?{title:"@ this commit ->",href:this.subIssues[0].reference_url}:null},showReadFullAnalysisLink(){return!(this.isDetailPage||this.groupedIssue.type!=="open_source"||!this.hasMultipleSubissues)},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"}}},Qr={key:0,class:"issue-detail__card readability_big_fonts"},Zr={class:"issue-detail__card__title-container"},eu={class:"issue-detail__card-body"},su={class:"issue-detail__card-section"},tu={class:"flex flex-column gap-8px"},ou=["href"],nu={key:1,class:"ml-4px"};function iu(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BreakSlashes"),f=r("ShowMoreParagraph");return o.tldr?(i(),_("div",Qr,[h("div",Zr,[a(l,{"semi-bold":"",class:"issue-detail__card__title"},{default:n(()=>[c("TL;DR")]),_:1})]),h("div",eu,[h("div",su,[h("div",tu,[this.groupedIssue.type==="open_source"&&!this.hasMultipleSubissues&&!o.issue.aikido_cve_analysis?(i(),m(l,{key:0,color:o.paragraphColor,class:"italic issue-detail__card__paragraph"},{default:n(()=>[c(" This is the package maintainer's summary. ")]),_:1},8,["color"])):I("",!0),(i(),m(f,{key:s.groupedIssue.id,color:o.paragraphColor,paragraphClasses:"issue-detail__card__paragraph ws-break-spaces"},{default:n(()=>[h("span",null,[a(p,{text:o.tldr},null,8,["text"])]),o.link?(i(),_("a",{key:0,href:o.link.href,target:"_blank",class:"link inline-link ml-4px"},g(o.link.title),9,ou)):I("",!0),o.worstCaseImpact?(i(),_("span",nu,g(o.worstCaseImpact),1)):I("",!0)]),_:1},8,["color"]))])])])])):I("",!0)}const au=C(Jr,[["render",iu]]),ru={emits:["loaded"],components:{BaseParagraph:E,ButtonMultiOption:Zs},props:{groupedIssue:Object,hideTitle:{type:Boolean,default:!1}},inject:["theme"],data(){return{answerOptions:[{id:"yes",title:this.$t("YES")},{id:"no",title:this.$t("NO")},{id:"unknown",title:this.$t("NOT_SURE")}]}},mounted(){this.$emit("loaded")},computed:{hasChecklist(){return Object.values(this.checklistByCve).length>0},checklistByCve(){const e={};for(const t of this.groupedIssue.issues)t.checklist&&(e[t.cve_id]=t.checklist);return e},checklistByCveUnique(){const e={},t=[];for(const s in this.checklistByCve){const d=this.checklistByCve[s];e[s]=[];for(const u of d)t.includes(u.question)||e[s].push(u),t.push(u.question)}return e},commaSeparatedChecklistCves(){return Object.keys(this.checklistByCve).join(", ")},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"}},methods:{async onSelectedItemsChanged(e,t,s){const[d,u]=e.split("_"),o=this.getAllCvesWithQuestion(u);if(await this.questionUpdateConfirmed(u,t,d)){s.answer.data=t;for(const p of o)await this.saveQuestionAnswer(u,t,p)}},async questionUpdateConfirmed(e,t,s){const d=await ke({checklist_item_description:e,checklist_item_answer:t,related_cve_id:s,related_issue_group_id:this.groupedIssue.id,dry_run:!0},{no_disable_buttons:!0});if(d==="issue_ignored"&&(await this.$modal.show("InfoModal",{headerText:"Auto ignore issue",title:"You're not affected ",description:`We will auto ignore all the issues for *${s}* right away.`,useDescriptionMarkup:!0,showCancelButton:!0,buttonCancelText:"Undo",buttonSubmitText:"Let's go!"})).type!="saved")return!1;if(d==="issue_downgraded"){let u=`We will downgrade the severity of all the issue for *${s}* in the next scan.`;if(ne.hasExpiredFullTrial()||(u+=" We'll trigger a new scan right away."),(await this.$modal.show("InfoModal",{headerText:"Auto downgrade issue",title:"Not as critical as we thought ",description:u,useDescriptionMarkup:!0,showCancelButton:!0,buttonCancelText:"Undo",buttonSubmitText:"Let's go!"})).type!="saved")return!1}return!0},async saveQuestionAnswer(e,t,s){const d=await ke({checklist_item_description:e,checklist_item_answer:t,related_cve_id:s,related_issue_group_id:this.groupedIssue.id},{no_disable_buttons:!0});d==="issue_ignored"&&(Toast.info({title:this.$t("ISSUE_AUTOMATICALLY_IGNORED")}),T.emit("issueUpdated")),d==="issue_downgraded"&&(this.$toast.success("Issue will be automatically downgraded in the next scan."),ne.hasExpiredFullTrial()||T.emit("requestRescan"))},getAllCvesWithQuestion(e){const t=[];for(const s in this.checklistByCve){const d=this.checklistByCve[s];for(const u of d)u.question===e&&t.push(s)}return t}}},uu={key:0,class:"issue-detail__card-section readability_big_fonts"},lu={key:0,class:"issue-detail__card__questionaire"},cu={class:"flex flex-column gap-16px flex-1"};function du(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("ButtonMultiOption");return o.hasChecklist?(i(),_("div",uu,[a(l,{color:o.paragraphColor,class:"my-8px issue-detail__card__paragraph"},{default:n(()=>[c(" We might be able to determine if this CVE is unable to affect you if you answer the below questions. This questionnaire is generated based on "+g(o.commaSeparatedChecklistCves),1)]),_:1},8,["color"]),(i(!0),_(w,null,N(o.checklistByCveUnique,(f,S)=>(i(),_("div",null,[f.length>0?(i(),_("div",lu,[(i(!0),_(w,null,N(f,k=>(i(),_("div",cu,[a(l,{color:o.paragraphColor,class:"issue-detail__card__questionaire__question"},{default:n(()=>[c(g(k.question),1)]),_:2},1032,["color"]),a(p,{class:"issue-detail__card__questionaire__answer",options:u.answerOptions,modelValue:k.answer.data,"onUpdate:modelValue":y=>o.onSelectedItemsChanged(`${S}_${k.question}`,y,k)},null,8,["options","modelValue","onUpdate:modelValue"])]))),256))])):I("",!0)]))),256))])):I("",!0)}const hu=C(ru,[["render",du]]),_u={emits:["loaded"],components:{ReachabilityAnalysisVisualisationModal:Ie,AffectedChecklist:hu,BaseParagraph:E,BaseLink:P},props:{groupedIssue:{type:Object,required:!0},forStatus:String},data(){return{showDependencyPathModal:!1,checklistLoaded:!1,issueAnalysisLoaded:!1,singleIssueAnalyses:null}},inject:["theme"],watch:{groupedIssue:{handler(){this.loadSignleIssueAnalysis()},immediate:!0},async loaded(){this.loaded&&(await this.$nextTick(),this.$emit("loaded"))}},computed:{loaded(){return!(!this.issueAnalysisLoaded||!this.checklistLoaded)},showSection(){return!this.loaded||!this.hasAtLeastOneOpenIssue?!1:!!(this.doest_this_affect_me||this.canShowReachabilityAnalysisModal||this.$refs.AffectedChecklist.hasChecklist)},subIssues(){return this.groupedIssue.issues.filter(e=>e.status==this.forStatus)},hasMultipleSubissues(){return this.subIssues.length>1},hasAtLeastOneOpenIssue(){return this.subIssues.length>0},issue(){return this.subIssues[0]},doest_this_affect_me(){return!this.hasMultipleSubissues&&this.issue.aikido_cve_analysis?this.issue.aikido_cve_analysis.doest_this_affect_me:this.hasMultipleSubissues||!this.singleIssueAnalyses||!this.singleIssueAnalyses.reachability_analysis_found?"":this.singleIssueAnalyses.is_reachable?this.forStatus==="ignored"?"":"With the information Aikido has about your environment and our reachability analysis, we have determined that this vulnerability can affect your environment.":this.forStatus==="ignored"?"Aikido's reachability analysis has determineded that this vulnerability can not affect your environment.":""},parentPackages(){let e=[];for(const t of this.issue.aikido_score_reasons)t.parent_packages&&(e=[...e,...t.parent_packages]);return e},canShowReachabilityAnalysisModal(){return this.hasMultipleSubissues?!1:this.groupedIssue.programming_language=="PY"||this.groupedIssue.programming_language=="JS"||this.parentPackages.length>0},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"}},methods:{openReachabilityAnalysisModal(){this.showDependencyPathModal=!0},closeReachabilityAnalysisModal(){this.showDependencyPathModal=!1},onChecklistLoaded(){this.checklistLoaded=!0},async loadSignleIssueAnalysis(){if(this.subIssues.length!=1){this.issueAnalysisLoaded=!0;return}try{this.singleIssueAnalyses=await de(this.issue.id,{disable_toasts:!0})}finally{this.issueAnalysisLoaded=!0}}}},pu={key:0,class:"issue-detail__card readability_big_fonts"},gu={class:"issue-detail__card__title-container"},fu={class:"issue-detail__card-body"},mu={key:0,class:"issue-detail__card-section"},Iu=h("span",{class:"group-hover:underline"},"How are you using it",-1),Su=h("i",{class:"icon icon-arrow-right text-8px ml-4px text-deco-none"},null,-1);function yu(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseLink"),f=r("AffectedChecklist"),S=r("ReachabilityAnalysisVisualisationModal");return o.hasAtLeastOneOpenIssue?Ge((i(),_("div",pu,[h("div",gu,[a(l,{"semi-bold":"",color:o.titleColor,class:"issue-detail__card__title"},{default:n(()=>[c("Does this affect me?")]),_:1},8,["color"])]),h("div",fu,[o.doest_this_affect_me||o.canShowReachabilityAnalysisModal?(i(),_("div",mu,[a(l,{color:o.paragraphColor,class:"issue-detail__card__paragraph ws-break-spaces"},{default:n(()=>[c(g(o.doest_this_affect_me),1)]),_:1},8,["color"]),o.canShowReachabilityAnalysisModal?(i(),m(p,{key:0,as:"button",onClick:o.openReachabilityAnalysisModal,class:"link mt-4px flex align-center group"},{default:n(()=>[Iu,Su]),_:1},8,["onClick"])):I("",!0)])):I("",!0),a(f,{ref:"AffectedChecklist",class:"mt-16px",groupedIssue:s.groupedIssue,onLoaded:o.onChecklistLoaded},null,8,["groupedIssue","onLoaded"])]),u.showDependencyPathModal?(i(),m(S,{key:0,issueId:o.issue.id,cveId:o.issue.cve_id,repoName:o.issue.repo_name,"target-path":o.issue.target_path,programmingLanguage:s.groupedIssue.programming_language,onClose:o.closeReachabilityAnalysisModal},null,8,["issueId","cveId","repoName","target-path","programmingLanguage","onClose"])):I("",!0)],512)),[[$e,o.showSection]]):I("",!0)}const ku=C(_u,[["render",yu]]),Cu=e=>e.includes("CWE-1321"),bu=e=>{const t=e.filter(y=>y.cloud_repo_id>0||y.cloud_id>0||y.cloud_instance_group_id>0?!1:y.repo_id>0),s=e.filter(y=>y.cloud_repo_id>0),d=e.filter(y=>y.cloud_repo_id>0||y.cloud_instance_group_id>0?!1:y.cloud_id>0),u=e.filter(y=>y.cloud_instance_group_id>0),o=[...new Set(t.map(y=>y.repo_name))],l=[...new Set(d.map(y=>y.cloud_name))],p=[...new Set(s.map(y=>y.cloud_repo_name))],f=[...new Set(u.map(y=>y.cloud_instance_group_name))],S=[...new Set([...o,...l,...p,...f])];if(S.length<3)return K(S);const k=[];if(o.length>0){const y=wu(o.length);k.push(y)}if(l.length>0){const y=vu(l.length);k.push(y)}if(p.length>0){const y=Eu(p.length);k.push(y)}if(f.length>0){const y=xu(f.length);k.push(y)}return K(k)},wu=e=>e==1?"1 repository":`${e} repositories`,vu=e=>e==1?"1 cloud":`${e} clouds`,Eu=e=>e==1?"1 container":`${e} containers`,xu=e=>e==1?"1 virtual machine":`${e} virtual machines`,Ru={AIK_node_nosqli_injection:"NOSQL_INJECTION",AIK_ts_node_nosqli_injection:"NOSQL_INJECTION",node_sqli_injection:"SQL_INJECTION",AIK_ts_sql_injection_template_literal:"SQL_INJECTION",AIK_js_shell_injection_child_process:"SHELL_INJECTION",AIK_ts_generic_path_traversal:"PATH_TRAVERSAL",AIK_ts_join_resolve_path_traversal:"PATH_TRAVERSAL",generic_path_traversal:"PATH_TRAVERSAL",join_resolve_path_traversal:"PATH_TRAVERSAL",AIK_js_ssrf:"SSRF"},Tu=e=>{const t=e.rule_id;return t?Object.keys(Ru).includes(t):!1},Ou={components:{BaseParagraph:E},props:{groupedIssue:Object,forStatus:String},computed:{subIssues(){return this.groupedIssue.issues.filter(e=>e.status=="open")},anySecretsInLatestGitVersion(){for(const e of this.subIssues){const t=e.aikido_score_reasons.map(s=>s.rule);if(!t.includes("secret_unused")&&!t.includes("file_no_longer_used"))return!0}return!1},extraNote(){return this.anySecretsInLatestGitVersion?this.$t("SECRETS_HOW_TO_FIX_NOTE_LIVE",this.subIssues.length):this.$t("SECRETS_HOW_TO_FIX_NOTE_OLD",this.subIssues.length)}}};function Au(e,t,s,d,u,o){const l=r("BaseParagraph");return i(),_(w,null,[a(l,{class:"issue-detail__card__paragraph"},{default:n(()=>[c(g(e.$t("ISSUE.LEAKED_SECRET.DESCRIPTION.HOW_TO_FIX")),1)]),_:1}),o.extraNote?(i(),m(l,{key:0,class:"issue-detail__card__paragraph italic"},{default:n(()=>[c(g(o.extraNote),1)]),_:1})):I("",!0)],64)}const Nu=C(Ou,[["render",Au]]),Lu={components:{BaseButton:L},methods:{onEnableRuntimeProtectionClicked(){if(!this.$featureflags.enable_rasp){const e="Hi, I would like to enable Zen.";window.Intercom("showNewMessage",e);return}window.open("/firewall","_blank")}}};function Bu(e,t,s,d,u,o){const l=r("BaseIcon"),p=r("BaseButton");return i(),_("div",null,[a(p,{variation:"blue",onClick:o.onEnableRuntimeProtectionClicked},{default:n(()=>[a(l,{icon:"icon-shield_check",class:"text--normal flex align-center",color:"#f9f9f9"}),c("Enable Zen ")]),_:1},8,["onClick"])])}const Uu=C(Lu,[["render",Bu]]),Pu={components:{BaseButton:L},props:{groupedIssue:{type:Object,required:!0}},computed:{autofixPageUrl(){return this.groupedIssue.detailed_related_type=="sast"?`/issues/fix/sast?groupedIssue=${this.groupedIssue.id}`:this.groupedIssue.detailed_related_type=="iac"?`/issues/fix/iac?groupedIssue=${this.groupedIssue.id}`:`/issues/fix?groupedIssue=${this.groupedIssue.id}`}}};function Mu(e,t,s,d,u,o){const l=r("BaseIcon"),p=r("BaseButton");return i(),_("div",null,[a(p,{as:"link",variation:"blue",to:o.autofixPageUrl,class:"text-transform-none"},{default:n(()=>[a(l,{icon:"icon-shield_check",class:"text--normal flex align-center",color:"#f9f9f9"}),c(" Autofix ")]),_:1},8,["to"])])}const Du=C(Pu,[["render",Mu]]),Fu={components:{HowToFixSecretSection:Nu,BaseParagraph:E,ShowMoreParagraph:es,IssueGroupDetailRuntimeProtectionCTA:Uu,IssueGroupDetailAutofixCTA:Du},props:{groupedIssue:{type:Object,required:!0},forStatus:String},inject:["theme"],computed:{subIssues(){return this.groupedIssue.issues.filter(e=>e.status==this.forStatus)},hasMultipleSubissues(){return this.subIssues.length>1},shouldShowHowToFixSection(){return!this.how_to_fix&&this.groupedIssue.type=="sast"?!1:this.subIssues.length>0},issue(){return this.subIssues[0]},isAllGcfArtifacts(){return this.subIssues.every(e=>e.attack_surface==="docker_container"&&e.cloud_repo_name.startsWith("gcf-artifacts"))},how_to_fix(){return this.groupedIssue.type==="leaked_secret"?"":this.groupedIssue.type==="license"?"Verify the risks for each license and either remove the package or find a way to comply with the license requirements.":this.groupedIssue.type==="cloud"?this.issue.remediation:this.groupedIssue.type==="sast"?this.issue.remediation:this.groupedIssue.type==="open_source"?this.howToFixOpenSource:this.groupedIssue.type==="eol"?this.issue.fix_version_info?this.hasMultipleSubissues?this.$t("ISSUE.EOL.DESCRIPTION.HOW_TO_FIX.NEAREST",{package_name:this.issue.package_name}):this.$t("ISSUE.EOL.DESCRIPTION.HOW_TO_FIX.PRECISE",{package_name:this.issue.package_name,package_version:this.issue.fix_version_info.package_version}):"Use another OS. e.g. a different Linux distribution.":"We have currently no suggested fix available."},howToFixExtraInfoLink(){return["cloud","sast"].includes(this.groupedIssue.type)?this.issue.background_info_url:""},howToFixOpenSourcePreText(){return this.groupedIssue.type!=="open_source"||this.isAllGcfArtifacts||this.howToFixOpenSource==="No action required."||this.howToFixOpenSource==="We have currently no suggested fix available."||this.issue.aikido_cve_analysis?"":this.subIssues.every(t=>t.attack_surface==="docker_container")?this.$t("ISSUE.OPEN_SOURCE.DESCRIPTION.HOW_TO_FIX.DOCKER")+`

`:""},howToFixOpenSource(){if(this.groupedIssue.type!=="open_source")return"";if(this.isAllGcfArtifacts)return this.$t("ISSUE.OPEN_SOURCE.DESCRIPTION.HOW_TO_FIX.GCP_ARTIFACT");if(this.hasMultipleSubissues){const t=bu(this.subIssues),s=xe(this.subIssues),d=xe(this.subIssues.filter(u=>u.initial_priority>=this.$severity.critical_min));return d&&s!=d?this.$t("ISSUE.OPEN_SOURCE.DESCRIPTION.HOW_TO_FIX.PATCH_MULTIPLE_CRITICAL_ONLY",{package_name:this.groupedIssue.package_name,repo_names:t,highest_patch:s,highest_patch_for_criticals:d}):this.$t("ISSUE.OPEN_SOURCE.DESCRIPTION.HOW_TO_FIX.PATCH_ALL",{package_name:this.groupedIssue.package_name,repo_names:t,highest_patch:s})}if(this.issue.aikido_cve_analysis)return this.issue.aikido_cve_analysis.how_to_fix;if(Cu(this.issue.cwe_classes)&&this.issue.status==="open")return"prototype_pollution";if(this.issue.aikido_score_reasons.map(t=>t.rule).includes("known_safe_version_installed"))return this.$t("ISSUE.OPEN_SOURCE.DESCRIPTION.HOW_TO_FIX.NO_ACTION_REQUIRED");if(this.issue.aikido_score_reasons.map(t=>t.rule).includes("known_safe_version_installed_by_range"))return this.$t("ISSUE.OPEN_SOURCE.DESCRIPTION.HOW_TO_FIX.NO_ACTION_REQUIRED");const e=Y(this.issue);return e&&e!="N/A"?this.$t("ISSUE.OPEN_SOURCE.DESCRIPTION.HOW_TO_FIX.PATCH_SINGLE",{installed_version:this.issue.installed_version,nearest_patch_version:e}):"We have currently no suggested fix available."},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"},shouldShowRuntimeCTA(){return this.groupedIssue.issues.some(t=>Tu(t))},isAutofixable(){return!this.groupedIssue||!this.groupedIssue.issues?!1:Xs(this.groupedIssue,!0)},shouldShowAutofixCTA(){return this.$route.path.includes("/issues/fix")?!1:this.isAutofixable}}},Gu={key:0,class:"issue-detail__card readability_big_fonts"},$u={class:"issue-detail__card__title-container"},zu={class:"issue-detail__card-body"},Vu={class:"issue-detail__card-section"},ju=h("a",{class:"link inline-link",target:"_blank",href:"/settings/integrations/autofix"},"this page",-1),Hu={class:"inherit-font ws-break-spaces"},qu={key:0,class:"mt-12px mb-4px ws-pre-line"},Wu=["href"],Ku={key:2,class:"mt-24px flex gap-16px"};function Xu(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("HowToFixSecretSection"),f=r("ShowMoreParagraph"),S=r("IssueGroupDetailRuntimeProtectionCTA"),k=r("IssueGroupDetailAutofixCTA");return o.shouldShowHowToFixSection?(i(),_("div",Gu,[h("div",$u,[a(l,{"semi-bold":"",color:o.titleColor,class:"issue-detail__card__title"},{default:n(()=>[c("How do I fix it?")]),_:1},8,["color"])]),h("div",zu,[h("div",Vu,[s.groupedIssue.type==="leaked_secret"?(i(),m(p,{key:0,groupedIssue:s.groupedIssue},null,8,["groupedIssue"])):(i(),m(f,{key:1,paragraphClasses:"issue-detail__card__paragraph",color:"black"},{default:n(()=>[o.how_to_fix==="prototype_pollution"?(i(),_(w,{key:0},[c(" You can let Aikido create a pull request with the fix via "),ju,c(". ")],64)):(i(),_(w,{key:1},[h("pre",Hu,g(o.how_to_fix)+" ",1),o.howToFixOpenSourcePreText?(i(),_("div",qu,g(o.howToFixOpenSourcePreText),1)):I("",!0),o.howToFixExtraInfoLink?(i(),_("a",{key:1,href:o.howToFixExtraInfoLink,class:"link",target:"_blank"},"More information",8,Wu)):I("",!0)],64))]),_:1})),o.shouldShowRuntimeCTA||o.shouldShowAutofixCTA?(i(),_("div",Ku,[o.shouldShowRuntimeCTA?(i(),m(S,{key:0})):I("",!0),o.shouldShowAutofixCTA?(i(),m(k,{key:1,groupedIssue:s.groupedIssue},null,8,["groupedIssue"])):I("",!0)])):I("",!0)])])])):I("",!0)}const Yu=C(Fu,[["render",Xu]]),Ju={components:{BaseParagraph:E},props:{groupedIssue:{type:Object,required:!0},forStatus:String},inject:["theme"],computed:{subIssues(){return this.groupedIssue.issues.filter(e=>e.status==this.forStatus)},hasMultipleSubissues(){return this.subIssues.length>1},hasAtLeastOneOpenIssue(){return this.subIssues.length>0},issue(){return this.subIssues[0]},tldr(){var e,t;return this.hasAtLeastOneOpenIssue?this.issue.scanner==="aik_domain_takeover"?((t=(e=this.issue.metadata)==null?void 0:e.analysis)==null?void 0:t.likelyhood)=="invalid_ssl_certificate"?`
						We detected that this subdomain does not have a valid SSL certificate associated with it. 
						SSL certificates are crucial for encrypting data transmitted between a user's browser and the server, ensuring that sensitive information is protected from interception by malicious actors. 
					`:`
                    We detected that this subdomain has a CNAME record in the DNS, but no application or service is providing content for it. 
                    This can happen because the app it's being pointed to is no longer in use. 
                    An attacker could take over this subdomain by simply creating an account with the app it is referring to.
					The attacker could then proceed to serve their own content and use this to steal cookies from your main domain and launch
					various social engineering attacks on your organization.
                `:this.issue.description:""},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"}}},Qu={key:0,class:"issue-detail__card readability_big_fonts"},Zu={class:"issue-detail__card__title-container"},el={class:"issue-detail__card-body"},sl={class:"issue-detail__card-section"};function tl(e,t,s,d,u,o){const l=r("BaseParagraph");return o.tldr?(i(),_("div",Qu,[h("div",Zu,[a(l,{"semi-bold":"",class:"issue-detail__card__title"},{default:n(()=>[c("TL;DR")]),_:1})]),h("div",el,[h("div",sl,[a(l,{color:o.paragraphColor,class:"issue-detail__card__paragraph"},{default:n(()=>[c(g(o.tldr),1)]),_:1},8,["color"])])])])):I("",!0)}const ol=C(Ju,[["render",tl]]),nl={components:{BaseParagraph:E},props:{groupedIssue:{type:Object,required:!0},forStatus:String},inject:["theme"],computed:{shouldShowSection(){return!!(this.issue.scanner!="nuclei"||this.issue.remediation)},subIssues(){return this.groupedIssue.issues.filter(e=>e.status==this.forStatus)},hasMultipleSubissues(){return this.subIssues.length>1},hasAtLeastOneOpenIssue(){return this.subIssues.length>0},issue(){return this.subIssues[0]},isInvalidSsslCertificateError(){var e,t;return((t=(e=this.issue.metadata)==null?void 0:e.analysis)==null?void 0:t.likelyhood)=="invalid_ssl_certificate"},howToFixExtraInfoLink(){return this.isInvalidSsslCertificateError?null:this.issue.scanner==="aik_domain_takeover"?"https://developer.mozilla.org/en-US/docs/Web/Security/Subdomain_takeovers":this.issue.background_info_url},description(){return this.hasAtLeastOneOpenIssue?this.issue.scanner==="aik_domain_takeover"?this.isInvalidSsslCertificateError?this.$t("ISSUE.SURFACE_MONITORING.DESCRIPTION.HOW_TO_FIX.INVALID_SSL_CERTIFICATE"):this.$t("ISSUE.SURFACE_MONITORING.DESCRIPTION.HOW_TO_FIX.DOMAIN_TAKEOVER"):this.issue.remediation:""},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"}}},il={key:0,class:"issue-detail__card readability_big_fonts"},al={class:"issue-detail__card__title-container"},rl={class:"issue-detail__card-body"},ul={class:"issue-detail__card-section"},ll=["href"];function cl(e,t,s,d,u,o){const l=r("BaseParagraph");return o.shouldShowSection?(i(),_("div",il,[h("div",al,[a(l,{"semi-bold":"",class:"issue-detail__card__title"},{default:n(()=>[c("How do I fix it?")]),_:1})]),h("div",rl,[h("div",ul,[a(l,{bold:"",color:o.titleColor,class:"uppercase"},null,8,["color"]),a(l,{color:o.paragraphColor,size:"medium",class:"leading-22px"},{default:n(()=>[c(g(o.description)+" ",1),o.howToFixExtraInfoLink?(i(),_("a",{key:0,href:o.howToFixExtraInfoLink,class:"link inline-link",target:"_blank"},"More information",8,ll)):I("",!0)]),_:1},8,["color"])])])])):I("",!0)}const dl=C(nl,[["render",cl]]),hl={bad_author_rule:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.BAD_AUTHOR_RULE"),executes_code_at_remote_url:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.EXECUTES_CODE_AT_REMOTE_URL"),ip_identification_rule:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.IP_IDENTIFICATION_RULE"),detect_python_obfuscation_rule:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.DETECT_PYTHON_OBFUSCATION_RULE"),suspicious_setup_commands_rule:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.SUSPICIOUS_SETUP_COMMANDS_RULE"),simple_js_obfuscation:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.SIMPLE_JS_OBFUSCATION"),ephemeral_domain_rule:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.EPHEMERAL_DOMAIN_RULE"),dependency_confusion_rule:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.DEPENDENCY_CONFUSION_RULE"),env_var_enumeration_rule:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.ENV_VAR_ENUMERATION_RULE"),suspicious_url_references_rule:D.global.t("ISSUE.MALWARE.DESCRIPTION.TLDR.SUSPICIOUS_URL_REFERENCES_RULE")},_l={components:{BaseParagraph:E},props:{groupedIssue:{type:Object,required:!0},forStatus:String},inject:["theme"],computed:{indicators(){return Object.keys(this.groupedIssue.indicators??{})},tldr(){for(const e of this.indicators){const t=hl[e];if(t)return t}return null},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"}}},pl={key:0,class:"issue-detail__card readability_big_fonts"},gl={class:"issue-detail__card__title-container"},fl={class:"issue-detail__card-body"},ml={class:"issue-detail__card-section"};function Il(e,t,s,d,u,o){const l=r("BaseParagraph");return o.tldr?(i(),_("div",pl,[h("div",gl,[a(l,{"semi-bold":"",color:o.titleColor,class:"issue-detail__card__title"},{default:n(()=>[c("TL;DR")]),_:1},8,["color"])]),h("div",fl,[h("div",ml,[a(l,{color:o.paragraphColor,class:"issue-detail__card__paragraph"},{default:n(()=>[c(g(o.tldr),1)]),_:1},8,["color"])])])])):I("",!0)}const Sl=C(_l,[["render",Il]]),yl={components:{BaseParagraph:E},props:{groupedIssue:{type:Object,required:!0},forStatus:String},inject:["theme"],computed:{description(){return"Uninstall the package as soon as possible."},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"}}},kl={class:"issue-detail__card readability_big_fonts"},Cl={class:"issue-detail__card__title-container"},bl={class:"issue-detail__card-body"},wl={class:"issue-detail__card-section"};function vl(e,t,s,d,u,o){const l=r("BaseParagraph");return i(),_("div",kl,[h("div",Cl,[a(l,{"semi-bold":"",class:"issue-detail__card__title"},{default:n(()=>[c("How do I fix it?")]),_:1})]),h("div",bl,[h("div",wl,[a(l,{bold:"",color:o.titleColor,class:"uppercase"},null,8,["color"]),a(l,{color:o.paragraphColor,size:"medium",class:"leading-22px"},{default:n(()=>[c(g(o.description),1)]),_:1},8,["color"])])])])}const El=C(yl,[["render",vl]]),xl={components:{BaseParagraph:E},props:{groupedIssue:{type:Object,required:!0},forStatus:String},inject:["theme"],computed:{tldr(){var e;return((e=this.groupedIssue.issues[0])==null?void 0:e.description)??null},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"}}},Rl={key:0,class:"issue-detail__card readability_big_fonts"},Tl={class:"issue-detail__card__title-container"},Ol={class:"issue-detail__card-body"},Al={class:"issue-detail__card-section"};function Nl(e,t,s,d,u,o){const l=r("BaseParagraph");return o.tldr?(i(),_("div",Rl,[h("div",Tl,[a(l,{"semi-bold":"",color:o.titleColor,class:"issue-detail__card__title"},{default:n(()=>[c("TL;DR")]),_:1},8,["color"])]),h("div",Ol,[h("div",Al,[a(l,{color:o.paragraphColor,class:"issue-detail__card__paragraph"},{default:n(()=>[c(g(o.tldr),1)]),_:1},8,["color"])])])])):I("",!0)}const Ll=C(xl,[["render",Nl]]),Bl={components:{BaseParagraph:E},props:{groupedIssue:{type:Object,required:!0},forStatus:String},inject:["theme"],computed:{description(){return this.groupedIssue.issues[0].remediation},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"}}},Ul={class:"issue-detail__card readability_big_fonts"},Pl={class:"issue-detail__card__title-container"},Ml={class:"issue-detail__card-body"},Dl={class:"issue-detail__card-section"};function Fl(e,t,s,d,u,o){const l=r("BaseParagraph");return i(),_("div",Ul,[h("div",Pl,[a(l,{"semi-bold":"",class:"issue-detail__card__title"},{default:n(()=>[c("How do I fix it?")]),_:1})]),h("div",Ml,[h("div",Dl,[a(l,{color:o.paragraphColor,class:"issue-detail__card__paragraph"},{default:n(()=>[c(g(o.description),1)]),_:1},8,["color"])])])])}const Gl=C(Bl,[["render",Fl]]),$l={components:{TldrSection:au,AffectSection:ku,FixSection:Yu,SurfaceMonitoringAnalysisSection:ol,SurfaceMonitoringFixSection:dl,MalwareAnalysisSection:Sl,MalwareFixSection:El,ScmSecurityFixSection:Gl,ScmSecurityAnalysisSection:Ll},props:{groupedIssue:{type:Object,required:!0},isDetailPage:Boolean,forStatus:{type:String,default:"open",validator(e){return["open","closed","snoozed","ignored"].includes(e)}}},data(){return{affectSectionLoaded:!1}},watch:{allLoaded(){this.allLoaded&&this.$emit("loaded")}},computed:{allLoaded(){return this.groupedIssue.type!=="open_source"?!0:this.affectSectionLoaded}}};function zl(e,t,s,d,u,o){const l=r("TldrSection"),p=r("AffectSection"),f=r("FixSection"),S=r("SurfaceMonitoringAnalysisSection"),k=r("SurfaceMonitoringFixSection"),y=r("MalwareAnalysisSection"),v=r("MalwareFixSection"),R=r("ScmSecurityAnalysisSection"),b=r("ScmSecurityFixSection");return i(),_(w,null,[s.groupedIssue.type==="open_source"?(i(),_(w,{key:0},[a(l,{groupedIssue:s.groupedIssue,forStatus:s.forStatus,isDetailPage:s.isDetailPage},null,8,["groupedIssue","forStatus","isDetailPage"]),a(p,{groupedIssue:s.groupedIssue,forStatus:s.forStatus,onLoaded:t[0]||(t[0]=x=>u.affectSectionLoaded=!0)},null,8,["groupedIssue","forStatus"]),a(f,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"])],64)):I("",!0),s.groupedIssue.type==="leaked_secret"?(i(),_(w,{key:1},[a(l,{groupedIssue:s.groupedIssue,forStatus:s.forStatus,isDetailPage:s.isDetailPage},null,8,["groupedIssue","forStatus","isDetailPage"]),a(f,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"])],64)):I("",!0),s.groupedIssue.type==="cloud"?(i(),_(w,{key:2},[a(l,{groupedIssue:s.groupedIssue,forStatus:s.forStatus,isDetailPage:s.isDetailPage},null,8,["groupedIssue","forStatus","isDetailPage"]),a(f,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"])],64)):I("",!0),s.groupedIssue.type==="sast"?(i(),_(w,{key:3},[a(l,{groupedIssue:s.groupedIssue,forStatus:s.forStatus,isDetailPage:s.isDetailPage},null,8,["groupedIssue","forStatus","isDetailPage"]),a(f,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"])],64)):I("",!0),s.groupedIssue.type==="surface_monitoring"?(i(),_(w,{key:4},[a(S,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"]),a(k,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"])],64)):I("",!0),s.groupedIssue.type==="malware"?(i(),_(w,{key:5},[a(y,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"]),a(v,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"])],64)):I("",!0),s.groupedIssue.type==="eol"?(i(),_(w,{key:6},[a(l,{groupedIssue:s.groupedIssue,forStatus:s.forStatus,isDetailPage:s.isDetailPage},null,8,["groupedIssue","forStatus","isDetailPage"]),a(f,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"])],64)):I("",!0),s.groupedIssue.type==="scm_security"?(i(),_(w,{key:7},[a(R,{groupedIssue:s.groupedIssue,forStatus:s.forStatus,isDetailPage:s.isDetailPage},null,8,["groupedIssue","forStatus","isDetailPage"]),a(b,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"])],64)):I("",!0),s.groupedIssue.type==="license"?(i(),_(w,{key:8},[a(l,{groupedIssue:s.groupedIssue,forStatus:s.forStatus,isDetailPage:s.isDetailPage},null,8,["groupedIssue","forStatus","isDetailPage"]),a(f,{groupedIssue:s.groupedIssue,forStatus:s.forStatus},null,8,["groupedIssue","forStatus"])],64)):I("",!0)],64)}const Vl=C($l,[["render",zl]]),jl={},Hl={class:"metric-number"};function ql(e,t,s,d,u,o){return i(),_("p",Hl,[F(e.$slots,"default")])}const Wl=C(jl,[["render",ql]]),W={paddingBetweenAngles:.03,innerRadius:.84,outerRadius:1,dotSize:.06,dotBorder:.01},le=We().domain([0,100]).range([0,1]).clamp(!0),ce=We().domain([0,1]).range([-Math.PI/2,Math.PI/2]).clamp(!0),Kl={components:{BaseMetricNumber:Wl},props:{data:{type:Array,required:!0},value:{type:Number,required:!0},width:{type:Number,default:120,required:!1}},inject:["theme"],methods:{clearChart(){ve(this.$refs.svg).selectAll("*").remove()},renderChart(){this.clearChart();const e=ve(this.$refs.svg);e.attr("viewBox","-1 -1 2 1").attr("width",this.width).attr("height",this.width/2),this.renderArcElements(e),this.renderDot(e)},renderArcElements(e){this.data.forEach(t=>{const s=et().innerRadius(W.innerRadius).outerRadius(W.outerRadius).startAngle(ce(le(t.start))).endAngle(ce(le(t.end))).padAngle(W.paddingBetweenAngles)();e.append("path").attr("d",s).attr("fill","currentColor").attr("class",t.colorClass)})},renderDot(e){function t(p,f){return[Math.cos(p-Math.PI/2)*f,Math.sin(p-Math.PI/2)*f]}const s=le(this.value),d=ce(s),u=1-(W.outerRadius-W.innerRadius)/2,[o,l]=t(d,u);e.append("circle").attr("fill","white").attr("stroke-width",W.dotBorder).attr("r",W.dotSize).attr("cx",o).attr("cy",l)}},mounted(){this.renderChart()},watch:{value(){this.renderChart()}}},Xl={class:"gauge-chart"},Yl={ref:"svg"};function Jl(e,t,s,d,u,o){const l=r("BaseMetricNumber");return i(),_("div",Xl,[(i(),_("svg",Yl,null,512)),a(l,{class:A([o.theme==="dark"?"text-white":"text-primary-aik-140"])},{default:n(()=>[c(g(s.value),1)]),_:1},8,["class"])])}const Ql=C(Kl,[["render",Jl]]),Zl={components:{BaseButton:L,BaseHeading:U,BaseModal:B,BaseParagraph:E},props:{severity:String,groupedIssue:Object,status:String},emits:["close","disagree"],computed:{issues(){const s=this.groupedIssue.issues.filter(u=>u.status===this.status).flatMap(u=>u.aikido_score_reasons.map(function(o){if((o==null?void 0:o.applied)!==!1)return o.rule_info})).filter(function(u){return!!u});return[...new Set(s)]}}},ec={class:"flex flex-column gap-12px"},sc={key:2,class:"list-disc pl-8px"};function tc(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("BaseButton"),S=r("BaseModal");return i(),m(S,{onClose:t[2]||(t[2]=k=>e.$emit("close"))},{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c(g(e.$t("SCORING_EXPLANATION_MODAL.SUB_TITLE")),1)]),_:1})]),content:n(()=>[h("div",ec,[a(p,{as:"h3"},{default:n(()=>[c(g(e.$t("SCORING_EXPLANATION_MODAL.TITLE",{scoring:s.severity.toLowerCase()})),1)]),_:1}),a(l,{size:"medium",bold:""},{default:n(()=>[c(g(e.$t("SCORING_EXPLANATION_MODAL.BASE_SCORING")),1)]),_:1}),s.groupedIssue.issues.length>1?(i(),m(l,{key:0,size:"small"},{default:n(()=>[c(g(e.$t("SCORING_EXPLANATION_MODAL.GROUP_SCORING",{scoring:s.severity.toLowerCase()})),1)]),_:1})):I("",!0),a(l,{size:"small",class:"mb-16px"},{default:n(()=>[c(g(e.$t(`SCORING_EXPLANATION_MODAL.TYPES.${s.groupedIssue.type.toUpperCase()}`)),1)]),_:1}),a(l,{size:"medium",bold:""},{default:n(()=>[c(g(e.$t("SCORING_EXPLANATION_MODAL.SCORING_MODIFIERS")),1)]),_:1}),o.issues.length>0?(i(),m(l,{key:1,size:"small"},{default:n(()=>[c(g(e.$t("SCORING_EXPLANATION_MODAL.DESCRIPTION")),1)]),_:1})):I("",!0),o.issues.length?(i(),_("ul",sc,[(i(!0),_(w,null,N(o.issues,k=>(i(),_("li",null,[a(l,{size:"small"},{default:n(()=>[c(g(k),1)]),_:2},1024)]))),256))])):(i(),m(l,{key:3,size:"small"},{default:n(()=>[c(g(e.$t("SCORING_EXPLANATION_MODAL.NO_REASONS")),1)]),_:1}))])]),footer:n(()=>[a(f,{variation:"secondary",onClicked:t[0]||(t[0]=k=>e.$emit("disagree")),class:"ml-auto"},{default:n(()=>[c(g(e.$t("SCORING_EXPLANATION_MODAL.DISAGREE")),1)]),_:1}),a(f,{variation:"primary",onClicked:t[1]||(t[1]=k=>e.$emit("close"))},{default:n(()=>[c(g(e.$t("SCORING_EXPLANATION_MODAL.AGREE")),1)]),_:1})]),_:1})}const oc=C(Zl,[["render",tc]]),nc={components:{BaseModal:B,BaseParagraph:E,BaseButton:L,BaseHeading:U,BaseForm:st,InputTextArea:J},props:{severity:String,groupedIssue:Object},computed:{lowerButtonVariation(){return!this.scoringValue||this.scoringValue==="lower"?"success":"secondary"},higherButtonVariation(){return!this.scoringValue||this.scoringValue==="higher"?"destructive":"secondary"}},methods:{async handleSubmit(e){this.scoringValueError=void 0,this.scoringReasonError=void 0;const t=this.scoringValue;if(!t){this.scoringValueError=this.$t("CHANGE_ISSUE_SCORING_MODAL.SCORING_VALUE.ERROR");return}const s=e.target.elements.scoringReason.value;if(!s){this.scoringReasonError=this.$t("CHANGE_ISSUE_SCORING_MODAL.CHANGE_SCORING_REASON.ERROR");return}await Ns({issueId:this.groupedIssue.id,scoring:t,reason:s}),this.$emit("close")},handleChangeScoring(e){this.scoringValue=e.target.value}},data(){return{scoringValueError:void 0,scoringReasonError:void 0,scoringValue:void 0}}},ic={class:"flex flex-column gap-16px"},ac={class:"flex flex-column gap-8px"},rc={class:"flex gap-8px"};function uc(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseHeading"),f=r("BaseButton"),S=r("InputTextArea"),k=r("BaseForm"),y=r("BaseModal");return i(),m(y,null,{header:n(()=>[a(l,{color:"gray"},{default:n(()=>[c(g(e.$t("CHANGE_ISSUE_SCORING_MODAL.SUB_TITLE")),1)]),_:1})]),content:n(()=>[h("div",ic,[a(p,{as:"h3"},{default:n(()=>[c(g(e.$t("CHANGE_ISSUE_SCORING_MODAL.TITLE")),1)]),_:1}),a(k,{id:"scoringForm",onSubmit:X(o.handleSubmit,["prevent"])},{default:n(()=>[h("div",ac,[a(l,{size:"small"},{default:n(()=>[c(g(e.$t("CHANGE_ISSUE_SCORING_MODAL.CHANGE_SCORING")),1)]),_:1}),h("div",rc,[a(f,{onClick:o.handleChangeScoring,size:"small",value:"lower",variation:o.lowerButtonVariation},{default:n(()=>[c(g(e.$t("CHANGE_ISSUE_SCORING_MODAL.SCORING_VALUE.LOWER")),1)]),_:1},8,["onClick","variation"]),a(f,{onClick:o.handleChangeScoring,size:"small",value:"higher",variation:o.higherButtonVariation},{default:n(()=>[c(g(e.$t("CHANGE_ISSUE_SCORING_MODAL.SCORING_VALUE.HIGHER")),1)]),_:1},8,["onClick","variation"])]),u.scoringValueError?(i(),m(l,{key:0,size:"small",color:"danger"},{default:n(()=>[c(g(u.scoringValueError),1)]),_:1})):I("",!0)]),a(S,{name:"scoringReason",title:e.$t("CHANGE_ISSUE_SCORING_MODAL.CHANGE_SCORING_REASON"),error:u.scoringReasonError},null,8,["title","error"])]),_:1},8,["onSubmit"])])]),footer:n(()=>[a(f,{variation:"plain",onClicked:t[0]||(t[0]=v=>e.$emit("close")),class:"ml-auto"},{default:n(()=>[c(g(e.$t("CHANGE_ISSUE_SCORING_MODAL.CANCEL")),1)]),_:1}),a(f,{variation:"primary",type:"submit",form:"scoringForm"},{default:n(()=>[c(g(e.$t("CHANGE_ISSUE_SCORING_MODAL.SUBMIT")),1)]),_:1})]),_:1})}const lc=C(nc,[["render",uc]]);async function cc(e){return(await ie.get(`/api/notes/issue/${e}`)).data}async function dc(e){return(await ie.get(`/api/notes/issue/${e}/count`)).data}async function hc({note:e,issueGroupId:t,audience:s,scope:d,scopeValue:u}){await ie.post(`/api/notes/issue/${t}`,{note:e,audience:s,scope:d,scope_value:u})}async function _c(e){await ie.post(`/api/notes/issue/${e}/delete`)}const pc={props:{width:{type:Number,default:20},color:{type:String,default:"#141031"}}},gc=["width"],fc=["fill"],mc=["fill"],Ic=["fill"];function Sc(e,t,s,d,u,o){return i(),_("svg",{width:s.width,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[h("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 6C8 3.79086 9.79086 2 12 2C14.2091 2 16 3.79086 16 6V11H14V6C14 4.89543 13.1046 4 12 4C10.8954 4 10 4.89543 10 6V11H8V6Z",fill:s.color},null,8,fc),h("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.7587 9H14.2413C15.0463 8.99999 15.7106 8.99998 16.2518 9.04419C16.8139 9.09012 17.3306 9.18868 17.816 9.43597C18.5686 9.81947 19.1805 10.4314 19.564 11.184C19.8113 11.6694 19.9099 12.1861 19.9558 12.7482C20 13.2894 20 13.9537 20 14.7587V16.2413C20 17.0463 20 17.7106 19.9558 18.2518C19.9099 18.8139 19.8113 19.3306 19.564 19.816C19.1805 20.5686 18.5686 21.1805 17.816 21.564C17.3306 21.8113 16.8139 21.9099 16.2518 21.9558C15.7106 22 15.0463 22 14.2413 22H9.75873C8.95374 22 8.28938 22 7.74818 21.9558C7.18608 21.9099 6.66937 21.8113 6.18404 21.564C5.43139 21.1805 4.81947 20.5686 4.43597 19.816C4.18868 19.3306 4.09012 18.8139 4.04419 18.2518C3.99998 17.7106 3.99999 17.0463 4 16.2413V14.7587C3.99999 13.9537 3.99998 13.2894 4.04419 12.7482C4.09012 12.1861 4.18868 11.6694 4.43597 11.184C4.81947 10.4314 5.43139 9.81947 6.18404 9.43597C6.66937 9.18868 7.18608 9.09012 7.74817 9.04419C8.28937 8.99998 8.95373 8.99999 9.7587 9ZM7.91104 11.0376C7.47262 11.0734 7.24842 11.1383 7.09202 11.218C6.7157 11.4097 6.40973 11.7157 6.21799 12.092C6.1383 12.2484 6.07337 12.4726 6.03755 12.911C6.00078 13.3611 6 13.9434 6 14.8V16.2C6 17.0566 6.00078 17.6389 6.03755 18.089C6.07337 18.5274 6.1383 18.7516 6.21799 18.908C6.40973 19.2843 6.7157 19.5903 7.09202 19.782C7.24842 19.8617 7.47262 19.9266 7.91104 19.9624C8.36113 19.9992 8.94342 20 9.8 20H14.2C15.0566 20 15.6389 19.9992 16.089 19.9624C16.5274 19.9266 16.7516 19.8617 16.908 19.782C17.2843 19.5903 17.5903 19.2843 17.782 18.908C17.8617 18.7516 17.9266 18.5274 17.9624 18.089C17.9992 17.6389 18 17.0566 18 16.2V14.8C18 13.9434 17.9992 13.3611 17.9624 12.911C17.9266 12.4726 17.8617 12.2484 17.782 12.092C17.5903 11.7157 17.2843 11.4097 16.908 11.218C16.7516 11.1383 16.5274 11.0734 16.089 11.0376C15.6389 11.0008 15.0566 11 14.2 11H9.8C8.94342 11 8.36113 11.0008 7.91104 11.0376Z",fill:s.color},null,8,mc),h("path",{d:"M11 16C11 15.4477 11.4477 15 12 15C12.5523 15 13 15.4477 13 16V17C13 17.5523 12.5523 18 12 18C11.4477 18 11 17.5523 11 17V16Z",fill:s.color},null,8,Ic)],8,gc)}const ss=C(pc,[["render",Sc]]),yc={props:{text:String},components:{BaseParagraph:E},inject:["theme"],computed:{separatedText(){const e=/(<br\s*\/?>)|\s+/g;return this.text.split(e).filter(Boolean)}},methods:{isLink(e){return e.indexOf("https://")===0||e.indexOf("http://")===0},getPaddedWord(e,t){return t===0?`${e} `:` ${e} `},handleOpenLink(e){this.$modal.show("NotifyExternalLink",{url:e})}}},kc=["href","onClick"],Cc={key:1};function bc(e,t,s,d,u,o){const l=r("BaseParagraph");return i(),m(l,{color:o.theme==="light"?"dark-gray":"light-gray"},{default:n(()=>[(i(!0),_(w,null,N(o.separatedText,(p,f)=>(i(),_(w,{key:f},[o.isLink(p)?(i(),_("a",{key:0,href:p,target:"_blank",class:"notes__note-link",onClick:X(()=>o.handleOpenLink(p),["prevent"])},g(p),9,kc)):p==="<br />"?(i(),_("br",Cc)):(i(),_(w,{key:2},[c(g(o.getPaddedWord(p,f)),1)],64))],64))),128))]),_:1},8,["color"])}const wc=C(yc,[["render",bc]]),vc={props:{note:Object},components:{BaseParagraph:E,LockIcon:ss,AvatarImage:ze,LinkifyText:wc,ActionMenu:re,BaseIconButton:pe},inject:["theme"],computed:{title(){return this.note.scope_value?`${this.note.user_name} for ${this.note.scope_value}`:`${this.note.user_name}`},timestamp(){return O.fromUnix(this.note.created_at).format(O.US_FRIENDLY_DATE_WITH_TIME)},audience(){return this.note.audience==="user"?"Only you":"Workspace"},sections(){return[{title:"Actions",items:[{hidden:!this.$groupUser.admin,label:"Delete Note",onClick:this.removeNote,icon:"icon-delete",iconColor:"red"}].filter(t=>!t.hidden)}]},shouldShowActions(){return this.sections.map(e=>e.items).flat(1).length>0}},methods:{async removeNote(){if(await Ve({headerText:"Delete Note",description:"Are you sure you want to delete this note?",buttonSubmitText:"Delete Note"})){try{await _c(this.note.id)}catch{return}this.$emit("noteDeleted"),this.$toast.success("Note successfully deleted")}}}},Ec={class:"flex gap-16px"},xc={class:"flex flex-column gap-4px w-full"},Rc={class:"flex justify-between align-center"},Tc={class:"flex flex-column gap-4px"},Oc={key:0},Ac={class:"flex gap-4px justify-between gap-12px"},Nc={class:"flex align-center gap-4px"};function Lc(e,t,s,d,u,o){const l=r("AvatarImage"),p=r("BaseParagraph"),f=r("LinkifyText"),S=r("BaseIconButton"),k=r("ActionMenu"),y=r("LockIcon");return i(),_("div",Ec,[a(l,{name:s.note.user_name,class:"size-24 inline-block rounded-10 notes__note-avatar"},null,8,["name"]),h("div",xc,[h("div",Rc,[h("div",Tc,[a(p,{color:o.theme==="light"?"black":"white",bold:""},{default:n(()=>[c(g(o.title),1)]),_:1},8,["color"]),a(f,{text:s.note.note},null,8,["text"])]),o.shouldShowActions?(i(),_("div",Oc,[a(k,{sections:o.sections,placement:"bottom-end",useBaseIcon:!0},{trigger:n(v=>[a(S,{size:"small",icon:"icon-actions",class:"rounded-24px sidebar-icon-button--inverted",onClicked:v.toggle},null,8,["onClicked"])]),_:1},8,["sections"])])):I("",!0)]),h("div",Ac,[a(p,{color:"gray"},{default:n(()=>[c(g(o.timestamp),1)]),_:1}),h("div",Nc,[a(y,{color:"#737283",width:14}),a(p,{color:"gray"},{default:n(()=>[c(g(o.audience),1)]),_:1})])])])])}const Bc=C(vc,[["render",Lc]]),Uc={props:{issueGroup:Object},components:{InputTextArea:J,BaseButton:L,BaseSelect:_e,LockIcon:ss},data(){return{audience:"workspace",note:null,scope:"issue_group",isSaving:!1}},inject:["theme"],async mounted(){},computed:{audienceOptions(){return[{id:"workspace",title:"All users"},{id:"user",title:"Just me"}]},disableSubmit(){return!!this.noteError},noteError(){var e;return!this.note||((e=this.note)==null?void 0:e.length)<1850?null:"Your note can not be longer than 1850 characters"},showScopeOption(){return["open_source"].includes(this.issueGroup.type)},scopeOptions(){if(this.issueGroup.type==="open_source"){const t=[...new Set(this.issueGroup.issues.map(s=>s.cve_id))].map(s=>({id:s,title:s}));return[{id:"issue_group",title:"All CVES"},...t]}return[]},scopeKind(){return this.scope!=="issue_group"&&this.issueGroup.type==="open_source"?"cve":"issue_group"}},methods:{resetForm(){this.note=null,this.audience="workspace"},async handleLeaveNote(){if(this.disableSubmit)return;this.isSaving=!0;let e=!1;this.note&&(this.note=this.note.trim());try{await hc({note:this.note,issueGroupId:this.issueGroup.id,audience:this.audience,scope:this.scopeKind,scopeValue:this.scopeKind==="issue_group"?void 0:this.scope})}catch{e=!0}e||(T.emit("noteCreated",{issueGroupId:this.issueGroup.id}),this.resetForm(),this.$toast.success({title:"Note added to issue",description:"A new note has been added to this issue"}),this.isSaving=!1)}}},Pc={class:"flex flex-column gap-8px w-full"},Mc={class:"flex gap-8px flex-1 flex-wrap"};function Dc(e,t,s,d,u,o){const l=r("InputTextArea"),p=r("LockIcon"),f=r("BaseSelect"),S=r("BaseButton");return i(),_("div",Pc,[a(l,{theme:o.theme,name:"note",placeholder:"Leave a plaintext note, no HTML",modelValue:u.note,"onUpdate:modelValue":t[0]||(t[0]=k=>u.note=k),rows:"3",wrap:"hard","max-length":1850,error:o.noteError},null,8,["theme","modelValue","error"]),h("div",Mc,[a(f,{id:"audience",modelValue:u.audience,"onUpdate:modelValue":t[1]||(t[1]=k=>u.audience=k),options:o.audienceOptions,theme:o.theme},{"prefix-icon":n(k=>[a(p,{width:14,color:k.color},null,8,["color"])]),_:1},8,["modelValue","options","theme"]),o.showScopeOption?(i(),m(f,{key:0,id:"scope",modelValue:u.scope,"onUpdate:modelValue":t[2]||(t[2]=k=>u.scope=k),options:o.scopeOptions,theme:o.theme},null,8,["modelValue","options","theme"])):I("",!0),a(S,{class:"ml-auto",variation:"primary",size:"small",onClick:o.handleLeaveNote,"is-loading":u.isSaving,disabled:o.disableSubmit},{default:n(()=>[c(" Add note ")]),_:1},8,["onClick","is-loading","disabled"])])])}const Fc=C(Uc,[["render",Dc]]),Gc={props:{issueGroup:Object},components:{CreateNoteForm:Fc,NoteDetails:Bc,XPreloader:je,BaseParagraph:E},data(){return{notes:[],isLoading:!0}},inject:["theme"],watch:{async issueGroup(){await this.getNotes()}},created(){T.on("noteCreated",this.handleSyncNotes)},beforeUnmount(){T.off("noteCreated",this.handleSyncNotes)},async mounted(){await this.getNotes(),this.isLoading=!1},computed:{themeClass(){return this.theme==="light"?"notes--theme-light":"notes--theme-dark"}},methods:{async handleSyncNotes(e,t){(!e||e.issueGroupId===this.issueGroup.id)&&await this.getNotes()},async getNotes(){this.notes=await cc(this.issueGroup.id)}}},$c={class:"flex flex-1 flex-column gap-24px relative"},zc={key:1,class:"flex flex-1 align-center justify-center"},Vc=h("div",{class:"notes-divider"},null,-1),jc={class:"flex w-full mt-auto"};function Hc(e,t,s,d,u,o){const l=r("XPreloader"),p=r("BaseParagraph"),f=r("NoteDetails"),S=r("CreateNoteForm");return i(),_("div",{class:A(["flex flex-column w-full flex-1 gap-24px",[o.themeClass]])},[h("div",$c,[u.isLoading?(i(),m(l,{key:0,size:"medium",theme:"transparent",class:"supercenter"})):u.notes.length===0?(i(),_("div",zc,[a(p,{color:o.theme==="light"?"black":"white"},{default:n(()=>[c("There are no notes yet for this issue. Be the first one to leave one!")]),_:1},8,["color"])])):(i(),_(w,{key:2},[Vc,(i(!0),_(w,null,N(u.notes,k=>(i(),m(f,{key:k.id,note:k,onNoteDeleted:o.getNotes},null,8,["note","onNoteDeleted"]))),128))],64))]),h("div",jc,[a(S,{"issue-group":s.issueGroup},null,8,["issue-group"])])],2)}const qc=C(Gc,[["render",Hc]]);function Wc(e,t,s,d,u,o,l){if(t=="group")return e;const p=[];for(const f of e)t==="repo"&&f.repo_id===s&&p.push(f),t==="cloud"&&f.cloud_id===d&&p.push(f),t==="domain"&&f.domain_id===u&&p.push(f),t==="path"&&o!=""&&f.target_path.includes(o)&&p.push(f),t=="single_issue"&&f.id==l&&p.push(f);return p}const Kc={props:{taskId:{type:Number,required:!0}},components:{BaseIconButton:pe,ActionMenu:re},emits:["taskUnlinked"],computed:{actions(){return[{title:"Actions",items:[{label:"Unlink Task",onClick:this.handleUnlinkTask,icon:"icon-link"}]}]},issueTrackerName(){return this.$t("TASK_TRACKER_"+ee.data.issueTracker)}},methods:{async handleUnlinkTask(){await Ve({title:this.$t("UNLINK_TASK.MODAL.TITLE",{taskTracker:this.issueTrackerName}),description:this.$t("UNLINK_TASK.MODAL.DESC",{taskTracker:this.issueTrackerName}),buttonSubmitText:"Unlink Task"})&&(await Ls(this.taskId),this.$emit("taskUnlinked"))}}};function Xc(e,t,s,d,u,o){const l=r("BaseIconButton"),p=r("ActionMenu");return i(),m(p,{sections:o.actions,useBaseIcon:!0,placement:"bottom-end"},{trigger:n(f=>[a(l,{icon:"icon-actions",class:"rounded-24px sidebar-icon-button",onClicked:f.toggle},null,8,["onClicked"])]),_:1},8,["sections"])}const Yc=C(Kc,[["render",Xc]]),Jc=e=>new Promise(t=>setTimeout(t,e)),Qc={emits:["requestDataFetch"],inject:["theme"],props:{groupedIssue:Object,isDetailPage:Boolean},components:{XPreloader:je,BaseParagraph:E,BaseCard:Ke,BaseBody:se,AvatarImage:ze,AccordionContainer:ot,SubIssuesSection:Qe,BaseButton:L,BaseLink:P,BaseIcon:ae,TasksActionMenu:Yc},data(){return{loaded:!1,showAddTaskModal:!1}},async mounted(){const e=this.$route.query.sidebarIssueTask;if(e){await this.$nextTick();const t=this.$refs[`AccordionContainer_${e}`];t&&t[0]&&(t[0].toggleExpanded(),await Jc(200),t[0].$el.scrollIntoView({behavior:"smooth",block:"start"}))}},computed:{sortedTasks(){return this.tasks.slice().sort((e,t)=>e.is_closed&&!t.is_closed?1:!e.is_closed&&t.is_closed?-1:0)},tasks(){return this.groupedIssue.tasks},issueTrackerIcon(){switch(ee.data.issueTracker){case"github":return"icon-github";case"gitlab":case"gitlab-server":return"icon-Gitlab";case"linear":return"icon-linear";case"asana":return"icon-asana";case"clickup":return"icon-clickup";case"azure-devops":return"icon-azure";case"jetbrains-youtrack":return"icon-jetbrains-youtrack";case"monday":return"icon-monday-dot-com";case"shortcut":return"icon-shortcut";case"jira-data-center":default:return"icon-JIRA"}},shouldShowLinkTaskOption(){return["jira","clickup","linear","azure-devops","github","gitlab-server"].includes(ee.data.issueTracker)},issueTrackerName(){return this.$t("TASK_TRACKER_"+ee.data.issueTracker)}},methods:{groupedIssueWithFilteredSubissues(e){const t=Wc(this.groupedIssue.issues,e.scope,e.scope_repo_id,e.scope_cloud_id,e.scope_domain_id,e.scope_path,e.single_issue_id);return{...this.groupedIssue,issues:t}},async addTask(){(await this.$modal.show("CreateTicketModal",{issueGroupId:this.groupedIssue.id})).type=="saved"&&this.$emit("requestDataFetch")},async showLinkTaskModal(){(await this.$modal.show("CreateTicketModal",{issueGroupId:this.groupedIssue.id,initialTab:"link"})).type=="saved"&&this.$emit("requestDataFetch")},async onTaskUnlinked(){T.emit("issueUpdated",this.groupedIssue.id),T.emit("taskCreated",{issueGroupId:this.groupedIssue.id}),this.$emit("requestDataFetch"),Toast.success({title:"Task unlinked",description:"We successfully unlinked a task for this issue"})}}},Zc={class:"flex flex-column w-full flex-1 gap-24px"},ed={class:"flex flex-1 flex-column gap-24px relative"},sd={key:0,class:"flex flex-1 align-center justify-center"},td={class:"flex flex-column gap-8px"},od={class:"flex justify-between"},nd={class:"flex align-center gap-8px overflow-hidden"},id={key:0},ad={key:0,class:"flex gap-12px align-center"},rd=h("i",{class:"icon icon-plus"},null,-1);function ud(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseLink"),f=r("AvatarImage"),S=r("BaseBody"),k=r("BaseIcon"),y=r("BaseButton"),v=r("TasksActionMenu"),R=r("SubIssuesSection"),b=r("AccordionContainer");return i(),_("div",Zc,[h("div",ed,[o.tasks.length===0?(i(),_("div",sd,[s.groupedIssue.status=="closed"?(i(),m(l,{key:0,color:o.theme==="light"?"black":"white"},{default:n(()=>[c(" There are no tasks for this issue. ")]),_:1},8,["color"])):(i(),m(l,{key:1,color:o.theme==="light"?"black":"white"},{default:n(()=>[c("There are no tasks yet for this issue. "),a(p,{onClick:o.addTask},{default:n(()=>[c("Create one")]),_:1},8,["onClick"]),o.shouldShowLinkTaskOption?(i(),_(w,{key:0},[c(" or "),a(p,{onClick:o.showLinkTaskModal},{default:n(()=>[c(g(e.$t("LINK_TASK.TEXT",{taskTracker:o.issueTrackerName})),1)]),_:1},8,["onClick"])],64)):I("",!0)]),_:1},8,["color"]))])):(i(),_(w,{key:1},[(i(!0),_(w,null,N(o.sortedTasks,x=>(i(),m(b,{key:x.id,ref_for:!0,ref:`AccordionContainer_${x.id}`,class:A({"opacity-70":x.is_closed})},{header:n(()=>[h("div",td,[a(l,{color:o.theme=="dark"?"white":"",size:"medium",class:"text-break-all"},{default:n(()=>[c(g(x.task_title),1)]),_:2},1032,["color"]),h("div",od,[h("div",nd,[a(f,{class:"size-20 inline-block rounded-10",name:x.task_assignee_name,src:x.task_assignee_avatar_url},null,8,["name","src"]),a(S,{color:o.theme=="dark"?"white":"",size:"small"},{default:n(()=>[c(g(x.task_assignee_name)+" ",1),x.is_sla_task?(i(),_("span",id,"| SLA Ticket ")):I("",!0)]),_:2},1032,["color"])])])]),a(y,{onClick:t[0]||(t[0]=X(()=>{},["stop"])),href:x.task_url,as:"outside-link",target:"_blank",size:"xs",class:"flex align-center min-w-75px ml-auto"},{default:n(()=>[a(k,{icon:o.issueTrackerIcon,color:"white",class:"inline-flex"},null,8,["icon"]),h("span",null,g(x.status),1)]),_:2},1032,["href"]),a(v,{taskId:x.id,onTaskUnlinked:o.onTaskUnlinked},null,8,["taskId","onTaskUnlinked"])]),body:n(()=>[h("div",{class:A({"mb-4px -mx-16px":!s.isDetailPage,"my-16px":s.isDetailPage})},[a(R,{groupedIssue:o.groupedIssueWithFilteredSubissues(x),hideTitle:"",showMoreLinkClass:"ml-16px"},null,8,["groupedIssue"])],2)]),_:2},1032,["class"]))),128)),s.groupedIssue.status!="closed"?(i(),_("div",ad,[a(y,{size:"small",variation:"blue",onClick:o.addTask},{default:n(()=>[rd,c(" Add task")]),_:1},8,["onClick"]),o.shouldShowLinkTaskOption?(i(),_(w,{key:0},[a(l,{color:o.theme=="dark"?"white":""},{default:n(()=>[c(" or ")]),_:1},8,["color"]),a(p,{onClick:o.showLinkTaskModal},{default:n(()=>[c(g(e.$t("LINK_TASK.TEXT",{taskTracker:o.issueTrackerName})),1)]),_:1},8,["onClick"])],64)):I("",!0)])):I("",!0)],64))])])}const ld=C(Qc,[["render",ud]]),cd={components:{BaseParagraph:E,BaseHeading:U,BaseButton:L},computed:{isDetailPage(){return this.$route.name=="groupedIssueDetail"}}},dd={key:0,class:"upgrade-popover-backdrop"},hd=h("i",{class:"icon icon-pro icon-12px"},null,-1);function _d(e,t,s,d,u,o){const l=r("BaseHeading"),p=r("BaseParagraph"),f=r("BaseButton");return i(),_(w,null,[o.isDetailPage?(i(),_("div",dd)):I("",!0),h("div",{class:A(["upgrade-popover",{fullscreen:o.isDetailPage}])},[a(l,{as:"h4",class:"mb-4px"},{default:n(()=>[c("Your account reached the user limit")]),_:1}),a(p,{size:"medium",loose:"",class:"mb-16px"},{default:n(()=>[c(" Please upgrade your account to add more users. ")]),_:1}),a(f,{to:"/settings/account?upgrade=true",as:"link",size:"small"},{default:n(()=>[hd,c(" Upgrade plan ")]),_:1})],2)],64)}const pd=C(cd,[["render",_d]]),gd={emits:["requestOpenEducationSection"],components:{BaseParagraph:E,BaseLink:P,BaseIcon:ae,BasePill:$},props:{groupedIssue:Object},computed:{videoTitles(){const s=this.groupedIssue.issues.filter(u=>u.scw_info).map(u=>u.scw_info).map(u=>u.name);return[...new Set(s)]}}},fd={class:"issue-detail__card readability_big_fonts"},md={class:"issue-detail__card__title-container"},Id=h("span",null,"Education",-1),Sd={class:"issue-detail__card-body"},yd={class:"issue-detail__card-section flex align-center gap-4px"},kd={key:0};function Cd(e,t,s,d,u,o){const l=r("BaseParagraph"),p=r("BaseLink");return i(),_("div",fd,[h("div",md,[a(l,{"semi-bold":"",class:"issue-detail__card__title flex align-center gap-8px"},{default:n(()=>[Id]),_:1})]),h("div",Sd,[h("div",yd,[a(l,{class:"issue-detail__card__paragraph"},{default:n(()=>[a(p,{class:"gap-8px max-w-full paragraph",onClick:t[0]||(t[0]=f=>e.$emit("requestOpenEducationSection"))},{default:n(()=>[c(" Watch video ")]),_:1}),c(" on "+g(o.videoTitles[0])+" ",1),o.videoTitles.length>1?(i(),_("span",kd,"and more")):I("",!0)]),_:1})])])])}const bd=C(gd,[["render",Cd]]),wd="https://cdn.aikido.dev/assets/icons/scw.png",vd={components:{BaseParagraph:E,BaseLink:P,BaseIcon:ae,BasePill:$,BaseCard:Ke,BaseHeading:U},inject:["theme"],props:{groupedIssue:Object,showClosedOnly:{type:Boolean,default:!1},showSnoozedOnly:{type:Boolean,default:!1},showIgnoredOnly:{type:Boolean,default:!1}},computed:{subIssues(){return this.showClosedOnly?this.groupedIssue.issues.filter(e=>e.status==="closed"):this.showSnoozedOnly?this.groupedIssue.issues.filter(e=>e.status==="snoozed"):this.showIgnoredOnly?this.groupedIssue.issues.filter(e=>e.status==="ignored"):this.groupedIssue.issues.filter(e=>e.status==="open")},scwInfoByCwe(){const e={};for(const t of this.subIssues)t.scw_info&&(e[t.scw_info.cwe]=t.scw_info);return e},descriptionColor(){return this.theme=="dark"?"light-gray":"dark-gray"}},methods:{onVideoPlay(){this.$track("educationVideoPlayed")}}},Ed={class:"readability_big_fonts grid gap-24px"},xd={class:"flex gap-8px align-start"},Rd=h("a",{class:"px-4px flex align-center gap-6px",href:"https://www.securecodewarrior.com/",target:"_blank"},[h("img",{src:wd,height:"12"}),c("Powered by SCW ")],-1),Td=h("span",null,"Open course in Secure Code Warrior",-1),Od={class:"w-full text-center"},Ad=["src"];function Nd(e,t,s,d,u,o){const l=r("BasePill"),p=r("BaseIcon"),f=r("BaseLink"),S=r("BaseParagraph"),k=r("BaseCard");return i(),_("div",Ed,[(i(!0),_(w,null,N(o.scwInfoByCwe,(y,v)=>(i(),m(k,{class:"flex flex-column gap-12px",key:v},{title:n(()=>[h("div",xd,[c(g(y.name)+" ",1),a(l,{size:"normal",variation:o.theme=="dark"?"gray-dark":"gray-fill",class:"text--semi text-12px mt-1px wide_mt-2px"},{default:n(()=>[Rd]),_:1},8,["variation"])])]),default:n(()=>[a(S,{color:o.descriptionColor,class:"-mt-16px"},{default:n(()=>[h("div",null,g(y.description),1),y.url?(i(),m(f,{key:0,href:y.url,target:"_blank",class:"gap-8px text-14px max-w-full"},{default:n(()=>[Td,a(p,{icon:"icon-openLink",class:"text--normal ml-4px valign-middle"})]),_:2},1032,["href"])):I("",!0)]),_:2},1032,["color"]),h("div",Od,[(i(!0),_(w,null,N(y.videos,R=>(i(),_("video",{onPlay:t[0]||(t[0]=(...b)=>o.onVideoPlay&&o.onVideoPlay(...b)),class:A(["w-full max-w-680px rounded-4px mt-32px",{"border-1 border-gray-50":o.theme!="dark"}]),controls:""},[h("source",{src:R,type:"video/mp4"},null,8,Ad)],34))),256))])]),_:2},1024))),128))])}const Ld=C(vd,[["render",Nd]]),Bd={emits:["itemSnoozed","groupedIssueLoaded"],components:{IssueScoringExplanationModal:oc,ContestIssueScoringModal:lc,BaseParagraph:E,GaugeChart:Ql,IssueStatus:us,SubIssuesSection:Qe,CveAnalysis:qr,IssueAnalysisSection:Vl,XTabs:tt,NoteTimelineForIssueGroup:qc,TasksForGroupedIssueSection:ld,IssueGroupDetailUpgradePopover:pd,BaseIcon:ae,XTooltip:z,EducationLinkSection:bd,EducationSection:Ld},inject:["theme"],props:{groupedIssueId:{type:[Number,String],required:!0},showClosedOnly:{type:Boolean,default:!1},showSnoozedOnly:{type:Boolean,default:!1},showIgnoredOnly:{type:Boolean,default:!1},isDetailPage:{type:Boolean,default:!1},filterRepoId:{type:Number,default:-1},filterCloudId:{type:Number,default:-1},filterInstanceGroupId:{type:Number,default:-1},filterCloudRepoId:{type:Number,default:-1},filterDomainId:{type:Number,default:-1},singleIssueFilter:{type:Number,default:-1},filterMyTeams:{type:Boolean,default:!1},excludeContainers:{type:Boolean,default:!1},filterOutOfSla:{type:Boolean,default:!1},filterDueSoon:{type:Boolean,default:!1},severityFilter:{type:[String,void 0],default:void 0}},data(){return{groupedIssue:null,noteCount:0,taskCount:0,priorityRanges:[{start:this.$severity.low_min,end:this.$severity.medium_min,colorClass:"text-color-success"},{start:this.$severity.medium_min,end:this.$severity.high_min,colorClass:"text-blue-accent"},{start:this.$severity.high_min,end:this.$severity.critical_min,colorClass:"text-color-primary"},{start:this.$severity.critical_min,end:this.$severity.critical_max,colorClass:"text-color-danger"}],showIssueScoringExplanationModal:!1,showContestIssueScoringModal:!1,issueAnalysisLoaded:!1,tab:this.$route.query.sidebarTab??"overview"}},async mounted(){Promise.all([this.loadNoteCount(),this.loadTaskCount()])},watch:{groupedIssueId:{immediate:!0,handler(){this.loadIssueDetail(),this.loadNoteCount(),this.loadTaskCount()}},singleIssueFilter(){this.filterSubissuesBySingleIssueFilter()},filteredStatusBasedOnFilter(){this.loadIssueDetail(!0)},filterMyTeams(){this.loadIssueDetail()},"$route.query.sidebarTab"(){const e=this.$route.query.sidebarTab||"overview";this.tab!=e&&(this.tab=e)}},created(){T.on("issueUpdated",this.loadIssueDetail),T.on("noteCreated",this.handleNoteCreated),T.on("taskCreated",this.handleTaskCreated),T.on(Ce,this.handleDependencyScanEvent),T.on(be,this.handleCloudScanEvent),!this.$route.query.sidebarTab&&this.$route.query.sidebarIssueTask&&(this.tab="tasks")},unmounted(){T.off("issueUpdated",this.loadIssueDetail),T.off("noteCreated",this.handleNoteCreated),T.off("taskCreated",this.handleTaskCreated),T.off(Ce,this.handleDependencyScanEvent),T.off(be,this.handleCloudScanEvent)},computed:{tabs(){const e=this.noteCount??0,t=this.taskCount??0,s=[{title:"Overview",id:"overview"},{title:e===0?"Notes":`Notes (${e})`,id:"notes"},{title:t===0?"Tasks":`Tasks (${t})`,id:"tasks"}];return this.hasEducationSection&&s.push({title:"Education",id:"education"}),s},npmUrl(){return this.groupedIssue.programming_language=="JS"&&this.groupedIssue.type=="open_source"?`https://www.npmjs.com/package/${this.groupedIssue.package_name}`:null},priority(){return this.groupedIssue.status==="ignored"&&this.groupedIssue.aikido_priority===1?this.groupedIssue.initial_priority:this.groupedIssue.aikido_priority},severity(){return this.$t(De(this.priority)+"_RISK")},lastDetectedAt(){return Z(this.groupedIssue.last_detected_at??this.groupedIssue.timestamp)},firstDetectedAt(){const e=O.fromUnix(this.groupedIssue.timestamp).format(O.SHORT_ISO_FORMAT),t=Z(this.groupedIssue.timestamp);return t.includes("hour")||t.includes("minute")||t.includes("second")?`First detected ${t} ago`:`First detected ${t} ago, on ${e}`},fixedAtDescription(){const e=this.groupedIssue.issues.map(t=>t.closed_timestamp).sort().reverse()[0];return this.$t("ISSUE_GROUP_DETAIL.OPEN_SOURCE.FIXED_AT",{count:this.groupedIssue.issues.filter(t=>t.status==="closed").length,fixedAt:Z(e)})},ignoredAtDescription(){const e=this.groupedIssue.issues.map(t=>t.ignored_at).filter(t=>t).sort().reverse()[0];return this.$t("ISSUE_GROUP_DETAIL.OPEN_SOURCE.IGNORED_AT",{count:this.groupedIssue.issues.filter(t=>t.status==="ignored").length,ignoredAt:Z(e)})},title(){return eo(this.groupedIssue,this.filteredStatus)},issueCount(){return this.groupedIssue.issues.filter(e=>e.status==="open").length},uniqueOpenCveCount(){return this.groupedIssue.type!=="open_source"?0:[...new Set(this.groupedIssue.issues.filter(e=>e.status=="open").map(e=>e.cve_id))].length},filteredStatus(){var e;return(e=this.groupedIssue)!=null&&e.issues.every(t=>t.status==="ignored")?"ignored":this.filteredStatusBasedOnFilter},filteredStatusBasedOnFilter(){return this.showClosedOnly?"closed":this.showSnoozedOnly?"snoozed":this.showIgnoredOnly?"ignored":null},forStatus(){return this.filteredStatus??"open"},labelForType(){switch(this.groupedIssue.type){case"open_source":return"Dependency";case"cloud":return"Misconfiguration";case"leaked_secret":return"Secrets";case"sast":return"SAST";case"surface_monitoring":return"Surface Monitoring";case"malware":return"Malware";case"eol":return"End-of-life runtime";case"scm_security":return"SCM security";case"license":return"License";default:return null}},iconForType(){switch(this.groupedIssue.type){case"open_source":return"icon-box";case"surface_monitoring":return"icon-group";case"cloud":return"icon-cloud";case"leaked_secret":return"icon-secrets";case"sast":return"icon-code";case"malware":return"icon-critical";case"eol":return"icon-eol";case"scm_security":return"icon-git";case"license":return"icon-license";default:return null}},additionalTypeInfoLabel(){if(this.groupedIssue.type!="sast")return null;const e=["sonarqube_sast","sonarqube_iac"],t=this.groupedIssue.issues[0]||{};return e.includes(t.scanner)?"sonarqube":null},repositoryIds(){return this.groupedIssue.issues.map(e=>e.repo_id)},cloudIds(){return this.groupedIssue.issues.map(e=>e.cloud_id)},paragraphColor(){return this.theme==="light"?"black":"light-gray"},titleColor(){return this.theme==="light"?"black":"white"},statusFilteredSubIssues(){return this.groupedIssue.issues.filter(e=>e.status==this.forStatus)},hasEducationSection(){return this.statusFilteredSubIssues.filter(e=>e.scw_info).length>0}},methods:{async loadIssueDetail(e=!1){var t;try{if(this.groupedIssue=await Bs(this.groupedIssueId,this.filterRepoId,this.filterCloudId,this.filterCloudRepoId,this.filterDomainId,-1,this.filterMyTeams,this.excludeContainers,this.filterOutOfSla,this.filterDueSoon,this.filterInstanceGroupId,!0,this.severityFilter,-1,this.filteredStatusBasedOnFilter),this.openCodeAnalysisWhenQueryParamIsSet(),e){if(this.groupedIssue.issues.length==0){T.emit("request-queue-sidebar-close");return}if(this.filteredStatusBasedOnFilter==null&&this.groupedIssue.issues.every(s=>s.status=="closed")){T.emit("request-queue-sidebar-close");return}}}catch(s){const d=((t=s.response.data)==null?void 0:t.reason_phrase)||s.response.statusText;await this.redirectToCorrectGroupOrShowError(d);return}this.filteredStatus&&(this.groupedIssue.status=this.filteredStatus,this.filteredStatus!=="open"&&(this.groupedIssue.enhanced_status=this.filteredStatus)),this.filterSubissuesBySingleIssueFilter(),this.tabs.map(s=>s.id).includes(this.tab)||(this.tab="overview"),this.$emit("groupedIssueLoaded",this.groupedIssue)},filterSubissuesBySingleIssueFilter(){this.groupedIssue.unfilteredIssues||(this.groupedIssue.unfilteredIssues=this.groupedIssue.issues),this.singleIssueFilter>0?this.groupedIssue.issues=this.groupedIssue.unfilteredIssues.filter(e=>e.id===this.singleIssueFilter):this.groupedIssue.issues=this.groupedIssue.unfilteredIssues},async handleDependencyScanEvent(e){const{type:t,repositoryId:s}=e;t==="completed"&&this.repositoryIds.includes(s)!==!1&&await this.loadIssueDetail()},async handleCloudScanEvent(e){const{type:t,cloudId:s}=e;t==="completed"&&this.cloudIds.includes(s)!==!1&&await this.loadIssueDetail()},handleOpenIssueScoringModal(){this.showIssueScoringExplanationModal=!0},handleCloseIssueScoringModal(){this.showIssueScoringExplanationModal=!1},handleDisagreeScoring(){this.showIssueScoringExplanationModal=!1,this.showContestIssueScoringModal=!0},handleCloseContestIssueScoringModal(){this.showContestIssueScoringModal=!1},async loadNoteCount(){const e=await dc(this.groupedIssueId);this.noteCount=e.note_count},async loadTaskCount(){this.taskCount=await Us(this.groupedIssueId,this.filterRepoId,this.filterCloudId,this.filterDomainId)},async handleNoteCreated(e){(!e||e.issueGroupId===this.groupedIssueId)&&await this.loadNoteCount()},async handleTaskCreated(e){(!e||e.issueGroupId===this.groupedIssueId)&&await this.loadTaskCount()},handleTabChanged(){const e=this.tab;if(e==="notes"||e==="tasks"||e==="education"){this.$router.replace({path:this.$route.path,query:{...this.$route.query,sidebarTab:e}});return}if(this.$route.query.sidebarTab){const s={...this.$route.query};delete s.sidebarTab,this.$router.replace({path:this.$route.path,query:{...s}})}},openEducationSection(){this.isDetailPage?this.$emit("requestOpenEducationSection"):this.tab="education"},async redirectToCorrectGroupOrShowError(e){const{group_id:t}=await Ps(this.groupedIssueId);if(t==null){this.$toast.error({title:this.$t("SOMETHING_WENT_WRONG"),description:e});return}if(this.$group.id==t){this.$toast.error({title:this.$t("SOMETHING_WENT_WRONG"),description:e});return}if(this.$route.fullPath=="/queue")return;const d=new URL(window.location);d.searchParams.set("groupId",t),window.location.href=d.toString()},openCodeAnalysisWhenQueryParamIsSet(){var s;const e=((s=this.$route.query)==null?void 0:s.codeAnalysis)??null;!e||!this.groupedIssue.issues.some(d=>d.id==e)||this.$modal.show("CodeAnalysisModal",{issueId:e,groupedIssueId:this.groupedIssue.id})}}},Ud={class:"issue-detail__column"},Pd={class:"issue-detail__card"},Md={class:"issue-detail__card-body"},Dd={class:"flex gap-24px"},Fd={class:"text-center"},Gd=h("i",{class:"icon icon-10px icon-information ml-2px valign-middle"},null,-1),$d=[Gd],zd={class:"flex flex-column gap-16px"},Vd={class:"flex flex-column gap-4px"},jd={key:0},Hd=["href"],qd=h("i",{class:"icon icon-openLink text-12px ml-2px valign-middle opacity-0 group_hover_opacity-100"},null,-1),Wd={key:0},Kd={key:1},Xd={class:"inline-flex gap-8px"},Yd={class:"status-tag carbon-80"},Jd={key:0,class:"status-tag carbon-80"},Qd={key:0},Zd=h("hr",{class:"issue-detail__tabs-separator"},null,-1),eh={key:0,class:"issue-detail__column"},sh={key:1,class:"flex flex-column flex-1"};function th(e,t,s,d,u,o){const l=r("XPreloader"),p=r("GaugeChart"),f=r("BaseParagraph"),S=r("XTooltip"),k=r("IssueStatus"),y=r("BaseIcon"),v=r("XTabs"),R=r("IssueAnalysisSection"),b=r("CveAnalysis"),x=r("EducationLinkSection"),M=r("SubIssuesSection"),ue=r("NoteTimelineForIssueGroup"),ts=r("TasksForGroupedIssueSection"),os=r("EducationSection"),ns=r("IssueScoringExplanationModal"),is=r("ContestIssueScoringModal"),as=r("IssueGroupDetailUpgradePopover");return i(),_("div",null,[u.groupedIssue?(i(),_("div",{key:1,class:A(["text-blue-dark issue-detail",{"issue-detail--theme-light":o.theme==="light","issue-detail--theme-dark":o.theme!=="light","blur pointer-events-none user-select-none":e.$group.limited_access}])},[h("div",Ud,[h("div",Pd,[h("div",Md,[h("div",Dd,[h("div",Fd,[a(p,{data:u.priorityRanges,value:o.priority},null,8,["data","value"]),a(f,{size:"small",color:o.paragraphColor,class:"flex align-center justify-center"},{default:n(()=>[c(g(o.severity)+" ",1),h("button",{class:"unset-all cursor-pointer",onClick:t[0]||(t[0]=(...oe)=>o.handleOpenIssueScoringModal&&o.handleOpenIssueScoringModal(...oe))},$d)]),_:1},8,["color"])]),h("div",zd,[h("div",Vd,[a(f,{"semi-bold":"",color:o.titleColor,size:"medium",class:"issue-detail__card__title flex align-center gap-4px"},{default:n(()=>[o.npmUrl?(i(),_("a",{key:1,href:o.npmUrl,class:"link flex align-center gap-8px link-hover group",target:"_blank"},[h("span",null,g(o.title),1),qd],8,Hd)):(i(),_("span",jd,g(o.title),1))]),_:1},8,["color"]),u.groupedIssue.status==="open"?(i(),m(f,{key:0,color:o.paragraphColor},{default:n(()=>[u.groupedIssue.type==="open_source"?(i(),_("span",Wd,[c(g(e.$t("ISSUE_GROUP_DETAIL.OPEN_SOURCE.LAST_DETECTED_AT",{lastDetectedAt:o.lastDetectedAt,count:o.uniqueOpenCveCount}))+" ",1),a(S,null,{default:n(()=>[h("span",null,g(o.firstDetectedAt),1)]),_:1})])):(i(),_("span",Kd,[c(g(e.$t("ISSUE_GROUP_DETAIL.LAST_DETECTED_AT",{lastDetectedAt:o.lastDetectedAt,count:o.issueCount}))+" ",1),a(S,null,{default:n(()=>[h("span",null,g(o.firstDetectedAt),1)]),_:1})]))]),_:1},8,["color"])):I("",!0),u.groupedIssue.status==="closed"?(i(),m(f,{key:1,color:o.paragraphColor},{default:n(()=>[c(g(o.fixedAtDescription),1)]),_:1},8,["color"])):I("",!0),u.groupedIssue.status==="ignored"?(i(),m(f,{key:2,color:o.paragraphColor},{default:n(()=>[c(g(o.ignoredAtDescription),1)]),_:1},8,["color"])):I("",!0)]),h("div",Xd,[a(k,{groupedIssue:u.groupedIssue},null,8,["groupedIssue"]),h("div",Yd,[c(g(o.labelForType)+" ",1),o.iconForType?(i(),m(y,{key:0,icon:o.iconForType,class:"ml-4px inline-flex",color:"#ffffff",size:"8"},null,8,["icon"])):I("",!0)]),o.additionalTypeInfoLabel?(i(),_("div",Jd,g(o.additionalTypeInfoLabel),1)):I("",!0)])])])])]),s.isDetailPage==!1?(i(),_("div",Qd,[a(v,{tabs:o.tabs,modelValue:u.tab,"onUpdate:modelValue":[t[1]||(t[1]=oe=>u.tab=oe),o.handleTabChanged],spacing:"compact",theme:"dark"},null,8,["tabs","modelValue","onUpdate:modelValue"]),Zd])):I("",!0),u.tab==="overview"?(i(),_(w,{key:1},[a(R,{groupedIssue:u.groupedIssue,isDetailPage:s.isDetailPage,forStatus:o.forStatus,onLoaded:t[2]||(t[2]=oe=>u.issueAnalysisLoaded=!0)},null,8,["groupedIssue","isDetailPage","forStatus"]),s.isDetailPage?(i(),m(b,{key:0,groupedIssue:u.groupedIssue,upperElementsLoaded:u.issueAnalysisLoaded},null,8,["groupedIssue","upperElementsLoaded"])):I("",!0)],64)):I("",!0)]),u.tab==="overview"?(i(),_("div",eh,[o.hasEducationSection&&s.isDetailPage?(i(),m(x,{key:0,groupedIssue:u.groupedIssue,onRequestOpenEducationSection:o.openEducationSection},null,8,["groupedIssue","onRequestOpenEducationSection"])):I("",!0),(i(),m(M,{key:u.groupedIssue.id,groupedIssue:u.groupedIssue,showClosedOnly:s.showClosedOnly,showSnoozedOnly:s.showSnoozedOnly,showIgnoredOnly:s.showIgnoredOnly},null,8,["groupedIssue","showClosedOnly","showSnoozedOnly","showIgnoredOnly"]))])):I("",!0),u.tab==="notes"?(i(),_("div",sh,[a(ue,{"issue-group":u.groupedIssue,class:"-mb-24px"},null,8,["issue-group"])])):I("",!0),u.tab==="tasks"?(i(),m(ts,{key:2,groupedIssue:u.groupedIssue,onRequestDataFetch:o.loadIssueDetail,isDetailPage:!1},null,8,["groupedIssue","onRequestDataFetch"])):I("",!0),u.tab==="education"?(i(),_(w,{key:3},[o.hasEducationSection?(i(),m(os,{key:0,groupedIssue:u.groupedIssue,showClosedOnly:s.showClosedOnly,showSnoozedOnly:s.showSnoozedOnly,showIgnoredOnly:s.showIgnoredOnly},null,8,["groupedIssue","showClosedOnly","showSnoozedOnly","showIgnoredOnly"])):I("",!0)],64)):I("",!0),u.showIssueScoringExplanationModal?(i(),m(ns,{key:4,severity:o.severity,groupedIssue:u.groupedIssue,status:o.forStatus,onClose:o.handleCloseIssueScoringModal,onDisagree:o.handleDisagreeScoring},null,8,["severity","groupedIssue","status","onClose","onDisagree"])):I("",!0),u.showContestIssueScoringModal?(i(),m(is,{key:5,groupedIssue:u.groupedIssue,severity:o.severity,onClose:o.handleCloseContestIssueScoringModal},null,8,["groupedIssue","severity","onClose"])):I("",!0)],2)):(i(),m(l,{key:0,class:"absolute-centered",size:"medium",theme:"transparent"})),u.groupedIssue&&e.$group.limited_access?(i(),m(as,{key:2})):I("",!0)])}const Mh=C(Bd,[["render",th]]),oh={props:{issueGroup:Object,filterRepoId:{type:[Number,String],default:void 0},filterImageId:{type:[Number,String],default:void 0},filterCloudId:{type:[Number,String],default:void 0},filterDomainId:{type:[Number,String],default:void 0},filterInstanceGroupId:{type:[Number,String],default:void 0}},components:{IgnoreGroupedIssueModal:Tt,ActionMenu:re,SnoozeGroupedIssueModal:Ft,SolveIssueModal:Ye,UnsnoozeGroupedIssueModal:Vt,UnignoreIssueGroup:Zt},data(){return{showIgnoreGroupedIssueFlow:!1,showSnoozeGroupedIssueFlow:!1,showUnsnoozeGroupedIssueFlow:!1,showSolveGroupedIssueFlow:!1,showUnignoreGroupedIssueFlow:!1}},mounted(){T.on("requestRescan",this.handleRescanIssue)},beforeUnmount(){T.off("requestRescan",this.handleRescanIssue)},computed:{showReScanAction(){var t;if(((t=this.$group)==null?void 0:t.scm_type)=="selfscan"&&!this.canRescanGroupForSelfScan)return!1;const e=["open_source","cloud","sast","surface_monitoring","eol","scm_security","license"];return!!this.issueGroup&&e.includes(this.issueGroup.type)},canRescanGroupForSelfScan(){return this.issueGroup?["cloud","surface_monitoring","docker_container","cloud_instance"].includes(this.issueGroup.detailed_related_type):!1},actions(){let e=[];return this.issueGroup?((this.issueGroup.type==="leaked_secret"||this.issueGroup.type==="malware")&&(this.issueGroup.status==="closed"?e.push({label:this.$t("ISSUE_ACTION_MENU.UNSOLVE"),onClick:this.handleUnsolveIssueGroup,icon:"icon-unsolve",iconColor:"#141031"}):e.push({label:this.$t("ISSUE_ACTION_MENU.SOLVE"),onClick:this.handleShowSolveGroupedIssueFlow,icon:"icon-tick-circle",iconColor:"green"})),this.showReScanAction&&e.push({label:this.$t("SCAN_AGAIN"),onClick:this.handleRescanIssue,icon:"icon-refresh"}),this.issueGroup.status==="open"&&(e.push({label:this.$t("SNOOZE"),onClick:this.handleShowSnoozeGroupedIssueFlow,icon:"icon-snooze"}),this.issueGroup.type!="license"&&e.push({label:this.$t("IGNORE"),onClick:this.handleShowIgnoreGroupedIssueFlow,icon:"icon-hidden"}),this.$groupUser.can_change_issue_severity==1&&this.issueGroup.type!="license"&&e.push({label:this.$t("ISSUE_ACTION_MENU.ADJUST_SEVERITY"),onClick:this.handleAdjustSeverity,icon:"icon-edit"})),this.issueGroup.status==="snoozed"&&e.push({label:this.$t("UNSNOOZE"),onClick:this.handleShowUnsnoozeGroupedIssueFlow,icon:"icon-notification_inactive"}),this.issueGroup.status==="ignored"&&e.push({label:"Unignore",onClick:this.handleShowUnignoreGroupedIssueFlow,icon:"icon-shield_check"}),this.issueGroup.type==="sast"&&this.$user.is_aikido_support&&e.push({label:"Start traces scan",onClick:this.startTracesScan,icon:"icon-arrow-right",iconColor:"secondary"}),[{title:"Actions",items:e}]):[{title:"Actions"}]}},methods:{handleCloseIgnoreGroupedIssueFlow(){this.showIgnoreGroupedIssueFlow=!1},handleShowIgnoreGroupedIssueFlow(){this.showIgnoreGroupedIssueFlow=!0},handleCloseSnoozeGroupedIssueFlow(){this.showSnoozeGroupedIssueFlow=!1},handleShowSnoozeGroupedIssueFlow(){this.showSnoozeGroupedIssueFlow=!0},handleShowUnsnoozeGroupedIssueFlow(){this.showUnsnoozeGroupedIssueFlow=!0},handleCloseUnsnoozeGroupedIssueFlow(){this.showUnsnoozeGroupedIssueFlow=!1},handleCloseSolveGroupedIssueFlow(){this.showSolveGroupedIssueFlow=!1},handleShowSolveGroupedIssueFlow(){this.showSolveGroupedIssueFlow=!0},handleShowUnignoreGroupedIssueFlow(){this.showUnignoreGroupedIssueFlow=!0},handleCloseUnignoreIssueGroupFlow(){this.showUnignoreGroupedIssueFlow=!1},async handleRescanIssue(){var p;if(ne.hasExpiredFullTrial())return this.$modal.show("UpgradeAccountModal");if(this.issueGroup.type==="scm_security"){await Ms({no_disable_buttons:!0}),this.$toast.success({title:this.$t("NOTIFICATIONS.SCAN_STARTED.TITLE"),description:"Scan started successfully, we'll report back soon."});return}if(this.issueGroup.type==="license"){await at({no_disable_buttons:!0}),this.$toast.success({title:this.$t("NOTIFICATIONS.SCAN_STARTED.TITLE"),description:"Scan started successfully, we'll report back soon."});return}this.startDomainScans();const e=this.startCloudReposScans(),t=this.getUniqueCloudIds(this.issueGroup.issues);await Promise.allSettled(t.map(f=>Ds(f,"scan",{no_disable_buttons:!0})));const s=t.length>0,d=this.issueGroup.issues.every(f=>f.status==="ignored"),u=this.issueGroup.issues.filter(({attack_surface:f,status:S})=>S=="ignored"&&!d?!1:f!=="docker_container");let o=this.getUniqueRepositoryIds(u);((p=this.$group)==null?void 0:p.scm_type)=="selfscan"&&(o=[]);let l=0;for(const f of o)await it({statusCode:404,errMessage:"The provided scm_integration_repo_id does not belong to an active repository"},async()=>{await Fs(f,{no_disable_buttons:!0})},()=>{l++});!e&&!s&&l==o.length||Toast.success({title:this.$t("NOTIFICATIONS.SCAN_STARTED.TITLE"),description:"Scan started successfully, we'll report back soon."})},getUniqueCloudIds(e){return Array.from(new Set(e.filter(t=>t.cloud_id>0).map(t=>t.cloud_id)))},getUniqueCloudRepoIds(e){const t=[];for(const s of e)s.cloud_id>0||s.cloud_repo_id>0&&(t.includes(s.cloud_repo_id)||t.push(s.cloud_repo_id));return t},getUniqueDomainIds(e){return Array.from(new Set(e.filter(t=>t.domain_id>0).map(t=>t.domain_id)))},getUniqueRepositoryIds(e){return Array.from(new Set(e.filter(t=>t.repo_id>0).map(t=>t.repo_id)))},async startCloudReposScans(){const e=this.getUniqueCloudRepoIds(this.issueGroup.issues);return await Promise.allSettled(e.map(t=>Gs({cloud_repo_id:t},{no_disable_buttons:!0}))),e.length>0},async startDomainScans(){const e=this.getUniqueDomainIds(this.issueGroup.issues);await Promise.allSettled(e.map($s))},handleAdjustSeverity(){this.$modal.show("AdjustIssueGroupSeverityModal",{groupedIssue:this.issueGroup,filterRepoId:this.filterRepoId,filterImageId:this.filterImageId,filterCloudId:this.filterCloudId,filterDomainId:this.filterDomainId,filterInstanceGroupId:this.filterInstanceGroupId})},async handleUnsolveIssueGroup(){await Je(this.issueGroup.id)},async startTracesScan(){let e=parseInt(this.filterRepoId??-1,10);e=isNaN(e)?-1:e;const t=this.issueGroup.status==="ignored";await Me(e,-1,this.issueGroup.id,void 0,t),this.$toast.success("Traces scan started")}}};function nh(e,t,s,d,u,o){const l=r("ActionMenu"),p=r("IgnoreGroupedIssueModal"),f=r("SnoozeGroupedIssueModal"),S=r("UnsnoozeGroupedIssueModal"),k=r("SolveIssueModal"),y=r("UnignoreIssueGroup");return i(),_(w,null,[a(l,{sections:o.actions,placement:"bottom-end",useBaseIcon:""},{trigger:n(v=>[F(e.$slots,"trigger",{toggle:v.toggle})]),_:3},8,["sections"]),a(p,{onCancel:o.handleCloseIgnoreGroupedIssueFlow,show:u.showIgnoreGroupedIssueFlow,groupedIssue:s.issueGroup,filterRepoId:s.filterRepoId,filterImageId:s.filterImageId,filterCloudId:s.filterCloudId,filterDomainId:s.filterDomainId,filterInstanceGroupId:s.filterInstanceGroupId},null,8,["onCancel","show","groupedIssue","filterRepoId","filterImageId","filterCloudId","filterDomainId","filterInstanceGroupId"]),u.showSnoozeGroupedIssueFlow?(i(),m(f,{key:0,onSnoozed:o.handleCloseSnoozeGroupedIssueFlow,onCancel:o.handleCloseSnoozeGroupedIssueFlow,groupedIssue:s.issueGroup,filterRepoId:s.filterRepoId,filterImageId:s.filterImageId,filterCloudId:s.filterCloudId,filterDomainId:s.filterDomainId,filterInstanceGroupId:s.filterInstanceGroupId},null,8,["onSnoozed","onCancel","groupedIssue","filterRepoId","filterImageId","filterCloudId","filterDomainId","filterInstanceGroupId"])):I("",!0),u.showUnsnoozeGroupedIssueFlow?(i(),m(S,{key:1,onCancel:o.handleCloseUnsnoozeGroupedIssueFlow,onSubmit:o.handleCloseUnsnoozeGroupedIssueFlow,groupedIssue:s.issueGroup},null,8,["onCancel","onSubmit","groupedIssue"])):I("",!0),u.showSolveGroupedIssueFlow?(i(),m(k,{key:2,onCancel:o.handleCloseSolveGroupedIssueFlow,groupedIssue:s.issueGroup},null,8,["onCancel","groupedIssue"])):I("",!0),u.showUnignoreGroupedIssueFlow?(i(),m(y,{key:3,onCancel:o.handleCloseUnignoreIssueGroupFlow,"issue-group":s.issueGroup},null,8,["onCancel","issue-group"])):I("",!0)],64)}const Dh=C(oh,[["render",nh]]);export{Ld as E,Ql as G,Mh as I,qc as N,Dh as S,ld as T,Zt as U,Tt as a,Ft as b,Ye as c,Vt as d,no as e,eo as f,Ph as g,Uh as h,dc as i,bo as j,Eo as k,hl as l,Ze as r,Je as u};
