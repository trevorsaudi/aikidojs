import{_ as U,au as N,z as y,h0 as C,A as p,r as u,q as c,k as S,w as n,n as o,m as w,o as t,s as f,u as M,p as g}from"./index-13ff96f4.js";import{I as v}from"./InputCheckbox-81cb3ca6.js";const V={components:{BaseConfirmModal:N,InputSwitch:y,InputCheckbox:v},props:{showAutoJoinSetting:{type:Boolean,default:!1}},emits:["close","confirm"],created(){this.setDefaultIssueChangesSettings(),this.setDefaultManageCloudContainerDomainSetting()},data(){return{allowUsersAutoJoin:!this.$featureflags.disable_auto_onboarding,forceNewUserTeamOnly:this.$featureflags.force_new_user_team_only===1,forceNewUserReadOnly:this.$featureflags.force_new_user_read_only===1,canNewUserIssueStatusChange:!1,canNewUserIssueSeverityChange:!1,canNewUserManageClouds:!1,canNewUserManageContainers:!1,canNewUserManageDomains:!1}},computed:{scmTypeCopy(){return this.$t("SCM_TYPE_"+this.$group.scm_type)},description(){let l="";return this.showAutoJoinSetting&&(l=` Allow users to auto-access Aikido through ${this.scmTypeCopy} or require manual invites.`),`Set default rights for new users.${l}`}},methods:{setDefaultIssueChangesSettings(){if(this.$featureflags.force_new_user_read_only===1){this.canNewUserIssueStatusChange=!1,this.canNewUserIssueSeverityChange=!1;return}this.canNewUserIssueStatusChange=this.$featureflags.restrict_new_user_issue_status_change!==1,this.canNewUserIssueSeverityChange=this.$featureflags.restrict_new_user_issue_severity_change!==1},setDefaultManageCloudContainerDomainSetting(){if(this.forceNewUserTeamOnly||this.forceNewUserReadOnly){this.canNewUserManageClouds=!1,this.canNewUserManageContainers=!1,this.canNewUserManageDomains=!1;return}this.canNewUserManageClouds=this.$featureflags.new_users_cant_manage_clouds!==1,this.canNewUserManageContainers=this.$featureflags.new_users_cant_manage_containers!==1,this.canNewUserManageDomains=this.$featureflags.new_users_cant_manage_domains!==1},async saveSettings(){await C({disable_auto_onboarding:!this.allowUsersAutoJoin,force_new_user_team_only:this.forceNewUserTeamOnly,force_new_user_read_only:this.forceNewUserReadOnly,restrict_new_user_issue_status_change:!this.canNewUserIssueStatusChange,restrict_new_user_issue_severity_change:!this.canNewUserIssueSeverityChange,new_users_cant_manage_clouds:!this.canNewUserManageClouds,new_users_cant_manage_containers:!this.canNewUserManageContainers,new_users_cant_manage_domains:!this.canNewUserManageDomains}),this.$toast.success("Successfully updated the users settings"),p.fetchProfile(),this.$emit("confirm")},handleForceNewUserReadOnlyChanged(){this.forceNewUserReadOnly&&(this.canNewUserIssueStatusChange=!1,this.canNewUserIssueSeverityChange=!1,this.canNewUserManageClouds=!1,this.canNewUserManageContainers=!1,this.canNewUserManageDomains=!1)},handleForceNewUserTeamOnlyChanged(){this.forceNewUserTeamOnly&&(this.canNewUserManageClouds=!1,this.canNewUserManageContainers=!1,this.canNewUserManageDomains=!1)}}},b={class:"flex flex-column gap-16px"},x={key:0,class:"flex justify-between w-full py-4px"},O={key:1,class:"divider w-full"},I={class:"mt-12px"},T=o("div",{class:"text-carbon-80 text--normal"},"New users can only view their own team's issues",-1),D=o("div",{class:"text-carbon-80 text--normal"},"New users have read-only rights",-1),A=o("div",{class:"text-carbon-80 text--normal"},"New users can snooze/ignore issues",-1),R=o("div",{class:"text-carbon-80 text--normal"},"New users can change severity",-1),B=o("div",{class:"text-carbon-80 text--normal"},"New users can manage clouds",-1),k=o("div",{class:"text-carbon-80 text--normal"},"New users can manage containers",-1),J=o("div",{class:"text-carbon-80 text--normal"},"New users can manage domains",-1);function F(l,s,d,P,e,i){const m=u("BaseParagraph"),_=u("InputSwitch"),r=u("InputCheckbox"),h=u("BaseConfirmModal");return c(),S(h,{width:600,title:"User Access Settings",description:i.description,buttonSubmitText:"Apply Changes",onSecondaryButtonClicked:s[8]||(s[8]=a=>l.$emit("close")),onClose:s[9]||(s[9]=a=>l.$emit("close")),onSubmit:i.saveSettings},{default:n(()=>[o("div",b,[d.showAutoJoinSetting?(c(),w("div",x,[t(m,{semiBold:""},{default:n(()=>[f("Allow all users to auto-join via "+M(i.scmTypeCopy),1)]),_:1}),t(_,{modelValue:e.allowUsersAutoJoin,"onUpdate:modelValue":s[0]||(s[0]=a=>e.allowUsersAutoJoin=a),name:"usersAutoJoin"},null,8,["modelValue"])])):g("",!0),d.showAutoJoinSetting?(c(),w("hr",O)):g("",!0),o("div",null,[t(m,{semiBold:""},{default:n(()=>[f("Default Rights for New Users")]),_:1}),o("div",I,[t(r,{modelValue:e.forceNewUserTeamOnly,"onUpdate:modelValue":[s[1]||(s[1]=a=>e.forceNewUserTeamOnly=a),i.handleForceNewUserTeamOnlyChanged],name:"forceNewUserTeamOnly"},{default:n(()=>[T]),_:1},8,["modelValue","onUpdate:modelValue"]),t(r,{modelValue:e.forceNewUserReadOnly,"onUpdate:modelValue":[s[2]||(s[2]=a=>e.forceNewUserReadOnly=a),i.handleForceNewUserReadOnlyChanged],name:"forceNewUserReadOnly"},{default:n(()=>[D]),_:1},8,["modelValue","onUpdate:modelValue"]),t(r,{modelValue:e.canNewUserIssueStatusChange,"onUpdate:modelValue":s[3]||(s[3]=a=>e.canNewUserIssueStatusChange=a),disabled:e.forceNewUserReadOnly,name:"canNewUserIssueStatusChange"},{default:n(()=>[A]),_:1},8,["modelValue","disabled"]),t(r,{modelValue:e.canNewUserIssueSeverityChange,"onUpdate:modelValue":s[4]||(s[4]=a=>e.canNewUserIssueSeverityChange=a),disabled:e.forceNewUserReadOnly,name:"canNewUserIssueSeverityChange"},{default:n(()=>[R]),_:1},8,["modelValue","disabled"]),t(r,{modelValue:e.canNewUserManageClouds,"onUpdate:modelValue":s[5]||(s[5]=a=>e.canNewUserManageClouds=a),disabled:e.forceNewUserReadOnly||e.forceNewUserTeamOnly,name:"canNewUserManageClouds"},{default:n(()=>[B]),_:1},8,["modelValue","disabled"]),t(r,{modelValue:e.canNewUserManageContainers,"onUpdate:modelValue":s[6]||(s[6]=a=>e.canNewUserManageContainers=a),disabled:e.forceNewUserReadOnly||e.forceNewUserTeamOnly,name:"canNewUserManageContainers"},{default:n(()=>[k]),_:1},8,["modelValue","disabled"]),t(r,{modelValue:e.canNewUserManageDomains,"onUpdate:modelValue":s[7]||(s[7]=a=>e.canNewUserManageDomains=a),disabled:e.forceNewUserReadOnly||e.forceNewUserTeamOnly,name:"canNewUserManageDomains"},{default:n(()=>[J]),_:1},8,["modelValue","disabled"])])])])]),_:1},8,["description","onSubmit"])}const z=U(V,[["render",F]]);export{z as default};
