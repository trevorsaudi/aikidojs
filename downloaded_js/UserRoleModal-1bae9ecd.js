import{_ as C,f as p,M as y,B as M,N as R,H as b,z as V,fZ as I,r as u,q as O,k as S,w as a,o as s,s as o,n as c,u as v}from"./index-13ff96f4.js";import{I as B}from"./InputCheckbox-81cb3ca6.js";const T={emits:["cancel","submit"],components:{BaseButton:p,BaseModal:y,BaseParagraph:M,BaseSelect:R,BaseHeading:b,InputSwitch:V,InputCheckbox:B},props:{user:Object},data(){return{showModal:!1,selectedRole:"standard",roleOptions:[{title:"Admin: can change all settings and organize teams",id:"admin"},{title:"Default: can view all issues and repositories",id:"standard"},{title:"Team only: can only view issues, repos, clouds,... related to their team",id:"team_only"}],isReadOnly:"0",readOnlyOptions:[{title:"Standard: read and write access to issues",id:"0"},{title:"Read-only: this user cannot ignore, snooze issues",id:"1"}],canSnoozeIgnoreIssues:this.user.can_snooze_issues&&this.user.can_ignore_issues,canManageTeams:this.user.can_manage_teams,canChangeIssueSeverity:this.user.can_change_issue_severity,canManageClouds:this.user.can_manage_clouds,canManageContainers:this.user.can_manage_containers,canManageDomains:this.user.can_manage_domains}},mounted(){this.user.admin&&(this.selectedRole="admin"),this.user.is_team_restricted&&(this.selectedRole="team_only"),this.user.read_only&&(this.isReadOnly="1")},computed:{disableTeamsManagementToggle(){return this.selectedRole=="admin"||this.isReadOnly=="1"||this.selectedRole=="team_only"},disableChangeIssueSeverityToggle(){return this.selectedRole=="admin"||this.isReadOnly=="1"},shouldDisableReadOnlyOption(){return this.selectedRole=="admin"},disabledCloudsManagementToggle(){return this.selectedRole==="admin"||this.selectedRole==="team_only"||this.isReadOnly==="1"},disableContainerManagementToggle(){return this.selectedRole==="admin"||this.isReadOnly==="1"||this.selectedRole==="team_only"},disbaledDomainsManagementToggle(){return this.selectedRole==="admin"||this.selectedRole==="team_only"||this.isReadOnly==="1"},errorMessage(){return this.$group.status!="production"?"You cannot change the role of a user in the free version":""}},methods:{handleCancel(){this.$emit("cancel")},async handleRoleChange(){await I({user_id:this.user.id,role:this.selectedRole,is_read_only:this.isReadOnly,can_snooze_issues:this.canSnoozeIgnoreIssues,can_ignore_issues:this.canSnoozeIgnoreIssues,can_manage_teams:this.canManageTeams,can_change_issue_severity:this.canChangeIssueSeverity,can_manage_clouds:this.canManageClouds,can_manage_containers:this.canManageContainers,can_manage_domains:this.canManageDomains}),this.$toast.success("User role updated"),this.$emit("saved")},changeReadOnlyStatus(r){r=="admin"&&(this.isReadOnly="0",this.canSnoozeIgnoreIssues=!0,this.canManageTeams=!0,this.canChangeIssueSeverity=!0,this.canManageClouds=!0,this.canManageContainers=!0,this.canManageDomains=!0),r=="team_only"&&(this.canManageTeams=!1,this.canManageClouds=!1,this.canManageContainers=!1,this.canManageDomains=!1)},onReadonlyChange(r){r=="1"&&(this.canSnoozeIgnoreIssues=!1,this.canChangeIssueSeverity=!1,this.canManageTeams=!1,this.canManageClouds=!1,this.canManageContainers=!1,this.canManageDomains=!1)}}},x={class:"flex flex-column gap-16px"},z={class:"flex flex-column select-input select-input--theme-light"},D=c("label",{class:"select-input__label"},[c("span",null,"Advanced Rights")],-1),U={class:"flex flex-column gap-8px"};function k(r,n,h,w,e,t){const i=u("BaseParagraph"),_=u("BaseHeading"),m=u("BaseSelect"),d=u("InputCheckbox"),g=u("BaseButton"),f=u("BaseModal");return O(),S(f,{onClose:t.handleCancel,error:t.errorMessage},{header:a(()=>[s(i,{color:"gray"},{default:a(()=>[o("Change user role")]),_:1})]),content:a(()=>[c("div",x,[s(_,{as:"h3"},{default:a(()=>[o(v(h.user.full_name),1)]),_:1}),s(m,{theme:"light",modelValue:e.selectedRole,"onUpdate:modelValue":[n[0]||(n[0]=l=>e.selectedRole=l),t.changeReadOnlyStatus],id:"selectedRole",options:e.roleOptions,label:"User type"},null,8,["modelValue","onUpdate:modelValue","options"]),s(m,{theme:"light",modelValue:e.isReadOnly,"onUpdate:modelValue":[n[1]||(n[1]=l=>e.isReadOnly=l),t.onReadonlyChange],id:"isReadOnly",options:e.readOnlyOptions,disabled:t.shouldDisableReadOnlyOption,label:"Data edit rights"},null,8,["modelValue","onUpdate:modelValue","options","disabled"]),c("div",z,[D,c("div",U,[s(d,{modelValue:e.canSnoozeIgnoreIssues,"onUpdate:modelValue":n[2]||(n[2]=l=>e.canSnoozeIgnoreIssues=l),name:"cansnoozeIgnore",disabled:e.selectedRole=="admin"||e.isReadOnly=="1"},{default:a(()=>[s(i,null,{default:a(()=>[o("Can snooze/ignore issues")]),_:1})]),_:1},8,["modelValue","disabled"]),s(d,{modelValue:e.canChangeIssueSeverity,"onUpdate:modelValue":n[3]||(n[3]=l=>e.canChangeIssueSeverity=l),name:"can_change_issue_severity",disabled:t.disableChangeIssueSeverityToggle},{default:a(()=>[s(i,null,{default:a(()=>[o("Can change issue severity")]),_:1})]),_:1},8,["modelValue","disabled"]),s(d,{modelValue:e.canManageTeams,"onUpdate:modelValue":n[4]||(n[4]=l=>e.canManageTeams=l),name:"can_manage_teams",disabled:t.disableTeamsManagementToggle},{default:a(()=>[s(i,null,{default:a(()=>[o("Can manage teams")]),_:1})]),_:1},8,["modelValue","disabled"]),s(d,{modelValue:e.canManageClouds,"onUpdate:modelValue":n[5]||(n[5]=l=>e.canManageClouds=l),name:"can_manage_clouds",disabled:t.disabledCloudsManagementToggle},{default:a(()=>[s(i,null,{default:a(()=>[o("Can manage clouds")]),_:1})]),_:1},8,["modelValue","disabled"]),s(d,{modelValue:e.canManageContainers,"onUpdate:modelValue":n[6]||(n[6]=l=>e.canManageContainers=l),name:"can_manage_containers",disabled:t.disableContainerManagementToggle},{default:a(()=>[s(i,null,{default:a(()=>[o("Can manage containers")]),_:1})]),_:1},8,["modelValue","disabled"]),s(d,{modelValue:e.canManageDomains,"onUpdate:modelValue":n[7]||(n[7]=l=>e.canManageDomains=l),name:"can_manage_domains",disabled:t.disbaledDomainsManagementToggle},{default:a(()=>[s(i,null,{default:a(()=>[o("Can manage domains")]),_:1})]),_:1},8,["modelValue","disabled"])])])])]),footer:a(()=>[s(g,{onClicked:t.handleCancel,variation:"plain",class:"ml-auto"},{default:a(()=>[o("Cancel")]),_:1},8,["onClicked"]),s(g,{onClicked:t.handleRoleChange},{default:a(()=>[o("Save")]),_:1},8,["onClicked"])]),_:1},8,["onClose","error"])}const P=C(T,[["render",k]]);export{P as default};
