import{_ as v,M as y,B as p,f,H as S,N as _,cF as g,bK as B,fN as C,an as j,r,q as w,k as x,w as e,o as t,s as i,n as E}from"./index-13ff96f4.js";const V={props:{issue:{type:Object}},emits:["close","saved"],components:{BaseModal:y,BaseParagraph:p,BaseButton:f,BaseHeading:S,BaseSelect:_,InputTextArea:g},data(){return{reason:"",reasonError:null,adjustedSeverity:null,adjustedSeverityError:null,isSaving:!1}},computed:{currentSeverity(){return B(this.issue.aikido_priority).toLowerCase()},severityOptions(){return[{id:"critical",title:"Critical",disabled:this.currentSeverity==="critical"},{id:"high",title:"High",disabled:this.currentSeverity==="high"},{id:"medium",title:"Medium",disabled:this.currentSeverity==="medium"},{id:"low",title:"Low",disabled:this.currentSeverity==="low"}]}},methods:{handleClose(){this.$emit("close")},isFormValid(){return!this.reason||this.reason.length===0&&this.reason!==""?this.reasonError="Please provide a reason the severity should be updated":this.reasonError=null,this.adjustedSeverity?this.adjustedSeverityError=null:this.adjustedSeverityError="You must select a new severity",this.adjustedSeverityError===null&&this.reasonError===null},async handleUpdateSeverity(){if(this.reason=this.reason.trim(),!!this.isFormValid()){this.isSaving=!0;try{await C({issueId:this.issue.id,severity:this.adjustedSeverity,reason:this.reason})}finally{j.emit("issueUpdated",{id:this.issue.id}),this.handleClose(),this.isSaving=!1}}}}},b={class:"flex flex-column gap-12px"};function k(N,a,A,M,s,o){const l=r("BaseParagraph"),u=r("BaseHeading"),h=r("BaseSelect"),c=r("InputTextArea"),d=r("BaseButton"),m=r("BaseModal");return w(),x(m,{width:600,onClose:o.handleClose,allowBackgroundClose:!1},{header:e(()=>[t(l,{color:"gray"},{default:e(()=>[i("Adjust issue severity")]),_:1})]),content:e(()=>[E("div",b,[t(u,{as:"h3"},{default:e(()=>[i("Change this issue's severity")]),_:1}),t(l,{size:"medium",loose:""},{default:e(()=>[i(" Do you think the severity of this issue is too high or too low? Adjust it here to manage it. ")]),_:1}),t(h,{class:"flex-1",id:"severity",label:"New severity",modelValue:s.adjustedSeverity,"onUpdate:modelValue":a[0]||(a[0]=n=>s.adjustedSeverity=n),options:o.severityOptions,placeholder:"Select new severity...",error:s.adjustedSeverityError},null,8,["modelValue","options","error"]),t(c,{title:"Reason for adjustment",placeholder:"Explain why you believe this issue's severity should be adjusted...",modelValue:s.reason,"onUpdate:modelValue":a[1]||(a[1]=n=>s.reason=n),rows:"5",required:!1,name:"reason",error:s.reasonError},null,8,["modelValue","error"])])]),footer:e(()=>[t(d,{variation:"plain",onClick:o.handleClose,class:"ml-auto"},{default:e(()=>[i("Cancel")]),_:1},8,["onClick"]),t(d,{onClick:o.handleUpdateSeverity,"is-loading":s.isSaving},{default:e(()=>[i("Confirm")]),_:1},8,["onClick","is-loading"])]),_:1},8,["onClose"])}const I=v(V,[["render",k]]);export{I as default};
