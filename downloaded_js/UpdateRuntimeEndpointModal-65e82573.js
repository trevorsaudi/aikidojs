import{_ as b,g as q,N as k,z as y,H as C,M as R,au as V,B as I,V as z,f as M,gs as L,an as v,r as s,q as d,k as N,w as e,n as p,o as t,s as n,m as r,u as m,p as U}from"./index-13ff96f4.js";import{S as O}from"./SelectRepo-706cbd92.js";import{B as T}from"./BaseCodeBlock-cec75629.js";import{S as E}from"./SlidingButtonGroup-ee0f3352.js";import"./repoName-872812ed.js";function H(){return[{id:(60*1e3).toString(),title:"minute"},{id:(10*60*1e3).toString(),title:"10 minutes"},{id:(30*60*1e3).toString(),title:"30 minutes"},{id:(60*60*1e3).toString(),title:"hour"}]}const P={emits:["close"],components:{BaseLink:q,BaseSelect:k,SlidingButtonGroup:E,InputSwitch:y,BaseCodeBlock:T,BaseHeading:C,BaseModal:R,SelectRepo:O,BaseConfirmModal:V,BaseParagraph:I,InputText:z,BaseButton:M},props:{endpoint:{type:Object,required:!0}},data(){return{submitting:!1,enabled:this.endpoint.rate_limiting?this.endpoint.rate_limiting.enabled:!1,maxRequests:this.endpoint.rate_limiting?this.endpoint.rate_limiting.max_requests:100,windowSizeInMS:this.endpoint.rate_limiting?this.endpoint.rate_limiting.window_size_in_ms:60*1e3,windowOptions:H()}},computed:{hasChanges(){return this.endpoint.rate_limiting?!this.endpoint.rate_limiting.enabled&&!this.enabled?!1:this.enabled!==this.endpoint.rate_limiting.enabled||this.maxRequests!=this.endpoint.rate_limiting.max_requests||this.windowSizeInMS!=this.endpoint.rate_limiting.window_size_in_ms:this.enabled}},methods:{selectWindowSize(u){this.windowSizeInMS=u},async onSubmit(){this.submitting=!0,await L({serviceId:this.endpoint.service_id,method:this.endpoint.method,route:this.endpoint.route,enabled:this.enabled,maxRequests:this.maxRequests,windowSizeInMS:this.windowSizeInMS,graphQLFieldName:this.endpoint.graphql?this.endpoint.graphql.name:void 0,graphQLOperationType:this.endpoint.graphql?this.endpoint.graphql.type:void 0}),this.$toast.success("Updated rate limiting for route. It might take a while to reflect on your instances."),v.emit("runtime.endpoint.updated",this.endpoint),this.$emit("close")}}},Q={class:"flex flex-column gap-12px w-full"},A={key:0},F={key:0},W={key:1},Y={key:1},j={class:"text--capitalize"},D=p("hr",{class:"divider w-full"},null,-1),G={key:0,class:"flex gap-8px align-center"};function J(u,i,o,K,a,h){const g=s("BaseHeading"),f=s("BaseLink"),c=s("BaseParagraph"),w=s("InputSwitch"),B=s("InputText"),S=s("BaseSelect"),_=s("BaseButton"),x=s("BaseModal");return d(),N(x,{width:800,onClose:i[3]||(i[3]=l=>this.$emit("close")),allowBackgroundClose:!1},{header:e(()=>[p("div",Q,[t(g,{as:"h3"},{default:e(()=>[n(" Rate Limiting For "),o.endpoint.graphql?(d(),r("strong",Y,[n(m(o.endpoint.route)+" · "+m(o.endpoint.graphql.name)+" · ",1),p("span",j,m(o.endpoint.graphql.type),1)])):(d(),r("strong",A,[o.endpoint.method==="*"?(d(),r("span",F,"ANY")):(d(),r("span",W,m(o.endpoint.method),1)),n(" "+m(o.endpoint.route),1)]))]),_:1}),t(c,null,{default:e(()=>[n(" Learn more about rate limiting and interactions with load balancers and proxies "),t(f,{href:"https://help.aikido.dev/doc/proxy-settings/docLY8sBN83Q",rel:"noopener noreferrer"},{default:e(()=>[n("here")]),_:1}),n(". ")]),_:1})])]),content:e(()=>[D,t(w,{modelValue:a.enabled,"onUpdate:modelValue":i[0]||(i[0]=l=>a.enabled=l),name:"enableRateLimiting","label-right":"Enable Rate Limiting"},null,8,["modelValue"]),a.enabled?(d(),r("div",G,[t(B,{modelValue:a.maxRequests,"onUpdate:modelValue":i[1]||(i[1]=l=>a.maxRequests=l),inputClass:"max-w-80px",type:"number",name:"maxRequests",id:"maxRequests"},null,8,["modelValue"]),t(c,{for:"maxRequests"},{default:e(()=>[n("requests per")]),_:1}),t(S,{options:a.windowOptions,modelValue:a.windowSizeInMS,"onUpdate:modelValue":h.selectWindowSize},null,8,["options","modelValue","onUpdate:modelValue"])])):U("",!0)]),footer:e(()=>[t(_,{onClicked:i[2]||(i[2]=l=>this.$emit("close")),variation:"tertiary",class:"ml-auto"},{default:e(()=>[n("Cancel")]),_:1}),t(_,{onClicked:h.onSubmit,disabled:this.submitting||!this.hasChanges},{default:e(()=>[n("Apply Changes")]),_:1},8,["onClicked","disabled"])]),_:1})}const ne=b(P,[["render",J]]);export{ne as default};
