import{_ as m,cr as F,r,q as I,k as g,w as h,o as s,s as E,u as k,S as C,n as p,I as w,cq as c,an as o,cs as Q,cu as U,m as L,F as A}from"./index-13ff96f4.js";import{Q as O}from"./QueueTable-de6aabd1.js";import{Q as v}from"./QueueSidebar-47492277.js";import{F as q}from"./FilterButton-bb5393a7.js";import{A as b}from"./ActionMenu-3e4470bf.js";import{F as R}from"./FeedActionsMenu-6d8ea3a2.js";import{Q as G}from"./QueueQuickFilter-70881bd4.js";import"./dateFns-a344cb79.js";import"./index-b87db690.js";import"./DataTableCell-51c0104f.js";import"./IssueGroupSeverityColumn-7631c77a.js";import"./SidebarActionMenu-1bf6804b.js";import"./CreateAutoFixProgressFlow-8111d22c.js";import"./RadioButtonList-1d4cdaad.js";import"./EnableIntegrationModal-48b01f56.js";import"./focusModePreference-150f170e.js";import"./TableListHeader-e50d01d1.js";import"./DataTable-e31a825a.js";import"./BaseRadioInput-a7ac3557.js";import"./BaseLabel-a1c0ca00.js";import"./AIText-891d4f7b.js";import"./InputCheckbox-81cb3ca6.js";import"./BreakSlashes-925eef0e.js";import"./UnignoreIssue-5dff8957.js";import"./CreateTicketModal-c14deeb1.js";import"./ManualInputSearchDropdown-6a7ece3e.js";import"./InputSearchDropdown-02988f6b.js";import"./repoName-872812ed.js";import"./taskTrackerNaming-55adac3e.js";import"./taskTrackerIcon-504ea566.js";import"./autofixable-c6560249.js";import"./autofixSastIssues-779ec5b4.js";import"./lock-files-cdbb050f.js";import"./BaseCodeBlock-cec75629.js";import"./string-814c5ffd.js";import"./ButtonMultiOption-12e505fb.js";import"./transform-c376ec3f.js";import"./linear-efb37b7f.js";import"./arc-12e4470a.js";import"./BaseForm-4c6fa06f.js";import"./XTabs-d492da26.js";import"./BaseCard-471d3203.js";import"./AccordionContainer-09dc0ed4.js";import"./trycatch-83445d5b.js";import"./licenses-6ab38515.js";import"./BaseStatusLabel-0ccd2806.js";import"./DataTableSeverityIndicator-48ffb8dc.js";import"./IssueGroupTypeColumn-03f014b0.js";import"./BracesIcon-0a8568f4.js";import"./BoxIcon-9908469f.js";import"./StackedAvatars-4925baeb.js";import"./InputMultiSelect-21584437.js";import"./DateRangePicker-89d26e9f.js";import"./export-427c6d83.js";import"./languages-12749071.js";const x={props:{initialRelatedTypeFilter:String},components:{ActionMenu:b,FilterButton:q},data(){return{relatedTypeFilter:this.initialRelatedTypeFilter}},emits:["filterSelected"],computed:{label(){return this.relatedTypeFilter?this.$t("QUEUE.QUICK_FILTER.LABEL",{filter:this.$t(`QUEUE.FILTER.LABEL_SHORTHAND.${this.relatedTypeFilter}`)}):"All types"},actions(){return[{title:this.$t("QUEUE.TYPE_FILTER.TITLE"),action:{label:"Clear filter",onClick:()=>this.handleClearFilter()},items:[{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.CLOUD_CONFIG_ISSUES"),onClick:()=>this.handleToggleTypeFilter("cloud"),icon:"icon-cloud",active:this.isActive("cloud")},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.SURFACE_MONITORING_ISSUES"),onClick:()=>this.handleToggleTypeFilter("surface_monitoring"),icon:"icon-group",active:this.isActive("surface_monitoring")},{label:this.$t("QUEUE.TYPE_FILTER.ACTIONS.EOL_ISSUES"),onClick:()=>this.handleToggleTypeFilter("eol"),icon:"icon-eol",active:this.isActive("eol")},{label:this.$t("QUEUE.QUICK_FILTER.ACTIONS.DOCKER"),onClick:()=>this.handleToggleTypeFilter("docker_container"),icon:"icon-docker",active:this.isActive("docker_container")}]}]},hasFilter(){return!!this.relatedTypeFilter}},methods:{isActive(e){return this.relatedTypeFilter===e},handleClearFilter(){this.relatedTypeFilter=void 0,this.emitSelectedFilter()},handleToggleTypeFilter(e){this.relatedTypeFilter===e?this.relatedTypeFilter=void 0:this.relatedTypeFilter=e,this.emitSelectedFilter()},emitSelectedFilter(){this.$emit("filterSelected",{relatedType:this.relatedTypeFilter}),F({relatedTypeFilter:this.relatedTypeFilter})}}},N=p("i",{class:"icon icon-caret_down icon-12px"},null,-1);function B(e,l,a,f,t,i){const n=r("FilterButton"),u=r("ActionMenu");return I(),g(u,{sections:i.actions,placement:"bottom-start",useBaseIcon:!0},{trigger:h(d=>[s(n,{onClick:d.toggle,class:C({"filter-button--active":i.hasFilter})},{default:h(()=>[E(k(i.label)+" ",1),N]),_:2},1032,["onClick","class"])]),_:1},8,["sections"])}const P=m(x,[["render",B]]),V={components:{QueueTable:O,QueueSidebar:v,InputSearch:w,CloudIssuesOverviewTypeFilter:P,FeedActionsMenu:R,QueueQuickFilter:G},props:{cloud:{type:Object,default:null}},data(){return{groupedIssues:[],isLoading:!0,showLoadingState:!0,searchTerm:c("search",""),relatedTypeFilter:c("type_filter",void 0),quickFilter:c("filter",void 0)}},emits:["issuesLoaded"],async mounted(){await Promise.all([this.loadGroupedIssues()]),this.showLoadingState=!1},created(){o.on("issueUpdated",this.handleIssueUpdated),o.on("cloudScanFinished",this.loadGroupedIssues),o.on("cloudImageUpdated",this.loadGroupedIssues)},beforeUnmount(){o.off("issueUpdated",this.handleIssueUpdated),o.off("cloudScanFinished",this.loadGroupedIssues),o.on("cloudImageUpdated",this.loadGroupedIssues)},computed:{cloudId(){return this.$route.params.id},showEmptyState(){return this.showLoadingState?!1:this.groupedIssues.length==0},hasActiveFilter(){return!!(this.searchTerm||this.relatedTypeFilter)}},watch:{async cloudId(){this.cloudId&&(this.showLoadingState=!0,await Promise.all([this.loadGroupedIssues()]),this.showLoadingState=!1)}},methods:{async onItemSelected(e){Q.replace({path:this.$route.path,query:{...this.$route.query,sidebarIssue:e.id}})},onSearchTermChanged(){this.loadGroupedIssues(),F({search:this.searchTerm})},async handleIssueUpdated(){await this.loadGroupedIssues()},async loadGroupedIssues(){this.showLoadingState=!0,this.isLoading=!0;try{const e=await U({filter_cloud_id:parseInt(this.cloudId),search_term:this.searchTerm,issue_type_filter:this.relatedTypeFilter,quick_filter:this.quickFilter});this.groupedIssues=this.enhanceStatus(e),this.$emit("issuesLoaded",this.groupedIssues)}finally{this.showLoadingState=!1,this.isLoading=!1}},async handleSelectRelatedTypeFilter(e){this.relatedTypeFilter=e.relatedType,await this.loadGroupedIssues()},async onQueueQuickFilterSelected(e){this.quickFilter=e.quickFilter,await this.loadGroupedIssues()},enhanceStatus(e){return["ignored","closed"].includes(this.quickFilter)?e.map(a=>({...a,enhanced_status:this.quickFilter})):e}}},M={class:"flex align-center justify-between gap-16px mb-16px"},D={class:"flex align-center gap-12px"};function Y(e,l,a,f,t,i){const n=r("InputSearch"),u=r("CloudIssuesOverviewTypeFilter"),d=r("QueueQuickFilter"),T=r("FeedActionsMenu"),_=r("QueueTable"),S=r("QueueSidebar");return I(),L(A,null,[p("div",M,[p("div",D,[s(n,{modelValue:t.searchTerm,"onUpdate:modelValue":[l[0]||(l[0]=y=>t.searchTerm=y),i.onSearchTermChanged],spacing:"compact"},null,8,["modelValue","onUpdate:modelValue"]),s(u,{onFilterSelected:i.handleSelectRelatedTypeFilter,persistFilterToQueryParams:!0,"initial-related-type-filter":t.relatedTypeFilter},null,8,["onFilterSelected","initial-related-type-filter"]),s(d,{onFilterSelected:i.onQueueQuickFilterSelected,hideCriticalOption:!0,hideNewOption:!0,hideLanguageFilter:!0,hideAttackSurfaceFilters:!0,"initial-filter":t.quickFilter,persistFilterToQueryParams:!0},null,8,["onFilterSelected","initial-filter"])]),s(T,{cloud:a.cloud,onRefresh:i.loadGroupedIssues},null,8,["cloud","onRefresh"])]),s(_,{onItemClicked:i.onItemSelected,groupedIssues:t.groupedIssues,isLoading:t.showLoadingState,filterCloudId:parseInt(i.cloudId),showEmptyState:i.showEmptyState,hasActiveFilter:i.hasActiveFilter,quickFilter:t.quickFilter},null,8,["onItemClicked","groupedIssues","isLoading","filterCloudId","showEmptyState","hasActiveFilter","quickFilter"]),s(S,{groupedIssues:t.groupedIssues,filterCloudId:parseInt(i.cloudId),showClosedOnly:t.quickFilter=="closed",showIgnoredOnly:t.quickFilter==="ignored",filterOutOfSla:t.quickFilter==="out_of_sla",filterDueSoon:t.quickFilter==="due_soon"},null,8,["groupedIssues","filterCloudId","showClosedOnly","showIgnoredOnly","filterOutOfSla","filterDueSoon"])],64)}const je=m(V,[["render",Y]]);export{je as default};
