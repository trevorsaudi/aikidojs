import{_ as C,M as w,B as y,al as B,g as x,a3 as p,gO as L,r as a,q as t,k as o,w as s,o as l,m as d,u as _,p as n,s as r}from"./index-13ff96f4.js";import{S as T}from"./ScreenshotImageCarousel-ff4bf56f.js";const I={props:{domainId:[Number,String],kind:String},components:{BaseModal:w,ScreenshotImageCarousel:T,BaseParagraph:y,LoadingSpinner:B,BaseLink:x},data(){return{isLoadingScreenshots:!0,rawTimestamp:null,latestHttpStatusCode:0,files:[]}},async mounted(){await this.fetchLatestScreenshots(),this.isLoadingScreenshots=!1},computed:{timestamp(){return!this.rawTimestamp||!this.hasScreenshots?null:p.fromUnix(this.rawTimestamp).format(p.US_FRIENDLY_DATE_WITH_TIME)},hasScreenshots(){return this.isLoadingScreenshots?!0:this.files.length>0},httpStatusCode(){return this.latestHttpStatusCode<=0?null:this.latestHttpStatusCode},showBlockedByFirewallMessage(){return this.kind==="verify_domain_access"&&this.latestHttpStatusCode==403}},methods:{handleClose(){this.$emit("close")},async fetchLatestScreenshots(){const{screenshots:i,timestamp:h,latest_http_status_code:u}=await L(this.domainId,this.kind);this.files=i,this.rawTimestamp=h,this.latestHttpStatusCode=u}}},b={key:0},M={key:1},D={key:0,class:"text-center p-8px rounded-4px bg-gray-25 min-h-110px relative"};function H(i,h,u,v,m,e){const c=a("BaseParagraph"),f=a("LoadingSpinner"),g=a("ScreenshotImageCarousel"),S=a("BaseLink"),k=a("BaseModal");return t(),o(k,{width:900,onClose:e.handleClose,canClose:!0},{header:s(()=>[l(c,{color:"gray"},{default:s(()=>[e.timestamp?(t(),d("span",b,"Taken on "+_(e.timestamp),1)):n("",!0),e.httpStatusCode?(t(),d("span",M," - HTTP Status Code "+_(e.httpStatusCode),1)):n("",!0)]),_:1})]),content:s(()=>[m.isLoadingScreenshots?(t(),d("div",D,[l(f,{color:"#645dd7","background-color":"#d0cdff",width:24,height:24,class:"z-index-1 absolute-centered"})])):n("",!0),e.hasScreenshots?(t(),o(g,{key:1,files:m.files},null,8,["files"])):(t(),o(c,{key:2,class:"text-center py-16px"},{default:s(()=>[r("There are no screenshots yet for this domain")]),_:1})),e.showBlockedByFirewallMessage?(t(),o(c,{key:3,class:"text-center"},{default:s(()=>[r(" Your firewall might be blocking Aikido. Check "),l(S,{target:"_blank",inline:"",href:"https://help.aikido.dev/doc/allowing-ip-addresses-for-dast--surface-monitoring/docyIavlFiD3"},{default:s(()=>[r("this article")]),_:1}),r(" on how to allow Aikido to bypass your firewall ")]),_:1})):n("",!0)]),_:1},8,["onClose"])}const F=C(I,[["render",H]]);export{F as default};
