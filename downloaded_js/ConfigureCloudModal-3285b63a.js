import{_ as U,M as O,B as E,f as A,V as B,N as D,a1 as I,H as S,bD as w,bE as N,an as P,ad as v,r as i,q as m,k as g,w as o,o as t,s as u,u as c,n as r,m as h,p as C,F as y}from"./index-13ff96f4.js";import{S as V}from"./SelectTeam-d51b76ec.js";import"./StackedAvatars-4925baeb.js";const M={props:{show:Boolean,cloud:Object},components:{BaseModal:O,BaseParagraph:E,BaseButton:A,InputText:B,BaseSelect:D,LoadingSkeleton:I,BaseHeading:S,SelectTeam:V},emits:["close","delete"],data(){return{name:void 0,awsArn:void 0,accountPurpose:void 0,isSaving:!1,isLoading:!0,linkedTeams:[],teams:[]}},async mounted(){await Promise.allSettled([this.loadCloudIntegrationDetails(),this.loadTeams()]),this.isLoading=!1},computed:{accountPurposeOptions(){return[{id:"production",title:"Production"},{id:"staging",title:"Staging"},{id:"development",title:"Development"},{id:"mixed",title:"Mixed"}]},isValid(){return!(this.name.trim()==""||this.accountPurpose.trim()=="")},isAwsCloud(){return this.cloud.type==="aws"}},methods:{async loadCloudIntegrationDetails(){const e=await w(this.cloud.id);this.name=e.name,this.accountPurpose=e.account_purpose,this.awsArn=e.aws_role_arn,this.linkedTeams=e.linked_teams},handleCancel(){this.arn=void 0,this.isSaving=!1,this.$emit("close")},async handleConfirm(){this.isSaving=!0,await N({cloud_id:this.cloud.id,account_purpose:this.accountPurpose,name:this.name,linked_teams:this.linkedTeams.map(e=>e.id)}),this.isSaving=!1,Toast.success({title:this.$t("NOTIFICATIONS.CLOUD_UPDATED.TITLE"),description:this.$t("SUCCESSFULLY_EDITED_INTEGRATION")}),P.emit("cloudEdited"),this.$emit("close")},async loadTeams(){this.teams=await v()},handleLinkTeam(e){this.linkedTeams=[...this.linkedTeams,e]},handleUnlinkTeam(e){this.linkedTeams=this.linkedTeams.filter(a=>a.id!=e)}}},R={class:"flex flex-column gap-24px"},F={key:0,class:"flex flex-column gap-24px"},b={class:"flex flex-column gap-4px"},G={class:"flex flex-column gap-4px"},H={key:0,class:"flex flex-column gap-4px"},j={class:"flex flex-column gap-12px"},q={class:"flex align-center gap-16px ml-auto"};function z(e,a,Y,$,n,l){const _=i("BaseParagraph"),s=i("LoadingSkeleton"),T=i("BaseHeading"),L=i("SelectTeam"),f=i("InputText"),k=i("BaseSelect"),p=i("BaseButton"),x=i("BaseModal");return m(),g(x,{width:484,onClose:l.handleCancel},{header:o(()=>[t(_,{color:"gray"},{default:o(()=>[u(c(e.$t("CONFGIURE_CLOUD_MODAL.TITLE")),1)]),_:1})]),content:o(()=>[r("div",R,[n.isLoading?(m(),h("div",F,[r("div",null,[t(s,{width:"100px",height:"16px"}),t(s,{height:"30px"})]),r("div",b,[t(s,{width:"100px",height:"16px"}),t(s,{height:"30px"})]),r("div",G,[t(s,{width:"100px",height:"16px"}),t(s,{width:"200px"}),t(s,{height:"30px"})]),l.isAwsCloud?(m(),h("div",H,[t(s,{width:"100px",height:"16px"}),t(s,{height:"30px"})])):C("",!0)])):(m(),h(y,{key:1},[r("div",j,[t(T,{as:"h3"},{default:o(()=>[u("Letâ€™s configure your cloud")]),_:1}),t(_,{size:"medium",loose:""},{default:o(()=>[u("Aikido needs a little more information to give you results that are informed by context and tailored for your workspace.")]),_:1})]),t(L,{onLinkTeam:l.handleLinkTeam,onUnlinkTeam:l.handleUnlinkTeam,"linked-teams":n.linkedTeams,teams:n.teams,linkType:"cloud"},null,8,["onLinkTeam","onUnlinkTeam","linked-teams","teams"]),t(f,{placeholder:"Cloud name",modelValue:n.name,"onUpdate:modelValue":a[0]||(a[0]=d=>n.name=d),name:"cloud-name",title:e.$t("CONFGIURE_CLOUD_MODAL.INPUT.NAME.LABEL")},null,8,["modelValue","title"]),t(k,{modelValue:n.accountPurpose,"onUpdate:modelValue":a[1]||(a[1]=d=>n.accountPurpose=d),id:"accountPurpose",label:e.$t("CONFGIURE_CLOUD_MODAL.INPUT.PURPOSE.LABEL"),sublabel:e.$t("CONFGIURE_CLOUD_MODAL.INPUT.PURPOSE.LABEL.SUB"),options:l.accountPurposeOptions},null,8,["modelValue","label","sublabel","options"]),l.isAwsCloud?(m(),g(f,{key:0,placeholder:"Aikido Role Arn",modelValue:n.awsArn,"onUpdate:modelValue":a[2]||(a[2]=d=>n.awsArn=d),disabled:!0,name:"aws-arn",title:e.$t("CONFGIURE_CLOUD_MODAL.INPUT.ARN.LABEL"),class:"truncate"},null,8,["modelValue","title"])):C("",!0)],64))])]),footer:o(()=>[t(p,{variation:"destructive",onClick:a[3]||(a[3]=d=>e.$emit("delete"))},{default:o(()=>[u(c(e.$t("CONFGIURE_CLOUD_MODAL.DELETE")),1)]),_:1}),r("div",q,[t(p,{onClicked:l.handleCancel,variation:"plain"},{default:o(()=>[u(c(e.$t("CONFGIURE_CLOUD_MODAL.CANCEL")),1)]),_:1},8,["onClicked"]),t(p,{onClicked:l.handleConfirm},{default:o(()=>[u(c(e.$t("CONFGIURE_CLOUD_MODAL.SAVE")),1)]),_:1},8,["onClicked"])])]),_:1},8,["onClose"])}const W=U(M,[["render",z]]);export{W as default};
