import{j as x}from"./reports-ed4978a9.js";import{P as A}from"./PageHeader-46c38a32.js";import{_ as B,H as F,X as D,dv as M,B as I,aV as L,r as e,m as n,o as t,w as o,n as i,k as p,F as _,t as H,p as T,q as a,s as l,S as N,u as h}from"./index-13ff96f4.js";import{A as O}from"./ActionMenu-3e4470bf.js";import{F as R}from"./FilterButton-bb5393a7.js";import{C as q}from"./ComplianceSection-1226ea47.js";import{C as z}from"./CompliancePrintHeader-341b18be.js";import{P as V}from"./PdfDownloadButton-072addbd.js";import"./AccordionContainer-09dc0ed4.js";import"./DataTable-e31a825a.js";import"./DataTableCell-51c0104f.js";import"./BracesIcon-0a8568f4.js";const X={components:{PageHeader:A,BaseHeading:F,XPreloader:D,ProgressBar:M,ComplianceSection:q,CompliancePrintHeader:z,ActionMenu:O,FilterButton:R,BaseParagraph:I,PdfDownloadButton:V},data(){return{isLoading:!0,overview:{},groupReference:void 0,mode:void 0}},provide(){return{filter_team_id:L(()=>this.$teamContext)}},async mounted(){await Promise.allSettled([this.loadComplianceOverview()])},watch:{async $teamContext(){this.$globalLoadingIndicator.show();try{await this.loadComplianceOverview()}finally{this.$globalLoadingIndicator.hide()}}},computed:{breadcrumbs(){return[{label:"Reports",href:"/reports"},{label:"PCI compliance"}]},compliance(){const s=this.overview.total_complying_rule_count??0,u=this.overview.total_rule_count??0;return s===0||this.isLoading?0:Math.round(s/u*100)},sections(){return this.mode?this.overview[this.mode]??{}:{...this.overview.network_security_control_measures_result??{},...this.overview.protect_stored_account_data_measures_result??{},...this.overview.protect_data_during_transmission_measures_result??{},...this.overview.protect_from_malware_measures_result??{},...this.overview.develop_and_maintain_secure_software_measures_result??{},...this.overview.restrict_access_to_system_components_measures_result??{},...this.overview.identify_users_and_authenticate_access_measures_result??{},...this.overview.log_and_monitor_access_to_system_measures_result??{},...this.overview.test_security_of_systems_measures_result??{}}},filterLabel(){return this.mode?this.mode==="network_security_control_measures_result"?"Network Security Controls":this.mode==="protect_stored_account_data_measures_result"?"Protect Stored Account Data":this.mode==="protect_data_during_transmission_measures_result"?"Protect Data During Transmission":this.mode==="protect_from_malware_measures_result"?"Protect Against Malware":this.mode==="develop_and_maintain_secure_software_measures_result"?"Develop And Maintain Secure Software Systems":this.mode==="restrict_access_to_system_components_measures_result"?"Restrict Access To System Components":this.mode==="identify_users_and_authenticate_access_measures_result"?"Identify Users and Authenticate Access":this.mode==="log_and_monitor_access_to_system_measures_result"?"Log and Monitor Access to Systems":this.mode==="test_security_of_systems_measures_result"?"Test Security of Systems and Networks":this.mode==="support_sec_security_with_org_policies"?"Support Security with Organizational Policies and Programs":"Filter controls":"Filter controls"},actions(){return[{title:"Controls",action:{label:"Clear filter",onClick:()=>this.mode=void 0},items:[{label:"1. Install and Maintain Network Security Controls",onClick:()=>this.handleChangeFilter("network_security_control_measures_result"),active:this.mode==="network_security_control_measures_result"},{label:"3. Protect Stored Account Data",onClick:()=>this.handleChangeFilter("protect_stored_account_data_measures_result"),active:this.mode==="protect_stored_account_data_measures_result"},{label:"4. Protect Account Data with Strong Cryptography During Transmission",onClick:()=>this.handleChangeFilter("protect_data_during_transmission_measures_result"),active:this.mode==="protect_data_during_transmission_measures_result"},{label:"5. Protect All Systems and Networks from Malicious Software",onClick:()=>this.handleChangeFilter("protect_from_malware_measures_result"),active:this.mode==="protect_from_malware_measures_result"},{label:"6. Develop and Maintain Secure Systems and Software",onClick:()=>this.handleChangeFilter("develop_and_maintain_secure_software_measures_result"),active:this.mode==="develop_and_maintain_secure_software_measures_result"},{label:"7. Access to system components and data is appropriately defined and assigned",onClick:()=>this.handleChangeFilter("restrict_access_to_system_components_measures_result"),active:this.mode==="restrict_access_to_system_components_measures_result"},{label:"8. Identify Users and Authenticate Access to System Components",onClick:()=>this.handleChangeFilter("identify_users_and_authenticate_access_measures_result"),active:this.mode==="identify_users_and_authenticate_access_measures_result"},{label:"9. Restrict Physical Access to Cardholder Data",onClick:()=>this.handleChangeFilter("restrict_physical_access_to_data"),active:this.mode==="restrict_physical_access_to_data"},{label:"10. Log and Monitor All Access to System Components",onClick:()=>this.handleChangeFilter("log_and_monitor_access_to_system_measures_result"),active:this.mode==="log_and_monitor_access_to_system_measures_result"},{label:"11. Test Security of Systems and Networks Regularly",onClick:()=>this.handleChangeFilter("test_security_of_systems_measures_result"),active:this.mode==="test_security_of_systems_measures_result"},{label:"12. Support Information Security with Organizational Policies and Programs",onClick:()=>this.handleChangeFilter("support_sec_security_with_org_policies"),active:this.mode==="support_sec_security_with_org_policies"}]}]},emptyControlsMessage(){if(this.mode==="restrict_physical_access_to_data")return"PCI Data Security Standards requires that physical security is monitored. This related to security of offices, data centers, the secure disposal of equipment. These requirements are external to the scope of Aikido.";if(this.mode==="support_sec_security_with_org_policies")return"PCI Data Security Standards requires that organizations have a strong, proactive approach to maintaining information security across the entire organization. These requirements are external to the scope of Aikido."}},methods:{async loadComplianceOverview(){this.overview=await x({teamId:null}),this.isLoading=!1},handleChangeFilter(s){if(this.mode===s){this.mode=void 0;return}this.mode=s}}},U={class:"flex gap-32px align-center"},j={class:"page-content"},E={class:"mb-16px flex align-center gap-12px"},W=i("i",{class:"icon icon-caret_down icon-12px"},null,-1),G={class:"flex flex-column gap-12px",id:"ComplianceSectionWrapper"},J={key:0,class:"flex rounded-8px py-32px px-16px bg-white border-1 border-carbon-20"};function K(s,u,Q,Y,m,r){const f=e("BaseHeading"),g=e("ProgressBar"),y=e("PdfDownloadButton"),v=e("PageHeader"),C=e("XPreloader"),w=e("FilterButton"),P=e("ActionMenu"),b=e("CompliancePrintHeader"),S=e("ComplianceSection"),k=e("BaseParagraph");return a(),n(_,null,[t(v,{breadcrumbs:r.breadcrumbs},{title:o(()=>[i("div",U,[t(f,{as:"h1"},{default:o(()=>[l("PCI compliance overview")]),_:1}),t(g,{progress:r.compliance},null,8,["progress"])])]),rightContent:o(()=>[t(y,{exportType:"pci"})]),_:1},8,["breadcrumbs"]),i("div",j,[m.isLoading?(a(),p(C,{key:0,class:"absolute-centered",theme:"transparent"})):(a(),n(_,{key:1},[i("div",E,[t(P,{sections:r.actions,placement:"bottom-start"},{trigger:o(c=>[t(w,{onClick:c.toggle,class:N({"filter-button--active":!!m.mode})},{default:o(()=>[l(h(r.filterLabel)+" ",1),W]),_:2},1032,["onClick","class"])]),_:1},8,["sections"])]),i("div",G,[t(b,{title:"PCI compliance overview"}),(a(!0),n(_,null,H(r.sections??{},(c,d)=>(a(),p(S,{key:d,section:c,code:d},null,8,["section","code"]))),128)),r.emptyControlsMessage?(a(),n("div",J,[t(k,{size:"medium"},{default:o(()=>[l(h(r.emptyControlsMessage),1)]),_:1})])):T("",!0)])],64))])],64)}const le=B(X,[["render",K]]);export{le as default};
