import{_ as C,M as S,B as k,f as v,H as U,V as x,g_ as N,bg as w,g$ as b,r as a,q as c,k as r,w as t,o as l,s as o,n as i,u as h,p as I}from"./index-13ff96f4.js";import{U as V}from"./UploadJsonFileInput-be53818c.js";const F={props:{cloud:Object},emits:["close"],components:{UploadJsonFileInput:V,BaseModal:S,BaseParagraph:k,BaseButton:v,BaseHeading:U,InputText:x},data(){return{clientSecret:void 0,isSaving:!1,updatedByName:null}},mounted(){this.cloud.secret_updated_by!==-1&&this.fetchFullNameForUser(this.cloud.secret_updated_by)},methods:{handleClose(){this.$emit("close")},async handleSave(){try{this.isSaving=!0,await N(this.cloud,this.clientSecret),w(this.cloud.id,"scan"),Toast.success({title:"Client Secret Updated",description:"We successfully updated the client secret for this cloud integration. We'll immediately start a scan."}),this.handleClose()}finally{this.isSaving=!1}},formatDate(s){return s?new Date(s*1e3).toLocaleDateString("en-CA"):"Unknown"},async fetchFullNameForUser(s){try{const e=await b(s);this.updatedByName=e.full_name||null}catch{this.updatedByName=null}}}},D=i("div",{class:"border-b-carbon-20"},null,-1),M={class:"flex flex-column gap-4px"};function T(s,e,u,H,n,d){const p=a("BaseParagraph"),f=a("BaseHeading"),g=a("UploadJsonFileInput"),y=a("InputText"),_=a("BaseButton"),B=a("BaseModal");return c(),r(B,{width:600,onClose:d.handleClose,allowBackgroundClose:!1},{header:t(()=>[l(p)]),content:t(()=>[l(f,{as:"h3"},{default:t(()=>[o("Update Secret")]),_:1}),l(p,{size:"medium"},{default:t(()=>[o("If you've rotated the secret in your cloud environment, update it here to keep Aikido scanning smoothly.")]),_:1}),D,i("div",M,[u.cloud.type==="gcp"?(c(),r(g,{key:0,onUpload:e[0]||(e[0]=m=>this.clientSecret=m)})):(c(),r(y,{key:1,modelValue:n.clientSecret,"onUpdate:modelValue":e[1]||(e[1]=m=>n.clientSecret=m),title:"Secret",placeholder:"****",type:"password"},null,8,["modelValue"])),u.cloud.secret_updated_at!==-1&&n.updatedByName?(c(),r(p,{key:2,color:"gray",class:"text--thin"},{default:t(()=>[o(" Last updated on "),i("strong",null,h(d.formatDate(u.cloud.secret_updated_at)),1),o(" by "),i("strong",null,h(n.updatedByName),1)]),_:1})):I("",!0)])]),footer:t(()=>[l(_,{onClicked:d.handleClose,variation:"tertiary",class:"ml-auto"},{default:t(()=>[o("Cancel")]),_:1},8,["onClicked"]),l(_,{onClicked:d.handleSave,"is-loading":n.isSaving},{default:t(()=>[o("Save")]),_:1},8,["onClicked","is-loading"])]),_:1},8,["onClose"])}const A=C(F,[["render",T]]);export{A as default};
