import{D as V,a as U}from"./DataTable-e31a825a.js";import{D as G,a as z}from"./DataTableCell-51c0104f.js";import{_ as T,a2 as H,B as k,r as s,q as m,m as f,o as e,w as t,s as c,u as _,n as r,p as w,a1 as J,f as X,d as M,dp as Y,bK as j,A as K,k as h,c7 as q,F,t as A}from"./index-13ff96f4.js";import{D as $}from"./DataTableSeverityIndicator-48ffb8dc.js";import{L as i}from"./languages-12749071.js";import{B as W}from"./BulletPointList-6afdb6ae.js";import{B as Q}from"./BulletPoint-1404881f.js";import{I as Z}from"./InputFilterDropdown-674351d9.js";import{O as ee}from"./OverviewEmptyState-c8440b9c.js";import{G as te}from"./GenericIllustration-4aca88e5.js";import{c as L}from"./autofixable-c6560249.js";import"./FilterButton-bb5393a7.js";import"./ActionMenu-3e4470bf.js";const ae={Python:"#3479B4",Java:"#DE8E2E",Go:"#1EAED8",JavaScript:"#FFDF00",JSX:"#FFDF00","C++":"#659AD1",TypeScript:"#3077C6",PHP:"#777BB3",Ruby:"#AB0D01",C:"#659BD2","C#":"#3C0094",Shell:"#000000",Nix:"#7EB4DF",Rust:"#F74B01",Scala:"#DE311D",Kotlin:"#6B57FF",Swift:"#F05137",Dart:"#2CB6F6",DM:"#15ACD3",Lua:"#000080",Groovy:"#619DBD",HTML:"#FF5721",Vue:"#3FB984",JSON:"#292929",XML:"#0060ac"},C=a=>ae[a]||"#757575",le={components:{BulletPointList:W,XTooltip:H,BulletPoint:Q,BaseParagraph:k},data(){return{visibleItemsAmount:5}},props:{programmingLanguageUsageList:{type:Array,required:!0}},computed:{list(){return this.programmingLanguageUsageList.slice(0,this.visibleItemsAmount).map((l,g)=>({id:g,color:C(l.programming_language),text:`${l.programming_language} - ${this.$t("X_FILES",l.usage_amount_files)}`}))},remainingItems(){return this.programmingLanguageUsageList.slice(this.visibleItemsAmount)},tooltip(){if(this.remainingItems.length==0)return null;const a=this.remainingItems.map(l=>`${l.programming_language} - ${this.$t("X_FILES",l.usage_amount_files)}`).join(`
`);return{title:this.$t("X_OTHERS",this.remainingItems.length),text:a,color:C("")}}},mounted(){window.innerWidth<1200&&(this.visibleItemsAmount=2)}},oe={class:"flex align-center gap-16px"},se={key:0,class:"flex align-center gap-4px"},ie={class:"ws-pre"};function ne(a,l,g,R,u,n){const b=s("BulletPointList"),y=s("BulletPoint"),v=s("BaseParagraph"),d=s("XTooltip");return m(),f("div",oe,[e(b,{iconSize:"medium",textSize:"small",list:n.list},null,8,["list"]),n.tooltip?(m(),f("div",se,[e(y,{color:n.tooltip.color,size:"medium"},null,8,["color"]),e(v,{class:"ws-nowrap",color:"gray",size:"small"},{default:t(()=>[c(_(n.tooltip.title),1)]),_:1}),e(d,null,{default:t(()=>[r("span",ie,_(n.tooltip.text),1)]),_:1})])):w("",!0)])}const re=T(le,[["render",ne]]),ue={components:{DataTable:V,DataTableCell:G,DataTableHeader:U,DataTableRow:z,BaseParagraph:k,LoadingSkeleton:J,DataTableSeverityIndicator:$,RepositoryProgrammingLanguageUsageList:re,BaseButton:X,BasePill:M,InputFilterDropdown:Z,OverviewEmptyState:ee,GenericIllustration:te},props:{repository:{type:Object,default:()=>({})}},data(){return{loading:!0,sastRules:[],languageFilter:void 0,languageSelectValues:[{value:void 0,label:"All languages",default:!0},{value:"PY",label:i.PY},{value:"Ruby",label:i.Ruby},{value:"rust",label:i.RUST},{value:"GO",label:i.GO},{value:"JS",label:i.JS},{value:"TS",label:i.TS},{value:"PHP",label:i.PHP},{value:"Java",label:i.Java},{value:"Scala",label:i.Scala},{value:".NET",label:i[".NET"]},{value:"C",label:i.C},{value:"kotlin",label:i.kotlin},{value:"dart",label:i.Dart},{value:"Elixir",label:i.Elixir},{value:"Swift",label:i.Swift}],typeFilter:void 0,typeOptions:[{value:void 0,label:"All types",default:!0},{value:"aikido_only",label:"Aikido rules"},{value:"custom_only",label:"Custom rules"},{value:"autofix_support_only",label:"Autofix supported rules"}]}},computed:{filteredSastRules(){let a=this.sastRules;return this.languageFilter&&(a=a.filter(l=>l.applicable_languages?l.applicable_languages.includes(this.languageFilter):l.language===this.languageFilter)),this.typeFilter&&(a=a.filter(l=>this.typeFilter=="aikido_only"?!l.is_custom_rule:this.typeFilter=="custom_only"?!!l.is_custom_rule:this.typeFilter=="autofix_support_only"?L(l.rule_id):!0)),a}},async created(){this.loading=!0,this.sastRules=await Y(),this.loading=!1},methods:{getSeverityText(a){return this.$t(j(a))},onAddCustomRuleClicked(){if(!K.isPayingAndNoProTrial()&&!this.$featureflags.force_enable_custom_sast_rules){const a="Hi, I would like to enable Custom SAST Rules.";window.Intercom("showNewMessage",a);return}this.$router.push("/repositories/sast/custom/add")},getCustomRuleLink(a){return a.is_custom_rule?`/repositories/sast/custom/${a.custom_rule_id}`:""},getAutofixableText(a){return L(a.rule_id)?"Yes":"No"},getAutofixableVariation(a){return L(a.rule_id)?"green":"gray-fill"}}},ce={class:"flex gap-16px align-center mb-24px w-full"},me=r("i",{class:"icon icon-add"},null,-1),ge={class:"flex w-full align-center"},de={class:"flex flex-column"},pe={class:"ml-auto"},_e=r("span",{class:"px-4px text--semi"},"Custom rule error",-1),fe=r("span",{class:"px-4px text--semi"},"Custom rule",-1),be={class:"w-full flex align-center justify-center"},he={class:"px-4px text--semi"};function ye(a,l,g,R,u,n){const b=s("InputFilterDropdown"),y=s("RepositoryProgrammingLanguageUsageList"),v=s("BaseButton"),d=s("DataTableHeader"),x=s("BaseParagraph"),p=s("DataTableCell"),S=s("BasePill"),P=s("DataTableSeverityIndicator"),D=s("DataTableRow"),I=s("GenericIllustration"),E=s("OverviewEmptyState"),B=s("LoadingSkeleton"),N=s("DataTable");return m(),f(F,null,[r("div",ce,[e(b,{modelValue:u.languageFilter,"onUpdate:modelValue":l[0]||(l[0]=o=>u.languageFilter=o),options:u.languageSelectValues},null,8,["modelValue","options"]),e(b,{modelValue:u.typeFilter,"onUpdate:modelValue":l[1]||(l[1]=o=>u.typeFilter=o),options:u.typeOptions},null,8,["modelValue","options"]),g.repository.programming_language_usage&&g.repository.programming_language_usage.length>0?(m(),h(y,{key:0,programmingLanguageUsageList:g.repository.programming_language_usage,class:"mobile_hidden"},null,8,["programmingLanguageUsageList"])):w("",!0),e(v,{class:"ml-auto",onClicked:n.onAddCustomRuleClicked,size:"small"},{default:t(()=>[me,c("Add custom rule ")]),_:1},8,["onClicked"])]),e(N,null,q({header:t(()=>[e(d,{width:"128px"},{default:t(()=>[c("Language")]),_:1}),e(d,{width:"auto"},{default:t(()=>[c("Description")]),_:1}),e(d,{width:"100px"},{default:t(()=>[c("Autofix")]),_:1}),e(d,{width:"96px"},{default:t(()=>[c("Score")]),_:1})]),_:2},[!u.loading&&n.filteredSastRules.length>0?{name:"body",fn:t(()=>[(m(!0),f(F,null,A(n.filteredSastRules,(o,O)=>(m(),h(D,{key:`${a.language}-${O}`,clickable:!!o.is_custom_rule,href:n.getCustomRuleLink(o)},{default:t(()=>[e(p,null,{default:t(()=>[e(x,{class:"text-programming-language",bold:""},{default:t(()=>[c(_(o.language),1)]),_:2},1024)]),_:2},1024),e(p,null,{default:t(()=>[r("div",ge,[r("div",de,[e(x,null,{default:t(()=>[c(_(o.title),1)]),_:2},1024),e(x,{size:"small",color:"subdued"},{default:t(()=>[c(_(o.description),1)]),_:2},1024)]),r("div",pe,[o.is_custom_rule&&o.custom_rule_has_error?(m(),h(S,{key:0,variation:"red",size:"compact"},{default:t(()=>[_e]),_:1})):o.is_custom_rule?(m(),h(S,{key:1,variation:"gray-fill",size:"compact"},{default:t(()=>[fe]),_:1})):w("",!0)])])]),_:2},1024),e(p,null,{default:t(()=>[r("div",be,[e(S,{variation:n.getAutofixableVariation(o),size:"compact"},{default:t(()=>[r("span",he,_(n.getAutofixableText(o)),1)]),_:2},1032,["variation"])])]),_:2},1024),e(P,{priority:o.base_score},null,8,["priority"])]),_:2},1032,["clickable","href"]))),128))]),key:"0"}:!u.loading&&n.filteredSastRules.length==0?{name:"body",fn:t(()=>[e(D,null,{default:t(()=>[r("td",{colspan:"3"},[e(E,{title:"No Custom Rules Yet",description:"Fine-tune security scans with rules crafted for your codebase using Opengrep.",variation:"empty",class:"mx-auto",actionLabel:"Add Custom Rule",onOnAction:n.onAddCustomRuleClicked},{default:t(()=>[e(I)]),_:1},8,["onOnAction"])])]),_:1})]),key:"1"}:{name:"body",fn:t(()=>[(m(),f(F,null,A(10,o=>e(D,{key:o},{default:t(()=>[e(p,null,{default:t(()=>[e(B)]),_:1}),e(p,null,{default:t(()=>[e(B,{width:"256px"})]),_:1}),e(p,null,{default:t(()=>[e(B)]),_:1})]),_:2},1024)),64))]),key:"2"}]),1024)],64)}const Pe=T(ue,[["render",ye]]);export{Pe as default};
