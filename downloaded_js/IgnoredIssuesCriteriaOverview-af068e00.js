import{_ as f,e as A,r as n,q as _,k as m,w as t,o as e,ai as S,p as T,B,a3 as D,bU as k,s as I,u as p,n as v,m as h,a1 as y,an as N,di as $,F as w,t as G}from"./index-13ff96f4.js";import{G as x}from"./GenericIllustration-4aca88e5.js";import{O as P}from"./OverviewEmptyState-c8440b9c.js";import{D as M,a as Y}from"./DataTable-e31a825a.js";import{D as O,a as C}from"./DataTableCell-51c0104f.js";import{B as F}from"./BulletPoint-1404881f.js";import{A as H}from"./ActionMenu-3e4470bf.js";const V={props:{criterium:Object},components:{DataTableCell:O,ActionMenu:H,BaseIconButton:A},computed:{actionItems(){return[{items:[{label:"Delete rule",onClick:this.handleDeleteIssueRule,destructive:!0,icon:"icon-delete",iconColor:"red"}]}]},showActionMenu(){return["rule_ignore"].includes(this.criterium.code)}},methods:{async handleDeleteIssueRule(){await this.$modal.show("DeleteIssueRuleModal",{rule:this.criterium.metadata,issueCount:this.criterium.issue_count})},handleClickActionMenu(){this.showActionMenu&&this.$refs.trigger.click()}}};function j(i,o,c,l,s,u){const r=n("BaseIconButton"),a=n("ActionMenu"),d=n("DataTableCell");return _(),m(d,{spacing:"compact",alignment:"center",class:"data-table__cell--action",onClick:S(u.handleClickActionMenu,["prevent","stop"])},{default:t(()=>[u.showActionMenu?(_(),m(a,{key:0,sections:u.actionItems,placement:"bottom-end","use-base-icon":!0},{trigger:t(E=>[e(r,{icon:"icon-actions",class:"data-table__row__action",onClick:S(E.toggle,["prevent"]),ref:"trigger"},null,8,["onClick"])]),_:1},8,["sections"])):T("",!0)]),_:1},8,["onClick"])}const K=f(V,[["render",j]]),Q={props:{criterium:Object,index:Number},components:{DataTableRow:C,DataTableCell:O,BulletPoint:F,BaseParagraph:B,IgnoredIssuesCriteriaOverviewActionMenu:K},computed:{title(){if(this.criterium.title)return this.criterium.title;if(!this.criterium.metadata||this.criterium.code!=="rule_ignore")return"Unknown reason";const{value:i,target:o,repo_id:c,repo_name:l,container_name:s,container_id:u}=this.criterium.metadata,r=c===0?"all repos":l,a=u===0?"all containers":s;return o==="cve_id"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_CVE.TITLE",{value:i,repo:r}):o==="path"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_PATH.TITLE",{repo:r}):o==="cloud_rule"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_CLOUD_RULE.TITLE",{value:i}):o==="sast_rule"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_CLOUD_RULE.TITLE",{value:i}):o==="scm_security_rule"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_SCM_SECURITY_RULE.TITLE",{value:i}):o==="package"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_PACKAGE.TITLE",{value:i,container:a}):"Unknown reason"},description(){if(this.criterium.description)return this.criterium.description;if(!this.criterium.metadata||this.criterium.code!=="rule_ignore")return"No information about this rule is available";const{target:i,created_at:o,value:c,created_by:l}=this.criterium.metadata,s=D.fromUnix(o).format(D.SHORT_DATE_FORMAT);return i==="cve_id"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_CVE.DESCRIPTION",{date:s,user:l}):i==="path"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_PATH.DESCRIPTION",{date:s,path:c,user:l}):i==="cloud_rule"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_CLOUD_RULE.DESCRIPTION",{date:s,user:l}):i==="sast_rule"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_SAST_RULE.DESCRIPTION",{date:s,user:l}):i==="scm_security_rule"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_SCM_SECURITY_RULE.DESCRIPTION",{date:s,user:l}):i==="package"?this.$t("IGNORED_ISSUE_CRITERIA.RULE_IGNORE.IGNORE_BY_PACKAGE.DESCRIPTION",{date:s,user:l}):"No information about this rule is available"},linkToOverviewWithFilter(){const i=k(),o=this.criterium.code==="rule_ignore"?`rule_ignore@${this.criterium.metadata.id}`:this.criterium.code;return`/issues/ignored?${new URLSearchParams({...i,ignore_reason_filter:o}).toString()}`}}},W={class:"flex align-center gap-8px w-full"},q={key:0,class:"icon icon-add icon-12px text-purple-accent"};function z(i,o,c,l,s,u){const r=n("BaseParagraph"),a=n("DataTableCell"),d=n("BulletPoint"),E=n("IgnoredIssuesCriteriaOverviewActionMenu"),g=n("DataTableRow");return _(),m(g,{clickable:!0,href:u.linkToOverviewWithFilter},{default:t(()=>[e(a,{spacing:"compact",alignment:"center"},{default:t(()=>[e(r,null,{default:t(()=>[I(p(c.index+1),1)]),_:1})]),_:1}),e(a,null,{default:t(()=>[v("div",W,[e(d,{color:c.criterium.color},{default:t(()=>[c.criterium.code==="rule_ignore"?(_(),h("i",q)):T("",!0)]),_:1},8,["color"]),e(r,{truncate:!0},{default:t(()=>[I(p(u.title),1)]),_:1})])]),_:1}),e(a,{alignment:"center"},{default:t(()=>[e(r,null,{default:t(()=>[I(p(c.criterium.issue_count),1)]),_:1})]),_:1}),e(a,null,{default:t(()=>[e(r,null,{default:t(()=>[I(p(u.description),1)]),_:1})]),_:1}),e(E,{criterium:c.criterium},null,8,["criterium"])]),_:1},8,["href"])}const J=f(Q,[["render",z]]),X={components:{DataTableRow:C,DataTableCell:O,LoadingSkeleton:y}};function Z(i,o,c,l,s,u){const r=n("LoadingSkeleton"),a=n("DataTableCell"),d=n("DataTableRow");return _(),m(d,null,{default:t(()=>[e(a,null,{default:t(()=>[e(r,{height:"16px"})]),_:1}),e(a,null,{default:t(()=>[e(r,{height:"16px"})]),_:1}),e(a,null,{default:t(()=>[e(r,{height:"16px"})]),_:1}),e(a,null,{default:t(()=>[e(r,{height:"16px"})]),_:1}),e(a,null,{default:t(()=>[e(r,{height:"16px"})]),_:1})]),_:1})}const ee=f(X,[["render",Z]]),te={data(){return{criteria:[],isLoading:!0}},async mounted(){N.on("issueRuleDeleted",this.getIgnoreCriteriaSummary),await this.getIgnoreCriteriaSummary(),this.isLoading=!1},beforeUnmount(){N.off("issueRuleDeleted",this.getIgnoreCriteriaSummary)},methods:{async getIgnoreCriteriaSummary(){this.criteria=await $()}},components:{DataTable:M,DataTableHeader:Y,IgnoredIssuesCriteriaOverviewRow:J,IgnoredIssuesCriteriaOverviewRowLoading:ee,DataTableRow:C,OverviewEmptyState:P,GenericIllustration:x},computed:{showEmptyState(){return!this.isLoading&&this.criteria.length===0}}},re={class:"my-24px"},ie={colspan:"4"};function ne(i,o,c,l,s,u){const r=n("DataTableHeader"),a=n("IgnoredIssuesCriteriaOverviewRowLoading"),d=n("IgnoredIssuesCriteriaOverviewRow"),E=n("GenericIllustration"),g=n("OverviewEmptyState"),U=n("DataTableRow"),L=n("DataTable");return _(),h("div",re,[e(L,null,{header:t(()=>[e(r,{width:"48px",alignment:"center"},{default:t(()=>[I("#")]),_:1}),e(r,{width:"30%"},{default:t(()=>[I("Reasons for ignoring")]),_:1}),e(r,{width:"100px",alignment:"center"},{default:t(()=>[I("# issues")]),_:1}),e(r,{width:"auto"},{default:t(()=>[I("Description")]),_:1}),e(r,{width:"48px"})]),body:t(()=>[s.isLoading?(_(),h(w,{key:0},G(5,R=>e(a,{key:R})),64)):(_(!0),h(w,{key:1},G(s.criteria,(R,b)=>(_(),m(d,{key:R.code,criterium:R,index:b},null,8,["criterium","index"]))),128)),u.showEmptyState?(_(),m(U,{key:2},{default:t(()=>[v("td",ie,[e(g,{title:i.$t("FEED.EMPTY_STATE.IGNORED_CRITERIA.NO_ISSUES.TITLE"),description:i.$t("FEED.EMPTY_STATE.IGNORED_CRITERIA.NO_ISSUES.DESCRIPTION"),variation:"empty"},{default:t(()=>[e(E)]),_:1},8,["title","description"])])]),_:1})):T("",!0)]),_:1})])}const Ie=f(te,[["render",ne]]);export{Ie as default};
