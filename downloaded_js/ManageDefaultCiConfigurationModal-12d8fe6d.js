import{_ as x,au as w,N as k,z as I,bk as D,d as V,A as h,gX as M,gY as B,r as c,T as P,q as i,k as m,w as r,p as S,U as A,m as u,n as f,o as l,s as d,F as O}from"./index-13ff96f4.js";const j=a=>new Promise(n=>setTimeout(n,a)),U={emits:["close","saved"],components:{BaseConfirmModal:w,BaseSelect:k,InputSwitch:I,BaseBody:D,BasePill:V},props:{},data(){return{loaded:!1,enableDefaultConfig:!1,minimumSeverity:"critical",enableDependencyScan:!0,enableIacScan:!1,enableSastScan:!1,enableSecretsScan:!1,enableMalwareScan:!1,postInlineCommentsMinimumSeverity:"none",disableChecksOnDraftPullRequests:!!this.$featureflags.pr_checks_disable_draft_pr}},watch:{enableSecretsScan(){this.disableInlineCommentOption&&(this.postInlineCommentsMinimumSeverity="none")},enableSastScan(){this.disableInlineCommentOption&&(this.postInlineCommentsMinimumSeverity="none")},enableIacScan(){this.disableInlineCommentOption&&(this.postInlineCommentsMinimumSeverity="none")}},async mounted(){await this.fetchDefaultChecksConfiguration(),await j(210),this.loaded=!0},computed:{isPayingAccount(){return h.isPaying()},minimumSeverityOptions(){return[{id:"critical",title:"Critical Only",disabled:this.minimumSeverity==="critical"},{id:"high",title:"High and Above",disabled:this.minimumSeverity==="high"},{id:"medium",title:"Medium and Above",disabled:this.minimumSeverity==="medium"},{id:"low",title:"Low and Above",disabled:this.minimumSeverity==="low"}]},isInlineCommentsSupported(){return["github"].includes(this.$group.scm_type)},inlineCommentsMinimumSeverityOptions(){return[{id:"critical",title:"Critical Only"},{id:"high",title:"High and Above"},{id:"medium",title:"Medium and Above"},{id:"low",title:"Low and Above"},{id:"none",title:"No Comments"}]},disableInlineCommentOption(){return!this.enableSastScan&&!this.enableSecretsScan&&!this.enableIacScan},showDisableOnDraftPrSetting(){return["github"].includes(this.$group.scm_type)}},methods:{handleClose(){this.$emit("close")},async handleSaveConfiguration(){if(this.enableDefaultConfig&&!this.enableDependencyScan&&!this.enableSastScan&&!this.enableIacScan&&!this.enableSecretsScan){this.$toast.error({title:"Invalid Configuration",description:"You must enable at least one of the scans to enable scanning."});return}const a={enable_default_config:this.enableDefaultConfig,minimum_severity:this.minimumSeverity,fail_on_dependency_scan:this.enableDependencyScan,fail_on_sast_scan:this.enableSastScan,fail_on_iac_scan:this.enableIacScan,fail_on_secrets_scan:this.enableSecretsScan,fail_on_malware_scan:this.enableMalwareScan,post_inline_comments:this.enablePostInlineComments,post_inline_comments_min_severity:this.postInlineCommentsMinimumSeverity,disable_checks_on_draft_pull_requests:this.disableChecksOnDraftPullRequests};await M(a),h.fetchProfile(),this.$emit("saved"),this.$toast.success({title:"Configuration Saved",description:"Default configuration settings have been saved."})},async fetchDefaultChecksConfiguration(){const a=await B();this.enableDefaultConfig=a.is_enabled,this.minimumSeverity=a.minimum_severity,this.enableDependencyScan=a.fail_on_dependency_scan,this.enableSastScan=a.fail_on_sast_scan,this.enableIacScan=a.fail_on_iac_scan,this.enableSecretsScan=a.fail_on_secrets_scan,this.enableMalwareScan=a.fail_on_malware_scan,this.postInlineCommentsMinimumSeverity=a.post_inline_comments_min_severity},requestCiMalwareScan(){const a="Hi, I would like to request malware in CI scanning.";window.Intercom("showNewMessage",a)}}},q=f("hr",{class:"divider w-full mb-16px -mt-24px"},null,-1),L={class:"flex flex-column gap-16px"},T=f("hr",{class:"divider w-full my-16px"},null,-1),N={key:0,class:"flex flex-column gap-16px"},R={class:"flex justify-between align-center"},F={key:1,class:"flex align-center justify-between"},H={key:3,class:"flex align-center justify-between"},X={key:5,class:"flex align-center justify-between"},z={key:7,class:"flex align-center justify-between"},G=f("hr",{class:"divider w-full"},null,-1),Y={class:"flex justify-between align-center gap-12px"};function E(a,n,J,K,e,s){const y=c("XPreloader"),o=c("InputSwitch"),C=c("BaseParagraph"),_=c("BaseSelect"),b=c("BaseBody"),p=c("BasePill"),g=c("BaseConfirmModal"),v=P("visible");return i(),m(g,{width:530,onClose:s.handleClose,onSecondaryButtonClicked:s.handleClose,onSubmit:s.handleSaveConfiguration,canClose:!0,title:"Configuration Settings",description:"Automatically activate new repos and apply specific configuration",descriptionClass:"text-gray-200",buttonSubmitText:"Apply Changes",buttonSecondaryText:"Cancel",headerText:" "},{default:r(()=>[e.loaded?S("",!0):(i(),m(y,{key:0,size:"medium",class:"absolute-centered",theme:"transparent"})),A((i(),u("div",null,[q,f("div",L,[l(o,{modelValue:e.enableDefaultConfig,"onUpdate:modelValue":n[0]||(n[0]=t=>e.enableDefaultConfig=t),class:"justify-between",labelLeft:"Automatically activate scan configuration for new repos",labelClass:"text-12px text--semi"},null,8,["modelValue"]),s.showDisableOnDraftPrSetting?(i(),m(o,{key:0,modelValue:e.disableChecksOnDraftPullRequests,"onUpdate:modelValue":n[1]||(n[1]=t=>e.disableChecksOnDraftPullRequests=t),class:"justify-between",labelLeft:"Disable checks on draft Pull Requests",labelClass:"text-12px text--semi"},null,8,["modelValue"])):S("",!0)]),T,!e.loaded||e.enableDefaultConfig?(i(),u("div",N,[f("label",R,[l(C,{class:"text--semi"},{default:r(()=>[d("Check Failure For")]),_:1}),l(_,{modelValue:e.minimumSeverity,"onUpdate:modelValue":n[2]||(n[2]=t=>e.minimumSeverity=t),options:s.minimumSeverityOptions,class:"min-w-116px",placeholder:""},null,8,["modelValue","options"])]),l(o,{modelValue:e.enableDependencyScan,"onUpdate:modelValue":n[3]||(n[3]=t=>e.enableDependencyScan=t),class:"justify-between",labelLeft:"Dependency Scan",labelClass:"text-12px text--semi"},null,8,["modelValue"]),s.isPayingAccount?(i(),m(o,{key:0,modelValue:e.enableSastScan,"onUpdate:modelValue":n[4]||(n[4]=t=>e.enableSastScan=t),class:"justify-between",labelLeft:"SAST Scan",labelClass:"text-12px text--semi"},null,8,["modelValue"])):(i(),u("div",F,[l(b,{class:"text-12px text--semi"},{default:r(()=>[d("SAST Scan")]),_:1}),l(p,{variation:"purple",title:"Upgrade"})])),s.isPayingAccount?(i(),m(o,{key:2,modelValue:e.enableIacScan,"onUpdate:modelValue":n[5]||(n[5]=t=>e.enableIacScan=t),class:"justify-between",labelLeft:"IaC Scan",labelClass:"text-12px text--semi"},null,8,["modelValue"])):(i(),u("div",H,[l(b,{class:"text-12px text--semi"},{default:r(()=>[d("IAC Scan")]),_:1}),l(p,{variation:"purple",title:"Upgrade"})])),s.isPayingAccount?(i(),m(o,{key:4,modelValue:e.enableSecretsScan,"onUpdate:modelValue":n[6]||(n[6]=t=>e.enableSecretsScan=t),class:"justify-between",labelLeft:"Secrets Scan",labelClass:"text-12px text--semi"},null,8,["modelValue"])):(i(),u("div",X,[l(b,{class:"text-12px text--semi"},{default:r(()=>[d("Secrets Scan")]),_:1}),l(p,{variation:"purple",title:"Upgrade"})])),a.$featureflags.enable_ci_malware_scan?(i(),m(o,{key:6,modelValue:e.enableMalwareScan,"onUpdate:modelValue":n[7]||(n[7]=t=>e.enableMalwareScan=t),class:"justify-between",labelLeft:"Malware Scan",labelClass:"text-12px text--semi"},null,8,["modelValue"])):(i(),u("div",z,[l(b,{class:"text-12px text--semi"},{default:r(()=>[d("Malware Scan")]),_:1}),l(p,{variation:"green",title:"Get in touch",class:"cursor-pointer",onClick:s.requestCiMalwareScan},null,8,["onClick"])])),s.isInlineCommentsSupported?(i(),u(O,{key:8},[G,f("div",Y,[l(b,{class:"text-12px text--semi"},{default:r(()=>[d("Add inline comments on the PR in GitHub")]),_:1}),l(_,{modelValue:e.postInlineCommentsMinimumSeverity,"onUpdate:modelValue":n[8]||(n[8]=t=>e.postInlineCommentsMinimumSeverity=t),options:s.inlineCommentsMinimumSeverityOptions,disabled:s.disableInlineCommentOption,class:"min-w-116px"},null,8,["modelValue","options","disabled"])])],64)):S("",!0)])):S("",!0)])),[[v,e.loaded]])]),_:1},8,["onClose","onSecondaryButtonClicked","onSubmit"])}const W=x(U,[["render",E]]);export{W as default};
