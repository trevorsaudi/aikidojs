import{_ as B,M as g,B as y,f as v,V as w,H as x,N as V,g as S,r as t,q as p,k as u,w as e,o,s as n,n as K,p as C,u as I}from"./index-13ff96f4.js";import{l as b,a as D}from"./drata-1feda70f.js";const N={emits:["close","saved"],components:{BaseModal:g,BaseParagraph:y,BaseButton:v,InputText:w,BaseHeading:x,BaseSelect:V,BaseLink:S},props:{id:Number,username:String,registry_name:String},data(){return{apiKey:"",isSaving:!1,step:"token",workspaceOptions:[],selectedWorkspaceId:null}},computed:{isValid(){return this.apiKey.trim()!==""}},methods:{close(){this.$emit("close")},async next(){if(this.step==="token"){const l=await b({token:this.apiKey});this.workspaceOptions=l.map(a=>({id:a.id,title:a.name})),this.selectedWorkspaceId=this.workspaceOptions[0].id,this.step="workspace"}else await this.save()},async save(){if(this.isValid){this.isSaving=!0;try{await D({token:this.apiKey,workspace_id:this.selectedWorkspaceId}),this.$toast.success("Successfully updated your Drata credentials"),this.$emit("saved")}finally{this.isSaving=!1}}}}},P={class:"flex flex-column gap-12px"};function T(l,a,W,M,s,i){const c=t("BaseParagraph"),m=t("BaseHeading"),k=t("BaseLink"),_=t("InputText"),f=t("BaseSelect"),d=t("BaseButton"),h=t("BaseModal");return p(),u(h,{width:600,onClose:i.close},{header:e(()=>[o(c,{color:"gray"},{default:e(()=>[n("Drata integration")]),_:1})]),content:e(()=>[K("div",P,[o(m,{as:"h3"},{default:e(()=>[n("Add your Drata API Key")]),_:1}),o(c,{size:"medium",loose:""},{default:e(()=>[n(" Read our documentation on "),o(k,{href:"https://help.aikido.dev/en/articles/8523691-compliance-integration-with-drata",target:"_blank"},{default:e(()=>[n("How to connect Drata")]),_:1}),n(". ")]),_:1})]),o(_,{disabled:s.step!=="token",title:"API Key",placeholder:"12345678-90a1-23b4-567c-de89fg012345",modelValue:s.apiKey,"onUpdate:modelValue":a[0]||(a[0]=r=>s.apiKey=r),modelModifiers:{trim:!0},name:"apiKey",onEnterKeyPress:i.save},null,8,["disabled","modelValue","onEnterKeyPress"]),s.step==="workspace"?(p(),u(f,{key:0,label:"Workspace",modelValue:s.selectedWorkspaceId,"onUpdate:modelValue":a[1]||(a[1]=r=>s.selectedWorkspaceId=r),options:s.workspaceOptions},null,8,["modelValue","options"])):C("",!0)]),footer:e(()=>[o(d,{onClicked:i.close,variation:"tertiary",class:"ml-auto"},{default:e(()=>[n("Cancel")]),_:1},8,["onClicked"]),o(d,{onClicked:i.next,isLoading:s.isSaving,disabled:!i.isValid},{default:e(()=>[n(I(this.step=="token"?"Next":"Save"),1)]),_:1},8,["onClicked","isLoading","disabled"])]),_:1},8,["onClose"])}const A=B(N,[["render",T]]);export{A as default};
