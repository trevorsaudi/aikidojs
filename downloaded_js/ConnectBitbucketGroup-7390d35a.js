import{a0 as c,_ as p,eU as u,eV as T,Y as l,b_ as d,b$ as C,r as s,k as O,w as E,q as N,o as b}from"./index-13ff96f4.js";import{C as m}from"./ConnectGroup-e27591ad.js";import{O as B}from"./OnboardingEmptyState-28bd43c0.js";import"./OnboardingProgressIndicator-8fa4a42d.js";async function g(){return(await c.get("/api/scm_integrations/bitbucket/listAccessibleWorkspaces")).data.workspaces}const G={components:{ConnectGroup:m,OnboardingEmptyState:B},data(){return{accessibleGroups:[],isLoading:!0}},async mounted(){this.accessibleGroups=await g(),this.isLoading=!1},computed:{groupOptions(){return this.accessibleGroups.map(e=>({id:e.slug,title:`${e.name} (${e.slug})`}))}},methods:{async handleCreateGroup({selectedGroup:e}){const{sys_group_id:n,status:o}=await u(e);if(o=="already_exists"){if(this.$user.auth_type!="bitbucket"){this.$toast.error({title:this.$t("SOMETHING_WENT_WRONG"),description:"This bitbucket already exists in Aikido. You need an invite to join."});return}await T()}await l.setGroupContext(n),d(),C(),go("/onboarding/bitbucket/connect-repositories")},async handleCreateSample(){go("/onboarding/demo")},handleUseDifferentAccount(){this.$router.replace("/onboarding/bitbucket/connect-organization")},goBack(){if(this.$user.auth_type!="bitbucket"){this.$router.replace("/onboarding/self-managed/select-onboarding-type");return}this.$router.replace("/onboarding/bitbucket/connect-organization")}}};function I(e,n,o,_,a,t){const i=s("OnboardingEmptyState"),r=s("ConnectGroup");return N(),O(r,{title:e.$t("ONBOARDING.BITBUCKET.CONNECT_GROUP.TITLE"),description:e.$t("ONBOARDING.BITBUCKET.CONNECT_GROUP.DESCRIPTION"),"select-title":e.$t("ONBOARDING.BITBUCKET.CONNECT_GROUP.SELECT.TITLE"),"select-description":e.$t("ONBOARDING.BITBUCKET.CONNECT_GROUP.SELECT.DESCRIPTION"),groups:t.groupOptions,"is-loading":a.isLoading,"number-of-steps":4,"number-of-completed-steps":1,onContinue:t.handleCreateGroup,onBack:t.goBack,icon:"icon-bitbucket"},{emptyState:E(()=>[b(i,{title:e.$t("ONBOARDING.BITBUCKET.CONNECT_GROUP.EMPTY_STATE.TITLE"),description:e.$t("ONBOARDING.BITBUCKET.CONNECT_GROUP.EMPTY_STATE.DESCRIPTION"),"primary-cta":e.$t("ONBOARDING.BITBUCKET.CONNECT_GROUP.EMPTY_STATE.PRIMARY_CTA"),"secondary-cta":e.$t("ONBOARDING.BITBUCKET.CONNECT_GROUP.EMPTY_STATE.SECONDARY_CTA"),onUseSample:t.handleCreateSample,onUseDifferentAccount:t.handleUseDifferentAccount},null,8,["title","description","primary-cta","secondary-cta","onUseSample","onUseDifferentAccount"])]),_:1},8,["title","description","select-title","select-description","groups","is-loading","onContinue","onBack"])}const A=p(G,[["render",I]]);export{A as default};
